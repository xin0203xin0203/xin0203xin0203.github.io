<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>知安</title>
  
  <subtitle>生活明朗 万物可爱</subtitle>
  <link href="https://xin0203xin0203.github.io/atom.xml" rel="self"/>
  
  <link href="https://xin0203xin0203.github.io/"/>
  <updated>2024-12-14T17:48:48.000Z</updated>
  <id>https://xin0203xin0203.github.io/</id>
  
  <author>
    <name>知安</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>三、Hive组件搭建--_内含MySQL安装</title>
    <link href="https://xin0203xin0203.github.io/posts/e3a54e89.html"/>
    <id>https://xin0203xin0203.github.io/posts/e3a54e89.html</id>
    <published>2023-12-15T07:30:17.236Z</published>
    <updated>2024-12-14T17:48:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>前置准备：<br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed">一、集群环境搭建高可用版本配置</a><br><a href="https://www.yuque.com/u25360462/nt1ri1/wzn655?view=doc_embed">二、zookeeper组件搭建</a><br>需要的安装包：<br>1.<a href="https://dev.mysql.com/downloads/file/?id=514685">MySQL</a>压缩包—-&gt;mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar<br>2.<a href="https://dlcdn.apache.org/hive/">Hive</a>压缩包—-&gt;apache-hive-2.3.4-bin.tar.gz<br>3.<a href="https://dev.mysql.com/downloads/connector/j/">MySQL的jar</a>包—-&gt;mysql-connector-java-5.1.37.jar<br>4.<a href="https://www.apache.org/dyn/closer.lua/tez/0.9.2/">tez引擎</a>包—-&gt;apache-tez-0.9.2-bin.tar.gz</p><h1 id="一、CentOS7-x安装MYSQL8-0-19"><a href="#一、CentOS7-x安装MYSQL8-0-19" class="headerlink" title="一、CentOS7.x安装MYSQL8.0.19"></a>一、CentOS7.x安装MYSQL8.0.19</h1><p>跟Hive组件一起连用，如果不需要，可以跳过<br>MySQL 8.0新特性：<br>1、默认字符集由latin1变为utf8mb4<br>2、MyISAM系统表全部换成InnoDB表<br>3、自增主键AUTO<em>INCREMENT的值支持持久化<br>4、InnoDB表的DDL支持事务完整性<br>5、支持在线修改全局参数并持久化<br>6、新增降序索引<br>7、对于group by字段不再隐式排序<br>8、大幅改进了对JSON的支持<br>9、支持redo和undo日志加密<br>10、InnoDB select for update跳过锁等待<br>11、在SQL语法中增加SET_VAR语法<br>12、使用INVISIBLE关键字在创建表或进行表变更中设置索引是否可见<br>13、支持直方图<br>14、新增innodb_dedicated_server参数<br>15、日志分类更详细<br>16、undo空间自动回收<br>17、新增资源组功能，用于调控线程优先级及绑定CPU<br>18、增加角色管理<br>[009-尚硅谷-Hive-配置Hive元数据存储为MySQL&amp;再次启动测试</em>哔哩哔哩_bilibili](<a href="https://www.bilibili.com/video/BV1EZ4y1G7iL/?p=9&amp;spm_id_from=pageDriver&amp;vd_source=da2acaac8a1d2357dae9e3de7ea3357e">https://www.bilibili.com/video/BV1EZ4y1G7iL/?p=9&amp;spm_id_from=pageDriver&amp;vd_source=da2acaac8a1d2357dae9e3de7ea3357e</a>)</p><h2 id="1-安装文件"><a href="#1-安装文件" class="headerlink" title="1. 安装文件"></a>1. 安装文件</h2><h3 id="1-1-关闭firewalld和selinux"><a href="#1-1-关闭firewalld和selinux" class="headerlink" title="1.1 关闭firewalld和selinux"></a>1.1 关闭<a href="https://so.csdn.net/so/search?q=firewalld&amp;urw=">firewalld</a>和<a href="https://so.csdn.net/so/search?q=selinux&amp;urw=">selinux</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="string">&#x27;查看防火墙&#x27;</span>&gt; systemctl status firewalld</span><br><span class="line">&lt;<span class="string">&#x27;关闭防火墙&#x27;</span>&gt; sudo systemctl stop firewalld</span><br><span class="line">&lt;<span class="string">&#x27;关闭selinux&#x27;</span>&gt; sudo vim /etc/selinux/config</span><br><span class="line">修改为:</span><br><span class="line">      SELINUX=disabled</span><br><span class="line">      SELINUXTYPE=targeted</span><br><span class="line">&lt;<span class="string">&#x27;查看selinux&#x27;</span>&gt; sestatus</span><br></pre></td></tr></table></figure><h3 id="1-2-删除CentOS-7-x自带的MariaDB"><a href="#1-2-删除CentOS-7-x自带的MariaDB" class="headerlink" title="1.2 删除CentOS 7.x自带的MariaDB"></a>1.2 删除CentOS 7.x自带的<a href="https://so.csdn.net/so/search?q=MariaDB&amp;urw=">MariaDB</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="string">&#x27;查看mariadb&#x27;</span>&gt; rpm -qa | grep -i mariadb</span><br><span class="line">mariadb-libs-5.5.56-2.el7.x86_64</span><br><span class="line">&lt;<span class="string">&#x27;删掉mariadb&#x27;</span>&gt; sudo rpm -e --nodeps mariadb-libs-5.5.56-2.el7.x86_64</span><br></pre></td></tr></table></figure><h3 id="可跳过-1-3-删除原有的MySQL"><a href="#可跳过-1-3-删除原有的MySQL" class="headerlink" title="(可跳过)1.3 删除原有的MySQL"></a>(可跳过)1.3 删除原有的MySQL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="string">&#x27;查看MySQL&#x27;</span>&gt; rpm -qa | grep -i mysql</span><br><span class="line">&lt;<span class="string">&#x27;卸载MySQL&#x27;</span>&gt; sudo yum -y remove <span class="string">&#x27;文件&#x27;</span></span><br><span class="line">&lt;<span class="string">&#x27;查找MySQL相关目录&#x27;</span>&gt; sudo find / -name mysql</span><br><span class="line">&lt;<span class="string">&#x27;删除MySQL相关目录&#x27;</span>&gt; sudo <span class="built_in">rm</span> -rf <span class="string">&#x27;文件&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="1-4-下载并安装MySQL8-0"><a href="#1-4-下载并安装MySQL8-0" class="headerlink" title="1.4 下载并安装MySQL8.0"></a>1.4 下载并安装<a href="https://blog.csdn.net/young_0609/article/details/109015666">MySQL8.0</a></h3><p> 这里直接使用mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar就行了不用wget下载<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wegt 不能执行,就直接下载wegt组件 ---&gt;  sudo yum -y install wget</span></span><br><span class="line">wget https://cdn.mysql.com//Downloads/MySQL-Cluster-8.0/mysql-cluster-community-8.0.31-1.el9.x86_64.rpm-bundle.tar</span><br><span class="line">tar -xf mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar -C /opt/</span><br></pre></td></tr></table></figure></p><h3 id="1-5-压缩MySQL运行包"><a href="#1-5-压缩MySQL运行包" class="headerlink" title="1.5 压缩MySQL运行包"></a>1.5 压缩MySQL运行包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -ivh mysql-community-common-5.7.28-1.el7.x86_64.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-libs-5.7.28-1.el7.x86_64.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-libs-compat-5.7.28-1.el7.x86_64.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-client-5.7.28-1.el7.x86_64.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-server-5.7.28-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><h3 id="1-6-如果mysql-community-server-5-7-28-1-el7-x86-64-rpm安装报错，就下载MySQL-server依赖包"><a href="#1-6-如果mysql-community-server-5-7-28-1-el7-x86-64-rpm安装报错，就下载MySQL-server依赖包" class="headerlink" title="1.6 如果mysql-community-server-5.7.28-1.el7.x86_64.rpm安装报错，就下载MySQL-server依赖包"></a>1.6 如果mysql-community-server-5.7.28-1.el7.x86_64.rpm安装报错，就下载MySQL-server依赖包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install libaio</span><br></pre></td></tr></table></figure><h2 id="2-配置MySQL文件并启动"><a href="#2-配置MySQL文件并启动" class="headerlink" title="2. 配置MySQL文件并启动"></a>2. 配置MySQL文件并启动</h2><h3 id="2-1-查看datadir的值"><a href="#2-1-查看datadir的值" class="headerlink" title="2.1 查看datadir的值"></a>2.1 查看datadir的值</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/my.cnf</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"># For advice on how to change settings please see</span></span><br><span class="line"><span class="string"># http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Remove leading # and set to the amount of RAM for the most important data</span></span><br><span class="line"><span class="string"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</span></span><br><span class="line"><span class="string"># innodb_buffer_pool_size = 128M</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Remove leading # to turn on a very important data integrity option: logging</span></span><br><span class="line"><span class="string"># changes to the binary log between backups.</span></span><br><span class="line"><span class="string"># log_bin</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Remove leading # to set options mainly useful for reporting servers.</span></span><br><span class="line"><span class="string"># The server defaults are faster for transactions and fast SELECTs.</span></span><br><span class="line"><span class="string"># Adjust sizes as needed, experiment to find the optimal values.</span></span><br><span class="line"><span class="string"># join_buffer_size = 128M</span></span><br><span class="line"><span class="string"># sort_buffer_size = 2M</span></span><br><span class="line"><span class="string"># read_rnd_buffer_size = 2M</span></span><br><span class="line"><span class="string">datadir=/var/lib/mysql</span></span><br><span class="line"><span class="string">socket=/var/lib/mysql/mysql.sock</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Disabling symbolic-links is recommended to prevent assorted security risks</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">log-error=/var/log/mysqld.log</span></span><br><span class="line"><span class="string">pid-file=/var/run/mysqld/mysqld.pid</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-删除-var-lib-mysql目录下的所有内容："><a href="#2-2-删除-var-lib-mysql目录下的所有内容：" class="headerlink" title="2.2 删除/var/lib/mysql目录下的所有内容："></a>2.2 删除/var/lib/mysql目录下的所有内容：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> -rf ./*// 注意执行命令,删错了重来(传说中的：删库跑路)</span><br><span class="line"><span class="comment">#查看内容:</span></span><br><span class="line">sudo <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><h3 id="2-3-初始化数据库"><a href="#2-3-初始化数据库" class="headerlink" title="2.3 初始化数据库"></a>2.3 <a href="https://blog.csdn.net/liuwkk/article/details/110627234">初始化</a>数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mysqld --initialize --user=mysql</span><br></pre></td></tr></table></figure><h3 id="2-4-查看临时生成的root用户的密码"><a href="#2-4-查看临时生成的root用户的密码" class="headerlink" title="2.4 查看临时生成的root用户的密码"></a>2.4 查看临时生成的root用户的密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cat</span> /var/log/mysqld.log</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.104258Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.525465Z 0 [Warning] InnoDB: New log files created, LSN=45790</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.703239Z 0 [Warning] InnoDB: Creating foreign key constraint system tables.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.822416Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: 2b9e4e23-635e-11ed-a517-000c29b25ef7.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.826219Z 0 [Warning] Gtid table is not ready to be used. Table &#x27;</span>mysql.gtid_executed<span class="string">&#x27; cannot be opened.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:23.146937Z 0 [Warning] CA certificate ca.pem is self signed.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:23.425713Z 1 [Note] A temporary password is generated for root@localhost: ?yr6d34alX5q</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 密码:  ?yr6d34alX5q</span></span><br></pre></td></tr></table></figure><h3 id="2-5-启动MySQL及查看启动状态"><a href="#2-5-启动MySQL及查看启动状态" class="headerlink" title="2.5 启动MySQL及查看启动状态"></a>2.5 启动MySQL及查看启动状态</h3><p>不是管理者需要sudo<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">service mysqld start</span><br><span class="line">service mysqld status</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Redirecting to /bin/systemctl status mysqld.service</span></span><br><span class="line"><span class="string">● mysqld.service - MySQL Server</span></span><br><span class="line"><span class="string">   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)</span></span><br><span class="line"><span class="string">   Active: active (running) since 日 2022-11-13 22:24:37 CST; 18s ago</span></span><br><span class="line"><span class="string">     Docs: man:mysqld(8)</span></span><br><span class="line"><span class="string">           http://dev.mysql.com/doc/refman/en/using-systemd.html</span></span><br><span class="line"><span class="string">  Process: 42313 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span></span><br><span class="line"><span class="string">  Process: 42296 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)</span></span><br><span class="line"><span class="string"> Main PID: 42316 (mysqld)</span></span><br><span class="line"><span class="string">   CGroup: /system.slice/mysqld.service</span></span><br><span class="line"><span class="string">           └─42316 /usr/sbin/mysqld --daemonize --pid-file=/var/run...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">11月 13 22:24:36 master systemd[1]: Starting MySQL Server...</span></span><br><span class="line"><span class="string">11月 13 22:24:37 master systemd[1]: Started MySQL Server.</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#  running 证明已开启</span></span><br><span class="line"><span class="comment">#  dead 证明已关闭</span></span><br></pre></td></tr></table></figure></p><h3 id="2-6-登录-lt-—-gt-登出"><a href="#2-6-登录-lt-—-gt-登出" class="headerlink" title="2.6  登录 &lt;! —- !&gt; 登出"></a>2.6  登录 &lt;! —- !&gt; 登出</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">Enter password:<span class="string">&#x27;?yr6d34alX5q(临时密码)&#x27;</span></span><br><span class="line"><span class="comment"># Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span><br><span class="line"><span class="comment"># Your MySQL connection id is 16</span></span><br><span class="line"><span class="comment"># Server version: 8.0.20 MySQL Community Server - GPL</span></span><br><span class="line"><span class="comment"># Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="comment"># Oracle is a registered trademark of Oracle Corporation and/or its</span></span><br><span class="line"><span class="comment"># affiliates. Other names may be trademarks of their respective</span></span><br><span class="line"><span class="comment"># owners.</span></span><br><span class="line"><span class="comment"># Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span></span><br><span class="line"><span class="comment"># mysql&gt; </span></span><br></pre></td></tr></table></figure><h2 id="3-MySQL配置向导"><a href="#3-MySQL配置向导" class="headerlink" title="3. MySQL配置向导"></a>3. MySQL配置向导</h2><h3 id="3-1-修改root用户密码"><a href="#3-1-修改root用户密码" class="headerlink" title="3.1 修改root用户密码"></a>3.1 修改root用户密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改MySQL的root密码,使及密码生效</span></span><br><span class="line">mysql&gt; <span class="built_in">set</span> password = password(<span class="string">&quot;新密码&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="3-2-进去mysql库中-修改mysqlku下的user表中的root用户允许任意ip连接-并及时生效"><a href="#3-2-进去mysql库中-修改mysqlku下的user表中的root用户允许任意ip连接-并及时生效" class="headerlink" title="3.2 进去mysql库中, 修改mysqlku下的user表中的root用户允许任意ip连接, 并及时生效"></a>3.2 进去mysql库中, 修改mysqlku下的user表中的root用户允许任意ip连接, 并及时生效</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">msyql&gt; show databases;---&gt; 查看数据库</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| Database           |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| information_schema |</span></span><br><span class="line"><span class="string">| mysql              |</span></span><br><span class="line"><span class="string">| performance_schema |</span></span><br><span class="line"><span class="string">| sys                |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">4 rows in set (0.01 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; show tables;---&gt; 查看数据表</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+---------------------------+</span></span><br><span class="line"><span class="string">| Tables_in_mysql           |</span></span><br><span class="line"><span class="string">+---------------------------+</span></span><br><span class="line"><span class="string">| columns_priv              |</span></span><br><span class="line"><span class="string">| db                        |</span></span><br><span class="line"><span class="string">| engine_cost               |</span></span><br><span class="line"><span class="string">| event                     |</span></span><br><span class="line"><span class="string">| func                      |</span></span><br><span class="line"><span class="string">| general_log               |</span></span><br><span class="line"><span class="string">| gtid_executed             |</span></span><br><span class="line"><span class="string">| help_category             |</span></span><br><span class="line"><span class="string">| help_keyword              |</span></span><br><span class="line"><span class="string">| help_relation             |</span></span><br><span class="line"><span class="string">| help_topic                |</span></span><br><span class="line"><span class="string">| innodb_index_stats        |</span></span><br><span class="line"><span class="string">| innodb_table_stats        |</span></span><br><span class="line"><span class="string">| ndb_binlog_index          |</span></span><br><span class="line"><span class="string">| plugin                    |</span></span><br><span class="line"><span class="string">| proc                      |</span></span><br><span class="line"><span class="string">| procs_priv                |</span></span><br><span class="line"><span class="string">| proxies_priv              |</span></span><br><span class="line"><span class="string">| server_cost               |</span></span><br><span class="line"><span class="string">| servers                   |</span></span><br><span class="line"><span class="string">| slave_master_info         |</span></span><br><span class="line"><span class="string">| slave_relay_log_info      |</span></span><br><span class="line"><span class="string">| slave_worker_info         |</span></span><br><span class="line"><span class="string">| slow_log                  |</span></span><br><span class="line"><span class="string">| tables_priv               |</span></span><br><span class="line"><span class="string">| time_zone                 |</span></span><br><span class="line"><span class="string">| time_zone_leap_second     |</span></span><br><span class="line"><span class="string">| time_zone_name            |</span></span><br><span class="line"><span class="string">| time_zone_transition      |</span></span><br><span class="line"><span class="string">| time_zone_transition_type |</span></span><br><span class="line"><span class="string">| user                      |</span></span><br><span class="line"><span class="string">+---------------------------+</span></span><br><span class="line"><span class="string">31 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 先进到mysql里，use mysql;</span></span><br><span class="line">mysql&gt; <span class="keyword">select</span> Host,User from user;---&gt; 查user表中的root用户</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| Host      | User          |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| localhost | mysql.session |</span></span><br><span class="line"><span class="string">| localhost | mysql.sys     |</span></span><br><span class="line"><span class="string">| localhost | root          |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">3 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; update mysql.user <span class="built_in">set</span> host=<span class="string">&quot;%&quot;</span> <span class="built_in">where</span> user=<span class="string">&quot;root&quot;</span>; ---&gt; 修改权限</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Query OK, 1 row affected (0.01 sec)</span></span><br><span class="line"><span class="string">Rows matched: 1  Changed: 1  Warnings: 0</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; <span class="keyword">select</span> Host,User from user;---&gt; 查user表中的root用户</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| Host      | User          |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| %         | root          |</span></span><br><span class="line"><span class="string">| localhost | mysql.session |</span></span><br><span class="line"><span class="string">| localhost | mysql.sys     |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">3 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; flush privileges;---&gt; 及时生效</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Query OK, 0 rows affected (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="4-测试连接"><a href="#4-测试连接" class="headerlink" title="4. 测试连接"></a>4. 测试连接</h2><h3 id="4-1-mysql连接测试"><a href="#4-1-mysql连接测试" class="headerlink" title="4.1 mysql连接测试"></a>4.1 mysql连接测试</h3><p><img src="https://cdn.nlark.com/yuque/0/2022/png/33576317/1668352017646-ca2cfd25-98df-4cd9-931d-93f3692e998c.png#averageHue=%23f9f8f8&amp;clientId=u67250bee-4ede-4&amp;from=ui&amp;id=u7a4335f2&amp;originHeight=666&amp;originWidth=570&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=true&amp;size=15238&amp;status=done&amp;style=shadow&amp;taskId=ufc26408b-44f4-4b18-beca-6d10c500d5e&amp;title=hive--mysql--%E8%BF%9E%E6%8E%A5%E6%B5%8B%E8%AF%95" alt="hive--mysql--连接测试" title="hive--mysql--连接测试"></p><h3 id="4-2-连接成功"><a href="#4-2-连接成功" class="headerlink" title="4.2 连接成功"></a>4.2 连接成功</h3><p><img src="https://cdn.nlark.com/yuque/0/2022/png/33576317/1668352104426-ed6a61d3-4a08-4ad1-bdba-abbc7aadad08.png#averageHue=%23f4f3f3&amp;clientId=u67250bee-4ede-4&amp;from=ui&amp;id=u4e45969c&amp;originHeight=272&amp;originWidth=881&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=true&amp;size=20715&amp;status=done&amp;style=shadow&amp;taskId=u1490c44d-df0b-4c9e-a6ca-f60266e8c83&amp;title=hive--mysql--%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F" alt="hive--mysql--连接成功" title="hive--mysql--连接成功"></p><h1 id="二、-Hive组件搭建"><a href="#二、-Hive组件搭建" class="headerlink" title="二、 Hive组件搭建"></a>二、 <a href="https://blog.csdn.net/zmzdmx/article/details/108776666?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166719648416782427496026%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166719648416782427496026&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-108776666-null-null.142^v62^pc_rank_34_queryrelevant25,201^v3^control_1,213^v1^control&amp;utm_term=hive&amp;spm=1018.2226.3001.4187">Hive</a>组件搭建</h1><p>Hive：由Facebook开源用于解决海量结构化日志的数据统计。<br>Hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能。<br><a href="https://www.yuque.com/attachments/yuque/0/2022/txt/33576317/1670333072537-0121e833-6fe6-4dfd-a9aa-bb50d0deb3b5.txt">Hive.txt</a></p><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1 准备工作"></a>1 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1  解压并改名"></a>1.1  解压并改名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-hive-2.3.4-bin.tar.gz -C /opt/</span><br><span class="line"><span class="built_in">mv</span> apache-hive-2.3.4-bin hive</span><br></pre></td></tr></table></figure><h2 id="2-配置Hive环境变量"><a href="#2-配置Hive环境变量" class="headerlink" title="2. 配置Hive环境变量"></a>2. 配置Hive环境变量</h2><h3 id="2-1-配置Hive环境变量"><a href="#2-1-配置Hive环境变量" class="headerlink" title="2.1 配置Hive环境变量"></a>2.1 配置Hive环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/hive</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br><span class="line">如果报错，试着修改以下内容：</span><br><span class="line"><span class="built_in">export</span> HBASE_HOME =/opt/hive</span><br><span class="line"><span class="built_in">export</span> PATH = <span class="variable">$PATH</span>:<span class="variable">$HBASE_HOME</span>/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-解决日志jar包冲突"><a href="#2-3-解决日志jar包冲突" class="headerlink" title="2.3 解决日志jar包冲突"></a>2.3 解决日志jar包冲突</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.6.2.jar <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.6.2.bak</span><br></pre></td></tr></table></figure><h3 id="2-4-初始化元数据库"><a href="#2-4-初始化元数据库" class="headerlink" title="2.4 初始化元数据库"></a>2.4 初始化元数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive] bin/schematool -dbType derby -initSchema</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: com.google.common.base.Preconditions.checkArgument(ZLjava/lang/String;Ljava/lang/Object;)V</span></span><br><span class="line"><span class="string">at org.apache.hadoop.conf.Configuration.set(Configuration.java:1357)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.conf.Configuration.set(Configuration.java:1338)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.mapred.JobConf.setJar(JobConf.java:536)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.mapred.JobConf.setJarByClass(JobConf.java:554)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.mapred.JobConf.&lt;init&gt;(JobConf.java:448)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.conf.HiveConf.initialize(HiveConf.java:4045)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.conf.HiveConf.&lt;init&gt;(HiveConf.java:4008)</span></span><br><span class="line"><span class="string">at org.apache.hive.beeline.HiveSchemaTool.&lt;init&gt;(HiveSchemaTool.java:82)</span></span><br><span class="line"><span class="string">at org.apache.hive.beeline.HiveSchemaTool.main(HiveSchemaTool.java:1117)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span></span><br><span class="line"><span class="string">at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span></span><br><span class="line"><span class="string">at java.lang.reflect.Method.invoke(Method.java:498)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.run(RunJar.java:323)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.main(RunJar.java:236)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="若报错则尝试-2-5-初始化如果报错，就把hadoop的guava包替换到hive的guava包"><a href="#若报错则尝试-2-5-初始化如果报错，就把hadoop的guava包替换到hive的guava包" class="headerlink" title="(若报错则尝试)2.5 初始化如果报错，就把hadoop的guava包替换到hive的guava包"></a>(若报错则尝试)2.5 初始化如果报错，就把hadoop的guava包替换到hive的guava包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$HIVE_HOME</span>/lib/guava-14.0.1.jar</span><br><span class="line"><span class="built_in">cp</span> <span class="variable">$HADOOP_HOME</span>/share/hadoop/common/lib/guava-27.0-jre.jar <span class="variable">$HIVE_HOME</span>/lib/</span><br></pre></td></tr></table></figure><h3 id="2-6-再次初始化元数据库-没有报错，可跳过"><a href="#2-6-再次初始化元数据库-没有报错，可跳过" class="headerlink" title="2.6 再次初始化元数据库(没有报错，可跳过)"></a>2.6 再次初始化元数据库(没有报错，可跳过)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[huser@master hive] bin/schematool -dbType derby -initSchema</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Metastore connection URL: jdbc:derby:;databaseName=metastore_db;create=true</span></span><br><span class="line"><span class="string">Metastore Connection Driver : org.apache.derby.jdbc.EmbeddedDriver</span></span><br><span class="line"><span class="string">Metastore connection User: APP</span></span><br><span class="line"><span class="string">Starting metastore schema initialization to 2.3.0</span></span><br><span class="line"><span class="string">Initialization script hive-schema-2.3.0.derby.sql</span></span><br><span class="line"><span class="string">Initialization script completed</span></span><br><span class="line"><span class="string">schemaTool completed</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-7-验证时，先开集群"><a href="#2-7-验证时，先开集群" class="headerlink" title="2.7 验证时，先开集群"></a>2.7 验证时，先开集群</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 /] hive</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-2.3.4.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">hive&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="3-Hive存储命令行"><a href="#3-Hive存储命令行" class="headerlink" title="3. Hive存储命令行"></a>3. Hive存储命令行</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">测试：</span><br><span class="line">hive&gt; show databases;</span><br><span class="line">OK</span><br><span class="line">default</span><br><span class="line">Time taken: 0.464 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; create database test1;</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.111 seconds</span><br><span class="line">hive&gt; show databases;</span><br><span class="line">OK</span><br><span class="line">default</span><br><span class="line">test1</span><br><span class="line">Time taken: 0.026 seconds, Fetched: 2 row(s)</span><br><span class="line">hive&gt; use test1 ;</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.028 seconds</span><br><span class="line">hive&gt; show tables;</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.029 seconds</span><br><span class="line">hive&gt; create table students(</span><br><span class="line"><span class="built_in">id</span> bigint comment <span class="string">&#x27;学生id&#x27;</span>,</span><br><span class="line">name string comment <span class="string">&#x27;学生姓名&#x27;</span>,</span><br><span class="line">age int comment <span class="string">&#x27;学生年龄&#x27;</span>,</span><br><span class="line">gender string comment <span class="string">&#x27;学生性别&#x27;</span>,</span><br><span class="line">clazz string comment <span class="string">&#x27;学生班级&#x27;</span></span><br><span class="line">)comment <span class="string">&#x27;学生信息表&#x27;</span></span><br><span class="line">row format delimited fields terminated by <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.424 seconds</span><br><span class="line">hive&gt; show tables;</span><br><span class="line">OK</span><br><span class="line">students</span><br><span class="line">Time taken: 0.025 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; desc students;</span><br><span class="line">OK</span><br><span class="line"><span class="built_in">id</span>                  bigint              ??<span class="built_in">id</span>                </span><br><span class="line">name                string              ????                </span><br><span class="line">age                 int                 ????                </span><br><span class="line">gender              string              ????                </span><br><span class="line">clazz               string              ????                </span><br><span class="line">Time taken: 0.077 seconds, Fetched: 5 row(s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span>;（退出命令）</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2022/png/33576317/1669395643886-1a949492-e750-498d-ae59-1db576e04194.png#averageHue=%23fdfcfc&amp;clientId=u182f1757-79fe-4&amp;from=ui&amp;height=506&amp;id=ueea7430b&amp;originHeight=716&amp;originWidth=1905&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=true&amp;size=36232&amp;status=done&amp;style=shadow&amp;taskId=ufbb1253e-c004-40c2-9b33-e30300ed139&amp;title=hive--hdfs--%E6%B5%8B%E8%AF%95&amp;width=1347" alt="hive--hdfs--测试" title="hive--hdfs--测试"></p><h2 id="4-解决报错"><a href="#4-解决报错" class="headerlink" title="4. 解决报错"></a>4. 解决报错</h2><h3 id="4-1-启动HIVE失败（jar包冲突）"><a href="#4-1-启动HIVE失败（jar包冲突）" class="headerlink" title="4.1 启动HIVE失败（jar包冲突）"></a>4.1 启动HIVE失败（jar包冲突）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">SLF4J: Found binding in [jar:file:/home/hdp/hive/lib/log4j-slf4j-impl-2.17.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span></span><br><span class="line"><span class="string">SLF4J: Found binding in [jar:file:/home/hdp/hadoop-3.2.1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.</span></span><br><span class="line"><span class="string">SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]</span></span><br><span class="line"><span class="string">HiveSchemaTool:Parsing failed.  Reason: Missing required option: [-help print this message, -alterCatalog Alter a catalog, requires --catalogLocation and/or --catalogDescription parameter as well, -initSchemaTo Schema initialization to a version, -upgradeSchemaFrom Schema upgrade from a version, -moveDatabase Move a database between catalogs.  Argument is the database name. Requires --fromCatalog and --toCatalog parameters as well, -moveTable Move a table to a different database.  Argument is the table name. Requires --fromCatalog, --toCatalog, --fromDatabase, and --toDatabase  parameters as well., -initSchema Schema initialization, -createCatalog Create a catalog, requires --catalogLocation parameter as well, -upgradeSchema Schema upgrade, -info Show config and schema details, -validate Validate the database]</span></span><br><span class="line"><span class="string">usage: schemaTool…………………………………………</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">解决方案：</span><br><span class="line"><span class="comment"># cd /opt/hive/lib</span></span><br><span class="line"><span class="comment"># ls log4j-*</span></span><br><span class="line"><span class="built_in">rm</span> -rf log4j-slf4j-impl-2.17.1.jar</span><br></pre></td></tr></table></figure><h3 id="4-2-格式化失败"><a href="#4-2-格式化失败" class="headerlink" title="4.2 格式化失败"></a>4.2 格式化失败</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">java.lang.IncompatibleClassChangeError: Found class jline.Terminal, but interface was expected</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">解决方案：</span><br><span class="line"><span class="comment"># 把高等级的guava.jar文件添加：进入hive/lib</span></span><br><span class="line"><span class="built_in">cp</span> /opt/hadoop/share/hadoop/common/lib/guava-27.0-jre.jar /opt/hive/lib</span><br></pre></td></tr></table></figure><h3 id="4-3-元数据出错"><a href="#4-3-元数据出错" class="headerlink" title="4.3 元数据出错"></a>4.3 元数据出错</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">FAILED: HiveException java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 元数据出错</span></span><br><span class="line">解决方案：</span><br><span class="line">./hive --service metastore &amp;</span><br><span class="line">然后重新启动  hive</span><br><span class="line"><span class="comment"># hive-site.xml出错</span></span><br></pre></td></tr></table></figure><h3 id="4-4-metastore-启动出错解决"><a href="#4-4-metastore-启动出错解决" class="headerlink" title="4.4 metastore 启动出错解决"></a>4.4 metastore 启动出错解决</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">MetaException(message:Version information not found in metastore.)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.RetryingHMSHandler.&lt;init&gt;(RetryingHMSHandler.java:84)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:93)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:8661)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:8656)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.startMetaStore(HiveMetaStore.java:8926)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.main(HiveMetaStore.java:8843)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span></span><br><span class="line"><span class="string">at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span></span><br><span class="line"><span class="string">at java.lang.reflect.Method.invoke(Method.java:498)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.run(RunJar.java:221)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.main(RunJar.java:136)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># hive metastore进程 已经有启动过了，应该讲相关的进程kill 掉。</span></span><br><span class="line">ps -ef |grep  hive </span><br><span class="line"><span class="comment"># huser     11025   3408  0 12:57 pts/1    00:00:00 grep --color=auto hive</span></span><br><span class="line"><span class="comment"># 将hive 相关进程kill 掉。然后重新启动：</span></span><br><span class="line">./hive --service metastore</span><br><span class="line"><span class="comment"># 同理如果 运行 </span></span><br><span class="line">./hive  --service hiveserver2 </span><br><span class="line"><span class="comment"># 出现 0.0.0.0/0.0.0.0:10000端口的错误，也可能是已经存在了相关的进程，将其杀掉重新启动就能解决</span></span><br><span class="line">没有出错，则</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-10-31 12:41:16: Starting HiveServer2</span></span><br><span class="line"><span class="string">Hive Session ID = 5e7ae187-9f27-4a22-8a81-c05dcf390598</span></span><br><span class="line"><span class="string">Hive Session ID = 570423cb-4125-4c95-9f83-5c256e9583fe</span></span><br><span class="line"><span class="string">Hive Session ID = ff65d2e0-6ead-4850-9d0c-38270c3e35a2</span></span><br><span class="line"><span class="string">Hive Session ID = 5cd156e1-3b30-4ce6-8c64-b00ef3ae7457</span></span><br><span class="line"><span class="string">..............</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 另外就是hive-site.xml的报错</span></span><br><span class="line">添加：</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;datanucleus.metadata.validate&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;hive.metastore.schema.verification&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;&lt;property&gt;</span><br><span class="line">&lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="comment"># 最后提醒：在xml配置文件中，在标签之间不要有空格！！！因为读取xml文件时是按标签读取的</span></span><br></pre></td></tr></table></figure><h1 id="三-Hive元数据配置到MySQL"><a href="#三-Hive元数据配置到MySQL" class="headerlink" title="三. Hive元数据配置到MySQL"></a>三. Hive元数据配置到MySQL</h1><h2 id="1-拷贝数据库驱动"><a href="#1-拷贝数据库驱动" class="headerlink" title="1. 拷贝数据库驱动"></a>1. 拷贝数据库驱动</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自行下载拷贝并上传</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-5.1.48.jar /opt/hive/lib/</span><br></pre></td></tr></table></figure><h2 id="2-配置Metastore到MySQL，目录-opt-hive-conf"><a href="#2-配置Metastore到MySQL，目录-opt-hive-conf" class="headerlink" title="2. 配置Metastore到MySQL，目录/opt/hive/conf"></a>2. 配置Metastore到MySQL，目录/opt/hive/conf</h2><h3 id="2-1-创建并配置hive-site-xml"><a href="#2-1-创建并配置hive-site-xml" class="headerlink" title="2.1 创建并配置hive-site.xml"></a>2.1 创建并配置hive-site.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet <span class="built_in">type</span>=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- jdbc连接的URL --&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;jdbc:mysql://slave1:3306/metastore?useSSL=<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- jdbc连接的Driver--&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- jdbc连接的username--&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;root&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- jdbc连接的password --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;000000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Hive默认在HDFS的工作目录 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;/user/hive/warehouse&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- Hive 元数据存储版本的验证 --&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">    &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt; </span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt; </span><br><span class="line"></span><br><span class="line">  &lt;!--元数据存储授权--&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">    &lt;name&gt;hive.metastore.event.db.notification.api.auth&lt;/name&gt; </span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h3 id="可跳过-2-2-配置日志文件位置-amp-打印当前库名mysq表头信息"><a href="#可跳过-2-2-配置日志文件位置-amp-打印当前库名mysq表头信息" class="headerlink" title="(可跳过)2.2 配置日志文件位置&amp;打印当前库名mysq表头信息"></a>(可跳过)2.2 配置日志文件位置&amp;打印当前库名mysq表头信息</h3><h4 id="2-2-1-防止直接修改出错，先将需要配置的文件复制一份再修改"><a href="#2-2-1-防止直接修改出错，先将需要配置的文件复制一份再修改" class="headerlink" title="2.2.1  #防止直接修改出错，先将需要配置的文件复制一份再修改"></a>2.2.1  #防止直接修改出错，先将需要配置的文件复制一份再修改</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /opt/hive/conf</span></span><br><span class="line"><span class="built_in">cp</span> hive-env.sh.template hive-env.sh</span><br><span class="line"><span class="built_in">cp</span> hive-log4j.properties.template hive-log4j.properties</span><br><span class="line"><span class="built_in">cp</span> hive-default.xml.template hive-default.xml</span><br></pre></td></tr></table></figure><h4 id="2-2-2-配置hive-env-sh"><a href="#2-2-2-配置hive-env-sh" class="headerlink" title="2.2.2 配置hive-env.sh"></a>2.2.2 配置hive-env.sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim hive-env.sh</span><br><span class="line">添加：</span><br><span class="line">HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> HIVE_CONF_DIR=/opt/hive/conf</span><br><span class="line"><span class="built_in">export</span> HIVE_AUX_JARS_PATH=/opt/hive/lib</span><br></pre></td></tr></table></figure><h4 id="2-2-3-配置hive-log4j-properties"><a href="#2-2-3-配置hive-log4j-properties" class="headerlink" title="2.2.3 配置hive-log4j.properties"></a>2.2.3 配置hive-log4j.properties</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim hive-log4j.properties</span><br><span class="line">添加：</span><br><span class="line">hive.log.dir=/opt/hive/log</span><br></pre></td></tr></table></figure><h4 id="2-2-4-创建并配置hive-site-xml"><a href="#2-2-4-创建并配置hive-site-xml" class="headerlink" title="2.2.4 创建并配置hive-site.xml"></a>2.2.4 创建并配置hive-site.xml</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet <span class="built_in">type</span>=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- jdbc连接的URL --&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;jdbc:mysql://slave1:3306/metastore?useSSL=<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- jdbc连接的Driver--&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- jdbc连接的username--&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;root&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- jdbc连接的password --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;000000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Hive默认在HDFS的工作目录 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;/user/hive/warehouse&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">  &lt;!-- Hive 元数据存储版本的验证 --&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">    &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt; </span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt; </span><br><span class="line"></span><br><span class="line">  &lt;!--元数据存储授权--&gt; </span><br><span class="line">  &lt;property&gt; </span><br><span class="line">    &lt;name&gt;hive.metastore.event.db.notification.api.auth&lt;/name&gt; </span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt; </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">      &lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;</span><br><span class="line">      &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.cli.print.header&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.cli.print.current.db&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h4 id="2-2-5-启动Hive"><a href="#2-2-5-启动Hive" class="headerlink" title="2.2.5 启动Hive"></a>2.2.5 启动Hive</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive] bin/hive</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-2.3.4.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">hive(default)&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="可跳过-2-3-配置信息位置-amp-优先级"><a href="#可跳过-2-3-配置信息位置-amp-优先级" class="headerlink" title="(可跳过)2.3 配置信息位置&amp;优先级"></a>(可跳过)2.3 配置信息位置&amp;优先级</h3><h4 id="2-3-1-查看当前所有的配置信息"><a href="#2-3-1-查看当前所有的配置信息" class="headerlink" title="2.3.1 查看当前所有的配置信息"></a>2.3.1 查看当前所有的配置信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="built_in">set</span>;</span><br></pre></td></tr></table></figure><h4 id="2-3-2-命令行参数方式"><a href="#2-3-2-命令行参数方式" class="headerlink" title="2.3.2 命令行参数方式"></a>2.3.2 命令行参数方式</h4><p>注意: 仅对本次hive启动有效<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive -hiveconf hive.cli.print.current.db=<span class="literal">false</span>;</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-2.3.4.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">hive&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">hive&gt; <span class="built_in">set</span> hive.cli.print.current.db=<span class="literal">true</span>;</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">hive(default)&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 查看参数设置</span></span><br><span class="line">hive(default)&gt; <span class="built_in">set</span> mapred.reduce.tasks;</span><br><span class="line"><span class="comment"># 在HQL中使用SET关键字设定参数</span></span><br><span class="line">hive(default)&gt; <span class="built_in">set</span> mapred.reduce.tasks=10;</span><br></pre></td></tr></table></figure></p><h3 id="2-4-登录MySQL"><a href="#2-4-登录MySQL" class="headerlink" title="2.4 登录MySQL"></a>2.4 登录MySQL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p000000</span><br></pre></td></tr></table></figure><h3 id="2-5-新建Hive元数据库"><a href="#2-5-新建Hive元数据库" class="headerlink" title="2.5 新建Hive元数据库"></a>2.5 新建Hive元数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database metastore; </span><br><span class="line">mysql&gt; quit;</span><br></pre></td></tr></table></figure><h3 id="2-6-初始化Hive元数据库"><a href="#2-6-初始化Hive元数据库" class="headerlink" title="2.6 初始化Hive元数据库"></a>2.6 初始化Hive元数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql -verbose</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">No rows affected (0.001 seconds)</span></span><br><span class="line"><span class="string">0: jdbc:mysql://slave1:3306/metastore&gt; !closeall</span></span><br><span class="line"><span class="string">Closing: 0: jdbc:mysql://slave1:3306/metastore?useSSL=false</span></span><br><span class="line"><span class="string">beeline&gt; </span></span><br><span class="line"><span class="string">beeline&gt; Initialization script completed</span></span><br><span class="line"><span class="string">schemaTool completed</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="3-再次启动hive"><a href="#3-再次启动hive" class="headerlink" title="3. 再次启动hive"></a>3. 再次启动hive</h2><h3 id="3-1-启动Hive"><a href="#3-1-启动Hive" class="headerlink" title="3.1 启动Hive"></a>3.1 启动Hive</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive</span><br></pre></td></tr></table></figure><h3 id="3-2-使用Hive"><a href="#3-2-使用Hive" class="headerlink" title="3.2 使用Hive"></a>3.2 使用Hive</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; show databases;</span><br><span class="line">OK</span><br><span class="line">default</span><br><span class="line">Time taken: 0.032 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; create table ts(<span class="built_in">id</span> string);</span><br><span class="line">OK</span><br><span class="line">Time taken: 1.062 seconds</span><br><span class="line">hive&gt; <span class="keyword">select</span> * from ts;</span><br><span class="line">OK</span><br><span class="line">Time taken: 0.349 seconds</span><br><span class="line"><span class="comment"># 这里没有数据</span></span><br><span class="line"><span class="comment"># 所以创建文件数据并上传hdfs</span></span><br><span class="line">[huser@slave1 hive]$ vim id.txt</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">10086</span></span><br><span class="line"><span class="string">10083</span></span><br><span class="line"><span class="string">12183273</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">[huser@slave1 hive]$ hadoop fs -put id.txt /user/hive/warehouse/ts</span><br><span class="line">2022-11-26 15:00:51,884 INFO sasl.SaslDataTransferClient: SASL encryption trust check: localHostTrusted = <span class="literal">false</span>, remoteHostTrusted = <span class="literal">false</span></span><br><span class="line">hive&gt; <span class="keyword">select</span> * from ts;</span><br><span class="line">OK</span><br><span class="line">10086</span><br><span class="line">10083</span><br><span class="line">12183273</span><br><span class="line">Time taken: 0.621 seconds, Fetched: 3 row(s)</span><br></pre></td></tr></table></figure><h2 id="4-使用元数据服务的方式访问Hive"><a href="#4-使用元数据服务的方式访问Hive" class="headerlink" title="4. 使用元数据服务的方式访问Hive"></a>4. 使用元数据服务的方式访问Hive</h2><h3 id="4-1-连接存储元数据地址，需要修改hive-site-xml"><a href="#4-1-连接存储元数据地址，需要修改hive-site-xml" class="headerlink" title="4.1 连接存储元数据地址，需要修改hive-site.xml"></a>4.1 连接存储元数据地址，需要修改hive-site.xml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定存储元数据要连接的地址 --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.metastore.uris&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;thrift://slave1:9083&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h3 id="4-2-启动Hive"><a href="#4-2-启动Hive" class="headerlink" title="4.2 启动Hive"></a>4.2 启动Hive</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive --service metastore</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-26 15:33:16: Starting Hive Metastore Server</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 注意：启动后窗口不能再操作，需打开一个新的shell窗口做别的操作</span></span><br><span class="line">[huser@slave1 hive]$ bin/hive</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-3.1.2.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">Hive Session ID = 59776f1a-d2d0-48ca-afb7-2de366803efb</span></span><br><span class="line"><span class="string">hive&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-3-测试"><a href="#4-3-测试" class="headerlink" title="4.3 测试"></a>4.3 测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; show databases;</span><br><span class="line">OK</span><br><span class="line">default</span><br><span class="line">Time taken: 0.871 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; show tables;</span><br><span class="line">OK</span><br><span class="line">ts</span><br><span class="line">Time taken: 0.126 seconds, Fetched: 1 row(s)</span><br><span class="line">hive&gt; <span class="keyword">select</span> * from ts;</span><br><span class="line">OK</span><br><span class="line">10086</span><br><span class="line">10083</span><br><span class="line">12183273</span><br><span class="line">Time taken: 4.242 seconds, Fetched: 3 row(s)</span><br></pre></td></tr></table></figure><h2 id="5-使用JDBC方式访问Hive"><a href="#5-使用JDBC方式访问Hive" class="headerlink" title="5. 使用JDBC方式访问Hive"></a>5. 使用JDBC方式访问Hive</h2><h3 id="5-1-在hive-site-xml文件中添加如下配置信息"><a href="#5-1-在hive-site-xml文件中添加如下配置信息" class="headerlink" title="5.1 在hive-site.xml文件中添加如下配置信息"></a>5.1 在hive-site.xml文件中添加如下配置信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定hiveserver2连接的host --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;slave1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!-- 指定hiveserver2连接的端口号 --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;10000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h3 id="5-2-启动metastore"><a href="#5-2-启动metastore" class="headerlink" title="5.2 启动metastore"></a>5.2 启动metastore</h3><p>注意：启动后窗口不能再操作，需打开一个新的shell窗口做别的操作<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive --service metastore</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-26 15:33:16: Starting Hive Metastore Server</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h3 id="5-2-启动hiveserver2"><a href="#5-2-启动hiveserver2" class="headerlink" title="5.2 启动hiveserver2"></a>5.2 启动hiveserver2</h3><p>注意：启动后窗口不能再操作，需打开一个新的shell窗口做别的操作<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive --service hiveserver2</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">which: no hbase in (/opt/hbase/bin:/opt/hive/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/usr/java/jdk1.8.0_341-amd64/bin:/opt/hadoop/bin:/opt/hadoop/sbin:/opt/zookeeper/bin:/opt/sqoop/bin:/opt/bin:/opt/maven/bin:/opt/maven/bin:/opt/flume/bin:/opt/kafka/bin:/opt/kafka/bin:/opt/kafka/bin:/bin:/home/huser/.local/bin:/home/huser/bin)</span></span><br><span class="line"><span class="string">2022-11-26 17:29:52: Starting HiveServer2</span></span><br><span class="line"><span class="string">Hive Session ID = 04c9025c-ba79-42de-8f2a-96de660072c8</span></span><br><span class="line"><span class="string">Hive Session ID = 6936bbd6-c52e-4523-bfea-016a7b62f0fc</span></span><br><span class="line"><span class="string">Hive Session ID = b16222cb-6a9e-4866-b08c-9f11de650f6a</span></span><br><span class="line"><span class="string">Hive Session ID = a36d5961-078f-4a70-9649-8113e32dc1d1</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h3 id="5-3-启动beeline客户端"><a href="#5-3-启动beeline客户端" class="headerlink" title="5.3 启动beeline客户端"></a>5.3 启动beeline客户端</h3><p>注意：1.启动后窗口不能再操作，需打开一个新的shell窗口做别的操作</p><ol><li>等hiveserver2服务完全开启, 否则直接报拒绝连接<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/beeline -u jdbc:hive2://slave1:10000 -n huser</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;Connecting to jdbc:hive2://slave1:10000</span></span><br><span class="line"><span class="string">Connected to: Apache Hive (version 3.1.2)</span></span><br><span class="line"><span class="string">Driver: Hive JDBC (version 3.1.2)</span></span><br><span class="line"><span class="string">Transaction isolation: TRANSACTION_REPEATABLE_READ</span></span><br><span class="line"><span class="string">Beeline version 3.1.2 by Apache Hive</span></span><br><span class="line"><span class="string">0: jdbc:hive2://slave1:10000&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="5-4-测试"><a href="#5-4-测试" class="headerlink" title="5.4 测试"></a>5.4 测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">0: jdbc:hive2://slave1:10000&gt; show databases;</span><br><span class="line">INFO  : Compiling <span class="built_in">command</span>(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756): show databases</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">INFO  : Semantic Analysis Completed (retrial = <span class="literal">false</span>)</span><br><span class="line">INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:database_name, <span class="built_in">type</span>:string, comment:from deserializer)], properties:null)</span><br><span class="line">INFO  : Completed compiling <span class="built_in">command</span>(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756); Time taken: 0.383 seconds</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">INFO  : Executing <span class="built_in">command</span>(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756): show databases</span><br><span class="line">INFO  : Starting task [Stage-0:DDL] <span class="keyword">in</span> serial mode</span><br><span class="line">INFO  : Completed executing <span class="built_in">command</span>(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756); Time taken: 0.093 seconds</span><br><span class="line">INFO  : OK</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">+----------------+</span><br><span class="line">| database_name  |</span><br><span class="line">+----------------+</span><br><span class="line">| default        |</span><br><span class="line">+----------------+</span><br><span class="line">1 row selected (0.914 seconds)</span><br><span class="line">0: jdbc:hive2://slave1:10000&gt; show tables;</span><br><span class="line">INFO  : Compiling <span class="built_in">command</span>(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1): show tables</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">INFO  : Semantic Analysis Completed (retrial = <span class="literal">false</span>)</span><br><span class="line">INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:tab_name, <span class="built_in">type</span>:string, comment:from deserializer)], properties:null)</span><br><span class="line">INFO  : Completed compiling <span class="built_in">command</span>(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1); Time taken: 0.172 seconds</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">INFO  : Executing <span class="built_in">command</span>(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1): show tables</span><br><span class="line">INFO  : Starting task [Stage-0:DDL] <span class="keyword">in</span> serial mode</span><br><span class="line">INFO  : Completed executing <span class="built_in">command</span>(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1); Time taken: 0.053 seconds</span><br><span class="line">INFO  : OK</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">+-----------+</span><br><span class="line">| tab_name  |</span><br><span class="line">+-----------+</span><br><span class="line">| ts        |</span><br><span class="line">+-----------+</span><br><span class="line">1 row selected (0.322 seconds)</span><br><span class="line">0: jdbc:hive2://slave1:10000&gt; <span class="keyword">select</span> * from ts;</span><br><span class="line">INFO  : Compiling <span class="built_in">command</span>(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3): <span class="keyword">select</span> * from ts</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">INFO  : Semantic Analysis Completed (retrial = <span class="literal">false</span>)</span><br><span class="line">INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:ts.id, <span class="built_in">type</span>:string, comment:null)], properties:null)</span><br><span class="line">INFO  : Completed compiling <span class="built_in">command</span>(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3); Time taken: 3.368 seconds</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">INFO  : Executing <span class="built_in">command</span>(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3): <span class="keyword">select</span> * from ts</span><br><span class="line">INFO  : Completed executing <span class="built_in">command</span>(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3); Time taken: 0.032 seconds</span><br><span class="line">INFO  : OK</span><br><span class="line">INFO  : Concurrency mode is disabled, not creating a lock manager</span><br><span class="line">+-----------+</span><br><span class="line">|   ts.id   |</span><br><span class="line">+-----------+</span><br><span class="line">| 10086     |</span><br><span class="line">| 10083     |</span><br><span class="line">| 12183273  |</span><br><span class="line">+-----------+</span><br><span class="line">3 rows selected (4.477 seconds)</span><br></pre></td></tr></table></figure><h3 id="5-5-拒接连接报错"><a href="#5-5-拒接连接报错" class="headerlink" title="5.5 拒接连接报错"></a>5.5 拒接连接报错</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to jdbc:hive2://slave1:10000</span></span><br><span class="line"><span class="string">22/11/26 17:29:24 [main]: WARN jdbc.HiveConnection: Failed to connect to slave1:10000</span></span><br><span class="line"><span class="string">Could not open connection to the HS2 server. Please check the server URI and if the URI is correct, then ask the administrator to check the server status.</span></span><br><span class="line"><span class="string">Error: Could not open client transport with JDBC Uri: jdbc:hive2://slave1:10000: java.net.ConnectException: 拒绝连接 (Connection refused) (state=08S01,code=0)</span></span><br><span class="line"><span class="string">Beeline version 3.1.2 by Apache Hive</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 解决</span></span><br><span class="line">1. 等hiveserver2服务完全开启</span><br><span class="line">2. 修改hadoop目录下的hdfs-site.xml和core-site.xml的文件</span><br></pre></td></tr></table></figure><h3 id="5-6-解决方案"><a href="#5-6-解决方案" class="headerlink" title="5.6 解决方案:"></a>5.6 解决方案:</h3><strong>注意：以下配置文件里出现的“huser”请换成您自己的用户名！！！</strong><h4 id="5-6-1-在hdfs-site-xml文件中添加如下内容（路径：-HADOOP-HOME-etc-hadoop）"><a href="#5-6-1-在hdfs-site-xml文件中添加如下内容（路径：-HADOOP-HOME-etc-hadoop）" class="headerlink" title="5.6.1 在hdfs-site.xml文件中添加如下内容（路径：$HADOOP_HOME/etc/hadoop）"></a>5.6.1 在hdfs-site.xml文件中添加如下内容（路径：$HADOOP_HOME/etc/hadoop）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h4 id="5-6-2-在core-site-xml文件中添加如下内容："><a href="#5-6-2-在core-site-xml文件中添加如下内容：" class="headerlink" title="5.6.2 在core-site.xml文件中添加如下内容："></a>5.6.2 在core-site.xml文件中添加如下内容：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hadoop.proxyuser.huser.hosts&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;slave1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hadoop.proxyuser.huser.groups&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;10000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><strong> 提示：配置的时候一定要注意细节哦，不然容易启动报错哦！！！其次记得分发改了的文件，并且重新启动相应的集群哦！！！</strong></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;前置准备：&lt;br&gt;&lt;a href=&quot;https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed&quot;&gt;一、集群环境搭建高可用版本配置&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.yuque.com/u25</summary>
      
    
    
    
    
    <category term="大数据应用" scheme="https://xin0203xin0203.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8/"/>
    
    <category term="HADOOP" scheme="https://xin0203xin0203.github.io/tags/HADOOP/"/>
    
    <category term="Linux" scheme="https://xin0203xin0203.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>二、zookeeper组件搭建</title>
    <link href="https://xin0203xin0203.github.io/posts/9dacd182.html"/>
    <id>https://xin0203xin0203.github.io/posts/9dacd182.html</id>
    <published>2023-12-15T07:30:17.223Z</published>
    <updated>2024-12-14T19:20:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>介绍：Zookeeper 是一个开源的分布式协调服务，目前由 Apache 进行维护。Zookeeper 可以用于实现分布式系统中常见的发布/订阅、负载均衡、命令服务、分布式协调/通知、集群管理、Master 选举、分布式锁和分布式队列等功能。<br>特点：</p><ul><li><strong>顺序一致性</strong>：从一个客户端发起的事务请求，最终都会严格按照其发起顺序被应用到 Zookeeper 中；</li><li><strong>原子性</strong>：所有事务请求的处理结果在整个集群中所有机器上都是一致的；不存在部分机器应用了该事务，而另一部分没有应用的情况；</li><li><strong>单一视图</strong>：所有客户端看到的服务端数据模型都是一致的；</li><li><strong>可靠性</strong>：一旦服务端成功应用了一个事务，则其引起的改变会一直保留，直到被另外一个事务所更改；</li><li><strong>实时性</strong>：一旦一个事务被成功应用后，Zookeeper 可以保证客户端立即可以读取到这个事务变更后的最新状态的数据。</li></ul><p>需要的安装包：<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/">zookeeper</a>压缩包——&gt;apache-zookeeper-3.7.1-bin.tar.gz<br>可以跳过观看，跟集群环境搭建高可用版本配置的文件相同<br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed">一、集群环境搭建高可用版本配置</a></p><h2 id="5-配置zookeeper文件"><a href="#5-配置zookeeper文件" class="headerlink" title="5.配置zookeeper文件"></a>5.配置<a href="https://so.csdn.net/so/search?q=zookeeper&amp;urw=">zookeeper</a>文件</h2><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>5.1.1 <strong>在Linux系统下的软件包导入</strong></p><p><strong>5.1.2 解压hadoop到目录下的/opt</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf apache-zookeeper-3.7.1-bin.tar.gz -C /opt/</span><br></pre></td></tr></table></figure></p><p>5.1.3  改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mv</span> apache-zookeeper-3.7.1-bin zookeeper</span><br></pre></td></tr></table></figure></p><p>5.1.4 改权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R huser:huser zookeeper</span><br><span class="line"></span><br><span class="line"><span class="comment"># drwxr-xr-x.   4 huser huser   37 10月 29 14:22 zookeeper</span></span><br></pre></td></tr></table></figure></p><h3 id="2-配置zookeeper环境"><a href="#2-配置zookeeper环境" class="headerlink" title="2.配置zookeeper环境"></a>2.配置zookeeper环境</h3><p>4.2.1 <strong>配置</strong>zookeeper<strong>环境并且生效</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># ZOOKEEPER_HOME</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br></pre></td></tr></table></figure></p><p>4.2.2  加载环境变量并查看<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></p><p>4.2.3 拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure></p><h3 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3.修改配置文件"></a>3.修改配置文件</h3><p>5.3.1 进入安装目录的 conf/ 目录下，拷贝配置样本并进行修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cd $ZOOKEEPER_HOME/conf</span></span><br><span class="line"><span class="built_in">cd</span> /opt/zookeeper/conf</span><br></pre></td></tr></table></figure></p><p>5.3.2 改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure></p><p>5.3.3 修改配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">vim zoo.cfg</span><br><span class="line">修改为：</span><br><span class="line">      <span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line">      tickTime=2000</span><br><span class="line">      <span class="comment"># The number of ticks that the initial </span></span><br><span class="line">      <span class="comment"># synchronization phase can take</span></span><br><span class="line">      initLimit=10</span><br><span class="line">      <span class="comment"># The number of ticks that can pass between </span></span><br><span class="line">      <span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line">      syncLimit=5</span><br><span class="line">      <span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line">      <span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line">      <span class="comment"># example sakes.</span></span><br><span class="line">      dataDir=/opt/zookeeper/data</span><br><span class="line">      <span class="comment"># the port at which the clients will connect</span></span><br><span class="line">      clientPort=2181</span><br><span class="line">添加：</span><br><span class="line">      dataLogDir=/opt/zookeeper/logs</span><br><span class="line">      server.1=master:2888:3888</span><br><span class="line">      server.2=slave1:2888:3888</span><br><span class="line">      server.3=slave2:2888:3888</span><br><span class="line"></span><br><span class="line"><span class="comment">#配置参数说明：</span></span><br><span class="line"><span class="comment">#    ·tickTime：用于计算的基础时间单元。比如 session 超时：N*tickTime；</span></span><br><span class="line"><span class="comment">#    ·initLimit：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；</span></span><br><span class="line"><span class="comment">#    ·syncLimit：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；</span></span><br><span class="line"><span class="comment">#    ·dataDir：数据存储位置；</span></span><br><span class="line"><span class="comment">#    ·dataLogDir：日志目录；</span></span><br><span class="line"><span class="comment">#    ·clientPort：用于客户端连接的端口，默认 2181</span></span><br></pre></td></tr></table></figure></p><p>5.3.4  拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/zookeeper  slave2(slave1):/opt/</span><br></pre></td></tr></table></figure></p><h3 id="4-标识节点"><a href="#4-标识节点" class="headerlink" title="4.标识节点"></a>4.标识节点</h3><p>5.4.1 创建存储目录（先 cd /opt/zookeeper）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> data logs</span><br></pre></td></tr></table></figure></p><p>5.4.2 创建并写入节点标识到 myid 文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave1主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave2主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;3&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br></pre></td></tr></table></figure></p><p>5.4.3 验证节点标识<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> myid(<span class="built_in">cat</span> /opt/zookeeper/data/myid)</span><br></pre></td></tr></table></figure></p><h3 id="5-启动zookeeper"><a href="#5-启动zookeeper" class="headerlink" title="5.启动zookeeper"></a>5.启动zookeeper</h3><p>5.5.1 启动QuorumPeerMain节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br></pre></td></tr></table></figure></p><p>5.5.2 查看集群<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh status</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">ZooKeeper JMX enabled by default</span></span><br><span class="line"><span class="string">Using config: /opt/zookeeper/bin/../conf/zoo.cfg</span></span><br><span class="line"><span class="string">Client port found: 2181. Client address: localhost. Client SSL: false.</span></span><br><span class="line"><span class="string">Mode: follower</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo"></a></p>]]></content>
    
    
    <summary type="html">Zookeeper 是一个开源的分布式协调服务，目前由 Apache 进行维护。</summary>
    
    
    
    <category term="大数据应用" scheme="https://xin0203xin0203.github.io/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8/"/>
    
    
    <category term="大数据应用" scheme="https://xin0203xin0203.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8/"/>
    
    <category term="HADOOP" scheme="https://xin0203xin0203.github.io/tags/HADOOP/"/>
    
    <category term="Linux" scheme="https://xin0203xin0203.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>一、集群环境搭建高可用版本配置</title>
    <link href="https://xin0203xin0203.github.io/posts/5a2ba262.html"/>
    <id>https://xin0203xin0203.github.io/posts/5a2ba262.html</id>
    <published>2023-12-14T17:46:28.379Z</published>
    <updated>2024-12-14T17:48:48.000Z</updated>
    
    <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-ic_train modern"><p>介绍：<strong>HDFS</strong> （<strong>Hadoop Distributed File System</strong>）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。<br>特点：<br>高容错：由于 HDFS 采用数据的多副本方案，所以部分硬件的损坏不会导致全部数据的丢失。<br>高吞吐量：HDFS 设计的重点是支持高吞吐量的数据访问，而不是低延迟的数据访问。<br>大文件支持：HDFS 适合于大文件的存储，文档的大小应该是是 GB 到 TB 级别的。<br>简单一致性模型：HDFS 更适合于一次写入多次读取 (write-once-read-many) 的访问模型。支持将内容追加到文件末尾，但不支持数据的随机访问，不能从文件任意位置新增数据。<br>跨平台移植性：HDFS 具有良好的跨平台移植性，这使得其他大数据计算框架都将其作为数据持久化存储的首选方案。</p></div><div class="tip home"><p>前提观看：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BVMware%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%B2%A1%E7%BD%91%E7%BB%9C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95_%E5%8D%91%E5%BE%AE%E5%B0%8F%E8%83%A1%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%5D(https:/blog.csdn.net/huyinghao03/article/details/127419315?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.n">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7etzE.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、VMware无法启动虚拟机里面没网络解决方法_卑微小胡的博客-CSDN博客</div>            <div class="tag-link-sitename">在真机win+R输入：services.msc找到图片下的几个服务启动就好了。我一开始只启动VMware NAT Servise服务发</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="tip success"><p>如果电脑没有虚拟网卡Vmnet1和Vmnet8，如下方案：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E5%85%B3%E4%BA%8EvmWare%E5%AE%89%E8%A3%85%E5%90%8E%E6%B2%A1%E6%9C%89%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1Vmnet1%E5%92%8CVmnet8_kingheart_%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2_vmware%E5%AE%89%E8%A3%85%E5%90%8E%E6%B2%A1%E6%9C%89%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1%5D(https:/blog.csdn.net/kingheart_/article/details/127434816?app_version=5.11.1&code=app_1562916241&csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22127434816%22,%22source%22:%22qq672596289%22%7D&uLinkId=usr1mkqgl919blen&utm_source=app)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7esiv.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">关于vmWare安装后没有虚拟网卡Vmnet1和Vmnet8_kingheart_的博客-CSDN博客_vmware安装后没有虚拟网卡</div>            <div class="tag-link-sitename">视频和百度学习 https://blog.csdn.net/kingheart_/article/details/127434816</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="tip cogs"><p>需要的安装包：</p></div><p>1.<a href="https://archive.kernel.org/centos-vault/7.5.1804/isos/x86_64/"><strong>CentOS</strong></a>镜像——&gt;<em>CentOS-7.5-x86_64-DVD-1804.iso</em><br>2.<a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html"><strong>jdk</strong></a>压缩包——&gt;<em>jdk-8u341-linux-x64.rpm</em><br>3.<a href="http://archive.apache.org/dist/hadoop/common/"><strong>hadoop</strong></a>压缩包——&gt;<em>hadoop-3.2.1.tar.gz</em><br>4.<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/"><strong>zookeeper</strong></a>压缩包——&gt;<em>apache-zookeeper-3.7.1-bin.tar.gz</em></p><h2 id="1-网络配置"><a href="#1-网络配置" class="headerlink" title="1.网络配置"></a>1.网络配置</h2><h3 id="1-1修改主机名和修改虚拟机IP地址，以及添加主机映射"><a href="#1-1修改主机名和修改虚拟机IP地址，以及添加主机映射" class="headerlink" title="1.1修改主机名和修改虚拟机IP地址，以及添加主机映射"></a>1.1修改<a href="https://so.csdn.net/so/search?q=%E4%B8%BB%E6%9C%BA%E5%90%8D&amp;spm=1001.2101.3001.7020"><strong>主机名</strong></a>和修改虚拟机IP地址，以及添加主机映射</h3><p>1.1.1 修改<a href="https://so.csdn.net/so/search?q=%E8%99%9A%E6%8B%9F%E6%9C%BA&amp;spm=1001.2101.3001.7020"><strong>虚拟机</strong></a>IP地址<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/sysconfig/network-scripts/ifcfg-ens33</span><br><span class="line">          修改:</span><br><span class="line">                  BOOTPROTO=<span class="keyword">static</span></span><br><span class="line">                  ONBOOT=yes</span><br><span class="line">          添加内容：</span><br><span class="line">                IPADRR = <span class="number">192.168</span><span class="number">.33</span><span class="number">.147</span>(匿)</span><br><span class="line">                GATEWAY = <span class="number">192.168</span><span class="number">.33</span><span class="number">.2</span></span><br><span class="line">                NETMASK = <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">                DNS1=<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br><span class="line"></span><br><span class="line">sudo vim /etc/sysconfig/network(可以不配)</span><br><span class="line">        添加内容：</span><br><span class="line">                NETWORKING=yes</span><br><span class="line">HOSTNAME=master</span><br></pre></td></tr></table></figure></p><p>1.1.2 重启网络<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network start</span><br></pre></td></tr></table></figure></p><p>1.1.3 下载<code>vim</code>和<code>net-tools</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install vim</span><br><span class="line">sudo yum -y install net-tools</span><br><span class="line"></span><br><span class="line">修改字体缩进格式</span><br><span class="line">sudo vim /etc/vimrc</span><br><span class="line">        添加  <span class="built_in">set</span> ts=4</span><br></pre></td></tr></table></figure></p><p>1.1.4 添加主机<a href="https://so.csdn.net/so/search?q=%E6%98%A0%E5%B0%84&amp;urw="><strong>映射</strong></a>（方便后面免密连接)<br><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br><span class="line"></span><br><span class="line">修改内容（如）：</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.147</span> master</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.148</span> slave1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.149</span> slave2</span><br></pre></td></tr></table></figure></p><p>1.1.5 关闭<a href="https://so.csdn.net/so/search?q=防火墙&amp;urw="><strong>防火墙</strong></a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop firewalld(.service)</span><br><span class="line"></span><br><span class="line">开机，重启自动关闭</span><br><span class="line">sudo systemctl disable firewalld(.service)</span><br></pre></td></tr></table></figure></p><p>1.1.6 查看防火墙<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure></p><p>1.1.7 关闭<a href="https://so.csdn.net/so/search?q=selinux&amp;urw="><strong>selinux</strong></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/selinux/config</span><br><span class="line">修改为：</span><br><span class="line">    SELINUX=disabled</span><br></pre></td></tr></table></figure></p><p>1.1.8 克隆slave1和slave2,先关机，修改各网络IP地址<br><br></p><p>1.1.9 修改每个主机名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hostname </span><br><span class="line"></span><br><span class="line">修改内容（如）：</span><br><span class="line">主机：master</span><br><span class="line">节点：slave1</span><br><span class="line">节点：slave2</span><br><span class="line">改完重启：reboot</span><br></pre></td></tr></table></figure></p><h3 id="1-2-生成公钥和私钥"><a href="#1-2-生成公钥和私钥" class="headerlink" title="1.2 生成公钥和私钥"></a>1.2 生成<a href="https://so.csdn.net/so/search?q=公钥&amp;urw="><strong>公钥</strong></a>和<a href="https://so.csdn.net/so/search?q=私钥&amp;urw="><strong>私钥</strong></a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>1.2.1 将公钥拷贝到要免密登录的目标机器上<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub master</span><br><span class="line"></span><br><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub slave1</span><br><span class="line"></span><br><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub slave2</span><br></pre></td></tr></table></figure></p><p>1.2.2 验证<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /home/huser/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><h2 id="2-配置时间服务器"><a href="#2-配置时间服务器" class="headerlink" title="2.配置时间服务器"></a>2.配置<a href="https://so.csdn.net/so/search?q=时间服务器&amp;urw="><strong>时间服务器</strong></a></h2><h3 id="2-1-检查ntp包是否安装"><a href="#2-1-检查ntp包是否安装" class="headerlink" title="2.1 检查ntp包是否安装"></a>2.1 检查ntp包是否安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep ntp</span><br></pre></td></tr></table></figure><p>2.1.1 没有，则安装ntp包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install ntp</span><br></pre></td></tr></table></figure></p><p>2.1.2 设置时间配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 ~]$ sudo vim /etc/ntp.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改一（设置本地网络上的主机不受限制）</span></span><br><span class="line"><span class="comment">#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap 为</span></span><br><span class="line">restrict 192.168.33.0 mask 255.255.255.0 nomodify notrap</span><br><span class="line"><span class="comment">#修改二（添加默认的一个内部时钟数据，使用它为局域网用户提供服务）</span></span><br><span class="line">server 127.127.1.0</span><br><span class="line">fudge 127.127.1.0 stratum 10</span><br><span class="line"><span class="comment">#修改三（设置为不采用公共的服务器）</span></span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst 为</span><br><span class="line"><span class="comment">#server 0.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 1.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 2.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 3.centos.pool.ntp.org iburst</span></span><br></pre></td></tr></table></figure></p><p>2.1.3  设置BIOS与系统时间同步<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 ~]$ sudo vim /etc/sysconfig/ntpd</span><br><span class="line"></span><br><span class="line"><span class="comment">#增加如下内容（让硬件时间与系统时间一起同步）</span></span><br><span class="line">OPTIONS=<span class="string">&quot;-u ntp:ntp -p /var/run/ntpd.pid -g&quot;</span></span><br><span class="line">SYNC_HWCLOCK=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure></p><p>2.1.4 启动ntp服务并测试<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 ~]$ sudo systemctl start ntpd</span><br><span class="line">[huser@slave1 ~]$ systemctl status ntpd</span><br><span class="line"><span class="comment">#设置ntp服务开机自启</span></span><br><span class="line">[huser@slave1 ~]$ sudo systemctl <span class="built_in">enable</span> ntpd.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line">[huser@slave1 ~]$ ntpstat</span><br><span class="line">synchronised to <span class="built_in">local</span> net (127.127.1.0) at stratum 11</span><br><span class="line">   time correct to within 3948 ms</span><br><span class="line">   polling server every 64 s</span><br><span class="line">[huser@slave1 ~]$ sudo ntpq -p</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">     remote           refid      st t when poll reach   delay   offset  jitter</span></span><br><span class="line"><span class="string">==============================================================================</span></span><br><span class="line"><span class="string">*LOCAL(0)        .LOCL.          10 l   26   64    3    0.000    0.000   0.000</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h3 id="2-2-其它节点与时间服务器同步时间"><a href="#2-2-其它节点与时间服务器同步时间" class="headerlink" title="2.2 其它节点与时间服务器同步时间"></a>2.2 其它节点与时间服务器同步时间</h3><p>2.2.1 关闭非时间服务器的ntp服务<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop ntpd</span><br></pre></td></tr></table></figure></p><p>2.2.2 手动同步<br>前提：每台节点必须安装ntp包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave2 ~]$ sudo ntpdate hadoop02</span><br><span class="line">24 Nov 11:25:13 ntpdate[2878]: step time server 192.168.239.125 offset 24520304.363894 sec</span><br><span class="line">[huser@slave2 ~]$ <span class="built_in">date</span> </span><br><span class="line">2020年 11月 24日 星期二 11:25:20 CST</span><br></pre></td></tr></table></figure></p><p>2.2.3 定时同步(可跳过)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install crond</span><br><span class="line">sudo vim /etc/crontab</span><br><span class="line"></span><br><span class="line">编写定时任务如下：</span><br><span class="line">*/1 * * * * /usr/sbin/ntpdate hadoop02</span><br><span class="line">*/1 * * * * /usr/bin/echo <span class="string">&quot;文件&quot;</span> &gt;&gt; ~/<span class="string">&quot;目录&quot;</span></span><br></pre></td></tr></table></figure></p><p>2.2.4 加载任务，生效(可跳过)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo crontab /etc/crontab</span><br></pre></td></tr></table></figure></p><p>2.2.5 修改时间服务器时间(可跳过)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">date</span> -s <span class="string">&quot;2020-11-24 11:24:11&quot;</span></span><br></pre></td></tr></table></figure></p><p>2.2.6 查看是否时间服务器同步<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span></span><br></pre></td></tr></table></figure></p><h2 id="3-配置JDk"><a href="#3-配置JDk" class="headerlink" title="3.配置JDk"></a>3.配置JDk</h2><p>3.1.1 在Linux系统下的软件包导入</p><p>3.1.2 <strong>解压JDk</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.zp文件：tar -zxvf jdk-8u341-linux-x64.tar.gz -C /usr/java</span><br><span class="line">.rpm文件：先把文件复制指定目录  <span class="built_in">cp</span> /home/huser/jdk-8u341-linux-x64.rpm /usr/java</span><br><span class="line">        解压                sudo rpm -ivh jdk-8u341-linux-x64.rpm</span><br></pre></td></tr></table></figure></p><p>3.1.3 <strong>配置JDK环境变量</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure></p><p>3.1.4 加载环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></p><p>3.1.5 查看java版本信息<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">java version &quot;</span>1.8.0_201<span class="string">&quot;</span></span><br><span class="line"><span class="string">Java(TM) SE Runtime Environment (build 1.8.0_201-b09)</span></span><br><span class="line"><span class="string">Java HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode)</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">java</span><br><span class="line">javac</span><br></pre></td></tr></table></figure><br>3.1.7  拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /usr/java/jdk1.8.0_341-amd64  slave2(slave1):/usr/java/</span><br><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure></p><h2 id="4-配置hadoop文件"><a href="#4-配置hadoop文件" class="headerlink" title="4.配置hadoop文件"></a>4.配置hadoop文件</h2><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>4.1.1 在Linux系统下的软件包导入<br><br></p><p>4.1.2 解压hadoop到目录下的/opt<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf hadoop-3.2.1.tar.gz -C /opt/</span><br></pre></td></tr></table></figure></p><p>4.1.3 改<a href="https://so.csdn.net/so/search?q=权限&amp;urw="><strong>权限</strong></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R huser:huser /opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># drwxr-xr-x.   4 huser huser   37 10月 29 14:22 opt</span></span><br></pre></td></tr></table></figure></p><p>4.1.4  改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> hadoop-3.2.1 hadoop</span><br></pre></td></tr></table></figure></p><h3 id="2-配置hadoop环境"><a href="#2-配置hadoop环境" class="headerlink" title="2.配置hadoop环境"></a>2.配置hadoop环境</h3><p>4.2.1 配置hadoop环境并且生效<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure></p><p>4.2.2  加载环境变量并查看<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line">hadoop version</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">Hadoop 2.7.7</span></span><br><span class="line"><span class="string">Subversion Unknown -r c1aad84bd27cd79c3d1a7dd58202a8c3ee1ed3ac</span></span><br><span class="line"><span class="string">Compiled by stevel on 2018-07-18T22:47Z</span></span><br><span class="line"><span class="string">Compiled with protoc 2.5.0</span></span><br><span class="line"><span class="string">From source with checksum 792e15d20b12c74bd6f19a1fb886490</span></span><br><span class="line"><span class="string">This command was run using /opt/hadoop/share/hadoop/common/hadoop-common-2.7.7.jar</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></p><p>4.2.3  创建文件（作用：放置数据源）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/tmp</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/journalnode_data</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/edits</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/datanode_data</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/namenode_data</span><br><span class="line"></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 datanode_data</span></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 edits</span></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 journalnode_data</span></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 namenode_data</span></span><br><span class="line"><span class="comment"># root ---&gt; huser</span></span><br><span class="line"><span class="comment">#chown -R huser:huser hadoop</span></span><br></pre></td></tr></table></figure></p><h3 id="3-配置集群文件-在-opt-hadoop-etc-hadoop目录里"><a href="#3-配置集群文件-在-opt-hadoop-etc-hadoop目录里" class="headerlink" title="3.配置集群文件,在/opt/hadoop/etc/hadoop目录里"></a>3.配置<a href="https://so.csdn.net/so/search?q=集群&amp;urw="><strong>集群</strong></a>文件,在<code>/opt/hadoop/etc/hadoop目录</code>里</h3><p>4.2.1 <strong>配置hadoop-env.sh</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim hadoop-env.sh</span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure></p><p>4.2.2 <strong>配置yarn-env.sh</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-env.sh</span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure></p><p>4.3.3   <strong>配置core-site.xml</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">    &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hdfs://hacluster&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--用来指定hadoop运行时产生文件的存放目录--&gt;</span><br><span class="line">    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;file:///opt/hadoop/tmp&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--设置缓存大小，默认4kb--&gt;</span><br><span class="line">    &lt;name&gt;io.file.buffer.size&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;4096&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定zookeeper的存放地址 --&gt;</span><br><span class="line">    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master:2181,slave1:2181,slave2:2181&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.4 <strong>配置hdfs-site.xml</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--数据块默认大小128M--&gt;</span><br><span class="line">     &lt;name&gt;dfs.block.size&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;134217728&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--副本数量，不配置的话默认为3--&gt;</span><br><span class="line">     &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;3&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--namenode节点数据（元数据）的存放位置--&gt;</span><br><span class="line">     &lt;name&gt;dfs.name.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;file:///opt/hadoop/dfs/namenode_data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--datanode节点数据（元数据）的存放位置--&gt;</span><br><span class="line">     &lt;name&gt;dfs.data.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;file:///opt/hadoop/dfs/datanode_data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.datanode.max.transfer.threads&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;4096&lt;/value&gt;</span><br><span class="line">     &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">     &lt;name&gt;dfs.nameservices&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;hacluster&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- hacluster集群下有两个namenode，分别为nn1,nn2 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.namenodes.hacluster&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;nn1,nn2,nn3&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- nn1的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.rpc-address.hacluster.nn1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:9000&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.servicepc-address.hacluster.nn1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:53310&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.http-address.hacluster.nn1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:50070&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- nn2的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.rpc-address.hacluster.nn2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:9000&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.servicepc-address.hacluster.nn2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:53310&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.http-address.hacluster.nn2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:50070&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;!-- nn3的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.rpc-address.hacluster.nn3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:9000&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.servicepc-address.hacluster.nn3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:53310&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.http-address.hacluster.nn3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:50070&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定namenode的元数据在JournalNode上存放的位置 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;qjournal://master:8485;slave1:8485;slave2:8485/hacluster&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/opt/hadoop/dfs/journalnode_data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- namenode操作日志的存放位置 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.edits.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/opt/hadoop/dfs/edits&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 开启namenode故障转移自动切换 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置失败自动切换实现方式 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.client.failover.proxy.provider.hacluster&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置隔离机制 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;sshfence&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 使用隔离机制需要SSH免密登录 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/home/huser/.ssh/id_rsa&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--hdfs文件操作权限,<span class="literal">false</span>为不验证--&gt;</span><br><span class="line">     &lt;name&gt;dfs.permissions&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.5 <strong>配置mapred-site.xml</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果有mapred-site.xml，直接跳过</span><br><span class="line">没有：<span class="built_in">cp</span> mapred-site.xml.template mapred-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim mapred-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定mapreduce运行在yarn上--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--配置任务历史服务器地址--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master:10020&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--配置任务历史服务器web-UI地址--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master:19888&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--开启uber模式--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.job.ubertask.enable&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.6 配置yarn-site.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;!-- 开启Yarn高可用 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定Yarn集群在zookeeper上注册的节点名 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;hayarn&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定两个ResourceManager的名称 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;rm1,rm2,rm3&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- ========== rm1 的配置 ========== --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定rm1的主机 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 rm1 的 web 端地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.webapp.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8088&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定 rm1 的内部通信地址 --&gt; </span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8032&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.scheduler.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8030&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定供 NM 连接的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8031&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- ========== rm2 的配置 ========== --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定rm2的主机 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 rm2 的 web 端地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.webapp.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8088&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定 rm2 的内部通信地址 --&gt; </span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8032&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 AM 向 rm2 申请资源的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.scheduler.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8030&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定供 NM 连接的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8031&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- ========== rm3 的配置 ========== --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定rm3的主机 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 rm3 的 web 端地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.webapp.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8088&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定 rm3 的内部通信地址 --&gt; </span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8032&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 AM 向 rm3 申请资源的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.scheduler.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8030&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定供 NM 连接的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8031&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置zookeeper的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:2181,slave1:2181,slave2:2181&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 开启Yarn恢复机制 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.recovery.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置执行ResourceManager恢复机制实现类 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.store.class&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--指定主resourcemanager的地址--&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--NodeManager获取数据的方式--&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 环境变量的继承 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;</span><br><span class="line">&lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--开启日志聚集功能--&gt;</span><br><span class="line">     &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 设置日志聚集服务器地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.log.server.url&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;http://master:19888/jobhistory/logs&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--配置日志保留7天--&gt;</span><br><span class="line">     &lt;name&gt;yarn.log-aggregation.retain-seconds&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;604800&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!--Spark--&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定类的位置和文件配置位置 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.application.classpath&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">&lt;!-- 配置HDFS网页登录使用的静态用户为huser--&gt;</span><br><span class="line">     &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;huser&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.7 <strong>配置slaves</strong></p><p><font color=red>hadoop3.3.0版本是 workers</font><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim slaves</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><p>4.3.8  拷贝到slave1和slave2节点,并改权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/hadoop  slave2(slave1):/opt/</span><br><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br><span class="line"><span class="comment"># 因为拷贝过去的文件是root权限,所以要改huser用户</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R huser:huser /opt</span><br></pre></td></tr></table></figure></p><h2 id="5-配置zookeeper文件"><a href="#5-配置zookeeper文件" class="headerlink" title="5.配置zookeeper文件"></a>5.配置zookeeper文件</h2><h3 id="1-准备工作-1"><a href="#1-准备工作-1" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>5.1.1 <strong>在Linux系统下的软件包导入</strong><br><br><br><strong>5.1.2 解压hadoop到目录下的/opt</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf apache-zookeeper-3.7.1-bin.tar.gz -C /opt/</span><br></pre></td></tr></table></figure></p><p>5.1.3  改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mv</span> apache-zookeeper-3.7.1-bin zookeeper</span><br></pre></td></tr></table></figure></p><p>5.1.4 改权限（如果是普通用户要加 sudo ）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R huser:huser zookeeper</span><br><span class="line"></span><br><span class="line"><span class="comment"># drwxr-xr-x.   4 huser huser   37 10月 29 14:22 zookeeper</span></span><br></pre></td></tr></table></figure></p><h3 id="2-配置zookeeper环境"><a href="#2-配置zookeeper环境" class="headerlink" title="2.配置zookeeper环境"></a>2.配置zookeeper环境</h3><p>4.2.1 <strong>配置</strong><code>zookeeper</code><strong>环境并且生效</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># ZOOKEEPER_HOME</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br></pre></td></tr></table></figure></p><p>4.2.2  加载环境变量并查看<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></p><p>4.2.3 拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure></p><h3 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3.修改配置文件"></a>3.修改配置文件</h3><p>5.3.1 进入安装目录的 conf/ 目录下，拷贝配置样本并进行修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/zookeeper/conf</span><br></pre></td></tr></table></figure></p><p>5.3.2 改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure></p><p>5.3.3 修改配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">vim zoo.cfg</span><br><span class="line">修改为：</span><br><span class="line">      <span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line">      tickTime=2000</span><br><span class="line">      <span class="comment"># The number of ticks that the initial </span></span><br><span class="line">      <span class="comment"># synchronization phase can take</span></span><br><span class="line">      initLimit=10</span><br><span class="line">      <span class="comment"># The number of ticks that can pass between </span></span><br><span class="line">      <span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line">      syncLimit=5</span><br><span class="line">      <span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line">      <span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line">      <span class="comment"># example sakes.</span></span><br><span class="line">      dataDir=/opt/zookeeper/data</span><br><span class="line">      <span class="comment"># the port at which the clients will connect</span></span><br><span class="line">      clientPort=2181</span><br><span class="line">添加：</span><br><span class="line">dataLogDir=/opt/zookeeper/logs</span><br><span class="line">server.1=master:2888:3888</span><br><span class="line">server.2=slave1:2888:3888</span><br><span class="line">server.3=slave2:2888:3888</span><br><span class="line"></span><br><span class="line"><span class="comment">#配置参数说明：</span></span><br><span class="line"><span class="comment">#    ·tickTime：用于计算的基础时间单元。比如 session 超时：N*tickTime；</span></span><br><span class="line"><span class="comment">#    ·initLimit：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；</span></span><br><span class="line"><span class="comment">#    ·syncLimit：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；</span></span><br><span class="line"><span class="comment">#    ·dataDir：数据存储位置；</span></span><br><span class="line"><span class="comment">#    ·dataLogDir：日志目录；</span></span><br><span class="line"><span class="comment">#    ·clientPort：用于客户端连接的端口，默认 2181</span></span><br></pre></td></tr></table></figure></p><p>5.3.4  拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/zookeeper  slave2(slave1):/opt/</span><br><span class="line"><span class="comment"># 因为拷贝过去的文件是root权限,所以要改huser用户</span></span><br><span class="line"><span class="comment"># 下面是slave2 slave3 的操作</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R huser:huser /opt/zookeeper</span><br></pre></td></tr></table></figure></p><h3 id="4-标识节点"><a href="#4-标识节点" class="headerlink" title="4.标识节点"></a>4.标识节点</h3><p>5.4.1 创建存储目录<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> data logs(<span class="built_in">cd</span> /opt/zookeeper)</span><br></pre></td></tr></table></figure></p><p>5.4.2 创建并写入节点标识到 myid 文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave1主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave2主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;3&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br></pre></td></tr></table></figure></p><p>5.4.3 验证节点标识<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> myid(<span class="built_in">cat</span> /opt/zookeeper/data/myid)</span><br></pre></td></tr></table></figure></p><h3 id="5-启动zookeeper"><a href="#5-启动zookeeper" class="headerlink" title="5.启动zookeeper"></a>5.启动zookeeper</h3><p>5.5.1 启动QuorumPeerMain节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br></pre></td></tr></table></figure></p><p>5.5.2 查看集群<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh status</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">ZooKeeper JMX enabled by default</span></span><br><span class="line"><span class="string">Using config: /opt/zookeeper/bin/../conf/zoo.cfg</span></span><br><span class="line"><span class="string">Client port found: 2181. Client address: localhost. Client SSL: false.</span></span><br><span class="line"><span class="string">Mode: follower</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h2 id="6-启动集群"><a href="#6-启动集群" class="headerlink" title="6. 启动集群"></a>6. 启动集群</h2><p>6.1.1 启动journalnode，三台机器都要这一步操作（仅第一次启动hadoop时，需要这一步操作）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start journalnode</span><br></pre></td></tr></table></figure></p><p>6.1.2 在master主机上执行格式化操作，格式化namenode<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure></p><p>6.1.3 复制Namenode元数据到slave1和slave2</p><p><font color=red>如果没有权限，就在代码前面加—-&gt; sudo</font><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r  <span class="variable">$HADOOP_HOME</span>/dfs/namenode_data/ slave1(slave2):<span class="variable">$HADOOP_HOME</span>/dfs/</span><br></pre></td></tr></table></figure></p><p>6.1.4 格式化zkfc</p><p><font color=red>slave1或slave2【二者选其一即可】</font><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs zkfc -formatZK</span><br></pre></td></tr></table></figure></p><p>6.1.5 启动集群<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动dfs服务(master)</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"><span class="comment"># 启动yarn服务(slave2)</span></span><br><span class="line">start-yarn.sh</span><br><span class="line"><span class="comment"># 启动任务历史服务器(master)</span></span><br><span class="line">mr-jobhistory-daemon.sh start historyserver</span><br><span class="line"><span class="comment"># ResourceManager(slave1)</span></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br><span class="line"><span class="comment"># 暴力启动</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="comment"># 关闭集群</span></span><br><span class="line">stop-all.sh</span><br></pre></td></tr></table></figure></p><p>6.1.6 查看<a href="https://so.csdn.net/so/search?q=节点&amp;urw="><strong>节点</strong></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">=============== master ===============</span></span><br><span class="line"><span class="string">50385 JournalNode</span></span><br><span class="line"><span class="string">50673 ResourceManager</span></span><br><span class="line"><span class="string">50115 NameNode</span></span><br><span class="line"><span class="string">45528 QuorumPeerMain</span></span><br><span class="line"><span class="string">50216 DataNode</span></span><br><span class="line"><span class="string">50538 DFSZKFailoverController</span></span><br><span class="line"><span class="string">51098 Jps</span></span><br><span class="line"><span class="string">50780 NodeManager</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">=============== slave1 ===============</span></span><br><span class="line"><span class="string">5777 NodeManager</span></span><br><span class="line"><span class="string">4310 NameNode</span></span><br><span class="line"><span class="string">4487 DataNode</span></span><br><span class="line"><span class="string">5608 ResourceManager</span></span><br><span class="line"><span class="string">5147 DFSZKFailoverController</span></span><br><span class="line"><span class="string">6811 Jps</span></span><br><span class="line"><span class="string">1260 QuorumPeerMain</span></span><br><span class="line"><span class="string">4860 JournalNode</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">=============== slave2 ===============</span></span><br><span class="line"><span class="string">5059 DFSZKFailoverController</span></span><br><span class="line"><span class="string">4484 DataNode</span></span><br><span class="line"><span class="string">5636 NodeManager</span></span><br><span class="line"><span class="string">4793 JournalNode</span></span><br><span class="line"><span class="string">4187 NameNode</span></span><br><span class="line"><span class="string">1262 QuorumPeerMain</span></span><br><span class="line"><span class="string">5486 ResourceManager</span></span><br><span class="line"><span class="string">7263 Jps</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><p>6.1.7 查看<a href="https://so.csdn.net/so/search?q=NameNode&amp;urw="><strong>NameNode</strong></a>和<a href="https://so.csdn.net/so/search?q=ResourceManager&amp;urw="><strong>ResourceManager</strong></a>的状态<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#【 查看NameNode的状态】</span></span><br><span class="line">[huser@master ~]$ hdfs haadmin -getServiceState nn1---&gt;   active</span><br><span class="line">[huser@master ~]$ hdfs haadmin -getServiceState nn2---&gt;   standby</span><br><span class="line">[huser@master ~]$ hdfs haadmin -getServiceState nn3---&gt;   standby</span><br><span class="line"></span><br><span class="line"><span class="comment">#【查看ResourceManager的状态】</span></span><br><span class="line">[huser@slave1(slave2) ~]$ yarn rmadmin -getServiceState rm1---&gt;   standby</span><br><span class="line">[huser@slave1(slave2) ~]$ yarn rmadmin -getServiceState rm2---&gt;   active</span><br></pre></td></tr></table></figure></p><h2 id="7-集群二次启动"><a href="#7-集群二次启动" class="headerlink" title="7.集群二次启动"></a>7.集群<a href="https://so.csdn.net/so/search?q=二次启动&amp;urw="><strong>二次启动</strong></a></h2><h3 id="1-启动集群"><a href="#1-启动集群" class="headerlink" title="1 启动集群"></a>1 启动集群</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master   ---&gt;     start-dfs.sh</span><br><span class="line">slave2   ---&gt;     start-yarn.sh</span><br><span class="line">slave1   ---&gt;     yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure><p>注意：HA集群都启动好之后，杀掉一个active的NameNode之后，发现另一个NameNode并不能自动切换成active，而还是standby，经过查看日志发现如下错误：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 logs]$ <span class="built_in">tail</span> -100 hadoop-xiaokang-zkfc-hadoop02.log</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span>PATH=<span class="variable">$PATH</span>:/sbin:/usr/sbin fuser -v -k -n tcp 9000 via ssh: bash: fuser: 未找到命令<span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><br>解决方法：（NameNode节点上安装上psmisc即可）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install psmisc</span><br></pre></td></tr></table></figure></p><h3 id="2-集群开启脚本-opt-bin"><a href="#2-集群开启脚本-opt-bin" class="headerlink" title="2. 集群开启脚本/opt/bin"></a>2. 集群开启脚本<code>/opt/bin</code></h3><h4 id="2-1-启动集群脚本"><a href="#2-1-启动集群脚本" class="headerlink" title="2.1 启动集群脚本"></a>2.1 启动集群脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">vim start-dfs.sh </span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#启动zk集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;zkServer.sh start&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#休眠1s</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#启动hdfs集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;start-dfs.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 启动yarn服务</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;start-yarn.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 启动任务历史服务器(master)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;mr-jobhistory-daemon.sh start historyserver&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 启动ResourceManager(slave1)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;yarn-daemon.sh start resourcemanager&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure><h4 id="2-2-关闭集群脚本"><a href="#2-2-关闭集群脚本" class="headerlink" title="2.2 关闭集群脚本"></a>2.2 关闭集群脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">vim stop-dfs.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#关闭zk集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;zkServer.sh stop&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#休眠1s</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#关闭hdfs集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;stop-dfs.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭yarn服务</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;stop-yarn.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭任务历史服务器(master)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;mr-jobhistory-daemon.sh stop historyserver&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭ResourceManager(slave1)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;yarn-daemon.sh stop resourcemanager&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure><h4 id="2-3-查看节点脚本"><a href="#2-3-查看节点脚本" class="headerlink" title="2.3 查看节点脚本"></a>2.3 查看节点脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim allJps.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#查看当前节点的角色进程</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span>     </span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;-----------<span class="variable">$node</span> jps--------------&quot;</span></span><br><span class="line">   ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;jps&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="2-4-HBase启动和关闭脚本"><a href="#2-4-HBase启动和关闭脚本" class="headerlink" title="2.4 HBase启动和关闭脚本"></a>2.4 HBase启动和关闭脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim hbase-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.1 启动集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动HBase</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;start-hbase.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"></span><br><span class="line">vim hbase-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.2 关闭集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭HBase</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;stop-hbase.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br></pre></td></tr></table></figure><h4 id="2-5-Kylin启动和关闭脚本"><a href="#2-5-Kylin启动和关闭脚本" class="headerlink" title="2.5 Kylin启动和关闭脚本"></a>2.5 Kylin启动和关闭脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim kylin-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.4 HBase启动脚本   下面添加：：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动Kylin</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;kylin.sh start&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"></span><br><span class="line">vim kylin-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.4 HBase关闭脚本   下面添加：：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭Kylin</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;kylin.sh stop&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br></pre></td></tr></table></figure><h4 id="2-6-spark启动和关闭脚本"><a href="#2-6-spark启动和关闭脚本" class="headerlink" title="2.6 spark启动和关闭脚本"></a>2.6 spark启动和关闭脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">vim spark-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.1 启动集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 开启任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br><span class="line"></span><br><span class="line">vim spark-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.2 关闭集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure><h4 id="2-7-HA-spark启动和关闭脚本"><a href="#2-7-HA-spark启动和关闭脚本" class="headerlink" title="2.7 HA-spark启动和关闭脚本"></a>2.7 HA-spark启动和关闭脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">vim HA-spark-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.1 启动集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;cd /opt/spark/sbin;source /etc/profile;bash /opt/spark/sbin/start-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 开启Master</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-master.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 开启任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br><span class="line"></span><br><span class="line">vim HA-spark-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.2 关闭集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭Master</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-master.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure><h4 id="2-8-配置shell环境变量并更新"><a href="#2-8-配置shell环境变量并更新" class="headerlink" title="2.8  配置shell环境变量并更新"></a>2.8  配置shell环境变量并更新</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"><span class="comment"># shell </span></span><br><span class="line"><span class="built_in">export</span> SHELL_HOME=/opt/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SHELL_HOME</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h4 id="2-8-权限和启动脚本"><a href="#2-8-权限和启动脚本" class="headerlink" title="2.8 权限和启动脚本"></a>2.8 权限和启动脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一种：</span><br><span class="line"><span class="built_in">chmod</span> +x startdfs.sh</span><br><span class="line"><span class="built_in">chmod</span> +x allJps.sh</span><br><span class="line"><span class="built_in">chmod</span> +x stopdfs.sh</span><br><span class="line">bash startdfs.sh</span><br><span class="line">第二种：</span><br><span class="line"><span class="built_in">chmod</span> -R 777 bin/</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line">startdfs.sh</span><br></pre></td></tr></table></figure><h4 id="2-9-vim快捷键"><a href="#2-9-vim快捷键" class="headerlink" title="2.9 vim快捷键"></a>2.9 vim快捷键</h4><p><font color=green>:%s/要替换的值/替换后的值</font></p><h4 id="2-10-执行脚本"><a href="#2-10-执行脚本" class="headerlink" title="2.10 执行脚本"></a>2.10 执行脚本</h4><p>去到脚本所在的目录然后 <code>./脚本名</code>例如<code>./start-dfs.sh</code>  切记!!!!!!!!!!!</p><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xVSu.png" alt="hdfs--namenode--master" title="hdfs--namenode--master"><br><br><br><img src="https://vip.helloimg.com/images/2023/12/15/o7xjmY.png" alt="hdfs--namenode--slave1" title="hdfs--namenode--slave1"><br><br><br><img src="https://vip.helloimg.com/images/2023/12/15/o7xh5E.png" alt="hdfs--namenode--slave2" title="hdfs--namenode--slave2"><br><br><br><img src="https://vip.helloimg.com/images/2023/12/15/o7xYpv.png" alt="hdfs--yarn" title="hdfs--yarn"><br><br><br><img src="https://vip.helloimg.com/images/2023/12/15/o7xrot.png" alt="hdfs-JobHistoty" title="hdfs-JobHistoty"></p><h2 id="8-web端hadoop-hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法"><a href="#8-web端hadoop-hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法" class="headerlink" title="8. web端hadoop hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法"></a>8. web端hadoop hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法</h2><h3 id="1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可"><a href="#1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可" class="headerlink" title="1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可"></a>1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可</h3><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xyYX.png" alt="捕获.PNG"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 apps.corel.com</span><br><span class="line">127.0.0.1 mc.corel.com</span><br><span class="line">127.0.0.1 origin-mc.corel.com</span><br><span class="line">127.0.0.1 iws.corel.com</span><br><span class="line">127.0.0.1 activate.navicat.com</span><br><span class="line">192.168.33.132 master(例)</span><br><span class="line">192.168.33.133 slave1(例)</span><br><span class="line">192.168.33.134 slave2(例)</span><br><span class="line">192.168.33.170 a1(例)</span><br><span class="line">192.168.33.171 a2(例)</span><br><span class="line">192.168.33.172 a3(例)</span><br></pre></td></tr></table></figure></p><h3 id="2-更改环境变量-可以跳过"><a href="#2-更改环境变量-可以跳过" class="headerlink" title="2. 更改环境变量(可以跳过)"></a>2. 更改环境变量(可以跳过)</h3><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xud9.png" alt="20201021221301809.png"></p><h3 id="3-用户权限问题"><a href="#3-用户权限问题" class="headerlink" title="3. 用户权限问题"></a>3. 用户权限问题</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">chmod</span> 777 <span class="string">&quot;文件&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;note green anzhiyufont anzhiyu-icon-ic_train modern&quot;&gt;&lt;p&gt;介绍：&lt;strong&gt;HDFS&lt;/strong&gt; （&lt;strong&gt;Hadoop Distributed File System&lt;/strong</summary>
      
    
    
    
    
    <category term="大数据应用" scheme="https://xin0203xin0203.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8/"/>
    
    <category term="HADOOP" scheme="https://xin0203xin0203.github.io/tags/HADOOP/"/>
    
    <category term="Linux" scheme="https://xin0203xin0203.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>完全分布式和Hadoop高可用集群的核心文件</title>
    <link href="https://xin0203xin0203.github.io/posts/7355e8ed.html"/>
    <id>https://xin0203xin0203.github.io/posts/7355e8ed.html</id>
    <published>2023-12-14T17:03:58.685Z</published>
    <updated>2024-12-14T16:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<div class="tip home"><p>前提观看：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h1 id="相同文件配置"><a href="#相同文件配置" class="headerlink" title="相同文件配置"></a>相同文件配置</h1><h2 id="workers"><a href="#workers" class="headerlink" title="workers"></a>workers</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h2 id="hadoop-env-sh"><a href="#hadoop-env-sh" class="headerlink" title="hadoop-env.sh"></a>hadoop-env.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/module/jdk1.8.0_321</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure><h1 id="完全分布式"><a href="#完全分布式" class="headerlink" title="完全分布式"></a>完全分布式</h1><h2 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定<span class="title class_">NameNode</span>的地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 指定hadoop数据的存储目录 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- nn web端访问地址--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9870<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 2nn web端访问地址--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9868<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 不开启权限检查 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定<span class="variable constant_">MR</span>走shuffle --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> </span><br><span class="line">&lt;!-- 指定<span class="title class_">ResourceManager</span>的地址--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> </span><br><span class="line">&lt;!-- 环境变量的继承 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 开启日志聚集功能 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 设置日志聚集服务器地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 设置日志保留时间为<span class="number">7</span>天 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">    &lt;!-- 指定<span class="title class_">MapReduce</span>程序运行在<span class="title class_">Yarn</span>上 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.env<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>HADOOP_MAPRED_HOME=/opt/hadoop<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.env<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>HADOOP_MAPRED_HOME=/opt/hadoop<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    </span><br><span class="line">    &lt;!-- 历史服务器端地址 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">     </span><br><span class="line">    &lt;!-- 历史服务器web端地址 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    </span><br><span class="line">    &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀</span><br><span class="line">掉，默认是 <span class="literal">true</span> --&gt; </span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span> </span><br><span class="line">    &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀</span><br><span class="line">掉，默认是 <span class="literal">true</span> --&gt; </span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span> </span><br></pre></td></tr></table></figure><h1 id="Hadoop高可用集群"><a href="#Hadoop高可用集群" class="headerlink" title="Hadoop高可用集群"></a>Hadoop高可用集群</h1><h2 id="core-site-xml-1"><a href="#core-site-xml-1" class="headerlink" title="core-site.xml"></a>core-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--用来指定hadoop运行时产生文件的存放目录--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--设置缓存大小，默认4kb--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--指定zookeeper的存放地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ha.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="hdfs-site-xml-1"><a href="#hdfs-site-xml-1" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--数据块默认大小128M--&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.block.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--副本数量，不配置的话默认为3--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--namenode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/namenode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--datanode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/datanode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.max.transfer.threads<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- hacluster集群下有两个namenode，分别为nn1,nn2 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.namenodes.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>nn1,nn2,nn3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn1的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn2的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- nn3的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定namenode的元数据在JournalNode上存放的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.shared.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>qjournal://master:8485;slave1:8485;slave2:8485/hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.journalnode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/journalnode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- namenode操作日志的存放位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/edits<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启namenode故障转移自动切换 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.automatic-failover.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置失败自动切换实现方式 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.failover.proxy.provider.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置隔离机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.methods<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>sshfence<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 使用隔离机制需要SSH免密登录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/huser/.ssh/id_rsa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--hdfs文件操作权限,false为不验证--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="yarn-site-xml-1"><a href="#yarn-site-xml-1" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;!-- 开启<span class="title class_">Yarn</span>高可用 --&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定Yarn集群在zookeeper上注册的节点名 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.cluster-id<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hayarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定两个ResourceManager的名称 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.rm-ids<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>rm1,rm2,rm3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm1 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm1的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm1 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm1 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm2 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm2的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm2 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm2 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm2 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm3 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm3的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm3 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm3 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm3 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置zookeeper的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.zk-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启Yarn恢复机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.recovery.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置执行ResourceManager恢复机制实现类 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.store.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定主resourcemanager的地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--NodeManager获取数据的方式--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 环境变量的继承 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--开启日志聚集功能--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 设置日志聚集服务器地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--配置日志保留7天--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--<span class="title class_">Spark</span>--&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定类的位置和文件配置位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="mapred-site-xml-1"><a href="#mapred-site-xml-1" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定mapreduce运行在yarn上--&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器web-UI地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--开启uber模式--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;tip home&quot;&gt;&lt;p&gt;前提观看：&lt;/p&gt;
&lt;/div&gt;
&lt;div calss=&#39;anzhiyu-tag-link&#39;&gt;&lt;a class=&quot;tag-Link&quot; target=&quot;_blank&quot; href=&quot;/%5B%E4%B8%80%E3%80%81%E9%</summary>
      
    
    
    
    
    <category term="大数据应用" scheme="https://xin0203xin0203.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8/"/>
    
    <category term="HADOOP" scheme="https://xin0203xin0203.github.io/tags/HADOOP/"/>
    
    <category term="Linux" scheme="https://xin0203xin0203.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>快速搭建大数据平台环境（简约版）</title>
    <link href="https://xin0203xin0203.github.io/posts/9a48b9a4.html"/>
    <id>https://xin0203xin0203.github.io/posts/9a48b9a4.html</id>
    <published>2023-12-14T15:35:57.363Z</published>
    <updated>2024-12-14T14:44:44.000Z</updated>
    
    <content type="html"><![CDATA[<div class="tip home"><p>需要的安装包：</p></div><ol><li><a href="https://www.centos.org/download/"><strong>CentOS</strong></a>镜像——&gt;<em>CentOS-7.5-x86_64-DVD-1804.iso</em></li><li><a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html"><strong>jdk</strong></a>压缩包——&gt;jdk-8u341-linux-x64.rpm</li><li><a href="http://archive.apache.org/dist/hadoop/common/"><strong>hadoop</strong></a>压缩包——&gt;hadoop-3.2.1.tar.gz</li><li><a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/"><strong>zookeeper</strong></a>压缩包——&gt;apache-zookeeper-3.7.1-bin.tar.gz</li><li><a href="https://dev.mysql.com/downloads/file/?id=514685"><strong>MySQL</strong></a>压缩包—-&gt;mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar</li><li><a href="https://dlcdn.apache.org/hive/"><strong>Hive</strong></a>压缩包—-&gt;apache-hive-2.3.4-bin.tar.gz</li><li><a href="https://dev.mysql.com/downloads/connector/j/"><strong>MySQL的jar</strong></a>包—-&gt;mysql-connector-java-5.1.37.jar</li><li><a href="http://kylin.apache.org/cn/download/"><strong>Kylin(麒麟)</strong></a>包—-&gt;apache-kylin-4.0.2-bin.tar.gz</li><li><a href="http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz"><strong>DataX</strong></a>包—-&gt;datax.tar.gz</li><li><a href="https://archive.apache.org/dist/maven/maven-3/"><strong>Maven</strong></a>包—-&gt;apache-maven-3.6.3-bin.tar.gz</li><li><a href="https://github.com/WeiYe-Jing/datax-web/archive/v-2.1.2.tar.gz"><strong>datax-web</strong></a>包—-&gt;datax-web-v-2.1.2.tar.gz</li><li><a href="https://gradle.org/releases/"><strong>Gradle</strong></a>包—-&gt;gradle-4.6-all.zip</li><li><a href="https://github.com/azkaban/azkaban/releases"><strong>azkaban</strong></a>包—-&gt;azkaban-3.57.0.tar.gz</li><li><a href="http://archive.apache.org/dist/flume/"><strong>flume</strong></a>压缩包——&gt;apache-flume-1.7.0-bin.tar.gz</li><li><a href="https://kafka.apache.org/downloads"><strong>kafka</strong></a>压缩包——&gt;kafka_2.12-3.0.0.tgz</li><li><a href="https://www.scala-lang.org/download/2.11.12.html"><strong>Scala</strong></a>压缩包——&gt;scala-2.12.8.tgz</li><li><a href="https://spark.apache.org/downloads.html"><strong>Spark</strong></a>压缩包——&gt;spark-3.1.3-bin-hadoop3.2.tgz</li><li><a href="https://archive.apache.org/dist/flink/"><strong>flink</strong></a>压缩包——&gt;flink-1.13.0-bin-scala_2.12.tgz<h1 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1. 环境准备"></a>1. 环境准备</h1><h2 id="1-1-修改-IP"><a href="#1-1-修改-IP" class="headerlink" title="1.1  修改 IP"></a>1.1  修改 IP</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/sysconfig/network-scripts/ifcfg-ens33</span><br><span class="line">          修改:</span><br><span class="line">                  <span class="variable constant_">BOOTPROTO</span>=<span class="keyword">static</span></span><br><span class="line">                  <span class="variable constant_">ONBOOT</span>=yes</span><br><span class="line">          添加内容：</span><br><span class="line">                <span class="variable constant_">IPADRR</span> = <span class="number">192.168</span><span class="number">.33</span><span class="number">.147</span>(匿)</span><br><span class="line">                <span class="variable constant_">GATEWAY</span> = <span class="number">192.168</span><span class="number">.33</span><span class="number">.2</span></span><br><span class="line">                <span class="variable constant_">NETMASK</span> = <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">                <span class="title class_">DNS1</span>=<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br><span class="line"></span><br><span class="line">sudo vim /etc/sysconfig/<span class="title function_">network</span>(可以不配)</span><br><span class="line">        添加内容：</span><br><span class="line">                <span class="variable constant_">NETWORKING</span>=yes</span><br><span class="line"><span class="variable constant_">HOSTNAME</span>=master</span><br></pre></td></tr></table></figure></li></ol><h2 id="1-2-修改主机名及主机名和-IP-地址的映射"><a href="#1-2-修改主机名及主机名和-IP-地址的映射" class="headerlink" title="1.2 修改主机名及主机名和 IP 地址的映射"></a>1.2 修改主机名及主机名和 IP 地址的映射</h2><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br><span class="line"></span><br><span class="line">修改内容（如）：</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.147</span> master</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.148</span> slave1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.149</span> slave2</span><br></pre></td></tr></table></figure><h2 id="1-3-关闭防火墙"><a href="#1-3-关闭防火墙" class="headerlink" title="1.3 关闭防火墙"></a>1.3 关闭防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop firewalld(.service)</span><br><span class="line"></span><br><span class="line">开机，重启自动关闭</span><br><span class="line">sudo systemctl <span class="built_in">disable</span> firewalld(.service)</span><br></pre></td></tr></table></figure><h2 id="1-4-ssh-免密登录"><a href="#1-4-ssh-免密登录" class="headerlink" title="1.4 ssh 免密登录"></a>1.4 ssh 免密登录</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ssh-keygen</span> <span class="string">-t</span> <span class="string">rsa</span></span><br><span class="line"></span><br><span class="line"><span class="string">ssh-copy-id</span> <span class="string">-i</span> <span class="string">~/.ssh/id_rsa.pub</span> <span class="string">master</span></span><br><span class="line"><span class="string">ssh-copy-id</span> <span class="string">-i</span> <span class="string">~/.ssh/id_rsa.pub</span> <span class="string">slave1</span></span><br><span class="line"><span class="string">ssh-copy-id</span> <span class="string">-i</span> <span class="string">~/.ssh/id_rsa.pub</span> <span class="string">slave2</span></span><br></pre></td></tr></table></figure><h1 id="2-创建文件"><a href="#2-创建文件" class="headerlink" title="2. 创建文件"></a>2. 创建文件</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 记得：要改文件权限 root ---&gt; huser&lt;font&gt;</span></span><br><span class="line"><span class="comment"># hadoop集群文件</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/tmp</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/journalnode_data</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/edits</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/datanode_data</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/namenode_data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zookeeper文件</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">data</span> <span class="string">logs(cd</span> <span class="string">/opt/zookeeper)</span></span><br><span class="line"><span class="string">myid(--</span></span><br><span class="line"><span class="comment"># master主机</span></span><br><span class="line"><span class="string">echo</span> <span class="string">&quot;1&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">/opt/zookeeper/data/myid</span></span><br><span class="line"><span class="comment"># slave1主机</span></span><br><span class="line"><span class="string">echo</span> <span class="string">&quot;2&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">/opt/zookeeper/data/myid</span></span><br><span class="line"><span class="comment"># slave2主机</span></span><br><span class="line"><span class="string">echo</span> <span class="string">&quot;3&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">/opt/zookeeper/data/myid</span></span><br><span class="line"><span class="string">--)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL 存储文件</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/mysql/data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HDFS 存放tez依赖包</span></span><br><span class="line"><span class="string">hdfs</span> <span class="string">dfs</span> <span class="string">-mkdir</span> <span class="string">/tez</span></span><br><span class="line"><span class="string">hdfs</span> <span class="string">dfs</span> <span class="string">-put</span> <span class="string">apache-tez-0.9.2-bin.tar.gz</span> <span class="string">/tez</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># maven 创建本地目录</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/opt/maven/maven_repository</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gradle 创建本地目录</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/opt/gradle/gradle_repository</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Azkaban-solo-server 新创建文件并配置 init.gradle</span></span><br><span class="line"><span class="string">vim</span> <span class="string">/opt/gradle/gradle_repository</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Azkaban-two-server 在web服务器目录下创建多级文件夹plugins/jobtypes</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/azkaban-two/web-server/plugins/jobtypes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Kafka 存储分区信息</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/opt/kafka/kafka-logs</span></span><br></pre></td></tr></table></figure><h1 id="3-下载组件"><a href="#3-下载组件" class="headerlink" title="3.下载组件"></a>3.下载组件</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(文件修改)sudo yum -<span class="function">y install <span class="title">vim</span></span></span><br><span class="line"><span class="function">(<span class="params">设置及功能</span>)sudo yum install net-<span class="title">tools</span></span></span><br><span class="line"><span class="function">(<span class="params">时间戳</span>)sudo yum -y install <span class="title">ntp</span></span></span><br><span class="line"><span class="function">(<span class="params">定时同步时间</span>)sudo yum -y install <span class="title">crond</span></span></span><br><span class="line"><span class="function">(<span class="params">解决日志发现错误NameNode</span>)sudo yum -y install <span class="title">psmisc</span></span></span><br><span class="line"><span class="function">(<span class="params">网页wegt组件</span>)sudo yum -y install <span class="title">wegt</span></span></span><br><span class="line"><span class="function">(<span class="params">安装MySQL</span>)sudo yum -y install mysql-community-<span class="title">server</span></span></span><br><span class="line"><span class="function">(<span class="params">更新源</span>)sudo yum -y <span class="title">update</span></span></span><br><span class="line"><span class="function">(<span class="params">安装mysql</span>)sudo yum -y install mysql-server mysql-<span class="title">client</span></span></span><br><span class="line"><span class="function">(<span class="params">zip解压</span>)sudo yun -y install <span class="title">unzip</span></span></span><br><span class="line"><span class="function">(<span class="params">git下载组件</span>)sudo yum -y install <span class="title">git</span></span></span><br><span class="line"><span class="function">(<span class="params">编译环境</span>)sudo yum -y install gcc-c++</span></span><br><span class="line"><span class="function">(<span class="params">测试网络及端口</span>)sudo yum -y install <span class="title">telnet</span></span></span><br><span class="line"><span class="function">(<span class="params">网络工具</span>)sudo yum -y install nc</span></span><br></pre></td></tr></table></figure><h1 id="4-文件修改"><a href="#4-文件修改" class="headerlink" title="4. 文件修改"></a>4. 文件修改</h1><h2 id="1-集群环境搭建高可用版本配置"><a href="#1-集群环境搭建高可用版本配置" class="headerlink" title="1. 集群环境搭建高可用版本配置"></a>1. <a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo"><strong>集群环境搭建高可用版本配置</strong></a></h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">文件缩进  )<span class="string">&#x27;net-tools&#x27;</span>(  ---&gt;$ sudo vim /etc/vimrc</span><br><span class="line">        添加  <span class="keyword">set</span> ts=<span class="number">4</span></span><br><span class="line"></span><br><span class="line">设置时间  )<span class="string">&#x27;ntp&#x27;</span>(  ---&gt;$ sudo vim /etc/ntp.conf</span><br><span class="line"><span class="meta">#修改一（设置本地网络上的主机不受限制）</span></span><br><span class="line"><span class="meta">#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap 为</span></span><br><span class="line">restrict <span class="number">192.168</span><span class="number">.33</span><span class="number">.0</span> mask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> nomodify notrap</span><br><span class="line"><span class="meta">#修改二（添加默认的一个内部时钟数据，使用它为局域网用户提供服务）</span></span><br><span class="line">server <span class="number">127.127</span><span class="number">.1</span><span class="number">.0</span></span><br><span class="line">fudge <span class="number">127.127</span><span class="number">.1</span><span class="number">.0</span> stratum <span class="number">10</span></span><br><span class="line"><span class="meta">#修改三（设置为不采用公共的服务器）</span></span><br><span class="line">server <span class="number">0.</span>centos.pool.ntp.org iburst</span><br><span class="line">server <span class="number">1.</span>centos.pool.ntp.org iburst</span><br><span class="line">server <span class="number">2.</span>centos.pool.ntp.org iburst</span><br><span class="line">server <span class="number">3.</span>centos.pool.ntp.org iburst 为</span><br><span class="line"><span class="meta">#server 0.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="meta">#server 1.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="meta">#server 2.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="meta">#server 3.centos.pool.ntp.org iburst</span></span><br><span class="line"></span><br><span class="line">设置BIOS与系统时间同步  )<span class="string">&#x27;ntp&#x27;</span>(    ---&gt;$ sudo vim /etc/sysconfig/ntpd</span><br><span class="line"><span class="meta">#增加如下内容（让硬件时间与系统时间一起同步）</span></span><br><span class="line">      OPTIONS=<span class="string">&quot;-u ntp:ntp -p /var/run/ntpd.pid -g&quot;</span></span><br><span class="line">      SYNC_HWCLOCK=yes</span><br><span class="line"></span><br><span class="line">定时同步    )<span class="string">&#x27;crond&#x27;</span>(  ---&gt;$ sudo vim /etc/crontab</span><br><span class="line">编写定时任务如下：</span><br><span class="line">*/<span class="number">1</span> * * * * /usr/sbin/ntpdate hadoop02</span><br><span class="line">*/<span class="number">1</span> * * * * /usr/bin/echo <span class="string">&quot;文件&quot;</span> &gt;&gt; ~/<span class="string">&quot;目录&quot;</span></span><br></pre></td></tr></table></figure><h2 id="2-Hive组件搭建"><a href="#2-Hive组件搭建" class="headerlink" title="2. Hive组件搭建"></a>2. <a href="https://www.yuque.com/u25360462/nt1ri1/zamxgf"><strong>Hive组件搭建</strong></a></h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">关闭selinux  )<span class="string">&#x27;selinux&#x27;</span>(   ---&gt;$ sudo vim /etc/selinux/config</span><br><span class="line">修改为:</span><br><span class="line">      SELINUX=disabled</span><br><span class="line">      SELINUXTYPE=targeted</span><br><span class="line"></span><br><span class="line">my.cnf )<span class="string">&#x27;mysql&#x27;</span>(   ---&gt;$ sudo vim /etc/my.cnf</span><br><span class="line">没有my.cnf的文件内容添加: </span><br><span class="line">[<span class="meta">mysqld</span>]</span><br><span class="line">basedir=/opt/mysql/</span><br><span class="line">datadir=/opt/mysql/data/</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">character-<span class="keyword">set</span>-server=UTF8MB4</span><br><span class="line">有my.cnf的文件内容,则添加:<span class="string">&#x27;[mysqld]&#x27;</span>,注释<span class="string">&#x27;[mysqld_safe]&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="3-Maven—-gt-DataX组件搭建"><a href="#3-Maven—-gt-DataX组件搭建" class="headerlink" title="3. Maven—&gt;DataX组件搭建"></a>3. <a href="https://www.yuque.com/u25360462/nt1ri1/fhwgf3"><strong>Maven</strong></a>—&gt;DataX组件搭建</h2><h3 id="3-1-配置setting-xml"><a href="#3-1-配置setting-xml" class="headerlink" title="3.1 配置setting.xml"></a>3.1 配置<em>setting.xml</em></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置本地仓库地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/opt/maven/maven_repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span></span><br><span class="line">&lt;!-- 阿里云仓库 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span></span><br><span class="line">&lt;!-- <span class="title class_">Java</span>的<span class="variable constant_">JDK</span>版本 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">profile</span>&gt;</span>    </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.8<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="4-Azkaban-solo-server—-gt-工作流调度"><a href="#4-Azkaban-solo-server—-gt-工作流调度" class="headerlink" title="4. Azkaban-solo-server—&gt;工作流调度"></a>4. <a href="https://www.yuque.com/u25360462/nt1ri1/fwil15"><strong>Azkaban-solo-server</strong></a>—&gt;工作流调度</h2><h3 id="1-Gradle—-gt-Azkaban-solo-server"><a href="#1-Gradle—-gt-Azkaban-solo-server" class="headerlink" title="1. Gradle—&gt;Azkaban-solo-server"></a>1. <a href="https://www.yuque.com/u25360462/nt1ri1/fwil15"><strong>Gradle</strong></a>—&gt;Azkaban-solo-server</h3><h4 id="4-1-新创建文件并配置-init-gradle-配置在-opt-gradle-init-d"><a href="#4-1-新创建文件并配置-init-gradle-配置在-opt-gradle-init-d" class="headerlink" title="4.1 新创建文件并配置 init.gradle,配置在/opt/gradle/init.d"></a>4.1 新创建文件并配置 <font color=red>init.gradle</font>,配置在<code>/opt/gradle/init.d</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">all&lt;&gt;projects &#123;</span><br><span class="line">    rpositories </span><br><span class="line">      &gt;  maven &#123; url <span class="string">&#x27;file:///opt/maven/maven_repository&#x27;</span>&#125;</span><br><span class="line">        mavenLocal()</span><br><span class="line">        maven &#123; name <span class="string">&quot;Alibaba&quot;</span> ; url <span class="string">&quot;https://maven.aliyun.com/repository/public&quot;</span> &#125;</span><br><span class="line">        maven &#123; name <span class="string">&quot;Bstek&quot;</span> ; url <span class="string">&quot;http://nexus.bsdn.org/content/groups/public/&quot;</span> &#125;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildscript &#123; </span><br><span class="line">        repositories &#123; </span><br><span class="line">            maven &#123; name <span class="string">&quot;Alibaba&quot;</span> ; url <span class="string">&#x27;https://maven.aliyun.com/repository/public&#x27;</span> &#125;</span><br><span class="line">            maven &#123; name <span class="string">&quot;Bstek&quot;</span> ; url <span class="string">&#x27;http://nexus.bsdn.org/content/groups/public/&#x27;</span> &#125;</span><br><span class="line">            maven &#123; name <span class="string">&quot;M2&quot;</span> ; url <span class="string">&#x27;https://plugins.gradle.org/m2/&#x27;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-Azkaban-solo-server安装"><a href="#2-Azkaban-solo-server安装" class="headerlink" title="2. Azkaban-solo-server安装"></a>2. Azkaban-solo-server安装</h3><h4 id="4-2-拷贝对应gradle版本和修改gradle-wrapper-properties-中的-distributionUrl-属性，指明使用本地的-gradle-vim-opt-azkaban-gradle-wrapper-gradle-wrapper-properties"><a href="#4-2-拷贝对应gradle版本和修改gradle-wrapper-properties-中的-distributionUrl-属性，指明使用本地的-gradle-vim-opt-azkaban-gradle-wrapper-gradle-wrapper-properties" class="headerlink" title="4.2 拷贝对应gradle版本和修改gradle-wrapper.properties 中的 distributionUrl 属性，指明使用本地的 gradle---vim /opt/azkaban/gradle/wrapper/gradle-wrapper.properties"></a>4.2 拷贝对应<font color=green size=4>gradle</font>版本和修改<code>gradle-wrapper.properties</code> 中的 <code>distributionUrl</code> 属性，指明使用本地的 <code>gradle---vim /opt/azkaban/gradle/wrapper/gradle-wrapper.properties</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">distributionUrl=gradle-4.6-all.zip</span><br></pre></td></tr></table></figure><h4 id="4-3-修改时区，进入conf目录，修改azkaban-properties"><a href="#4-3-修改时区，进入conf目录，修改azkaban-properties" class="headerlink" title="4.3 修改时区，进入conf目录，修改azkaban.properties"></a>4.3 修改时区，进入conf目录，修改azkaban.properties</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default.timezone.id=Asia/Shanghai</span><br></pre></td></tr></table></figure><h2 id="5-Azkaban-two-server—-gt-工作流调度"><a href="#5-Azkaban-two-server—-gt-工作流调度" class="headerlink" title="5. Azkaban-two-server—&gt;工作流调度"></a>5. <a href="https://www.yuque.com/u25360462/nt1ri1/ba4s1h"><strong>Azkaban-two-server</strong></a>—&gt;工作流调度</h2><h3 id="5-1-web-服务器配置"><a href="#5-1-web-服务器配置" class="headerlink" title="5.1 web 服务器配置"></a>5.1 web 服务器配置</h3><h4 id="5-1-1-进入-azkaban-web-服务器安装目录的conf目录下，修改azkaban-properties"><a href="#5-1-1-进入-azkaban-web-服务器安装目录的conf目录下，修改azkaban-properties" class="headerlink" title="5.1.1 进入 azkaban web 服务器安装目录的conf目录下，修改azkaban.properties"></a>5.1.1 进入 <code>azkaban web</code> 服务器安装目录的<code>conf目录</code>下，修改<font color=red>azkaban.properties</font></h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Azkaban Personalization Settings</span></span><br><span class="line"><span class="string">azkaban.name=huser</span></span><br><span class="line"><span class="string">azkaban.label=huser-Azkaban</span></span><br><span class="line"><span class="string">azkaban.color=#FF3601</span></span><br><span class="line"><span class="string">azkaban.default.servlet.path=/index</span></span><br><span class="line"><span class="string">web.resource.dir=/opt/azkaban-two/web-server/web</span></span><br><span class="line"><span class="string">default.timezone.id=Asia/Shanghai</span></span><br><span class="line"><span class="comment"># Azkaban UserManager class</span></span><br><span class="line"><span class="string">user.manager.class=azkaban.user.XmlUserManager</span></span><br><span class="line"><span class="string">user.manager.xml.file=/opt/azkaban-two/web-server/conf/azkaban-users.xml</span></span><br><span class="line"><span class="comment"># Loader for projects</span></span><br><span class="line"><span class="string">executor.global.properties=/opt/azkaban-two/web-server/conf/global.properties</span></span><br><span class="line"><span class="string">azkaban.project.dir=projects</span></span><br><span class="line"><span class="comment"># Velocity dev mode</span></span><br><span class="line"><span class="string">velocity.dev.mode=false</span></span><br><span class="line"><span class="comment"># Azkaban Jetty server properties.</span></span><br><span class="line"><span class="string">jetty.ssl.port=8443</span></span><br><span class="line"><span class="string">jetty.port=8081</span></span><br><span class="line"><span class="string">jetty.keystore=/opt/azkaban-two/web-server/keystore</span></span><br><span class="line"><span class="string">jetty.password=123456</span></span><br><span class="line"><span class="string">jetty.keypassword=123456</span></span><br><span class="line"><span class="string">jetty.truststore=/opt/azkaban-two/web-server/keystore</span></span><br><span class="line"><span class="string">jetty.trustpassword=huser</span></span><br><span class="line"><span class="string">jetty.maxThreads=25</span></span><br><span class="line"><span class="comment"># Azkaban Executor settings</span></span><br><span class="line"><span class="string">executor.port=11241</span></span><br><span class="line"><span class="comment"># mail settings</span></span><br><span class="line"><span class="string">mail.sender=</span></span><br><span class="line"><span class="string">mail.host=</span></span><br><span class="line"><span class="comment"># User facing web server configurations used to construct the user facing server URLs. They are useful when there is a reverse proxy between Azkaban web servers and users.</span></span><br><span class="line"><span class="comment"># enduser -&gt; myazkabanhost:443 -&gt; proxy -&gt; localhost:8081</span></span><br><span class="line"><span class="comment"># when this parameters set then these parameters are used to generate email links.</span></span><br><span class="line"><span class="comment"># if these parameters are not set then jetty.hostname, and jetty.port(if ssl configured jetty.ssl.port) are used.</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_hostname=myazkabanhost.com</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_ssl_port=443</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_port=8081</span></span><br><span class="line"><span class="string">job.failure.email=</span></span><br><span class="line"><span class="string">job.success.email=</span></span><br><span class="line"><span class="string">lockdown.create.projects=false</span></span><br><span class="line"><span class="string">cache.directory=cache</span></span><br><span class="line"><span class="comment"># JMX stats</span></span><br><span class="line"><span class="string">jetty.connector.stats=true</span></span><br><span class="line"><span class="string">executor.connector.stats=true</span></span><br><span class="line"><span class="comment"># Azkaban plugin settings</span></span><br><span class="line"><span class="string">azkaban.jobtype.plugin.dir=/opt/azkaban-two/web-server/plugins/jobtypes</span></span><br><span class="line"><span class="comment"># Azkaban mysql settings by default. Users should configure their own username and password.</span></span><br><span class="line"><span class="string">database.type=mysql</span></span><br><span class="line"><span class="string">mysql.port=3306</span></span><br><span class="line"><span class="string">mysql.host=192.168.33.147</span></span><br><span class="line"><span class="string">mysql.database=azkaban_two</span></span><br><span class="line"><span class="string">mysql.user=root</span></span><br><span class="line"><span class="string">mysql.password=1</span></span><br><span class="line"><span class="string">mysql.numconnections=100</span></span><br><span class="line"><span class="comment">#Multiple Executor</span></span><br><span class="line"><span class="string">azkaban.use.multiple.executors=true</span></span><br><span class="line"><span class="string">azkaban.executorselector.filters=StaticRemainingFlowSize,CpuStatus</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.NumberOfAssignedFlowComparator=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.Memory=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.LastDispatched=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.CpuUsage=1</span></span><br></pre></td></tr></table></figure><h4 id="5-1-2-log4j-properties修改日志文件路径"><a href="#5-1-2-log4j-properties修改日志文件路径" class="headerlink" title="5.1.2  log4j.properties修改日志文件路径"></a>5.1.2  log4j.properties修改日志文件路径</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j.appender.server.File=/opt/azkaban-two/web-server/logs/azkaban-webserver.log</span><br></pre></td></tr></table></figure><h4 id="5-1-3-在azkaban-web-服务器安装目录的conf目录下，-按照如下配置修改-azkaban-users-xml文件，增加自定义管理员用户"><a href="#5-1-3-在azkaban-web-服务器安装目录的conf目录下，-按照如下配置修改-azkaban-users-xml文件，增加自定义管理员用户" class="headerlink" title="5.1.3 在azkaban web 服务器安装目录的conf目录下， 按照如下配置修改 azkaban-users.xml文件，增加自定义管理员用户"></a>5.1.3 在<code>azkaban web</code> 服务器安装目录的<code>conf目录</code>下， 按照如下配置修改 <code>azkaban-users.xml文件</code>，增加自定义管理员用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;azkaban-users&gt;</span><br><span class="line">  &lt;user <span class="built_in">groups</span>=<span class="string">&quot;azkaban&quot;</span> password=<span class="string">&quot;azkaban&quot;</span> roles=<span class="string">&quot;admin&quot;</span> username=<span class="string">&quot;azkaban&quot;</span>/&gt;</span><br><span class="line">  &lt;user <span class="built_in">groups</span>=<span class="string">&quot;azkaban&quot;</span> password=<span class="string">&quot;xiaokang&quot;</span> roles=<span class="string">&quot;admin&quot;</span> username=<span class="string">&quot;xiaokang&quot;</span>/&gt;</span><br><span class="line">  &lt;user password=<span class="string">&quot;metrics&quot;</span> roles=<span class="string">&quot;metrics&quot;</span> username=<span class="string">&quot;metrics&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;role name=<span class="string">&quot;admin&quot;</span> permissions=<span class="string">&quot;ADMIN&quot;</span>/&gt;</span><br><span class="line">  &lt;role name=<span class="string">&quot;metrics&quot;</span> permissions=<span class="string">&quot;METRICS&quot;</span>/&gt;</span><br><span class="line">&lt;/azkaban-users&gt;</span><br></pre></td></tr></table></figure><h3 id="2-Executor-服务器配置"><a href="#2-Executor-服务器配置" class="headerlink" title="2. Executor 服务器配置"></a>2. Executor 服务器配置</h3><h4 id="5-2-1-进入-azkaban-executor-服务器安装目录的conf目录下，修改azkaban-properties"><a href="#5-2-1-进入-azkaban-executor-服务器安装目录的conf目录下，修改azkaban-properties" class="headerlink" title="5.2.1 进入 azkaban executor 服务器安装目录的conf目录下，修改azkaban.properties"></a>5.2.1 进入 <code>azkaban executor</code> 服务器安装目录的<code>conf目录</code>下，修改<font color=red>azkaban.properties</font></h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Azkaban Personalization Settings</span></span><br><span class="line"><span class="literal">default</span>.timezone.id=Asia/Shanghai</span><br><span class="line"><span class="meta"># Azkaban UserManager class</span></span><br><span class="line"><span class="meta"># Loader for projects</span></span><br><span class="line">executor.<span class="keyword">global</span>.properties=/opt/azkaban-two/executor-server/conf/<span class="keyword">global</span>.properties</span><br><span class="line">azkaban.project.dir=projects</span><br><span class="line">azkaban.webserver.url=https:<span class="comment">//master:8443</span></span><br><span class="line"><span class="meta"># Azkaban plugin settings</span></span><br><span class="line">azkaban.jobtype.plugin.dir=/opt/azkaban-two/executor-server/plugins/jobtypes</span><br><span class="line"><span class="meta"># Azkaban mysql settings by default. Users should configure their own username and password.</span></span><br><span class="line">database.type=mysql</span><br><span class="line">mysql.port=<span class="number">3306</span></span><br><span class="line">mysql.host=<span class="number">192.168</span><span class="number">.33</span><span class="number">.147</span></span><br><span class="line">mysql.database=azkaban_two</span><br><span class="line">mysql.user=root</span><br><span class="line">mysql.password=<span class="number">1</span></span><br><span class="line">mysql.numconnections=<span class="number">100</span></span><br><span class="line"><span class="meta"># Azkaban Executor settings</span></span><br><span class="line">executor.maxThreads=<span class="number">50</span></span><br><span class="line">executor.flow.threads=<span class="number">30</span></span><br><span class="line">executor.port=<span class="number">11241</span></span><br></pre></td></tr></table></figure><h4 id="5-2-2-log4j-properties修改日志文件路径"><a href="#5-2-2-log4j-properties修改日志文件路径" class="headerlink" title="5.2.2 log4j.properties修改日志文件路径"></a>5.2.2 <font color=red>log4j.properties</font>修改日志文件路径</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j.appender.server.File=/opt/azkaban-two/executor-server/logs/azkaban-execserver.log</span><br></pre></td></tr></table></figure><h1 id="5-环境文件配置"><a href="#5-环境文件配置" class="headerlink" title="5. 环境文件配置"></a>5. 环境文件配置</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"><span class="comment"># HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br><span class="line"><span class="comment"># ZOOKEEPER_HOME</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br><span class="line"><span class="comment"># HIVE_HOME(HBASE_HOME)</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/hive</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HIVE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># HBASE_HOME</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/opt/hbase</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HBASE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># sqoop</span></span><br><span class="line"><span class="built_in">export</span> SQOOP_HOME=/opt/sqoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SQOOP_HOME</span>/bin</span><br><span class="line"><span class="comment"># shell </span></span><br><span class="line"><span class="built_in">export</span> SHELL_HOME=/opt/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SHELL_HOME</span></span><br><span class="line"><span class="comment"># maven</span></span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$MAVEN_HOME</span>/bin</span><br><span class="line"><span class="comment"># gradle</span></span><br><span class="line"><span class="built_in">export</span> GRADLE_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> GRADLE_USER_HOME=/opt/gradle</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GRADLE_HOME</span>/bin</span><br><span class="line"><span class="comment"># flume</span></span><br><span class="line"><span class="built_in">export</span> FLUME_HOME=/opt/flume</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$FLUME_HOME</span>/bin</span><br><span class="line"><span class="comment"># kafka</span></span><br><span class="line"><span class="built_in">export</span> KAFKA_HOME=/opt/kafka</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$KAFKA_HOME</span>/bin</span><br><span class="line"><span class="comment"># scala</span></span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=/opt/scala</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SCALA_HOME</span>/bin</span><br><span class="line"><span class="comment"># spark</span></span><br><span class="line"><span class="built_in">export</span> SPARK_HOME=/opt/spark</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SPARK_HOME</span>/bin</span><br><span class="line"><span class="comment"># flink</span></span><br><span class="line"><span class="built_in">export</span> FILNK_HOME=/opt/flink</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$FLINK_HOME</span>/bin</span><br></pre></td></tr></table></figure><h1 id="6-集群环境文件配置"><a href="#6-集群环境文件配置" class="headerlink" title="6. 集群环境文件配置"></a>6. 集群环境文件配置</h1><h2 id="1-配置hdfs"><a href="#1-配置hdfs" class="headerlink" title="1. 配置hdfs"></a>1. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo"><strong>hdfs</strong></a></h2><h3 id="1-1-配置hadoop-env-sh"><a href="#1-1-配置hadoop-env-sh" class="headerlink" title="1.1 配置hadoop-env.sh"></a>1.1 配置<font color=purple>hadoop-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure><h3 id="1-2-配置hadoop-yarn-sh"><a href="#1-2-配置hadoop-yarn-sh" class="headerlink" title="1.2 配置hadoop-yarn.sh"></a>1.2 配置<font color=purple>hadoop-yarn.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure><h3 id="1-3-配置core-site-xml"><a href="#1-3-配置core-site-xml" class="headerlink" title="1.3 配置core-site.xml"></a>1.3 配置<font color=purple>core-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">       &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">       <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">       <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="comment">&lt;!--用来指定hadoop运行时产生文件的存放目录--&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="comment">&lt;!--设置缓存大小，默认4kb--&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="comment">&lt;!--指定zookeeper的存放地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>ha.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-4-配置hdfs-site-xml"><a href="#1-4-配置hdfs-site-xml" class="headerlink" title="1.4 配置hdfs-site.xml"></a>1.4 配置<font color=purple>hdfs-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--数据块默认大小128M--&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.block.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--副本数量，不配置的话默认为3--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--namenode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/namenode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--datanode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/datanode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.max.transfer.threads<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- hacluster集群下有两个namenode，分别为nn1,nn2 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.namenodes.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>nn1,nn2,nn3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn1的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn2的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- nn3的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定namenode的元数据在JournalNode上存放的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.shared.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>qjournal://master:8485;slave1:8485;slave2:8485/hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.journalnode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/journalnode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- namenode操作日志的存放位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/edits<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启namenode故障转移自动切换 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.automatic-failover.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置失败自动切换实现方式 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.failover.proxy.provider.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置隔离机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.methods<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>sshfence<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 使用隔离机制需要SSH免密登录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/huser/.ssh/id_rsa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--hdfs文件操作权限,false为不验证--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-5-配置mapred-site-xml"><a href="#1-5-配置mapred-site-xml" class="headerlink" title="1.5 配置mapred-site.xml"></a>1.5 配置<font color=purple>mapred-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定mapreduce运行在yarn上--&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器web-UI地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--开启uber模式--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-6-配置yarn-site-xml"><a href="#1-6-配置yarn-site-xml" class="headerlink" title="1.6 配置yarn-site.xml"></a>1.6 配置<font color=purple>yarn-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;!-- 开启<span class="title class_">Yarn</span>高可用 --&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定Yarn集群在zookeeper上注册的节点名 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.cluster-id<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hayarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定两个ResourceManager的名称 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.rm-ids<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>rm1,rm2,rm3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm1 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm1的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm1 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm1 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm2 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm2的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm2 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm2 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm2 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm3 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm3的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm3 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm3 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm3 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置zookeeper的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.zk-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启Yarn恢复机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.recovery.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置执行ResourceManager恢复机制实现类 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.store.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定主resourcemanager的地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--NodeManager获取数据的方式--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 环境变量的继承 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--开启日志聚集功能--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 设置日志聚集服务器地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--配置日志保留7天--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--<span class="title class_">Spark</span>--&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定类的位置和文件配置位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-7-配置slaves"><a href="#1-7-配置slaves" class="headerlink" title="1.7  配置slaves"></a>1.7  配置<font color=purple>slaves</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h2 id="2-配置zookeeper-—-gt-zoo-sample-cfg-—-gt-zoo-cfg"><a href="#2-配置zookeeper-—-gt-zoo-sample-cfg-—-gt-zoo-cfg" class="headerlink" title="2. 配置zookeeper —&gt;zoo_sample.cfg —&gt; zoo.cfg"></a>2. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/wzn655"><strong>zookeeper</strong></a> —&gt;<code>zoo_sample.cfg</code> —&gt; <code>zoo.cfg</code></h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">修改为：</span><br><span class="line">      <span class="meta"># The number of milliseconds of each tick</span></span><br><span class="line">      tickTime=<span class="number">2000</span></span><br><span class="line">      <span class="meta"># The number of ticks that the initial </span></span><br><span class="line">      <span class="meta"># synchronization phase can take</span></span><br><span class="line">      initLimit=<span class="number">10</span></span><br><span class="line">      <span class="meta"># The number of ticks that can pass between </span></span><br><span class="line">      <span class="meta"># sending a request and getting an acknowledgement</span></span><br><span class="line">      syncLimit=<span class="number">5</span></span><br><span class="line">      <span class="meta"># the directory where the snapshot is stored.</span></span><br><span class="line">      <span class="meta"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line">      <span class="meta"># example sakes.</span></span><br><span class="line">      dataDir=/opt/zookeeper/data</span><br><span class="line">      <span class="meta"># the port at which the clients will connect</span></span><br><span class="line">      clientPort=<span class="number">2181</span></span><br><span class="line">添加：</span><br><span class="line">      dataLogDir=/opt/zookeeper/logs</span><br><span class="line">      server<span class="number">.1</span>=master:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">      server<span class="number">.2</span>=slave1:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">      server<span class="number">.3</span>=slave2:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#配置参数说明：</span></span><br><span class="line"><span class="meta">#    ·tickTime：用于计算的基础时间单元。比如 session 超时：N*tickTime；</span></span><br><span class="line"><span class="meta">#    ·initLimit：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；</span></span><br><span class="line"><span class="meta">#    ·syncLimit：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；</span></span><br><span class="line"><span class="meta">#    ·dataDir：数据存储位置；</span></span><br><span class="line"><span class="meta">#    ·dataLogDir：日志目录；</span></span><br><span class="line"><span class="meta">#    ·clientPort：用于客户端连接的端口，默认 2181</span></span><br></pre></td></tr></table></figure><h2 id="3-配置hive"><a href="#3-配置hive" class="headerlink" title="3. 配置hive"></a>3. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/zamxgf"><strong>hive</strong></a></h2><h3 id="3-1-配置hive-env-sh"><a href="#3-1-配置hive-env-sh" class="headerlink" title="3.1 配置hive-env.sh"></a>3.1 配置<font color=purple>hive-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> HIVE_CONF_DIR=/opt/hive/conf</span><br><span class="line"><span class="built_in">export</span> HIVE_AUX_JARS_PATH=/opt/hive/lib</span><br></pre></td></tr></table></figure><h3 id="3-2-配置hive-log4j-properties"><a href="#3-2-配置hive-log4j-properties" class="headerlink" title="3.2 配置hive-log4j.properties"></a>3.2 配置<font color=purple>hive-log4j.properties</font></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive.log.dir=/opt/hive/log</span><br></pre></td></tr></table></figure><h3 id="3-3-创建并配置hive-site-xml"><a href="#3-3-创建并配置hive-site-xml" class="headerlink" title="3.3 创建并配置hive-site.xml"></a>3.3 创建并配置<font color=purple>hive-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的URL --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://master:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的Driver--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- jdbc连接的username--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的password --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>&#x27;密码&#x27;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- Hive默认在HDFS的工作目录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- Hive 元数据存储版本的验证 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!--元数据存储授权--&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>datanucleus.schema.autoCreateAll<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="4-配置HBase"><a href="#4-配置HBase" class="headerlink" title="4. 配置HBase"></a>4. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/rncd28"><strong>HBase</strong></a></h2><h3 id="4-1-配置hbase-env-sh"><a href="#4-1-配置hbase-env-sh" class="headerlink" title="4.1 配置hbase-env.sh"></a>4.1 配置<font color=purple>hbase-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="comment">#表示不引用hbase自带的zookeeper，用我们自己安装的</span></span><br><span class="line"><span class="built_in">export</span> HBASE_MANAGES_ZK=<span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="4-2-配置hbase-site-xml"><a href="#4-2-配置hbase-site-xml" class="headerlink" title="4.2  配置hbase-site.xml"></a>4.2  配置<font color=purple>hbase-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!-- hbase 在 zookeeper 中的缓冲的节点目录  --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>zookeeper.znode.parent<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>//opt/hbase/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 指定 hbase 在 HDFS 上存储的路径 mycluster为hdfs的nameservice名称--&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://mycluster/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 指定 zk 的地址,多个用&quot;,&quot;分割 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master,slave1,slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="4-3-配置regionservers服务器列表"><a href="#4-3-配置regionservers服务器列表" class="headerlink" title="4.3  配置regionservers服务器列表"></a>4.3  配置<font color=purple>regionservers</font>服务器列表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h2 id="5-配置Kylin-麒麟"><a href="#5-配置Kylin-麒麟" class="headerlink" title="5. 配置Kylin(麒麟)"></a>5. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/agzot9"><strong>Kylin(麒麟</strong>)</a></h2><h3 id="5-1-配置conf目录下的kylin-properties"><a href="#5-1-配置conf目录下的kylin-properties" class="headerlink" title="5.1 配置conf目录下的kylin.properties"></a>5.1 配置<code>conf目录</code>下的<font color=red>kylin.properties</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改成东八区, 否则会出现时间显示不准的问题</span></span><br><span class="line">kylin.web.timezone=GMT+8</span><br></pre></td></tr></table></figure><h3 id="5-2-配置bin目录下的kylin-sh"><a href="#5-2-配置bin目录下的kylin-sh" class="headerlink" title="5.2 配置bin目录下的kylin.sh"></a>5.2 配置bin目录下的kylin.sh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ -z <span class="variable">$reload_dependency</span> &amp;&amp; `<span class="built_in">ls</span> -1 <span class="variable">$&#123;dir&#125;</span>/cached-* 2&gt;/dev/null | <span class="built_in">wc</span> -l` -eq 5 ]]</span><br><span class="line">   <span class="keyword">then</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;Using cached dependency...&quot;</span></span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hive-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hbase-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hadoop-conf-dir.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-kafka-dependency.sh</span><br><span class="line">       <span class="comment">#source $&#123;dir&#125;/cached-spark-dependency.sh</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hive-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hbase-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hadoop-conf-dir.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-kafka-dependency.sh</span><br><span class="line">       <span class="comment">#source $&#123;dir&#125;/find-spark-dependency.sh</span></span><br><span class="line">   <span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h2 id="6-配置Sqoop"><a href="#6-配置Sqoop" class="headerlink" title="6. 配置Sqoop"></a>6. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/hp4a5r"><strong>Sqoop</strong></a></h2><h3 id="6-1-配置sqoop-env-sh"><a href="#6-1-配置sqoop-env-sh" class="headerlink" title="6.1 配置sqoop-env.sh"></a>6.1 配置<font color=purple>sqoop-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拷贝 Sqoop 的环境配置模板</span></span><br><span class="line"><span class="built_in">cp</span> sqoop-env-template.cmd sqoop-env.sh</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="comment">#Set path to where bin/hadoop is available</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=/opt/hadoop</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set path to where hadoop-*-core.jar is available</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=/opt/hadoop</span><br><span class="line"></span><br><span class="line"><span class="comment">#set the path to where bin/hbase is available</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/opt/hbase</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set the path to where bin/hive is available</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/hive</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set the path for where zookeper config dir is</span></span><br><span class="line"><span class="built_in">export</span> ZOOCFGDIR=/opt/zookeeper/conf</span><br></pre></td></tr></table></figure><h2 id="7-配置Flume"><a href="#7-配置Flume" class="headerlink" title="7. 配置Flume"></a>7. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/ilmsg4"><strong>Flume</strong></a></h2><h3 id="7-1-配置flume-env-sh"><a href="#7-1-配置flume-env-sh" class="headerlink" title="7.1 配置flume-env.sh"></a>7.1 配置<font color=purple>flume-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure><h3 id="7-2-新建配置文件telnet-logger-properties"><a href="#7-2-新建配置文件telnet-logger-properties" class="headerlink" title="7.2  新建配置文件telnet-logger.properties"></a>7.2  新建配置文件<font color=red>telnet-logger.properties</font></h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#指定agent的sources、channels、sinks</span></span><br><span class="line">a1.sources = s1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sinks = k1</span><br><span class="line"></span><br><span class="line"><span class="meta">#配置source属性</span></span><br><span class="line">a1.sources.s1.type = netcat</span><br><span class="line">a1.sources.s1.bind = master</span><br><span class="line">a1.sources.s1.port = <span class="number">44444</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#配置channel类型</span></span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = <span class="number">10000</span></span><br><span class="line">a1.channels.c1.transactionCapacity = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#配置sink</span></span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line"><span class="meta">#将sources和channels绑定</span></span><br><span class="line">a1.sources.s1.channels = c1</span><br><span class="line"></span><br><span class="line"><span class="meta">#将sinks和channels绑定</span></span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><h2 id="8-配置kafka"><a href="#8-配置kafka" class="headerlink" title="8. 配置kafka"></a>8. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/ais8mvhduvvmrp1f"><strong>kafka</strong></a></h2><h3 id="8-1-配置server-properties"><a href="#8-1-配置server-properties" class="headerlink" title="8.1 配置server.properties"></a>8.1 配置<font color=red>server.properties</font></h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># broker的全局唯一标识号，不能重复. 给集群中的每个broker配置一个不同的id</span></span><br><span class="line">broker.id=<span class="number">0</span></span><br><span class="line"><span class="meta"># 分区数据的存储位置</span></span><br><span class="line">log.dirs=/opt/kafka/kafka-logs</span><br><span class="line"><span class="meta"># 连接Zookeeper集群地址</span></span><br><span class="line">zookeeper.connect=master:<span class="number">2181</span>,slave1:<span class="number">2181</span>,slave2:<span class="number">2181</span></span><br></pre></td></tr></table></figure><h2 id="9-配置Spark"><a href="#9-配置Spark" class="headerlink" title="9. 配置Spark"></a>9. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/pgd5fk7fsd12wlxt"><strong>Spark</strong></a></h2><h3 id="9-1-配置spark-env-sh"><a href="#9-1-配置spark-env-sh" class="headerlink" title="9.1 配置spark-env.sh"></a>9.1 配置<font color=purple>spark-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=/opt/scala</span><br><span class="line">YARN_CONF_DIR=/opt/hadoop/etc/hadoop</span><br><span class="line"><span class="built_in">export</span> SPARK_HISTORY_OPTS=<span class="string">&quot;-Dspark.history.ui.port=18080 -Dspark.history.retainedApplications=24 -Dspark.history.fs.logDirectory=hdfs://master:9000/spark-jobhistory&quot;</span></span><br><span class="line"><span class="built_in">export</span> SPARK_DAEMON_JAVA_OPTS=<span class="string">&quot;-Dspark.deploy.recoveryMode=ZOOKEEPER -Dspark.deploy.zookeeper.url=master:2181,slave1:2181,slave2:2181 -Dspark.deploy.zookeeper.dir=/opt/spark/data/&quot;</span></span><br></pre></td></tr></table></figure><h3 id="9-2-配置spark-defaults-conf"><a href="#9-2-配置spark-defaults-conf" class="headerlink" title="9.2 配置spark-defaults.conf"></a>9.2 配置<font color=purple>spark-defaults.conf</font></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># spark.master                    spark://master:7077</span></span><br><span class="line"><span class="string">spark.master</span>                     <span class="string">spark://master:7077,slave1:7077</span></span><br><span class="line"><span class="string">spark.eventLog.enabled</span>           <span class="literal">true</span></span><br><span class="line"><span class="string">spark.eventLog.dir</span>               <span class="string">hdfs://master:9000/spark-jobhistory</span></span><br><span class="line"><span class="string">spark.yarn.historyServer.address</span>               <span class="string">master:18080</span></span><br></pre></td></tr></table></figure><h3 id="9-3-配置workers"><a href="#9-3-配置workers" class="headerlink" title="9.3 配置workers"></a>9.3 配置<font color=purple>workers</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="9-4-配置hadoop的yarn-site-xml"><a href="#9-4-配置hadoop的yarn-site-xml" class="headerlink" title="9.4 配置hadoop的yarn-site.xml"></a>9.4 配置hadoop的<font color=purple>yarn-site.xml</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 由于测试环境的虚拟机内存太少, 防止将来任务被意外杀死, 做如下配置 --&gt;</span><br><span class="line">&lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是<span class="literal">true</span> --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是<span class="literal">true</span> --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.log.server.url&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;http://master:19888/jobhistory/logs&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h1 id="7-启动命令"><a href="#7-启动命令" class="headerlink" title="7. 启动命令"></a>7. 启动命令</h1><h2 id="1-启动zookeeper"><a href="#1-启动zookeeper" class="headerlink" title="1. 启动zookeeper"></a>1. 启动zookeeper</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(启动QuorumPeerMain节点) ---  zkServer.<span class="function">sh <span class="title">start</span></span></span><br><span class="line"><span class="function">(<span class="params">关闭QuorumPeerMain节点</span>) ---  zkServer.sh <span class="title">stop</span></span></span><br><span class="line"><span class="function">(<span class="params">查看zookeeper集群</span>) ---  zkServer.sh <span class="title">status</span></span></span><br><span class="line"><span class="function">(<span class="params">格式化zkfc</span>) ---  hdfs zkfc -formatZK</span></span><br></pre></td></tr></table></figure><h2 id="2-启动hdfs集群"><a href="#2-启动hdfs集群" class="headerlink" title="2. 启动hdfs集群"></a>2. 启动hdfs集群</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># journalnode</span></span><br><span class="line">(启动journalnode节点) ---  hadoop-daemon.<span class="function">sh start <span class="title">journalnode</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">(<span class="params">关闭journalnode节点</span>) ---  hadoop-daemon.sh stop journalnode</span></span><br><span class="line"><span class="function"># <span class="title">hdfs</span></span></span><br><span class="line"><span class="function">(<span class="params">格式化namenode</span>) ---  hdfs namenode -<span class="title">format</span></span></span><br><span class="line"><span class="function">(<span class="params">启动dfs服务</span>) ---  start-dfs.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">启动yarn服务</span>) ---  start-yarn.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">启动hdfs集群</span>) ---  start-all.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">关闭hdfs集群</span>) ---  stop-all.sh</span></span><br><span class="line"><span class="function"># <span class="title">namenode</span></span></span><br><span class="line"><span class="function">(<span class="params">启动namenode节点</span>) ---  hadoop-daemon.sh start <span class="title">namenode</span></span></span><br><span class="line"><span class="function">(<span class="params">关闭namenode节点</span>) ---  hadoop-daemon.sh stop namenode</span></span><br><span class="line"><span class="function">&lt;&#x27;查看NameNode的状态&#x27;&gt; ---$ hdfs haadmin -getServiceState nn1---&gt;   active</span></span><br><span class="line"><span class="function">&lt;&#x27;查看NameNode的状态&#x27;&gt; ---$ hdfs haadmin -getServiceState nn2---&gt;   standby</span></span><br><span class="line"><span class="function">&lt;&#x27;查看NameNode的状态&#x27;&gt; ---$ hdfs haadmin -getServiceState nn3---&gt;   standby</span></span><br><span class="line"><span class="function"># <span class="title">historyserver</span></span></span><br><span class="line"><span class="function">(<span class="params">启动任务历史服务器</span>) ---  mr-jobhistory-daemon.sh start historyserver</span></span><br><span class="line"><span class="function"># <span class="title">ResourceManager</span></span></span><br><span class="line"><span class="function">(<span class="params">启动ResourceManager节点</span>) --- yarn-daemon.sh start resourcemanager</span></span><br><span class="line"><span class="function">&lt;&#x27;查看ResourceManager的状态&#x27;&gt; ---$ yarn rmadmin -getServiceState rm1---&gt;   standby</span></span><br><span class="line"><span class="function">&lt;&#x27;查看ResourceManager的状态&#x27;&gt; ---$ yarn rmadmin -getServiceState rm2---&gt;   <span class="title">active</span></span></span><br><span class="line"><span class="function">(<span class="params">查看节点</span>) ---  jps</span></span><br></pre></td></tr></table></figure><h2 id="3-启动hive"><a href="#3-启动hive" class="headerlink" title="3. 启动hive"></a>3. 启动hive</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(格式化hive) ---  schematool -dbType mysql -initSchema</span><br><span class="line">(格式化hive) ---  schematool -initSchema -<span class="function">dbType <span class="title">derby</span></span></span><br><span class="line"><span class="function">(<span class="params">启动hive</span>) ---  <span class="title">hive</span></span></span><br><span class="line"><span class="function">(<span class="params">启动metastore</span>) ---  hive --service <span class="title">metastore</span></span></span><br><span class="line"><span class="function">(<span class="params">启动hiveserver2</span>) ---  hive  --service hiveserver2 </span></span><br></pre></td></tr></table></figure><h2 id="4-启动HBase"><a href="#4-启动HBase" class="headerlink" title="4. 启动HBase"></a>4. 启动HBase</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(启动HBase) ---  start-hbase.sh</span><br><span class="line">(关闭HBase) ---  stop-hbase.sh</span><br></pre></td></tr></table></figure><h2 id="5-启动Kylin"><a href="#5-启动Kylin" class="headerlink" title="5. 启动Kylin"></a>5. 启动Kylin</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(启动Kylin) ---  kylin.sh start</span><br><span class="line">(关闭Kylin) ---  kylin.sh stop</span><br></pre></td></tr></table></figure><h2 id="6-Sqoop命令"><a href="#6-Sqoop命令" class="headerlink" title="6. Sqoop命令"></a>6. Sqoop命令</h2><h4 id="6-1-1-查看所有命令"><a href="#6-1-1-查看所有命令" class="headerlink" title="6.1.1 查看所有命令"></a>6.1.1 查看所有命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">help</span></span><br></pre></td></tr></table></figure><h4 id="6-1-2-查看某条命令的具体使用方法"><a href="#6-1-2-查看某条命令的具体使用方法" class="headerlink" title="6.1.2 查看某条命令的具体使用方法"></a>6.1.2 查看某条命令的具体使用方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">help</span> 命令名</span><br><span class="line"><span class="comment">#例如sqoop help import</span></span><br></pre></td></tr></table></figure><h3 id="2-Sqoop-与-MySQL"><a href="#2-Sqoop-与-MySQL" class="headerlink" title="2. Sqoop 与 MySQL"></a>2. Sqoop 与 MySQL</h3><h4 id="6-2-1-查询MySQL所有数据库"><a href="#6-2-1-查询MySQL所有数据库" class="headerlink" title="6.2.1 查询MySQL所有数据库"></a>6.2.1 查询MySQL所有数据库</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-databases --connect jdbc:mysql://192.168.33.147:3306 --username root --password 123456</span><br></pre></td></tr></table></figure><h4 id="6-2-2-查询指定数据库种所有数据表"><a href="#6-2-2-查询指定数据库种所有数据表" class="headerlink" title="6.2.2 查询指定数据库种所有数据表"></a>6.2.2 查询指定数据库种所有数据表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-tables --connect jdbc:mysql://192.168.33.147:3306/familyaccount --username root --password 123456</span><br></pre></td></tr></table></figure><h3 id="3-Sqoop-与-HDFS"><a href="#3-Sqoop-与-HDFS" class="headerlink" title="3. Sqoop 与 HDFS"></a>3. Sqoop 与 HDFS</h3><h4 id="6-3-1-MySQL数据导入到HDFS"><a href="#6-3-1-MySQL数据导入到HDFS" class="headerlink" title="6.3.1 MySQL数据导入到HDFS"></a>6.3.1 MySQL数据导入到HDFS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword \</span><br><span class="line">--delete-target-dir \</span><br><span class="line">--target-dir /sqoop \</span><br><span class="line">--fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">-m 3</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--table help_keyword \    # 待导入的表</span></span><br><span class="line"><span class="string">--delete-target-dir \    # 目标目录存在则先删除</span></span><br><span class="line"><span class="string">--target-dir /sqoop \    # 导入的目标目录</span></span><br><span class="line"><span class="string">--fields-terminated-by &#x27;</span>\t<span class="string">&#x27; \    # 指定导出数据的分隔符</span></span><br><span class="line"><span class="string">-m 3    # 指定并行执行的 map tasks 数量  </span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="6-3-2-导入验证"><a href="#6-3-2-导入验证" class="headerlink" title="6.3.2 导入验证"></a>6.3.2 导入验证</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看导入后的目录</span></span><br><span class="line">hdfs dfs -<span class="built_in">ls</span> -R /sqoop</span><br><span class="line"><span class="comment"># 查看导入内容</span></span><br><span class="line">hdfs dfs -<span class="built_in">cat</span> /sqoop/part-m-00000</span><br></pre></td></tr></table></figure><h4 id="6-3-3-增量导入"><a href="#6-3-3-增量导入" class="headerlink" title="6.3.3 增量导入"></a>6.3.3 增量导入</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword \</span><br><span class="line">--target-dir /sqoop  \</span><br><span class="line">--append \</span><br><span class="line">--incremental  append  \             </span><br><span class="line">--fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">--check-column  help_keyword_id \</span><br><span class="line">--last-value 463  \ </span><br><span class="line">-m 1</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--fields-terminated-by &#x27;</span>\t<span class="string">&#x27; \    # 指定导出数据的分隔符</span></span><br><span class="line"><span class="string">--check-column  help_keyword_id \    # 指明用于增量导入的参考列</span></span><br><span class="line"><span class="string">--last-value 463  \    # 指定参考列上次导入的最大值 </span></span><br><span class="line"><span class="string">-m 1</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="6-3-4-hdfs数据导出到MySQL"><a href="#6-3-4-hdfs数据导出到MySQL" class="headerlink" title="6.3.4 hdfs数据导出到MySQL"></a>6.3.4 hdfs数据导出到MySQL</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE help_keyword_from_hdfs LIKE help_keyword;</span><br><span class="line">sqoop <span class="built_in">export</span> \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword_from_hdfs \</span><br><span class="line">--export-dir /sqoop/* \</span><br><span class="line">--input-fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">-m 3</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--table help_keyword_from_hdfs \     # 导出数据存储在 MySQL 的 help_keyword_from_hdf 的表中</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="7-DataX命令"><a href="#7-DataX命令" class="headerlink" title="7.  DataX命令"></a>7.  DataX命令</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">----------------DataX----------------</span><br><span class="line">(运行自检脚本) --- bin/datax.py job/job.json</span><br><span class="line">(运行Job) --- /opt/datax/bin/datax.py 目录/文件.json</span><br><span class="line">(MySQL数据导入到HDFS官方json配置模板)</span><br><span class="line">python /opt/datax/bin/datax.py -r mysqlreader -<span class="function">w <span class="title">hdfswriter</span></span></span><br><span class="line"><span class="function">(<span class="params">HDFS数据导出到MySQL官方json配置模板</span>)</span></span><br><span class="line"><span class="function">python /opt/datax/bin/datax.py -r hdfsreader -w mysqlwriter</span></span><br><span class="line"><span class="function">----------------Maven----------------</span></span><br><span class="line"><span class="function">(<span class="params">打包jar到本地仓库</span>)</span></span><br><span class="line"><span class="function">mvn install:install-file -Dfile</span>=/opt/bin/mysql-connector-java<span class="number">-5.1</span><span class="number">.37</span>.jar  -DgroupId=cool.huser -DartifactId=mysql-connector -Dversion=<span class="number">5.1</span><span class="number">.37</span> -Dpackaging=jar</span><br><span class="line">(编译打包) --- <span class="function">mvn clean <span class="title">install</span></span></span><br><span class="line"><span class="function">(<span class="params">执行安装脚本</span>) --- ./install.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">启动datax-admin和datax-executor服务</span>) --- ./start-all.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">WebUI查看</span>) --- tail -50f /opt/datax-web/modules/datax-admin/bin/console.<span class="keyword">out</span></span></span><br></pre></td></tr></table></figure><h2 id="8-Azkaban-solo-server命令"><a href="#8-Azkaban-solo-server命令" class="headerlink" title="8. Azkaban-solo-server命令"></a>8. Azkaban-solo-server命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">----------------<span class="title class_">Gradle</span>----------------</span><br><span class="line">(验证是否安装成功) --- [huser@master bin]$ ./gradle -v</span><br><span class="line">----------------<span class="title class_">Azkaban</span>----------------</span><br><span class="line">(执行编译) --- [huser@master azkaban]$ ./gradlew distTar</span><br><span class="line">(查看节点) --- jps</span><br><span class="line"># 注意：不能进入 bin 目录下执行，不然会抛出 <span class="title class_">Cannot</span> find <span class="string">&#x27;database.properties&#x27;</span> 异常</span><br><span class="line">(执行启动) --- [huser@master azkaban-solo-server]$ bin/start-solo.<span class="property">sh</span> </span><br></pre></td></tr></table></figure><h2 id="9-Azkaban-two-server命令"><a href="#9-Azkaban-two-server命令" class="headerlink" title="9. Azkaban-two-server命令"></a>9. Azkaban-two-server命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">----------------executor----------------</span><br><span class="line">(启动命令executor服务器) --- [huser@master bin]$ ./start-exec.<span class="property">sh</span></span><br><span class="line">(关闭命令executor服务器) --- [huser@master bin]$ ./shutdown-exec.<span class="property">sh</span></span><br><span class="line">(手动激活executor服务器) --- curl <span class="attr">http</span>:<span class="comment">//master:11241/executor?action=activate</span></span><br><span class="line">----------------web----------------</span><br><span class="line"># web服务器bin目录下执行启动命令</span><br><span class="line">(启动命令web服务器) --- [huser@master bin]$ ./start-web.<span class="property">sh</span></span><br><span class="line">(关闭命令web服务器) --- [huser@master bin]$ ./shutdown-web.<span class="property">sh</span></span><br></pre></td></tr></table></figure><h2 id="10-Flume命令"><a href="#10-Flume命令" class="headerlink" title="10. Flume命令"></a>10. Flume命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(验证是否安装成功) --- flume-ng version</span><br><span class="line">(启动命令<span class="title class_">Flume</span>) --- flume-ng agent -n a1 -c /opt/flume/conf/ -f conf/telnet-logger.<span class="property">properties</span> -<span class="title class_">Dflume</span>.<span class="property">root</span>.<span class="property">logger</span>=<span class="variable constant_">INFO</span>,<span class="variable language_">console</span></span><br></pre></td></tr></table></figure><h2 id="11-kafka命令"><a href="#11-kafka命令" class="headerlink" title="11. kafka命令"></a>11. kafka命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(启动kafka节点) ---  kafka-server-start.<span class="property">sh</span> /opt/kafka/config/server.<span class="property">properties</span></span><br><span class="line">(关闭kafka节点) ---  kafka-server-stop.<span class="property">sh</span> /opt/kafka/config/server.<span class="property">properties</span></span><br><span class="line">(创建测试主题) --- kafka-topics.<span class="property">sh</span> --create --topic kkjjssdd --bootstrap-server <span class="attr">master</span>:<span class="number">9092</span>,<span class="attr">slave1</span>:<span class="number">9092</span>,<span class="attr">slave2</span>:<span class="number">9092</span> --partitions <span class="number">2</span> --replication-factor <span class="number">1</span></span><br><span class="line">(查看创建列表) ---  kafka-topics.<span class="property">sh</span> --list --bootstrap-server <span class="attr">master</span>:<span class="number">9092</span>,<span class="attr">slave1</span>:<span class="number">9092</span>,<span class="attr">slave2</span>:<span class="number">9092</span></span><br></pre></td></tr></table></figure><h2 id="12-Spark命令"><a href="#12-Spark命令" class="headerlink" title="12. Spark命令"></a>12. Spark命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(启动spark集群) --- [huser@slave1 sbin]$ ./start-all.<span class="property">sh</span></span><br><span class="line">(关闭spark集群) ---  [huser@slave1 sbin]$ ./stop-all.<span class="property">sh</span></span><br><span class="line">(启动master节点) --- [huser@slave1 sbin]$ ./start-master.<span class="property">sh</span></span><br><span class="line">(关闭master节点) ---  [huser@slave1 sbin]$ ./stop-master.<span class="property">sh</span></span><br><span class="line">(启动任务历史服务器) --- [huser@slave1 sbin]$ ./start-history-server.<span class="property">sh</span></span><br><span class="line">(关闭任务历史服务器) ---  [huser@slave1 sbin]$ ./stop-history-server.<span class="property">sh</span></span><br><span class="line">(<span class="title class_">Web</span> <span class="variable constant_">UI</span>查看) --- cat /opt/spark/logs/spark-huser-org.<span class="property">apache</span>.<span class="property">spark</span>.<span class="property">deploy</span>.<span class="property">master</span>.<span class="property">Master</span>-<span class="number">1</span>-master.<span class="property">out</span> | grep <span class="title class_">MasterWebUI</span></span><br><span class="line">(计算 <span class="variable constant_">PI</span>) --- [huser@master spark]$ bin/spark-submit --master yarn --<span class="keyword">class</span> <span class="title class_">org</span>.<span class="property">apache</span>.<span class="property">spark</span>.<span class="property">examples</span>.<span class="property">SparkPi</span> /opt/spark/examples/jars/spark-examples_2<span class="number">.12</span>-<span class="number">3.1</span><span class="number">.3</span>.<span class="property">jar</span> <span class="number">1000</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;tip home&quot;&gt;&lt;p&gt;需要的安装包：&lt;/p&gt;
&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://www.centos.org/download/&quot;&gt;&lt;strong&gt;CentOS&lt;/strong&gt;&lt;/a&gt;镜像——&amp;gt;&lt;em&gt;CentO</summary>
      
    
    
    
    
    <category term="大数据应用" scheme="https://xin0203xin0203.github.io/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8/"/>
    
    <category term="HADOOP" scheme="https://xin0203xin0203.github.io/tags/HADOOP/"/>
    
    <category term="Linux" scheme="https://xin0203xin0203.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>js教程</title>
    <link href="https://xin0203xin0203.github.io/posts/5023fd11.html"/>
    <id>https://xin0203xin0203.github.io/posts/5023fd11.html</id>
    <published>2023-11-27T16:46:39.859Z</published>
    <updated>2023-12-14T15:37:32.632Z</updated>
    
    <content type="html"><![CDATA[<p>复习：</p><p>splice() 方法用于添加或删除数组中的元素。</p><p><strong>注意：</strong>这种方法会改变原始数组。</p><ol><li><strong>删除数组：</strong></li></ol><p>splice(起始位置， 删除的个数)</p><p>比如：1</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">1</span>) <span class="comment">// 删除green元素</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr) <span class="comment">// [&#x27;red, &#x27;blue&#x27;]</span></span><br></pre></td></tr></table></figure><ol><li><strong>添加元素</strong></li></ol><p>splice(起始位置，删除个数，添加数组元素)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line"><span class="comment">//arr.splice(1, 0, &#x27;pink&#x27;) // 在索引号是1的位置添加 pink</span></span><br><span class="line"><span class="comment">//console.log(arr) // [&#x27;red&#x27;, &#x27;pink&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;]</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;pink&#x27;</span>, <span class="string">&#x27;hotpink&#x27;</span>) <span class="comment">// 在索引号是1的位置添加 pink  hotpink</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr) <span class="comment">// [&#x27;red&#x27;, &#x27;pink&#x27;, &#x27;hotpink&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;]</span></span><br></pre></td></tr></table></figure><h1 id="Web-APIs-第1天笔记"><a href="#Web-APIs-第1天笔记" class="headerlink" title="Web APIs - 第1天笔记"></a>Web APIs - 第1天笔记</h1><blockquote><p>了解 DOM 的结构并掌握其基本的操作，体验 DOM 的在开发中的作用</p></blockquote><ul><li>知道 ECMAScript 与 JavaScript 的关系</li><li>了解 DOM 的相关概念及DOM 的本质是一个对象</li><li>掌握查找节点的基本方法</li><li>掌握节点属性和文本的操作</li><li>能够使用间歇函数创建定时任务</li></ul><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote><p>知道 ECMAScript 与 JavaScript 的关系，Web APIs 是浏览器扩展的功能。</p></blockquote><p>严格意义上讲，我们在 JavaScript 阶段学习的知识绝大部分属于 ECMAScript 的知识体系，ECMAScript 简称 ES 它提供了一套语言标准规范，如变量、数据类型、表达式、语句、函数等语法规则都是由 ECMAScript 规定的。浏览器将 ECMAScript 大部分的规范加以实现，并且在此基础上又扩展一些实用的功能，这些被扩展出来的内容我们称为 Web APIs。</p><p><img src="./assets/guide.png" alt="guide"></p><p>ECMAScript 运行在浏览器中然后再结合 Web APIs 才是真正的 JavaScript，Web APIs 的核心是 DOM 和 BOM。</p><p>扩展阅读：ECMAScript 规范在不断的更新中，存在多个不同的版本，早期的版本号采用数字顺序编号如 ECMAScript3、ECMAScript5，后来由于更新速度较快便采用年份做为版本号，如 ECMAScript2017、ECMAScript2018 这种格式，ECMAScript6 是 2015 年发布的，常叫做 EMCAScript2015。</p><p>关于 JavaScript 历史的<a href="https://javascript.ruanyifeng.com/introduction/history.html">扩展阅读</a>。</p><blockquote><p>知道 DOM 相关的概念，建立对 DOM 的初步认识，学习 DOM 的基本操作，体会 DOM 的作用</p></blockquote><p>DOM（Document Object Model）是将整个 HTML 文档的每一个标签元素视为一个对象，这个对象下包含了许多的属性和方法，通过操作这些属性或者调用这些方法实现对 HTML 的动态更新，为实现网页特效以及用户交互提供技术支撑。</p><p>简言之 DOM 是用来动态修改 HTML 的，其目的是开发网页特效及用户交互。</p><p>观察一个小例子：</p><p><img src="assets/demo.gif" alt="demo"></p><p>上述的例子中当用户分分别点击【开始】或【结束】按钮后，通过右侧调试窗口可以观察到 html 标签的内容在不断的发生改变，这便是通过 DOM 实现的。</p><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="DOM-树"><a href="#DOM-树" class="headerlink" title="DOM 树"></a>DOM 树</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  文本</span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>链接名<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如下图所示，将 HTML 文档以树状结构直观的表现出来，我们称之为文档树或 DOM 树，<strong>文档树直观的体现了标签与标签之间的关系。</strong></p><p><img src="./assets/web-api.jpg" alt="dom"></p><h4 id="DOM-节点"><a href="#DOM-节点" class="headerlink" title="DOM 节点"></a>DOM 节点</h4><p>节点是文档树的组成部分，<strong>每一个节点都是一个 DOM 对象</strong>，主要分为元素节点、属性节点、文本节点等。</p><ol><li>【元素节点】其实就是 HTML 标签，如上图中 <code>head</code>、<code>div</code>、<code>body</code> 等都属于元素节点。</li><li>【属性节点】是指 HTML 标签中的属性，如上图中 <code>a</code> 标签的 <code>href</code> 属性、<code>div</code> 标签的 <code>class</code> 属性。</li><li>【文本节点】是指 HTML 标签的文字内容，如 <code>title</code> 标签中的文字。</li><li>【根节点】特指 <code>html</code> 标签。</li><li>其它…</li></ol><h4 id="document"><a href="#document" class="headerlink" title="document"></a>document</h4><p><code>document</code> 是 JavaScript 内置的专门用于 DOM 的对象，该对象包含了若干的属性和方法，<code>document</code> 是学习 DOM 的核心。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// document 是内置的对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(typeof document);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 通过 document 获取根节点</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>); <span class="comment">// 对应 html 标签</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 2. 通过 document 节取 body 节点</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">body</span>); <span class="comment">// 对应 body 标签</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 3. 通过 document.write 方法向网页输出内容</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述列举了 <code>document</code> 对象的部分属性和方法，我们先对 <code>document</code> 有一个整体的认识。</p><h2 id="获取DOM对象"><a href="#获取DOM对象" class="headerlink" title="获取DOM对象"></a>获取DOM对象</h2><ol><li>querySelector   满足条件的第一个元素</li><li>querySelectorAll  满足条件的元素集合 返回伪数组</li><li>了解其他方式<ol><li>getElementById</li><li>getElementsByTagName</li></ol></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>DOM - 查找节点<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>查找元素类型节点<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>从整个 DOM 树中查找 DOM 节点是学习 DOM 的第一个步骤。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>)  <span class="comment">// 获取第一个p元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> lis = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;li&#x27;</span>)  <span class="comment">// 获取第一个p元素</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>总结：</p><ul><li>document.getElementById 专门获取元素类型节点，根据标签的 <code>id</code>  属性查找</li><li>任意 DOM 对象都包含 nodeType 属性，用来检检测节点类型</li></ul><h2 id="操作元素内容"><a href="#操作元素内容" class="headerlink" title="操作元素内容"></a>操作元素内容</h2><p>通过修改 DOM 的文本内容，动态改变网页的内容。</p><ol><li><code>innerText</code> 将文本内容添加/更新到任意标签位置，<strong>文本中包含的标签不会被解析。</strong></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// innerText 将文本内容添加/更新到任意标签位置</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> intro = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// intro.innerText = &#x27;嗨~ 我叫李雷！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// intro.innerText = &#x27;&lt;h4&gt;嗨~ 我叫李雷！&lt;/h4&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li><code>innerHTML</code> 将文本内容添加/更新到任意标签位置，<strong>文本中包含的标签会被解析。</strong></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// innerHTML 将文本内容添加/更新到任意标签位置</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> intro = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  intro.<span class="property">innerHTML</span> = <span class="string">&#x27;嗨~ 我叫韩梅梅！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  intro.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;h4&gt;嗨~ 我叫韩梅梅！&lt;/h4&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>总结：如果文本内容中包含 <code>html</code> 标签时推荐使用 <code>innerHTML</code>，否则建议使用 <code>innerText</code> 属性。</p><h2 id="操作元素属性"><a href="#操作元素属性" class="headerlink" title="操作元素属性"></a>操作元素属性</h2><p>有3种方式可以实现对属性的修改：</p><h4 id="常用属性修改"><a href="#常用属性修改" class="headerlink" title="常用属性修改"></a>常用属性修改</h4><ol><li>直接能过属性名修改，最简洁的语法</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 获取 img 对应的 DOM 元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> pic = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.pic&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 2. 修改属性</span></span></span><br><span class="line"><span class="language-javascript">  pic.<span class="property">src</span> = <span class="string">&#x27;./images/lion.webp&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  pic.<span class="property">width</span> = <span class="number">400</span>;</span></span><br><span class="line"><span class="language-javascript">  pic.<span class="property">alt</span> = <span class="string">&#x27;图片不见了...&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="控制样式属性"><a href="#控制样式属性" class="headerlink" title="控制样式属性"></a>控制样式属性</h4><ol><li>应用【修改样式】，通过修改行内样式 <code>style</code> 属性，实现对样式的动态修改。</li></ol><p>通过元素节点获得的 <code>style</code> 属性本身的数据类型也是对象，如 <code>box.style.color</code>、<code>box.style.width</code> 分别用来获取元素节点 CSS 样式的 <code>color</code> 和 <code>width</code> 的值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习 - 修改样式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>随便一些文本内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;300px&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// css 属性的 - 连接符与 JavaScript 的 减运算符</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 冲突，所以要改成驼峰法</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;pink&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>任何标签都有 <code>style</code> 属性，通过 <code>style</code> 属性可以动态更改网页标签的样式，如要遇到 <code>css</code> 属性中包含字符 <code>-</code> 时，要将 <code>-</code> 去掉并将其后面的字母改成大写，如 <code>background-color</code> 要写成 <code>box.style.backgroundColor</code></p><ol><li>操作类名(className) 操作CSS</li></ol><p>如果修改的样式比较多，直接通过style属性修改比较繁琐，我们可以通过借助于css类名的形式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习 - 修改样式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.pink</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: pink;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: hotpink;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>随便一些文本内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">className</span> = <span class="string">&#x27;pink&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>1.由于class是关键字, 所以使用className去代替</p><p>2.className是使用新值换旧值, 如果需要添加一个类,需要保留之前的类名</p></blockquote><ol><li>通过 classList 操作类控制CSS</li></ol><p>为了解决className 容易覆盖以前的类名，我们可以通过classList方式追加和删除类名</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: hotpink;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;one&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1.获取元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// let box = document.querySelector(&#x27;css选择器&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// add是个方法 添加  追加</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// box.classList.add(&#x27;active&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// remove() 移除 类</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// box.classList.remove(&#x27;one&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 切换类</span></span></span><br><span class="line"><span class="language-javascript">        box.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;one&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="操作表单元素属性"><a href="#操作表单元素属性" class="headerlink" title="操作表单元素属性"></a>操作表单元素属性</h4><p>表单很多情况，也需要修改属性，比如点击眼睛，可以看到密码，本质是把表单类型转换为文本框</p><p>正常的有属性有取值的跟其他的标签属性没有任何区别</p><p>获取:DOM对象.属性名</p><p>设置:DOM对象.属性名= 新值</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;请输入&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">disabled</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;agree&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1. 获取元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. 取值或者设置值  得到input里面的值可以用 value</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// console.log(input.value)</span></span></span><br><span class="line"><span class="language-javascript">        input.<span class="property">value</span> = <span class="string">&#x27;小米手机&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        input.<span class="property">type</span> = <span class="string">&#x27;password&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. 启用按钮</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// disabled 不可用   =  false  这样可以让按钮启用</span></span></span><br><span class="line"><span class="language-javascript">        btn.<span class="property">disabled</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3. 勾选复选框</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> checkbox = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.agree&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        checkbox.<span class="property">checked</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="自定义属性"><a href="#自定义属性" class="headerlink" title="自定义属性"></a>自定义属性</h4><p>标准属性: 标签天生自带的属性 比如class id title等, 可以直接使用点语法操作比如： disabled、checked、selected</p><p>自定义属性：</p><p>在html5中推出来了专门的data-自定义属性  </p><p>在标签上一律以data-开头</p><p>在DOM对象上一律以dataset对象方式获取</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span>&gt;</span> 自定义属性 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1. 获取元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. 获取自定义属性值</span></span></span><br><span class="line"><span class="language-javascript">         <span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">dataset</span>.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="间歇函数"><a href="#间歇函数" class="headerlink" title="间歇函数"></a>间歇函数</h2><blockquote><p>知道间歇函数的作用，利用间歇函数创建定时任务。</p></blockquote><p><code>setInterval</code> 是 JavaScript 中内置的函数，它的作用是间隔固定的时间自动重复执行另一个函数，也叫定时器函数。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 定义一个普通函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">repeat</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不知疲倦的执行下去....&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 2. 使用 setInterval 调用 repeat 函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 间隔 1000 毫秒，重复调用 repeat</span></span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setInterval</span>(repeat, <span class="number">1000</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="今日单词"><a href="#今日单词" class="headerlink" title="今日单词"></a>今日单词</h2><div class="table-container"><table><thead><tr><th>单词</th><th>说明</th><th>解释</th></tr></thead><tbody><tr><td>setInterval</td><td>定时器</td><td>setInterval(repeat, 1000)</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;复习：&lt;/p&gt;
&lt;p&gt;splice() 方法用于添加或删除数组中的元素。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;这种方法会改变原始数组。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;删除数组：&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;splice(起始位</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Photoshop</title>
    <link href="https://xin0203xin0203.github.io/posts/ec54ee2f.html"/>
    <id>https://xin0203xin0203.github.io/posts/ec54ee2f.html</id>
    <published>2023-10-29T13:30:32.012Z</published>
    <updated>2023-12-14T15:37:32.639Z</updated>
    
    <content type="html"><![CDATA[<p>前置准备：<br><a href="https://www.yuque.com/yuqueyonghub89qji/ctd2b5/int42sxavx9n5bmu?view=doc_embed">Photoshop安装教程</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/ctd2b5/soygm9tgu96z7qp0?view=doc_embed">基础篇</a></p><p>参考视频：<br><a href="https://player.bilibili.com/player.html?bvid=BV1YW411e7n5&amp;p=41&amp;page=41&amp;autoplay=0">点击查看【bilibili】</a></p><p>素材：<br><img src="https://cdn.nlark.com/yuque/0/2023/jpeg/33576317/1678793990491-1fd0285b-0e48-4d67-8e1d-9253f3a8e6a1.jpeg#averageHue=%23f5f5f5&amp;clientId=u5ec6d62c-f69a-4&amp;from=drop&amp;id=u565e3c34&amp;originHeight=523&amp;originWidth=1024&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=118800&amp;status=done&amp;style=none&amp;taskId=u45d9f87e-b893-4f4c-9c7d-a3d353ddc1a&amp;title=" alt="B005.jpg"></p><p>第一步：用钢笔工具抠图</p><ol><li>用<code>钢笔工具（P）</code>，把需要的部分选出一个区域，再点击<code>蒙版</code></li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678796532252-75e7e079-2b00-42cb-8174-8bf66b307680.png#averageHue=%23d9d9d9&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u7c071555&amp;originHeight=800&amp;originWidth=1448&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=347122&amp;status=done&amp;style=none&amp;taskId=u11cd86d3-68d0-4479-b35d-67475c61f9b&amp;title=" alt="1.png"><br>第二步：在蒙版内抠图</p><ol><li>用<code>钢笔工具（P）</code>，把需要的部分选出一个区域</li><li>设置<code>排除重叠形状</code></li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678797845859-fbe25c7e-1820-4ca4-b460-c14ccaff95f3.png#averageHue=%23868584&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u6bb86614&amp;originHeight=189&amp;originWidth=254&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=8625&amp;status=done&amp;style=none&amp;taskId=uc72bb46e-8e27-42a3-bfde-658bf44b215&amp;title=" alt="1.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678797478623-f4c55f6a-fa35-4eda-bd19-4cb5007c1897.png#averageHue=%23dadada&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u56ab52e6&amp;originHeight=596&amp;originWidth=1319&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=264106&amp;status=done&amp;style=none&amp;taskId=u96d095f3-7e2e-42c0-8b21-c5e3e3a822c&amp;title=" alt="1.png"><br>第三步：创建新的背景</p><ol><li>添加图层后，填充前景色，并选择颜色，按<code>Alt+delete</code>填充颜色</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678797943775-c226815f-9a31-457f-bb8c-9f84fa8e5607.png#averageHue=%23565656&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u0ee0aaac&amp;originHeight=575&amp;originWidth=255&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=19709&amp;status=done&amp;style=none&amp;taskId=u156c80f9-21da-4cbb-89e9-e0826b54b8b&amp;title=" alt="1.png"><br>第四步：用钢笔工具对局部地方进行竞精细的抠图</p><ol><li>注意：抠图的过程，点击<code>蒙版</code>在进行<code>钢笔工具</code>描边，描完点击<code>回车</code></li><li>如果抠图不满意，则用<code>选择工具（A）</code>对线条进行修改</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678798452992-a4311dab-0184-4bf5-bafc-ab682bcbd4fa.png#averageHue=%23777574&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=uf7ba6eb6&amp;originHeight=534&amp;originWidth=1041&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=235668&amp;status=done&amp;style=none&amp;taskId=uf8d08489-5bf3-4a67-9bdf-ff3edd82586&amp;title=" alt="1.png"><br>最终效果：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678798684612-9d557d97-cf23-4b38-8ddb-6139c5c7575d.png#averageHue=%2308c615&amp;clientId=u5ec6d62c-f69a-4&amp;from=drop&amp;id=ue29268ca&amp;originHeight=523&amp;originWidth=1024&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=184570&amp;status=done&amp;style=none&amp;taskId=u5f42e432-3518-402e-8556-72b41355f30&amp;title=" alt="B005.png"></p>]]></content>
    
    
    <summary type="html">文章描述</summary>
    
    
    
    
    <category term="6" scheme="https://xin0203xin0203.github.io/tags/6/"/>
    
  </entry>
  
  <entry>
    <title>6</title>
    <link href="https://xin0203xin0203.github.io/posts/1db87a14.html"/>
    <id>https://xin0203xin0203.github.io/posts/1db87a14.html</id>
    <published>2023-10-24T02:42:14.343Z</published>
    <updated>2023-10-24T02:44:44.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="夏至"><a href="#夏至" class="headerlink" title="夏至"></a>夏至</h1><blockquote><p>一生的时间很短<br>短到不过是两颗心之间的距离<br>一生的时间也很长<br>不如我们试着走走看</p></blockquote><div class="tip "><p>6</p></div>]]></content>
    
    
    <summary type="html">文章描述1212</summary>
    
    
    
    
    <category term="6" scheme="https://xin0203xin0203.github.io/tags/6/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://xin0203xin0203.github.io/posts/4a17b156.html"/>
    <id>https://xin0203xin0203.github.io/posts/4a17b156.html</id>
    <published>2023-09-24T08:59:15.680Z</published>
    <updated>2023-12-05T15:38:34.324Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
