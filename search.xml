<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>十四、Flink组件搭建之Scala环境搭建（一）</title>
      <link href="/posts/e7ef9c46.html"/>
      <url>/posts/e7ef9c46.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-shapes modern"><p>介绍：<br>Scala 是一门多范式（multi-paradigm）的编程语言，设计初衷是要集成面向对象编程和函数式编程的各种特性。<br>Scala 运行在 Java 虚拟机上，并兼容现有的 Java 程序。<br>Scala 源代码被编译成 Java 字节码，所以它可以运行于 JVM 之上，并可以调用现有的 Java 类库。</p></div><div class="tip bolt"><p>参考文件：</p></div><p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MDQzMzYyMg==&amp;mid=2247485228&amp;idx=1&amp;sn=a1924a0895d668ec77e9621cf1effa5e&amp;chksm=ebb9c195dcce4883e064380ee281c69c78c96b49bdcc075ee3fbd5c9930b83fd221bf5c50ccb&amp;scene=21#wechat_redirect">Scala环境搭建-视频教程</a></p><h1 id="一、Window-下搭建开发环境"><a href="#一、Window-下搭建开发环境" class="headerlink" title="一、Window 下搭建开发环境"></a>一、Window 下搭建开发环境</h1><h2 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1. 环境准备"></a>1. 环境准备</h2><p>准保JDK8安装成功，并成功配置环境变量：<code>JAVA_HOME</code>, <code>Path</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673011843389-4846b1c8-c4cb-4be7-b65c-10469055d563.png#averageHue=%23f3f2f1&amp;clientId=uba40e7b7-93dd-4&amp;from=drop&amp;height=646&amp;id=u4e02822a&amp;originHeight=658&amp;originWidth=619&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=38675&amp;status=done&amp;style=none&amp;taskId=u35bf3c0f-ce93-4895-9d8f-4fe1b96bef3&amp;title=&amp;width=608" alt="640.png"></p><h2 id="2-下载"><a href="#2-下载" class="headerlink" title="2. 下载"></a>2. 下载</h2><p><a href="https://scala-lang.org/download/2.13.6.html"><strong>Scala 2.13.6</strong></a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673016414858-05a93ae9-c025-4e90-87b5-440774854280.png#averageHue=%23fefefd&amp;clientId=uba40e7b7-93dd-4&amp;from=drop&amp;id=u601cab17&amp;originHeight=380&amp;originWidth=835&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=28497&amp;status=done&amp;style=none&amp;taskId=u164319eb-e29d-46fa-84eb-c413da3f9da&amp;title=" alt="a4f72964-ea59-49a0-900a-aacbc6874f89.png"></p><h2 id="3-解压"><a href="#3-解压" class="headerlink" title="3. 解压"></a>3. 解压</h2><p>解压到自己文件目录里，然后记住文件路径</p><h2 id="4-配置环境变量"><a href="#4-配置环境变量" class="headerlink" title="4. 配置环境变量"></a>4. 配置环境变量</h2><p>配置Scala 环境变量：<code>SCALA_HOME</code> 和 <code>Path</code><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673016561291-7edd584f-67b7-4f8b-8532-ef482bbcbd82.png#averageHue=%23f0efee&amp;clientId=uba40e7b7-93dd-4&amp;from=drop&amp;id=uf8ad1d69&amp;originHeight=666&amp;originWidth=644&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=35723&amp;status=done&amp;style=none&amp;taskId=u1a43a331-144b-4812-b0ea-64dc40ba3fc&amp;title=" alt="1.PNG"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673016565697-9609aadb-67c0-4cf9-95e6-a391bb240e63.png#averageHue=%23f3f2f0&amp;clientId=uba40e7b7-93dd-4&amp;from=drop&amp;height=677&amp;id=ud3448b0f&amp;originHeight=564&amp;originWidth=527&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=23818&amp;status=done&amp;style=none&amp;taskId=u21f88428-4131-4f12-9582-eaa70397d3e&amp;title=&amp;width=633" alt="2.PNG"></p><h2 id="5-验证安装是否成功"><a href="#5-验证安装是否成功" class="headerlink" title="5. 验证安装是否成功"></a>5. 验证安装是否成功</h2><p>按下键盘的Win+R后，输入cmd回车，输入Scala，如果能进入 <code>Scala</code> 交互环境，则代表安装成功：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673016633239-0f47e29d-223b-4f1b-bbb1-4f8cc114a582.png#averageHue=%231f1f1f&amp;clientId=uba40e7b7-93dd-4&amp;from=drop&amp;id=u2fffa6fb&amp;originHeight=512&amp;originWidth=979&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=11087&amp;status=done&amp;style=none&amp;taskId=uf6b631da-cb0e-4aae-8527-442bbcc6a24&amp;title=" alt="3.PNG"></p><h1 id="二、Linux-下搭建开发环境"><a href="#二、Linux-下搭建开发环境" class="headerlink" title="二、Linux 下搭建开发环境"></a>二、Linux 下搭建开发环境</h1><h2 id="1-JDK环境准备"><a href="#1-JDK环境准备" class="headerlink" title="1. JDK环境准备"></a>1. JDK环境准备</h2><p><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed&amp;inner=pYJji">一、集群环境搭建高可用版本配置</a></p><h2 id="2-下载解压并改名"><a href="#2-下载解压并改名" class="headerlink" title="2. 下载解压并改名"></a>2. 下载解压并改名</h2><p><strong><a href="https://scala-lang.org/download/2.13.6.html">Scala</a>压缩包——&gt;scala-2.13.6.tgz</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf scala-<span class="number">2.13</span><span class="number">.6</span>.tgz </span><br><span class="line">mv scala-<span class="number">2.13</span><span class="number">.6</span>.tgz scala</span><br></pre></td></tr></table></figure></p><h2 id="3-配置环境变量"><a href="#3-配置环境变量" class="headerlink" title="3. 配置环境变量"></a>3. 配置环境变量</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"># 添加以下内容</span><br><span class="line">export SCALA_HOME=/opt/scala</span><br><span class="line">export PATH=$PATH:$SCALA_HOME/bin</span><br></pre></td></tr></table></figure><h2 id="4-更新环境变量"><a href="#4-更新环境变量" class="headerlink" title="4. 更新环境变量"></a>4. 更新环境变量</h2><p>使得配置的环境变量立即生效：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></p><h2 id="5-验证安装是否成功-1"><a href="#5-验证安装是否成功-1" class="headerlink" title="5. 验证安装是否成功"></a>5. 验证安装是否成功</h2><p>输入<code>scala</code>，如果能进入 Scala 交互环境，则代表安装成功<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673018721033-ce50cbd6-bfe5-4629-8218-a71f7b76c292.png#averageHue=%23040302&amp;clientId=uba40e7b7-93dd-4&amp;from=drop&amp;height=184&amp;id=u3d69efc6&amp;originHeight=142&amp;originWidth=580&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=6318&amp;status=done&amp;style=none&amp;taskId=u204acc93-09a7-44da-b777-607ab3b0a53&amp;title=&amp;width=750" alt="捕获.PNG"></p><h1 id="三、Scala-的Hello-world-案例"><a href="#三、Scala-的Hello-world-案例" class="headerlink" title="三、Scala 的Hello world 案例"></a>三、Scala 的Hello world 案例</h1><h2 id="1-创建一个Maven工程"><a href="#1-创建一个Maven工程" class="headerlink" title="1. 创建一个Maven工程"></a>1. 创建一个Maven工程</h2><p>参考文件：<br><a href="https://www.yuque.com/yuqueyonghub89qji/whl8ua/yf1fllg7ivf7yv8h?view=doc_embed">1. 安装指南</a></p><h2 id="2-引入依赖"><a href="#2-引入依赖" class="headerlink" title="2. 引入依赖"></a>2. 引入依赖</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">flink.version</span>&gt;</span>1.13.0<span class="tag">&lt;/<span class="name">flink.version</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">target.java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target.java.version</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">scala.binary.version</span>&gt;</span>2.12<span class="tag">&lt;/<span class="name">scala.binary.version</span>&gt;</span></span></span><br><span class="line">&lt;/properties&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-scala_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-streaming-scala_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-clients_$&#123;scala.binary.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;flink.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>等待下载。。。</p><h2 id="3-创建项目的源文件目录"><a href="#3-创建项目的源文件目录" class="headerlink" title="3. 创建项目的源文件目录"></a>3. 创建项目的源文件目录</h2><p>在 <code>main</code> 下创建一个文件夹作为 <code>scala</code> 源文件的根目录, 比如目录名: <code>scala</code>, 然后标记为源文件根目录<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673021063073-07077ee0-2d43-430d-a92b-9374277fb831.png#averageHue=%232e3845&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;height=317&amp;id=u7707aaef&amp;originHeight=187&amp;originWidth=267&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=37568&amp;status=done&amp;style=none&amp;taskId=u646fb508-f4aa-483a-a73d-87cb501b44d&amp;title=&amp;width=452" alt="2.PNG"></p><h2 id="4-下载scala组件工具"><a href="#4-下载scala组件工具" class="headerlink" title="4. 下载scala组件工具"></a>4. 下载scala组件工具</h2><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673021159509-c8a99853-1cc3-4099-bdfd-01af3638d40a.png#averageHue=%23383c41&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;id=uc13fd20c&amp;originHeight=713&amp;originWidth=983&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=68470&amp;status=done&amp;style=none&amp;taskId=u42330566-902f-4c38-bd3e-5340c16d192&amp;title=" alt="1.PNG"></p><h2 id="5-引入scala组件工具"><a href="#5-引入scala组件工具" class="headerlink" title="5. 引入scala组件工具"></a>5. 引入scala组件工具</h2><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673021205156-8b1d9962-75c4-4bce-9ee1-f4776c920f07.png#averageHue=%233d444a&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;height=663&amp;id=uac9a82b4&amp;originHeight=714&amp;originWidth=515&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=202908&amp;status=done&amp;style=none&amp;taskId=u8ec6da13-d142-4ef1-8f72-e32d0bc6d27&amp;title=&amp;width=478" alt="1a4e41ef43002d13b72f0549a388e90.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673021246301-55cb56ce-b859-4550-a120-95ae118860b2.png#averageHue=%233c4043&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;height=472&amp;id=ud49d66c8&amp;originHeight=638&amp;originWidth=647&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=31065&amp;status=done&amp;style=none&amp;taskId=u7342fa3a-b7f5-422e-a79f-b5f2d17d668&amp;title=&amp;width=479" alt="3.PNG"></p><h2 id="4-创建Scala-的类"><a href="#4-创建Scala-的类" class="headerlink" title="4. 创建Scala 的类"></a>4. 创建Scala 的类</h2><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673021113873-f049a220-9fb7-4384-99bd-5bfc8d7f2642.png#averageHue=%23404853&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;height=263&amp;id=udd682feb&amp;originHeight=182&amp;originWidth=334&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=6098&amp;status=done&amp;style=none&amp;taskId=uf543e95b-2cb2-44bb-8f73-5513165470c&amp;title=&amp;width=483" alt="捕获.PNG"></p><h2 id="5-编写程序"><a href="#5-编写程序" class="headerlink" title="5. 编写程序"></a>5. 编写程序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">object HelloWorld &#123;</span><br><span class="line">  def <span class="title function_">main</span><span class="params">(args:Array[String])</span>:Unit = &#123;</span><br><span class="line">    println(<span class="string">&quot;Hello Scala&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-运行"><a href="#6-运行" class="headerlink" title="6. 运行"></a>6. 运行</h2><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673021039738-b7f90108-b0e4-4ee2-82a1-c29441689e02.png#averageHue=%232f3a49&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;height=214&amp;id=ub60b93f2&amp;originHeight=195&amp;originWidth=679&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=149050&amp;status=done&amp;style=none&amp;taskId=u5b2c1696-edeb-4dcd-906b-3705d5a69c1&amp;title=&amp;width=746" alt="捕获.PNG"></p><h1 id="拓展统计单词计算"><a href="#拓展统计单词计算" class="headerlink" title="拓展统计单词计算"></a>拓展统计单词计算</h1><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673024696331-315de340-84e1-4214-ae34-abbc1d8179d8.png#averageHue=%23353f4b&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;id=uf9d1fe06&amp;originHeight=350&amp;originWidth=243&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=89792&amp;status=done&amp;style=none&amp;taskId=u1f79d7a4-ae70-438e-aac6-bda8020210a&amp;title=" alt="捕获.PNG"></p><h2 id="1-准备数据"><a href="#1-准备数据" class="headerlink" title="1. 准备数据"></a>1. 准备数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hello python</span><br><span class="line">hello scala</span><br><span class="line">hello java</span><br><span class="line">hello hadoop</span><br><span class="line">hello word</span><br><span class="line">hello spark</span><br></pre></td></tr></table></figure><h2 id="2-编写程序"><a href="#2-编写程序" class="headerlink" title="2. 编写程序"></a>2. 编写程序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.com</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.scala.&#123;ExecutionEnvironment, createTypeInformation&#125;</span><br><span class="line"></span><br><span class="line">object BatchWordCount &#123;</span><br><span class="line">  def <span class="title function_">main</span><span class="params">(args: Array[String])</span>: Unit = &#123;</span><br><span class="line">    <span class="comment">// 1. 创建一个执行环境</span></span><br><span class="line">    <span class="type">val</span> <span class="variable">env</span> <span class="operator">=</span> ExecutionEnvironment.getExecutionEnvironment</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// 2. 读取文本文件数据</span></span><br><span class="line">    <span class="type">val</span> <span class="variable">lineDataSet</span> <span class="operator">=</span> env.readTextFile(<span class="string">&quot;input/test.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 对数据集中进行转换处理</span></span><br><span class="line">    <span class="type">val</span> <span class="variable">wordAndOne</span> <span class="operator">=</span> lineDataSet.flatMap(_.split(<span class="string">&quot; &quot;</span>)).map(word=&gt;(word, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 按照单词进行分组</span></span><br><span class="line">    <span class="type">val</span> <span class="variable">wordAndOneGroup</span> <span class="operator">=</span> wordAndOne.groupBy(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. 对分组数据进行sum聚合统计</span></span><br><span class="line">    <span class="type">val</span> <span class="variable">sum</span> <span class="operator">=</span> wordAndOneGroup.sum(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. 打印</span></span><br><span class="line">    sum.print()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="报错提醒"><a href="#报错提醒" class="headerlink" title="报错提醒"></a>报错提醒</h2><h3 id="报错原因：由于scala的版本不对"><a href="#报错原因：由于scala的版本不对" class="headerlink" title="报错原因：由于scala的版本不对"></a><strong>报错原因：</strong>由于scala的版本不对</h3><p><code>Error:scalac: Error: scala.collection.mutable.Set$.apply(Lscala/collection/Seq；)</code><br>解决方案：<br><a href="https://blog.csdn.net/Miraitowa_Neo/article/details/123232229">Error:scalac: Error: scala.collection.mutable.Set$.apply(Lscala/collection/Seq；)_编不出代码的女程序员的博客-CSDN博客_lscala/collection/seq</a></p><h3 id="报错原因：java与scala的版本冲突导致"><a href="#报错原因：java与scala的版本冲突导致" class="headerlink" title="**报错原因：java与scala的版本冲突导致"></a>**报错原因：java与<a href="https://so.csdn.net/so/search?q=scala&amp;spm=1001.2101.3001.7020">scala</a>的版本冲突导致</h3><p>解决方案：<br><a href="https://blog.csdn.net/miaohui8023/article/details/105327734">Error:scalac: error while loading package, Scala signature package has wrong version_miaohui8023的博客-CSDN博客</a></p><h2 id="3-运行结果"><a href="#3-运行结果" class="headerlink" title="3. 运行结果"></a>3. 运行结果</h2><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1673024619752-3ba0946b-3931-44f5-ab63-a51384fca7ae.png#averageHue=%232f3d4d&amp;clientId=u530254e3-1a9c-4&amp;from=drop&amp;id=u565ec8cd&amp;originHeight=267&amp;originWidth=821&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=281691&amp;status=done&amp;style=none&amp;taskId=u454a3ad7-588a-4512-9570-9e831f3a317&amp;title=" alt="捕获.PNG"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0.html"/>
      <url>/posts/0.html</url>
      
        <content type="html"><![CDATA[<p>前置准备：<br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed">一、集群环境搭建高可用版本配置</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/ifi3zw34ztgm4bqt?view=doc_embed">（一）Scala环境搭建</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/fbyk58l02whdr677?view=doc_embed">(二) Flink集群环境搭建(Local模式)</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/dxmlft2waa775lkm?view=doc_embed">(三) Flink集群环境搭建(Standalone模式)</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/lne7tfikcbvkww26?view=doc_embed">(四) HA-Flink集群环境搭建(Standalone模式)</a><br>需要的安装包：<a href="https://archive.apache.org/dist/flink/">flink</a>压缩包——&gt;flink-1.13.0-bin-scala_2.12.tgz</p><h1 id="HA-Yarn模式"><a href="#HA-Yarn模式" class="headerlink" title="HA-Yarn模式"></a>HA-Yarn模式</h1><h3 id="1-1-修改集群配置"><a href="#1-1-修改集群配置" class="headerlink" title="1.1 修改集群配置"></a>1.1 修改集群配置</h3><h4 id="1-1-1-vim-HADOOP-HOME-etc-hadoop-yarn-site-xml"><a href="#1-1-1-vim-HADOOP-HOME-etc-hadoop-yarn-site-xml" class="headerlink" title="1.1.1 vim $HADOOP_HOME/etc/hadoop/yarn-site.xml"></a>1.1.1 vim $HADOOP_HOME/etc/hadoop/yarn-site.xml</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--关闭yarn的内存检查--&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.am.max-attempts&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="number">4</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h4 id="1-1-2-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件"><a href="#1-1-2-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件" class="headerlink" title="1.1.2 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件"></a>1.1.2 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#配置Flink的主节点</span><br><span class="line">jobmanager.rpc.address: master</span><br><span class="line"># 配置使用zookeeper来开启高可用模式</span><br><span class="line">high-availability: zookeeper</span><br><span class="line"># 配置zookeeper的地址，采用zookeeper集群时，可以使用逗号来分隔多个节点地址</span><br><span class="line">high-availability.zookeeper.quorum: master:<span class="number">2181</span>,slave1:<span class="number">2181</span>,slave2:<span class="number">2181</span></span><br><span class="line"># 在zookeeper上存储flink集群元信息的路径</span><br><span class="line">high-availability.zookeeper.path.root: /ha-flink</span><br><span class="line"># 持久化存储JobManager元数据的地址，zookeeper上存储的只是指向该元数据的指针信息</span><br><span class="line">high-availability.storageDir: hdfs:<span class="comment">//hacluster:8020/flink/recovery</span></span><br><span class="line">#（hacluster与HAHadoop中的core-site.xml里的hadoop集群在zookeeper上注册的节点名一致）</span><br><span class="line"># 将已完成的作业上传到此目录中，让任务历史服务器进行监控</span><br><span class="line">jobmanager.archive.fs.dir: hdfs:<span class="comment">//hacluster:8020/flink-jobhistory</span></span><br><span class="line">historyserver.web.address: master</span><br><span class="line">historyserver.web.port: <span class="number">18082</span></span><br><span class="line"># 任务历史服务器监控目录中已存档的作业</span><br><span class="line">historyserver.archive.fs.dir: hdfs:<span class="comment">//hacluster:8020/flink-jobhistory</span></span><br><span class="line">historyserver.web.refresh-interval: <span class="number">10000</span></span><br><span class="line">#比StandAlone模式多了</span><br><span class="line">yarn.application-attempts: <span class="number">10</span></span><br></pre></td></tr></table></figure><p>除了上面的配置之外，Flink 还可以使用以下可选参数来优化集群性能：</p><ul><li><strong>jobmanager.heap.size</strong>：JobManager 的 JVM 堆内存大小，默认为 1024m 。</li><li><strong>taskmanager.heap.size</strong>：Taskmanager 的 JVM 堆内存大小，默认为 1024m 。</li><li><strong>taskmanager.numberOfTaskSlots</strong>：Taskmanager 上 slots 的数量，通常设置为 CPU 核心的数量，或其一半。</li><li><strong>parallelism.default</strong>：任务默认的并行度。</li><li><strong>io.tmp.dirs</strong>：存储临时文件的路径，如果没有配置，则默认采用服务器的临时目录，如 LInux 的 /tmp 目录。<h4 id="1-1-3-修改-masters-文件，指定JobManager节点"><a href="#1-1-3-修改-masters-文件，指定JobManager节点" class="headerlink" title="1.1.3 修改 masters 文件，指定JobManager节点"></a>1.1.3 修改 masters 文件，指定JobManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">master:<span class="number">8081</span></span><br><span class="line">slave1:<span class="number">8081</span></span><br></pre></td></tr></table></figure><h4 id="1-1-4-修改-slaves（workers）-文件，添加TaskManager节点"><a href="#1-1-4-修改-slaves（workers）-文件，添加TaskManager节点" class="headerlink" title="1.1.4 修改 slaves（workers） 文件，添加TaskManager节点"></a>1.1.4 修改 slaves（workers） 文件，添加TaskManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="1-2-导入Flink依赖flink-shaded-hadoop包到Flink-lib中去（各个节点Flink的lib）"><a href="#1-2-导入Flink依赖flink-shaded-hadoop包到Flink-lib中去（各个节点Flink的lib）" class="headerlink" title="1.2 导入Flink依赖flink-shaded-hadoop包到Flink/lib中去（各个节点Flink的lib）"></a>1.2 导入Flink依赖<strong>flink-shaded-hadoop</strong>包到Flink/lib中去（各个节点Flink的lib）</h3><strong>将文件下载本地，再将文件的后缀篡改为jar，在上传群集文件当中（.txt—&gt;.jar）</strong><br><a href="https://www.yuque.com/attachments/yuque/0/2023/txt/33576317/1676461700287-df65f88c-00ec-4a79-9a33-83f71af0a1d4.txt">flink-shaded-hadoop-2-uber-2.8.3-10.0.txt</a><h3 id="1-3-分发Flink给其他节点"><a href="#1-3-分发Flink给其他节点" class="headerlink" title="1.3 分发Flink给其他节点"></a>1.3 分发Flink给其他节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r $FLINK_HOME/ slave1:/opt/</span><br><span class="line">scp -r $FLINK_HOME/ slave2:/opt/</span><br></pre></td></tr></table></figure><h3 id="1-4-在HDFS上创建HIstory目录"><a href="#1-4-在HDFS上创建HIstory目录" class="headerlink" title="1.4 在HDFS上创建HIstory目录"></a>1.4 在<strong>HDFS</strong>上<strong>创建</strong>HIstory目录</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir /flink</span><br><span class="line">hdfs dfs -mkdir /flink/recovery</span><br><span class="line">hdfs dfs -mkdir /flink-jobhistory</span><br><span class="line">hdfs dfs -chmod <span class="number">777</span> /flink-jobhistory</span><br></pre></td></tr></table></figure><h3 id="1-5-启动"><a href="#1-5-启动" class="headerlink" title="1.5 启动"></a>1.5 启动</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 启动HAHadoop集群</span><br><span class="line">[huser@master ~]$ ./opt/bin/start-dfs.sh--&gt;  <span class="string">&#x27;脚本启动&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="1-6-启动Flink集群和任务历史服务器"><a href="#1-6-启动Flink集群和任务历史服务器" class="headerlink" title="1.6 启动Flink集群和任务历史服务器"></a>1.6 启动Flink集群和任务历史服务器</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[huser@master ~]$ start-cluster.sh</span><br><span class="line">[huser@master ~]$ historyserver.sh start</span><br><span class="line"><span class="meta">#jps</span></span><br><span class="line">#主节点多出:</span><br><span class="line"><span class="number">3835</span> StandaloneSessionClusterEntrypoint</span><br><span class="line"><span class="number">4148</span> TaskManagerRunner</span><br><span class="line">#其他节点多出：</span><br><span class="line"><span class="number">3437</span> TaskManagerRunner</span><br></pre></td></tr></table></figure><h3 id="1-7-查看web端"><a href="#1-7-查看web端" class="headerlink" title="1.7 查看web端"></a>1.7 查看web端</h3>两个 JobManager 和 任务历史服务器的端口号分别为 8081 、8081和 18082，界面应该如下：<br>访问 <a href="http://192.168.33.151:8081">http://192.168.33.151:8081</a>或<a href="http://192.168.33.150:8081">http://192.168.33.150:8081</a>,<a href="http://192.168.33.150:18082">http://192.168.33.150:18082</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676462763256-60f6f434-cf8b-4065-8e83-f49cfad24db3.png#averageHue=%23fbfbfa&amp;clientId=uec47b960-6911-4&amp;from=ui&amp;id=ucb39e37d&amp;originHeight=853&amp;originWidth=1808&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=62330&amp;status=done&amp;style=none&amp;taskId=ua48356e6-5943-428f-a62c-3717ed19ef3&amp;title=" alt="Snipaste_2023-02-15_20-05-43.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676462802475-5f2887ba-1976-4ad7-8d4a-6e21a1f57011.png#averageHue=%23fbfafa&amp;clientId=uec47b960-6911-4&amp;from=ui&amp;id=udae1af25&amp;originHeight=911&amp;originWidth=1822&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=61825&amp;status=done&amp;style=none&amp;taskId=u2de4e3f7-1d47-4151-8e66-8a17e380ea6&amp;title=" alt="Snipaste_2023-02-15_20-05-43.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676462828392-4bbb4a02-c0bb-4afb-814e-57172f10371c.png#averageHue=%23fbfbfb&amp;clientId=uec47b960-6911-4&amp;from=ui&amp;id=u79f7325e&amp;originHeight=842&amp;originWidth=1822&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=57209&amp;status=done&amp;style=none&amp;taskId=u75a6e051-3847-4852-9169-4dcc78f3044&amp;title=" alt="Snipaste_2023-02-15_20-05-43.png"><h3 id="1-8-HA测试"><a href="#1-8-HA测试" class="headerlink" title="1.8 HA测试"></a>1.8 HA测试</h3>注意：在测试的时候，内存先调大，推荐3G内存执行任务；另外，就是网页端无法进去的情况，修改系统文件中System32/drivers/etc/hosts，调整网络IP和虚拟机的用户名是否对准，或者有没有重复的。<br><strong>流计算词频统计案例源码：</strong><br><strong>将文件下载本地，再将文件的后缀篡改为jar，在上传群集文件当中（.txt—&gt;.jar）</strong><br><a href="https://www.yuque.com/attachments/yuque/0/2023/txt/33576317/1676461700284-5c77fac5-f291-43f5-85b2-d06bd0185868.txt">flink_scala-1.0-SNAPSHOT.txt</a><br>提交作业：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">1.</span>虚拟机内开启端口</span><br><span class="line">[huser@master ~]$ nc -lk <span class="number">5555</span></span><br><span class="line"># <span class="number">2.</span>运行Flink的Jar包</span><br><span class="line">flink run -m yarn-cluster -ys <span class="number">1</span> -c cs -d flink_scala<span class="number">-1.0</span>-SNAPSHOT.jar master <span class="number">5555</span></span><br><span class="line"></span><br><span class="line">注意：这个时候我们使用flink run的时候，它会默认找这个文件，然后根据这个文件找到刚才我们创建的那个永久的Flink集群，这个文件里面保存的就是刚才启动的那个Flink集群在YARN中对应的applicationid</span><br><span class="line"></span><br><span class="line">#两个master节点随便一个会多出Yarnjob服务</span><br><span class="line"><span class="number">26696</span> YarnJobClusterEntrypoint</span><br><span class="line">#进去<span class="number">8088</span>网页会发现有新的任务</span><br><span class="line">#进度条后面有一个ApplocationMaster点击</span><br><span class="line">#然后就会进入了Flink的Job页面</span><br><span class="line"></span><br><span class="line">#找出哪个master节点有YarnJobClusterEntrypoint服务然后Kill掉一个</span><br><span class="line">kill <span class="number">-9</span> YarnJobClusterEntrypoint服务端口</span><br><span class="line">#重新进入刚刚的FlinkWeb页端</span><br><span class="line">会跳回<span class="number">8088</span>端口</span><br><span class="line">#然后查看另一个master </span><br><span class="line">jps</span><br><span class="line">#是否出现</span><br><span class="line">YarnJobClusterEntrypoint服务</span><br><span class="line">#然后再点击进度条后面的ApplocationMaster就可以重新进入Flink另一个master的JOb端</span><br></pre></td></tr></table></figure>访问端口<a href="http://192.168.33.152:8088(例">http://192.168.33.152:8088(例</a>)<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676469906270-ced64677-e0ae-4bc9-a594-cc443c23c7a0.png#averageHue=%23ddba7c&amp;clientId=u81e4375d-ee9d-4&amp;from=ui&amp;id=udd521d76&amp;originHeight=1000&amp;originWidth=1802&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=164598&amp;status=done&amp;style=none&amp;taskId=u6708cd0e-3383-4b18-8d9f-2c70fe6fb59&amp;title=" alt="Snipaste_2023-02-15_22-03-23.png"><br>往下操作<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676469938570-518c852e-5b6f-495a-ade0-79800a9cc9c8.png#averageHue=%23faf9f9&amp;clientId=u81e4375d-ee9d-4&amp;from=ui&amp;id=u9536f47d&amp;originHeight=1002&amp;originWidth=1824&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=62352&amp;status=done&amp;style=none&amp;taskId=u694d9db8-2423-49cd-accc-89cbf4e3a7b&amp;title=" alt="Snipaste_2023-02-15_22-03-42.png"><br>运行过程中将正在服务的JobManager给kill掉，测试是否高可用<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill <span class="number">-9</span> YarnJobClusterEntrypoint服务端口</span><br></pre></td></tr></table></figure>此时hadoop01的8081无法访问，hadoop02会进行接管（重新提交刚才被中断的作业），这个过程需要稍等一会儿<br>再次输入数据后可以从结果看出是一个新作业：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676469951148-7e863fc8-edda-47a5-9d45-7cfbe4cda616.png#averageHue=%231b1917&amp;clientId=u81e4375d-ee9d-4&amp;from=ui&amp;id=u6550542b&amp;originHeight=860&amp;originWidth=1147&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=105446&amp;status=done&amp;style=none&amp;taskId=ud7aa2ebb-2161-4e7e-9a55-892ff2c7619&amp;title=" alt="Snipaste_2023-02-15_22-04-27.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676469959235-bce2fe1d-a20d-4934-8edb-e133093befb3.png#averageHue=%23fbfbfa&amp;clientId=u81e4375d-ee9d-4&amp;from=ui&amp;id=ud6d253e2&amp;originHeight=345&amp;originWidth=962&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=21993&amp;status=done&amp;style=none&amp;taskId=u8ec83d57-9a06-4232-8602-8190f603704&amp;title=" alt="Snipaste_2023-02-15_22-04-39.png"><br>结束任务后可以在任务历史服务器WebUI中进行查看：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676461674361-59a57d45-997a-4181-8249-fa9c64733ece.png#averageHue=%23fbfbfa&amp;clientId=ua26ddcb6-7483-4&amp;from=paste&amp;height=200&amp;id=uf77f14ca&amp;originHeight=207&amp;originWidth=1556&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=13833&amp;status=done&amp;style=none&amp;taskId=ub4d7bf44-3575-4f2b-880c-e04aabc0198&amp;title=&amp;width=1504" alt="image.png"><h3 id="1-9-关闭命令"><a href="#1-9-关闭命令" class="headerlink" title="1.9 关闭命令"></a>1.9 关闭命令</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/stop-cluster.sh</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0.html"/>
      <url>/posts/0.html</url>
      
        <content type="html"><![CDATA[<p>前置准备：<br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed">一、集群环境搭建高可用版本配置</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/ifi3zw34ztgm4bqt?view=doc_embed">（一）Scala环境搭建</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/fbyk58l02whdr677?view=doc_embed">(二) Flink集群环境搭建(Local模式)</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/dxmlft2waa775lkm?view=doc_embed">(三) Flink集群环境搭建(Standalone模式)</a><br>需要的安装包：<a href="https://archive.apache.org/dist/flink/">flink</a>压缩包——&gt;flink-1.13.0-bin-scala_2.12.tgz</p><h1 id="HA-StandAlone模式"><a href="#HA-StandAlone模式" class="headerlink" title="HA-StandAlone模式"></a>HA-StandAlone模式</h1><h3 id="1-1-修改集群配置"><a href="#1-1-修改集群配置" class="headerlink" title="1.1 修改集群配置"></a>1.1 修改集群配置</h3><h4 id="1-1-1-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件"><a href="#1-1-1-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件" class="headerlink" title="1.1.1 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件"></a>1.1.1 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#配置Flink的主节点</span><br><span class="line">jobmanager.rpc.address: master</span><br><span class="line"># 配置使用zookeeper来开启高可用模式</span><br><span class="line">high-availability: zookeeper</span><br><span class="line"># 配置zookeeper的地址，采用zookeeper集群时，可以使用逗号来分隔多个节点地址</span><br><span class="line">high-availability.zookeeper.quorum: master:<span class="number">2181</span>,slave1:<span class="number">2181</span>,slave2:<span class="number">2181</span></span><br><span class="line"># 在zookeeper上存储flink集群元信息的路径</span><br><span class="line">high-availability.zookeeper.path.root: /ha-flink</span><br><span class="line"># 持久化存储JobManager元数据的地址，zookeeper上存储的只是指向该元数据的指针信息</span><br><span class="line">high-availability.storageDir: hdfs:<span class="comment">//hacluster:8020/flink/recovery</span></span><br><span class="line">#（hacluster与HAHadoop中的core-site.xml里的hadoop集群在zookeeper上注册的节点名一致）</span><br><span class="line"># 将已完成的作业上传到此目录中，让任务历史服务器进行监控</span><br><span class="line">jobmanager.archive.fs.dir: hdfs:<span class="comment">//hacluster:8020/flink-jobhistory</span></span><br><span class="line">historyserver.web.address: master</span><br><span class="line">historyserver.web.port: <span class="number">18082</span></span><br><span class="line"># 任务历史服务器监控目录中已存档的作业</span><br><span class="line">historyserver.archive.fs.dir: hdfs:<span class="comment">//hacluster:8020/flink-jobhistory</span></span><br><span class="line">historyserver.web.refresh-interval: <span class="number">10000</span></span><br></pre></td></tr></table></figure><p>除了上面的配置之外，Flink 还可以使用以下可选参数来优化集群性能：</p><ul><li><strong>jobmanager.heap.size</strong>：JobManager 的 JVM 堆内存大小，默认为 1024m 。</li><li><strong>taskmanager.heap.size</strong>：Taskmanager 的 JVM 堆内存大小，默认为 1024m 。</li><li><strong>taskmanager.numberOfTaskSlots</strong>：Taskmanager 上 slots 的数量，通常设置为 CPU 核心的数量，或其一半。</li><li><strong>parallelism.default</strong>：任务默认的并行度。</li><li><strong>io.tmp.dirs</strong>：存储临时文件的路径，如果没有配置，则默认采用服务器的临时目录，如 LInux 的 /tmp 目录。<h4 id="1-1-2-修改-masters-文件，指定JobManager节点"><a href="#1-1-2-修改-masters-文件，指定JobManager节点" class="headerlink" title="1.1.2 修改 masters 文件，指定JobManager节点"></a>1.1.2 修改 masters 文件，指定JobManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">master:<span class="number">8081</span></span><br><span class="line">slave1:<span class="number">8081</span></span><br></pre></td></tr></table></figure><h4 id="1-1-3-修改-slaves（workers）-文件，添加TaskManager节点"><a href="#1-1-3-修改-slaves（workers）-文件，添加TaskManager节点" class="headerlink" title="1.1.3 修改 slaves（workers） 文件，添加TaskManager节点"></a>1.1.3 修改 slaves（workers） 文件，添加TaskManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="1-2-导入Flink依赖flink-shaded-hadoop包到Flink-lib中去（各个节点Flink的lib）"><a href="#1-2-导入Flink依赖flink-shaded-hadoop包到Flink-lib中去（各个节点Flink的lib）" class="headerlink" title="1.2 导入Flink依赖flink-shaded-hadoop包到Flink/lib中去（各个节点Flink的lib）"></a>1.2 导入Flink依赖<strong>flink-shaded-hadoop</strong>包到Flink/lib中去（各个节点Flink的lib）</h3><strong>将文件下载本地，再将文件的后缀篡改为jar，在上传群集文件当中（.txt—&gt;.jar）</strong><br><a href="https://www.yuque.com/attachments/yuque/0/2023/txt/33576317/1676461093792-9afc6989-aa00-46ce-aebc-2578461d1c97.txt">flink-shaded-hadoop-2-uber-2.8.3-10.0.txt</a><h3 id="1-3-分发Flink给其他节点"><a href="#1-3-分发Flink给其他节点" class="headerlink" title="1.3 分发Flink给其他节点"></a>1.3 分发Flink给其他节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r $FLINK_HOME/ slave1:/opt/</span><br><span class="line">scp -r $FLINK_HOME/ slave2:/opt/</span><br></pre></td></tr></table></figure><h3 id="1-4-在HDFS上创建HIstory目录"><a href="#1-4-在HDFS上创建HIstory目录" class="headerlink" title="1.4 在HDFS上创建HIstory目录"></a>1.4 在<strong>HDFS</strong>上<strong>创建</strong>HIstory目录</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir /flink</span><br><span class="line">hdfs dfs -mkdir /flink/recovery</span><br><span class="line">hdfs dfs -mkdir /flink-jobhistory</span><br><span class="line">hdfs dfs -chmod <span class="number">777</span> /flink-jobhistory</span><br></pre></td></tr></table></figure><h3 id="1-5-启动"><a href="#1-5-启动" class="headerlink" title="1.5 启动"></a>1.5 启动</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 启动HAHadoop集群</span><br><span class="line">[huser@master ~]$ ./opt/bin/start-dfs.sh--&gt;  <span class="string">&#x27;脚本启动&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="1-6-启动Flink集群和任务历史服务器"><a href="#1-6-启动Flink集群和任务历史服务器" class="headerlink" title="1.6 启动Flink集群和任务历史服务器"></a>1.6 启动Flink集群和任务历史服务器</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[huser@master ~]$ start-cluster.sh</span><br><span class="line">[huser@master ~]$ historyserver.sh start</span><br><span class="line"><span class="meta">#jps</span></span><br><span class="line">#主节点多出:</span><br><span class="line"><span class="number">3835</span> StandaloneSessionClusterEntrypoint</span><br><span class="line"><span class="number">4148</span> TaskManagerRunner</span><br><span class="line">#其他节点多出：</span><br><span class="line"><span class="number">3437</span> TaskManagerRunner</span><br></pre></td></tr></table></figure><h3 id="1-7-查看web端"><a href="#1-7-查看web端" class="headerlink" title="1.7 查看web端"></a>1.7 查看web端</h3>启动成功后，访问 <a href="http://192.168.33.151:8081">http://192.168.33.151:8081</a>或<a href="http://192.168.33.150:8081">http://192.168.33.150:8081</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676451724146-e2477fcb-6135-4182-83f0-6619f1287f56.png#averageHue=%23fcfcfc&amp;clientId=u837ef046-2fb6-4&amp;from=paste&amp;height=922&amp;id=u79ba204e&amp;originHeight=922&amp;originWidth=1811&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=55644&amp;status=done&amp;style=none&amp;taskId=ue9d0252a-ba3a-490f-88d1-60f5c498583&amp;title=&amp;width=1811" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676451706030-12e9e8e0-6ed4-4572-ae0b-f0e999ecce25.png#averageHue=%23f7f7f7&amp;clientId=u837ef046-2fb6-4&amp;from=paste&amp;height=825&amp;id=u8f41c3a1&amp;originHeight=825&amp;originWidth=1821&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=61117&amp;status=done&amp;style=none&amp;taskId=u143203ca-8ae8-4e7e-bb5d-271f3b08c62&amp;title=&amp;width=1821" alt="image.png"><h3 id="1-8-HA测试"><a href="#1-8-HA测试" class="headerlink" title="1.8 HA测试"></a>1.8 HA测试</h3><strong>流计算词频统计案例源码：</strong><br><strong>将文件下载本地，再将文件的后缀篡改为jar，在上传群集文件当中（.txt—&gt;.jar）</strong><br><a href="https://www.yuque.com/attachments/yuque/0/2023/txt/33576317/1676452304638-4248c58f-a2be-479e-b4f8-30660c34f5c1.txt">flink_scala-1.0-SNAPSHOT.txt</a><br>提交作业：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">1.</span>虚拟机内开启端口</span><br><span class="line">[huser@master ~]$ nc -lk <span class="number">5555</span></span><br><span class="line"># <span class="number">2.</span>提交作业</span><br><span class="line">[huser@master ~]$ flink run -c cs flink_scala<span class="number">-1.0</span>-SNAPSHOT.jar master <span class="number">5555</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>     格式        class_path   jar_name          node_name   nc_端口  <span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>输入数据以及结果：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676461010604-02911a94-0330-4759-b8b9-aecc6634e469.png#averageHue=%23120f0d&amp;clientId=ua26ddcb6-7483-4&amp;from=paste&amp;height=162&amp;id=uecdcc0ea&amp;originHeight=162&amp;originWidth=1138&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=20028&amp;status=done&amp;style=none&amp;taskId=udd4f25a1-5b14-4bae-af5a-3c1605810bc&amp;title=&amp;width=1138" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676460987877-d766354f-126a-4435-97b7-6809695c138e.png#averageHue=%23fefefd&amp;clientId=ua26ddcb6-7483-4&amp;from=paste&amp;height=922&amp;id=u0d197667&amp;originHeight=922&amp;originWidth=1824&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=87108&amp;status=done&amp;style=none&amp;taskId=u1b331ac4-c06a-4112-aec4-ac632e5c292&amp;title=&amp;width=1824" alt="image.png"><br>运行过程中将正在服务的JobManager给kill掉，测试是否高可用<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill <span class="number">-9</span> 端口号</span><br></pre></td></tr></table></figure>此时hadoop01的8081无法访问，hadoop02会进行接管（重新提交刚才被中断的作业），这个过程需要稍等一会儿<br>再次输入数据后可以从结果看出是一个新作业：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676461617105-bd7bb917-9e94-427e-8d2b-843d6b302d69.png#averageHue=%230a0704&amp;clientId=ua26ddcb6-7483-4&amp;from=paste&amp;height=65&amp;id=ub93a9e3a&amp;originHeight=65&amp;originWidth=422&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=3071&amp;status=done&amp;style=none&amp;taskId=u834c81b9-2049-4a9c-b8db-2eaf41754d7&amp;title=&amp;width=422" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676461626555-28b2406c-465f-4b31-be96-550eb81ff934.png#averageHue=%23fdfdfc&amp;clientId=ua26ddcb6-7483-4&amp;from=paste&amp;height=242&amp;id=u0448460c&amp;originHeight=166&amp;originWidth=293&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=6544&amp;status=done&amp;style=none&amp;taskId=ua57dd8d5-2fac-4973-84c2-ddd628febd6&amp;title=&amp;width=427" alt="image.png"><br>结束任务后可以在任务历史服务器WebUI中进行查看：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676461674361-59a57d45-997a-4181-8249-fa9c64733ece.png#averageHue=%23fbfbfa&amp;clientId=ua26ddcb6-7483-4&amp;from=paste&amp;height=200&amp;id=uf77f14ca&amp;originHeight=207&amp;originWidth=1556&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=13833&amp;status=done&amp;style=none&amp;taskId=ub4d7bf44-3575-4f2b-880c-e04aabc0198&amp;title=&amp;width=1504" alt="image.png"><h3 id="1-9-关闭命令"><a href="#1-9-关闭命令" class="headerlink" title="1.9 关闭命令"></a>1.9 关闭命令</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/stop-cluster.sh</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/posts/0.html"/>
      <url>/posts/0.html</url>
      
        <content type="html"><![CDATA[<p>前置准备：<br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed">一、集群环境搭建高可用版本配置</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/ifi3zw34ztgm4bqt?view=doc_embed">（一）Scala环境搭建</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/fbyk58l02whdr677?view=doc_embed">(二) Flink集群环境搭建(Local模式)</a><br>需要的安装包：<a href="https://archive.apache.org/dist/flink/">flink</a>压缩包——&gt;flink-1.13.0-bin-scala_2.12.tgz</p><h1 id="StandAlone模式"><a href="#StandAlone模式" class="headerlink" title="StandAlone模式"></a>StandAlone模式</h1><h3 id="1-1-修改集群配置"><a href="#1-1-修改集群配置" class="headerlink" title="1.1 修改集群配置"></a>1.1 修改集群配置</h3><h4 id="1-1-1-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件"><a href="#1-1-1-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件" class="headerlink" title="1.1.1 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件"></a>1.1.1 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">jobmanager.rpc.address: master</span><br><span class="line"># 将已完成的作业上传到此目录中，让任务历史服务器进行监控</span><br><span class="line">jobmanager.archive.fs.dir: hdfs:<span class="comment">//hacluster:8020/flink-jobhistory</span></span><br><span class="line">historyserver.web.address: master</span><br><span class="line">historyserver.web.port: <span class="number">18082</span></span><br><span class="line"># # 任务历史服务器监控目录中已存档的作业</span><br><span class="line">historyserver.archive.fs.dir: hdfs:<span class="comment">//hacluster:8020/flink-jobhistory</span></span><br><span class="line">historyserver.web.refresh-interval: <span class="number">10000</span></span><br></pre></td></tr></table></figure><p>除了上面的配置之外，Flink 还可以使用以下可选参数来优化集群性能：</p><ul><li><strong>jobmanager.heap.size</strong>：JobManager 的 JVM 堆内存大小，默认为 1024m 。</li><li><strong>taskmanager.heap.size</strong>：Taskmanager 的 JVM 堆内存大小，默认为 1024m 。</li><li><strong>taskmanager.numberOfTaskSlots</strong>：Taskmanager 上 slots 的数量，通常设置为 CPU 核心的数量，或其一半。</li><li><strong>parallelism.default</strong>：任务默认的并行度。</li><li><strong>io.tmp.dirs</strong>：存储临时文件的路径，如果没有配置，则默认采用服务器的临时目录，如 LInux 的 /tmp 目录。<h4 id="1-1-2-修改-masters-文件，指定JobManager节点"><a href="#1-1-2-修改-masters-文件，指定JobManager节点" class="headerlink" title="1.1.2 修改 masters 文件，指定JobManager节点"></a>1.1.2 修改 masters 文件，指定JobManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">master:<span class="number">8081</span></span><br></pre></td></tr></table></figure><h4 id="1-1-3-修改-slaves（workers）-文件，添加TaskManager节点"><a href="#1-1-3-修改-slaves（workers）-文件，添加TaskManager节点" class="headerlink" title="1.1.3 修改 slaves（workers） 文件，添加TaskManager节点"></a>1.1.3 修改 slaves（workers） 文件，添加TaskManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="1-2-分发Flink给其他节点"><a href="#1-2-分发Flink给其他节点" class="headerlink" title="1.2 分发Flink给其他节点"></a>1.2 分发Flink给其他节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r $FLINK_HOME/ slave1:/opt/</span><br><span class="line">scp -r $FLINK_HOME/ slave2:/opt/</span><br></pre></td></tr></table></figure><h3 id="1-3-在HDFS上创建HIstory目录"><a href="#1-3-在HDFS上创建HIstory目录" class="headerlink" title="1.3 在HDFS上创建HIstory目录"></a>1.3 在<strong>HDFS</strong>上<strong>创建</strong>HIstory目录</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir /flink-jobhistory</span><br><span class="line">hdfs dfs -chmod <span class="number">777</span> /flink-jobhistory</span><br></pre></td></tr></table></figure><h3 id="1-3-启动"><a href="#1-3-启动" class="headerlink" title="1.3 启动"></a>1.3 启动</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#启动HAHadoop集群</span><br><span class="line">[huser@master ~]$ ./opt/bin/start-dfs.sh--&gt;  <span class="string">&#x27;脚本启动&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="1-4-启动Flink集群和任务历史服务器"><a href="#1-4-启动Flink集群和任务历史服务器" class="headerlink" title="1.4 启动Flink集群和任务历史服务器"></a>1.4 启动Flink集群和任务历史服务器</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[huser@master ~]$ start-cluster.sh</span><br><span class="line">[huser@master ~]$ historyserver.sh start</span><br><span class="line"><span class="meta">#jps</span></span><br><span class="line">#主节点多出:</span><br><span class="line"><span class="number">3835</span> StandaloneSessionClusterEntrypoint</span><br><span class="line"><span class="number">4148</span> TaskManagerRunner</span><br><span class="line">#其他节点多出：</span><br><span class="line"><span class="number">3437</span> TaskManagerRunner</span><br></pre></td></tr></table></figure><h3 id="1-5-查看web端"><a href="#1-5-查看web端" class="headerlink" title="1.5 查看web端"></a>1.5 查看web端</h3>启动成功后，访问 <a href="http://master:8081">http://master:8081</a>或<a href="http://192.168.33.150:8081">http://192.168.33.150:8081</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676451724146-e2477fcb-6135-4182-83f0-6619f1287f56.png#averageHue=%23fcfcfc&amp;clientId=u837ef046-2fb6-4&amp;from=paste&amp;height=922&amp;id=u79ba204e&amp;originHeight=922&amp;originWidth=1811&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=55644&amp;status=done&amp;style=none&amp;taskId=ue9d0252a-ba3a-490f-88d1-60f5c498583&amp;title=&amp;width=1811" alt="image.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676451706030-12e9e8e0-6ed4-4572-ae0b-f0e999ecce25.png#averageHue=%23f7f7f7&amp;clientId=u837ef046-2fb6-4&amp;from=paste&amp;height=825&amp;id=u8f41c3a1&amp;originHeight=825&amp;originWidth=1821&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=61117&amp;status=done&amp;style=none&amp;taskId=u143203ca-8ae8-4e7e-bb5d-271f3b08c62&amp;title=&amp;width=1821" alt="image.png"><h3 id="1-6-关闭命令"><a href="#1-6-关闭命令" class="headerlink" title="1.6 关闭命令"></a>1.6 关闭命令</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/stop-cluster.sh</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>十四、Flink组件搭建之Flink集群环境搭建(Local模式)(二)</title>
      <link href="/posts/3cc2c9ad.html"/>
      <url>/posts/3cc2c9ad.html</url>
      
        <content type="html"><![CDATA[<h1 id="Flink的简介："><a href="#Flink的简介：" class="headerlink" title="Flink的简介："></a>Flink的简介：</h1><p>Apache Flink是一个框架和分布式处理引擎，用于对无界和有界数据流进行有状态计算。Flink设计为在所有常见的集群环境中运行，以内存速度和任何规模执行计算。<br>Apache Flink的数据流编程模型在有限和无限数据集上提供单次事件（event-at-a-time）处理。在基础层面，Flink程序由流和转换组成。<br>Apache Flink的API：有界或无界数据流的数据流API、用于有界数据集的数据集API、表API。</p><h3 id="数据流的运行流程"><a href="#数据流的运行流程" class="headerlink" title="数据流的运行流程"></a>数据流的运行流程</h3><p>Flink程序在执行后被映射到流数据流，每个Flink数据流以一个或多个源（数据输入，例如消息队列或文件系统）开始，并以一个或多个接收器（数据输出，如消息队列、文件系统或数据库等）结束。Flink可以对流执行任意数量的变换，这些流可以被编排为有向无环数据流图，允许应用程序分支和合并数据流。</p><h3 id="Flink的数据源和接收器"><a href="#Flink的数据源和接收器" class="headerlink" title="Flink的数据源和接收器"></a>Flink的数据源和接收器</h3><p>Flink提供现成的源和<a href="https://baike.baidu.com/item/%E6%8E%A5%E6%94%B6%E8%BF%9E%E6%8E%A5%E5%99%A8/3533010?fromModule=lemma_inlink">接收连接器</a>，包括Apache Kafka、Amazon Kinesis、HDFS和Apache Cassandra等。<br>Flink程序可以作为集群内的分布式系统运行，也可以以独立模式或在YARN、Mesos、基于Docker的环境和其他资源管理框架下进行部署。</p><h3 id="Flink的状态-state"><a href="#Flink的状态-state" class="headerlink" title="Flink的状态(state)"></a>Flink的状态(state)</h3><p>Flink检查点和容错：检查点是应用程序状态和源流中位置的自动异步快照。在发生故障的情况下，启用了检查点的Flink程序将在恢复时从上一个完成的检查点恢复处理，确保Flink在应用程序中保持一致性（exactly-once）状态语义。检查点机制暴露应用程序代码的接口，以便将外部系统包括在检查点机制中（如打开和提交数据库系统的事务）。<br>Flink保存点的机制是一种手动触发的检查点。用户可以生成保存点，停止正在运行的Flink程序，然后从流中的相同应用程序状态和位置恢复程序。 保存点可以在不丢失应用程序状态的情况下对Flink程序或Flink群集进行更新。</p><h3 id="Flink的数据流API"><a href="#Flink的数据流API" class="headerlink" title="Flink的数据流API"></a>Flink的数据流API</h3><p>Flink的数据流API支持有界或无界数据流上的转换（如过滤器、聚合和窗口函数），包含了20多种不同类型的转换，可以在Java和Scala中使用。<br>有状态流处理程序的一个简单Scala示例是从连续输入流发出字数并在5秒窗口中对数据进行分组的应用： [4] </p><h3 id="Apache-Beam"><a href="#Apache-Beam" class="headerlink" title="Apache Beam"></a>Apache Beam</h3><p>Apache Beam“提供了一种高级统一编程模型，允许（开发人员）实现可在在任何执行引擎上运行批处理和流数据处理作业”。Apache Flink-on-Beam运行器是功能最丰富的、由Beam社区维护的能力矩阵。<br>data Artisans与Apache Flink社区一起，与Beam社区密切合作，开发了一个强大的Flink runner。</p><h3 id="数据集API"><a href="#数据集API" class="headerlink" title="数据集API"></a>数据集API</h3><p>Flink的数据集API支持对有界数据集进行转换（如过滤、映射、连接和分组），包含了20多种不同类型的转换。 该API可用于Java、Scala和实验性的Python API。Flink的数据集API在概念上与数据流API类似。 [3] </p><h3 id="表API和SQL"><a href="#表API和SQL" class="headerlink" title="表API和SQL"></a>表API和SQL</h3><p>Flink的表API是一种类似SQL的表达式语言，用于关系流和批处理，可以嵌入Flink的Java和Scala数据集和数据流API中。表API和SQL接口在关系表抽象上运行，可以从外部数据源或现有数据流和数据集创建表。表API支持<a href="https://baike.baidu.com/item/%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6/352774?fromModule=lemma_inlink">关系运算符</a>，如表上的选择、聚合和连接等。<br>也可以使用常规SQL查询表。表API提供了和SQL相同的功能，可以在同一程序中混合使用。将表转换回数据集或数据流时，由<a href="https://baike.baidu.com/item/%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6/352774?fromModule=lemma_inlink">关系运算符</a>和SQL查询定义的逻辑计划将使用Apache Calcite进行优化，并转换为数据集或数据流程序。</p><p>前置准备：<br><a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo?view=doc_embed">一、集群环境搭建高可用版本配置</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/xc0gbs/ifi3zw34ztgm4bqt?view=doc_embed">（一）Scala环境搭建</a><br>需要的安装包：<a href="https://archive.apache.org/dist/flink/">flink</a>压缩包——&gt;flink-1.13.0-bin-scala_2.12.tgz</p><h2 id="1-本地启动"><a href="#1-本地启动" class="headerlink" title="1. 本地启动"></a>1. 本地启动</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1 解压并改名"></a>1.1 解压并改名</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf flink<span class="number">-1.13</span><span class="number">.0</span>-bin-scala_2<span class="number">.12</span>.tgz -C /opt/</span><br><span class="line">mv flink<span class="number">-1.13</span><span class="number">.0</span> flink</span><br></pre></td></tr></table></figure><h3 id="1-2-配置Flink环境变量"><a href="#1-2-配置Flink环境变量" class="headerlink" title="1.2 配置Flink环境变量"></a>1.2 配置Flink环境变量</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"># Flink</span><br><span class="line"><span class="keyword">export</span> FLINK_HOME=/opt/flink</span><br><span class="line"><span class="keyword">export</span> PATH=$PATH:$FLINK_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="1-3-加载环境变量"><a href="#1-3-加载环境变量" class="headerlink" title="1.3 加载环境变量"></a>1.3 加载环境变量</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h3 id="1-4-开启Flink集群"><a href="#1-4-开启Flink集群" class="headerlink" title="1.4 开启Flink集群"></a>1.4 开启Flink集群</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/start-cluster.sh</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">Starting cluster.</span><br><span class="line">Starting standalonesession daemon on host slave1.</span><br><span class="line">Starting taskexecutor daemon on host slave1.</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">[huser@master ~]$ jps</span><br><span class="line"><span class="number">10369</span> StandaloneSessionClusterEntrypoint</span><br><span class="line"><span class="number">10680</span> TaskManagerRunner</span><br><span class="line"><span class="number">10717</span> Jps</span><br></pre></td></tr></table></figure><h3 id="1-5-访问-Web-UI"><a href="#1-5-访问-Web-UI" class="headerlink" title="1.5 访问 Web UI"></a>1.5 访问 Web UI</h3><p>启动成功后，访问 <a href="http://master:8081">http://master:8081</a>或<a href="http://192.168.33.150:8081">http://192.168.33.150:8081</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1674734330071-a33d5b08-183b-4aa0-87fe-6a48d1f84f8a.png#averageHue=%23fafafa&amp;clientId=ud06bda3c-a0f0-4&amp;from=paste&amp;height=671&amp;id=u22d7dd91&amp;originHeight=1007&amp;originWidth=1916&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=106498&amp;status=done&amp;style=none&amp;taskId=ubab717bd-5437-4850-9efd-af276fa1471&amp;title=&amp;width=1277.3333333333333" alt="image.png"></p><h3 id="1-6-关闭Flink集群"><a href="#1-6-关闭Flink集群" class="headerlink" title="1.6 关闭Flink集群"></a>1.6 关闭Flink集群</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/stop-cluster.sh</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="function">Stopping taskexecutor <span class="title">daemon</span> <span class="params">(pid: <span class="number">2901</span>)</span> on host slave1.</span></span><br><span class="line"><span class="function">Stopping standalonesession <span class="title">daemon</span> <span class="params">(pid: <span class="number">2635</span>)</span> on host slave1.</span></span><br><span class="line"><span class="function">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="2-远程集群启动"><a href="#2-远程集群启动" class="headerlink" title="2. 远程集群启动"></a>2. 远程集群启动</h1><h3 id="2-1-修改集群配置"><a href="#2-1-修改集群配置" class="headerlink" title="2.1 修改集群配置"></a>2.1 修改集群配置</h3><h4 id="2-1-1-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件"><a href="#2-1-1-进入-FLINK-HOME-conf-目录下，修改flink-conf-yaml文件" class="headerlink" title="2.1.1 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件"></a>2.1.1 进入 ${FLINK_HOME}/conf 目录下，修改flink-conf.yaml文件</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jobmanager.rpc.address: master</span><br></pre></td></tr></table></figure><h4 id="2-1-2-修改-masters-文件，指定JobManager节点"><a href="#2-1-2-修改-masters-文件，指定JobManager节点" class="headerlink" title="2.1.2 修改 masters 文件，指定JobManager节点"></a>2.1.2 修改 masters 文件，指定JobManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">master:<span class="number">8081</span></span><br><span class="line">slave1:<span class="number">8081</span></span><br></pre></td></tr></table></figure><h4 id="2-1-3-修改-slaves（workers）-文件，添加TaskManager节点"><a href="#2-1-3-修改-slaves（workers）-文件，添加TaskManager节点" class="headerlink" title="2.1.3 修改 slaves（workers） 文件，添加TaskManager节点"></a>2.1.3 修改 slaves（workers） 文件，添加TaskManager节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="2-2-分发Flink给其他节点"><a href="#2-2-分发Flink给其他节点" class="headerlink" title="2.2 分发Flink给其他节点"></a>2.2 分发Flink给其他节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r $FLINK_HOME/ slave1:/opt/</span><br><span class="line">scp -r $FLINK_HOME/ slave2:/opt/</span><br></pre></td></tr></table></figure><h3 id="2-3-启动命令"><a href="#2-3-启动命令" class="headerlink" title="2.3 启动命令"></a>2.3 启动命令</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/start-cluster.sh</span><br></pre></td></tr></table></figure><h3 id="2-4-查看节点"><a href="#2-4-查看节点" class="headerlink" title="2.4 查看节点"></a>2.4 查看节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#jps多出:</span></span><br><span class="line"><span class="number">4658</span> StandaloneSessionClusterEntrypoint</span><br><span class="line"><span class="number">4978</span> TaskManagerRunner</span><br></pre></td></tr></table></figure><h3 id="2-5-查看开发端口IP"><a href="#2-5-查看开发端口IP" class="headerlink" title="2.5 查看开发端口IP"></a>2.5 <strong>查看开发端口IP</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">netstat -nltp</span><br><span class="line"># 注意：要用此命令，必须先下载组件</span><br><span class="line">yum install -y nc  OR  yum install -y netcat</span><br><span class="line"># 如果不行，就下载组件</span><br><span class="line">yum -y install net-tools</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">(Not all processes could be identified, non-owned process info</span></span><br><span class="line"><span class="string"> will not be shown, you would have to be root to see it all.)</span></span><br><span class="line"><span class="string">Active Internet connections (only servers)</span></span><br><span class="line"><span class="string">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span></span><br><span class="line"><span class="string">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   </span></span><br><span class="line"><span class="string">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -                   </span></span><br><span class="line"><span class="string">tcp6       0      0 192.168.33.150:33308    :::*                    LISTEN      9630/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 :::34909                :::*                    LISTEN      9630/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 :::34273                :::*                    LISTEN      9630/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 :::43715                :::*                    LISTEN      9281/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 :::6123                 :::*                    LISTEN      9281/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 :::8081                 :::*                    LISTEN      9281/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 :::22                   :::*                    LISTEN      -                   </span></span><br><span class="line"><span class="string">tcp6       0      0 :::39481                :::*                    LISTEN      9281/java           </span></span><br><span class="line"><span class="string">tcp6       0      0 ::1:25                  :::*                    LISTEN      -  </span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2-6-查看web端"><a href="#2-6-查看web端" class="headerlink" title="2.6 查看web端"></a>2.6 查看web端</h3><p>启动成功后，访问 <a href="http://master:8081">http://master:8081</a>或<a href="http://192.168.33.150:8081">http://192.168.33.150:8081</a><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1676444068752-e82b4997-1f17-4ff0-9e12-56fa25e34ee3.png#averageHue=%23fcfbfb&amp;clientId=ubc49e345-800f-4&amp;from=paste&amp;height=971&amp;id=ud09f432b&amp;originHeight=971&amp;originWidth=1830&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=58307&amp;status=done&amp;style=none&amp;taskId=ub737f5e6-3457-492b-b1f2-a65bcf5a574&amp;title=&amp;width=1830" alt="image.png"></p><h3 id="2-7-关闭命令"><a href="#2-7-关闭命令" class="headerlink" title="2.7 关闭命令"></a>2.7 关闭命令</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master flink]$ bin/stop-cluster.sh</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>八、DataX组件搭建--数据迁移工具</title>
      <link href="/posts/28f6f62f.html"/>
      <url>/posts/28f6f62f.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-dove modern"><p>简介： <a href="https://blog.csdn.net/weixin_46902396/article/details/121904705?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166731346816782395330610%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166731346816782395330610&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-121904705-null-null.142^v62^pc_rank_34_queryrelevant25,201^v3^control_1,213^v1^control&amp;utm_term=DataX&amp;spm=1018.2226.3001.4187"><strong>DataX</strong></a>是一个异构数据源离线同步工具，致力于实现包括关系型数据库(MySQL、Oracle等)、HDFS、Hive、ODPS、HBase、FTP等各种异构数据源之间稳定高效的数据同步功能。</p></div><div class="tip cogs"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note info simple"><p>需要的安装包：<a href="http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz"><strong>DataX</strong></a>包—-&gt;<strong>datax.tar.gz</strong></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1 解压并改名"></a>1.1 解压并改名</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf datax.tar.gz -C /opt/software/</span><br><span class="line"><span class="meta"># 这里解压出来的名字刚好是datax，所以不用改名</span></span><br></pre></td></tr></table></figure><h3 id="1-2-运行自检脚本"><a href="#1-2-运行自检脚本" class="headerlink" title="1.2 运行自检脚本"></a>1.2 运行自检脚本</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/datax.py job/job.json</span><br></pre></td></tr></table></figure><h3 id="1-3-部署datax到本地后首次执行任务报错"><a href="#1-3-部署datax到本地后首次执行任务报错" class="headerlink" title="1.3 部署datax到本地后首次执行任务报错"></a>1.3 部署datax到本地后首次执行任务报错</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-02 12:53:46.815 [main] WARN  ConfigParser - 插件[streamreader,streamwriter]加载失败，1s后重试... Exception:Code:[Common-00], Describe:[您提供的配置文件存在错误信息，请检查您的作业配置 .] - 配置信息错误，您提供的配置文件[/opt/datax/plugin/reader/._drdsreader/plugin.json]不存在. 请检查您的配置文件. </span></span><br><span class="line"><span class="string">2022-11-02 12:53:47.834 [main] ERROR Engine - </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">经DataX智能分析,该任务最可能的错误原因是:</span></span><br><span class="line"><span class="string">com.alibaba.datax.common.exception.DataXException: Code:[Common-00], Describe:[您提供的配置文件存在错误信息，请检查您的作业配置 .] - 配置信息错误，您提供的配置文件[/opt/datax/plugin/reader/._drdsreader/plugin.json]不存在. 请检查您的配置文件.</span></span><br><span class="line"><span class="string">at com.alibaba.datax.common.exception.DataXException.asDataXException(DataXException.java:26)</span></span><br><span class="line"><span class="string">at com.alibaba.datax.common.util.Configuration.from(Configuration.java:95)</span></span><br><span class="line"><span class="string">at com.alibaba.datax.core.util.ConfigParser.parseOnePluginConfig(ConfigParser.java:153)</span></span><br><span class="line"><span class="string">at com.alibaba.datax.core.util.ConfigParser.parsePluginConfig(ConfigParser.java:125)</span></span><br><span class="line"><span class="string">at com.alibaba.datax.core.util.ConfigParser.parse(ConfigParser.java:63)</span></span><br><span class="line"><span class="string">at com.alibaba.datax.core.Engine.entry(Engine.java:137)</span></span><br><span class="line"><span class="string">at com.alibaba.datax.core.Engine.main(Engine.java:204)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">解决方案：</span><br><span class="line"><span class="built_in">cd</span> /plugin/reader</span><br><span class="line"><span class="built_in">rm</span> -rf  ./._*</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /plugin/writer</span><br><span class="line"><span class="built_in">rm</span> -rf  ./._*</span><br></pre></td></tr></table></figure><h2 id="2-基本使用"><a href="#2-基本使用" class="headerlink" title="2. 基本使用"></a>2. 基本使用</h2><h3 id="2-1-从stream读取数据并打印到控制台"><a href="#2-1-从stream读取数据并打印到控制台" class="headerlink" title="2.1 从stream读取数据并打印到控制台"></a>2.1 从stream读取数据并打印到控制台</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">python /opt/datax/bin/datax.py -r streamreader -w streamwriter</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">DataX</span> (DATAX-OPENSOURCE<span class="number">-3.0</span>), From Alibaba !</span><br><span class="line"><span class="built_in">Copyright</span> (C) <span class="number">2010</span><span class="number">-2017</span>, Alibaba Group. All Rights Reserved.</span><br><span class="line"></span><br><span class="line">Please refer to the streamreader document:</span><br><span class="line">     https:<span class="comment">//github.com/alibaba/DataX/blob/master/streamreader/doc/streamreader.md </span></span><br><span class="line"></span><br><span class="line">Please refer to the streamwriter document:</span><br><span class="line">     https:<span class="comment">//github.com/alibaba/DataX/blob/master/streamwriter/doc/streamwriter.md </span></span><br><span class="line"> </span><br><span class="line">Please save the following configuration as a json file <span class="keyword">and</span>  use</span><br><span class="line">     python &#123;DATAX_HOME&#125;/bin/datax.py &#123;JSON_FILE_NAME&#125;.json </span><br><span class="line">to run the job.</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;job&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;reader&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;streamreader&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;column&quot;</span>: [], </span><br><span class="line">                        <span class="string">&quot;sliceRecordCount&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="string">&quot;writer&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;streamwriter&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;encoding&quot;</span>: <span class="string">&quot;&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;print&quot;</span>: <span class="literal">true</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ], </span><br><span class="line">        <span class="string">&quot;setting&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;speed&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;channel&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-根据模板编写json文件-新建一个data目录下stream2stream-json文件"><a href="#2-2-根据模板编写json文件-新建一个data目录下stream2stream-json文件" class="headerlink" title="2.2 根据模板编写json文件,新建一个data目录下stream2stream.json文件"></a>2.2 根据模板编写json文件,新建一个data目录下stream2stream.json文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;job&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;reader&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;streamreader&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;column&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="string">&quot;type&quot;</span>:<span class="string">&quot;string&quot;</span>,</span><br><span class="line">                                <span class="string">&quot;value&quot;</span>:<span class="string">&quot;xiaokang-微信公众号:小康新鲜事儿&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="string">&quot;type&quot;</span>:<span class="string">&quot;string&quot;</span>,</span><br><span class="line">                                <span class="string">&quot;value&quot;</span>:<span class="string">&quot;你好，世界-DataX&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;sliceRecordCount&quot;</span>: <span class="string">&quot;10&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="string">&quot;writer&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;streamwriter&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;encoding&quot;</span>: <span class="string">&quot;utf-8&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;print&quot;</span>: <span class="literal">true</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ], </span><br><span class="line">        <span class="string">&quot;setting&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;speed&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;channel&quot;</span>: <span class="string">&quot;2&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-运行Job"><a href="#2-3-运行Job" class="headerlink" title="2.3 运行Job"></a>2.3 运行Job</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/datax/bin/datax.py data/stream2stream.json</span><br></pre></td></tr></table></figure><h2 id="3-MySQL数据导入到HDFS"><a href="#3-MySQL数据导入到HDFS" class="headerlink" title="3. MySQL数据导入到HDFS"></a>3. MySQL数据导入到HDFS</h2><h3 id="3-1-查看官方json配置模板"><a href="#3-1-查看官方json配置模板" class="headerlink" title="3.1 查看官方json配置模板"></a>3.1 查看官方json配置模板</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python /opt/datax/bin/datax.py -r mysqlreader -w hdfswriter</span><br></pre></td></tr></table></figure><h3 id="3-2-根据模板编写json文件-data目录下mysql2hdfs-json文件"><a href="#3-2-根据模板编写json文件-data目录下mysql2hdfs-json文件" class="headerlink" title="3.2 根据模板编写json文件,data目录下mysql2hdfs.json文件"></a>3.2 根据模板编写json文件,data目录下mysql2hdfs.json文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;job&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;reader&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;mysqlreader&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;column&quot;</span>: [</span><br><span class="line">                            <span class="string">&quot;help_keyword_id&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;name&quot;</span></span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;connection&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="string">&quot;jdbcUrl&quot;</span>: [</span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://192.168.33.147:3306/mysql&quot;</span></span><br><span class="line">                                ], </span><br><span class="line">                                <span class="string">&quot;table&quot;</span>: [</span><br><span class="line">                                    <span class="string">&quot;help_keyword&quot;</span></span><br><span class="line">                                ]</span><br><span class="line">                            &#125;</span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;root&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="string">&quot;writer&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hdfswriter&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;column&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="string">&quot;name&quot;</span>:<span class="string">&quot;help_keyword_id&quot;</span>,</span><br><span class="line">                                <span class="string">&quot;type&quot;</span>:<span class="string">&quot;int&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="string">&quot;name&quot;</span>:<span class="string">&quot;name&quot;</span>,</span><br><span class="line">                                <span class="string">&quot;type&quot;</span>:<span class="string">&quot;string&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;defaultFS&quot;</span>: <span class="string">&quot;hdfs://192.168.33.147:9000&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;fieldDelimiter&quot;</span>: <span class="string">&quot;|&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;fileName&quot;</span>: <span class="string">&quot;keyword.txt&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;fileType&quot;</span>: <span class="string">&quot;text&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/datax&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;writeMode&quot;</span>: <span class="string">&quot;append&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ], </span><br><span class="line">        <span class="string">&quot;setting&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;speed&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;channel&quot;</span>: <span class="string">&quot;3&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-运行Job"><a href="#3-3-运行Job" class="headerlink" title="3.3 运行Job"></a>3.3 运行Job</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/datax/bin/datax.py data/mysql2hdfs.json</span><br></pre></td></tr></table></figure><h2 id="4-HDFS数据导出到MySQL"><a href="#4-HDFS数据导出到MySQL" class="headerlink" title="4. HDFS数据导出到MySQL"></a>4. HDFS数据导出到MySQL</h2><h3 id="4-1-将3-2中导入的文件重命名并在数据库创建表"><a href="#4-1-将3-2中导入的文件重命名并在数据库创建表" class="headerlink" title="4.1 将3.2中导入的文件重命名并在数据库创建表"></a>4.1 将3.2中导入的文件重命名并在数据库创建表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">mv</span> /datax/keyword.txt__4c0e0d04_e503_437a_a1e3_49db49cbaaed /datax/keyword.txt</span><br></pre></td></tr></table></figure><h3 id="4-2-创建表"><a href="#4-2-创建表" class="headerlink" title="4.2 创建表"></a>4.2 创建表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE help_keyword_from_hdfs_datax LIKE help_keyword;</span><br></pre></td></tr></table></figure><h3 id="4-3-查看官方json配置模板"><a href="#4-3-查看官方json配置模板" class="headerlink" title="4.3 查看官方json配置模板"></a>4.3 查看官方json配置模板</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python /opt/datax/bin/datax.py -r hdfsreader -w mysqlwriter</span><br></pre></td></tr></table></figure><h3 id="4-4-根据模板编写json文件，data目录下hdfs2mysql-json文件"><a href="#4-4-根据模板编写json文件，data目录下hdfs2mysql-json文件" class="headerlink" title="4.4 根据模板编写json文件，data目录下hdfs2mysql.json文件"></a>4.4 根据模板编写json文件，data目录下hdfs2mysql.json文件</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;job&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;reader&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;hdfsreader&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;column&quot;</span>: [</span><br><span class="line">                            <span class="string">&quot;*&quot;</span></span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;defaultFS&quot;</span>: <span class="string">&quot;hdfs://192.168.33.147:9000&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;encoding&quot;</span>: <span class="string">&quot;UTF-8&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;fieldDelimiter&quot;</span>: <span class="string">&quot;|&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;fileType&quot;</span>: <span class="string">&quot;text&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/datax/keyword.txt&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="string">&quot;writer&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;mysqlwriter&quot;</span>, </span><br><span class="line">                    <span class="string">&quot;parameter&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;column&quot;</span>: [</span><br><span class="line">                            <span class="string">&quot;help_keyword_id&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;name&quot;</span></span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;connection&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="string">&quot;jdbcUrl&quot;</span>: <span class="string">&quot;jdbc:mysql://192.168.33.147:3306/mysql&quot;</span>, </span><br><span class="line">                                <span class="string">&quot;table&quot;</span>: [<span class="string">&quot;help_keyword_from_hdfs_datax&quot;</span>]</span><br><span class="line">                            &#125;</span><br><span class="line">                        ], </span><br><span class="line">                        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1&quot;</span>,  </span><br><span class="line">                        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;root&quot;</span>, </span><br><span class="line">                        <span class="string">&quot;writeMode&quot;</span>: <span class="string">&quot;insert&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ], </span><br><span class="line">        <span class="string">&quot;setting&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;speed&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;channel&quot;</span>: <span class="string">&quot;3&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-5-运行Job"><a href="#4-5-运行Job" class="headerlink" title="4.5 运行Job"></a>4.5 运行Job</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/opt/datax/bin/datax.py data/hdfs2mysql.json</span><br></pre></td></tr></table></figure><h2 id="5-DataX-Web安装"><a href="#5-DataX-Web安装" class="headerlink" title="5. DataX Web安装"></a>5. DataX Web安装</h2><h3 id="5-1-Maven安装"><a href="#5-1-Maven安装" class="headerlink" title="5.1 Maven安装"></a>5.1 Maven安装</h3><div class="note green anzhiyufont anzhiyu-icon-dove modern"><p>简介：<strong>Maven</strong>是一个跨平台的项目管理工具。作为Apache组织的一个颇为成功的开源项目，其主要服务于基于Java平台的项目创建，依赖管理和项目信息管理。maven是Apache的顶级项目，解释为“专家，内行”，它是一个项目管理的工具，maven自身是纯java开发的，可以使用maven对java项目进行构建、依赖管理。</p></div><div class="note info simple"><p>需要的安装包：<strong>1.<a href="https://archive.apache.org/dist/maven/maven-3/">Maven</a>包—-&gt;apache-maven-3.6.3-bin.tar.gz</strong><br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<strong>2.<a href="https://github.com/WeiYe-Jing/datax-web/archive/v-2.1.2.tar.gz">datax-web</a>包—-&gt;datax-web-v-2.1.2.tar.gz</strong></p></div><h4 id="5-1-1-准备工作"><a href="#5-1-1-准备工作" class="headerlink" title="5.1.1 准备工作"></a>5.1.1 准备工作</h4><h5 id="1-解压并改名"><a href="#1-解压并改名" class="headerlink" title="1. 解压并改名"></a>1. 解压并改名</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-maven-3.6.3-bin.tar.gz -C /opt/</span><br><span class="line"><span class="built_in">mv</span> apache-maven-3.6.3 maven</span><br></pre></td></tr></table></figure><h4 id="5-1-2-配置Sqoop环境变量"><a href="#5-1-2-配置Sqoop环境变量" class="headerlink" title="5.1.2 配置Sqoop环境变量"></a>5.1.2 配置Sqoop环境变量</h4><h5 id="1-配置Sqoop环境变量"><a href="#1-配置Sqoop环境变量" class="headerlink" title="1. 配置Sqoop环境变量"></a>1. 配置Sqoop环境变量</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="comment"># maven</span></span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$MAVEN_HOME</span>/bin</span><br></pre></td></tr></table></figure><h5 id="2-加载环境变量"><a href="#2-加载环境变量" class="headerlink" title="2. 加载环境变量"></a>2. 加载环境变量</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h4 id="5-1-3-修改配置"><a href="#5-1-3-修改配置" class="headerlink" title="5.1.3 修改配置"></a>5.1.3 修改配置</h4><h5 id="1-创建本地目录"><a href="#1-创建本地目录" class="headerlink" title="1. 创建本地目录"></a>1. 创建本地目录</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /opt/maven/maven_repository</span><br></pre></td></tr></table></figure><h5 id="2-配置setting-xml"><a href="#2-配置setting-xml" class="headerlink" title="2. 配置setting.xml"></a>2. 配置setting.xml</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置本地仓库地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/opt/maven/maven_repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span></span><br><span class="line">&lt;!-- 阿里云仓库 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span></span><br><span class="line">&lt;!-- <span class="title class_">Java</span>的<span class="variable constant_">JDK</span>版本 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">profile</span>&gt;</span>    </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.8<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="5-1-4-验证"><a href="#5-1-4-验证" class="headerlink" title="5.1.4 验证"></a>5.1.4 验证</h4><h5 id="1-查看版本"><a href="#1-查看版本" class="headerlink" title="1. 查看版本"></a>1. 查看版本</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mvn -version</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)</span></span><br><span class="line"><span class="string">Maven home: /opt/maven</span></span><br><span class="line"><span class="string">Java version: 1.8.0_341, vendor: Oracle Corporation, runtime: /usr/java/jdk1.8.0_341-amd64/jre</span></span><br><span class="line"><span class="string">Default locale: zh_CN, platform encoding: UTF-8</span></span><br><span class="line"><span class="string">OS name: &quot;linux&quot;, version: &quot;3.10.0-862.el7.x86_64&quot;, arch: &quot;amd64&quot;, family: &quot;unix&quot;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="2-打包jar到本地仓库（自己先准备一个jar包）"><a href="#2-打包jar到本地仓库（自己先准备一个jar包）" class="headerlink" title="2. 打包jar到本地仓库（自己先准备一个jar包）"></a>2. 打包jar到本地仓库（自己先准备一个jar包）</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mvn install:install-file -Dfile=/opt/bin/mysql-connector-java-5.1.37.jar  -DgroupId=cool.huser -DartifactId=mysql-connector -Dversion=5.1.37 -Dpackaging=jar</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">[INFO] Installing /opt/bin/mysql-connector-java-5.1.37.jar to /opt/maven/maven_repository/cool/huser/mysql-connector/5.1.37/mysql-connector-5.1.37.jar</span></span><br><span class="line"><span class="string">[INFO] Installing /tmp/mvninstall987975586380233206.pom to /opt/maven/maven_repository/cool/huser/mysql-connector/5.1.37/mysql-connector-5.1.37.pom</span></span><br><span class="line"><span class="string">[INFO] ------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">[INFO] BUILD SUCCESS</span></span><br><span class="line"><span class="string">[INFO] ------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">[INFO] Total time:  19.473 s</span></span><br><span class="line"><span class="string">[INFO] Finished at: 2022-11-02T15:09:33+08:00</span></span><br><span class="line"><span class="string">[INFO] -----</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="5-2-DataX-Web安装"><a href="#5-2-DataX-Web安装" class="headerlink" title="5.2 DataX Web安装"></a>5.2 DataX Web安装</h3><h4 id="5-2-1-准备工作"><a href="#5-2-1-准备工作" class="headerlink" title="5.2.1 准备工作"></a>5.2.1 准备工作</h4><h5 id="1-解压并改名-1"><a href="#1-解压并改名-1" class="headerlink" title="1. 解压并改名"></a>1. 解压并改名</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf datax-web-v<span class="number">-2.1</span><span class="number">.2</span>.tar.gz -C /opt/</span><br><span class="line">mv datax-web-v<span class="number">-2.1</span><span class="number">.2</span> datax-web</span><br></pre></td></tr></table></figure><h5 id="2-编译打包"><a href="#2-编译打包" class="headerlink" title="2. 编译打包"></a>2. 编译打包</h5><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">huser@master</span> <span class="string">datax-web</span>]<span class="string">$</span> <span class="string">mvn</span> <span class="string">clean</span> <span class="string">install</span></span><br><span class="line"><span class="string">‘’‘</span></span><br><span class="line">[<span class="string">INFO</span>] <span class="attr">Reactor Summary for datax-web 2.1.2:</span></span><br><span class="line">[<span class="string">INFO</span>] </span><br><span class="line">[<span class="string">INFO</span>] <span class="string">datax-web</span> <span class="string">..........................................</span> <span class="string">SUCCESS</span> [  <span class="number">2.238</span> <span class="string">s</span>]</span><br><span class="line">[<span class="string">INFO</span>] <span class="string">datax-rpc</span> <span class="string">..........................................</span> <span class="string">SUCCESS</span> [<span class="number">03</span><span class="string">:21</span> <span class="string">min</span>]</span><br><span class="line">[<span class="string">INFO</span>] <span class="string">datax-core</span> <span class="string">.........................................</span> <span class="string">SUCCESS</span> [<span class="number">03</span><span class="string">:20</span> <span class="string">min</span>]</span><br><span class="line">[<span class="string">INFO</span>] <span class="string">datax-admin</span> <span class="string">........................................</span> <span class="string">SUCCESS</span> [<span class="number">11</span><span class="string">:10</span> <span class="string">min</span>]</span><br><span class="line">[<span class="string">INFO</span>] <span class="string">datax-executor</span> <span class="string">.....................................</span> <span class="string">SUCCESS</span> [ <span class="number">13.001</span> <span class="string">s</span>]</span><br><span class="line">[<span class="string">INFO</span>] <span class="string">datax-assembly</span> <span class="string">.....................................</span> <span class="string">SUCCESS</span> [ <span class="number">10.013</span> <span class="string">s</span>]</span><br><span class="line">[<span class="string">INFO</span>] <span class="string">------------------------------------------------------------------------</span></span><br><span class="line">[<span class="string">INFO</span>] <span class="string">BUILD</span> <span class="string">SUCCESS</span></span><br><span class="line">[<span class="string">INFO</span>] <span class="string">------------------------------------------------------------------------</span></span><br><span class="line">[<span class="string">INFO</span>] <span class="attr">Total time:</span>  <span class="number">18</span><span class="string">:28</span> <span class="string">min</span></span><br><span class="line">[<span class="string">INFO</span>] <span class="attr">Finished at:</span> <span class="number">2022-11-02T15:32:04+08:00</span></span><br><span class="line">[<span class="string">INFO</span>]</span><br><span class="line"><span class="string">’‘’</span></span><br></pre></td></tr></table></figure><h4 id="5-2-2-安装部署"><a href="#5-2-2-安装部署" class="headerlink" title="5.2.2 安装部署"></a>5.2.2 安装部署</h4><h5 id="1-权限，不然不能执行"><a href="#1-权限，不然不能执行" class="headerlink" title="1. 权限，不然不能执行"></a><font color=red>1. 权限，不然不能执行</font></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> -R 777 install.sh s*</span><br></pre></td></tr></table></figure><h5 id="2-执行安装脚本"><a href="#2-执行安装脚本" class="headerlink" title="2. 执行安装脚本"></a>2. 执行安装脚本</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ ./install.sh</span><br><span class="line">’‘’</span><br><span class="line">出现以下界面说明DataX Web安装成功</span><br><span class="line">2022-11-02 15:45:37.890 [INFO] (108159)  Start to build directory</span><br><span class="line">2022-11-02 15:45:37.893 [INFO] (108159) Creating directory: [/opt/datax-web/modules/datax-executor/bin/../logs].</span><br><span class="line">2022-11-02 15:45:37.946 [INFO] (108159) Directory or file: [/opt/datax-web/modules/datax-executor/bin/../conf] has been exist</span><br><span class="line">2022-11-02 15:45:37.950 [INFO] (108159) Creating directory: [/opt/datax-web/modules/datax-executor/bin/../data].</span><br><span class="line">2022-11-02 15:45:37.989 [INFO] (108159) Creating directory: [/opt/datax-web/modules/datax-executor/bin/../json].</span><br><span class="line">2022-11-02 15:45:38.027 [INFO] (108078)  <span class="comment">####### Finish To Install Modules ######</span></span><br><span class="line">‘’‘</span><br></pre></td></tr></table></figure><h4 id="5-2-3-运行查看"><a href="#5-2-3-运行查看" class="headerlink" title="5.2.3 运行查看"></a>5.2.3 运行查看</h4><h5 id="1-启动datax-admin和datax-executor服务"><a href="#1-启动datax-admin和datax-executor服务" class="headerlink" title="1. 启动datax-admin和datax-executor服务"></a><strong>1. 启动datax-admin和datax-executor服务</strong></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ ./start-all.sh </span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-02 15:47:42.408 [INFO] (108231)  ####### Begin To Start Module: [datax-admin] ######</span></span><br><span class="line"><span class="string">2022-11-02 15:47:42.415 [INFO] (108239) load environment variables</span></span><br><span class="line"><span class="string">2022-11-02 15:47:43.091 [INFO] (108239) DATAX-ADMIN has been started in process</span></span><br><span class="line"><span class="string">2022-11-02 15:47:43.102 [INFO] (108396)  ####### Begin To Start Module: [datax-executor] ######</span></span><br><span class="line"><span class="string">2022-11-02 15:47:43.110 [INFO] (108404) load environment variables</span></span><br><span class="line"><span class="string">2022-11-02 15:47:43.592 [INFO] (108404) /usr/java/jdk1.8.0_341-amd64/bin/java</span></span><br><span class="line"><span class="string">2022-11-02 15:47:43.595 [INFO] (108404) Waiting DATAX-EXEXUTOR to start complete ...</span></span><br><span class="line"><span class="string">2022-11-02 15:48:06.153 [ERROR] (108223)  Start Modules [datax-executor] Failed!</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="2-查看启动是否成功"><a href="#2-查看启动是否成功" class="headerlink" title="2. 查看启动是否成功"></a>2. 查看启动是否成功</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">jps</span></span><br><span class="line"><span class="string">DataXExecutorApplication</span></span><br><span class="line"><span class="string">DataXAdminApplication</span></span><br><span class="line"><span class="string">Nailgun</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="3-WebUI查看-默认账号密码为：admin-123456"><a href="#3-WebUI查看-默认账号密码为：admin-123456" class="headerlink" title="3. WebUI查看,默认账号密码为：admin    123456"></a>3. WebUI查看,默认账号密码为：<strong>admin    123456</strong></h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span>huser@master bin<span class="punctuation">]</span>$ tail <span class="number">-50</span>f /opt/datax-web/modules/datax-admin/bin/console.out</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"><span class="number">16</span><span class="punctuation">:</span><span class="number">09</span><span class="punctuation">:</span><span class="number">10.035</span> admin <span class="punctuation">[</span>main<span class="punctuation">]</span> INFO  c.w.d.a.DataXAdminApplication - Access URLs<span class="punctuation">:</span></span><br><span class="line">----------------------------------------------------------</span><br><span class="line">Local-API<span class="punctuation">:</span> http<span class="punctuation">:</span><span class="comment">//127.0.0.1:9527/doc.html</span></span><br><span class="line">External-API<span class="punctuation">:</span> http<span class="punctuation">:</span><span class="comment">//192.168.33.147:9527/doc.html</span></span><br><span class="line">web-URL<span class="punctuation">:</span> http<span class="punctuation">:</span><span class="comment">//127.0.0.1:9527/index.html</span></span><br><span class="line">----------------------------------------------------------</span><br><span class="line"><span class="number">16</span><span class="punctuation">:</span><span class="number">09</span><span class="punctuation">:</span><span class="number">19.671</span> admin <span class="punctuation">[</span>http-nio<span class="number">-9527</span>-exec<span class="number">-1</span><span class="punctuation">]</span> INFO  o.a.c.c.C.<span class="punctuation">[</span>.<span class="punctuation">[</span>.<span class="punctuation">[</span>/<span class="punctuation">]</span> - Initializing Spring DispatcherServlet &#x27;dispatcherServlet&#x27;</span><br><span class="line"><span class="number">16</span><span class="punctuation">:</span><span class="number">09</span><span class="punctuation">:</span><span class="number">19.672</span> admin <span class="punctuation">[</span>http-nio<span class="number">-9527</span>-exec<span class="number">-1</span><span class="punctuation">]</span> INFO  o.s.w.s.DispatcherServlet - Initializing Servlet &#x27;dispatcherServlet&#x27;</span><br><span class="line"><span class="number">16</span><span class="punctuation">:</span><span class="number">09</span><span class="punctuation">:</span><span class="number">19.686</span> admin <span class="punctuation">[</span>http-nio<span class="number">-9527</span>-exec<span class="number">-1</span><span class="punctuation">]</span> INFO  o.s.w.s.DispatcherServlet - Completed initialization in <span class="number">14</span> ms</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>datax-web</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7lZ96.png" alt="datax-web" title="datax-web"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十三、Spark组件搭建之Scala环境搭建(一)</title>
      <link href="/posts/411e35e9.html"/>
      <url>/posts/411e35e9.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-inbox modern"><p>简介: 是一种多范式的编程语言，其设计的初衷是要集成面向对象编程和函数式编程的各种特性 。Scala 运 行 于Java平台（ Java 虚 拟 机 ）， 并 兼 容 现 有 的 Java 程 序 。</p></div><div class="tip error"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note success simple"><p>需要的安装包：<a href="https://www.scala-lang.org/download/2.11.12.html"><strong>Scala</strong></a>压缩包——&gt;<strong>scala-2.12.8.tgz</strong></p></div><h2 id="1-解压并改名"><a href="#1-解压并改名" class="headerlink" title="1. 解压并改名"></a>1. 解压并改名</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf scala<span class="number">-2.12</span><span class="number">.8</span>.tgz -C /opt/</span><br><span class="line">mv scala<span class="number">-2.12</span><span class="number">.8</span> scala</span><br></pre></td></tr></table></figure><h2 id="2-配置Scala环境变量"><a href="#2-配置Scala环境变量" class="headerlink" title="2. 配置Scala环境变量"></a>2. 配置Scala环境变量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="meta"># scala</span></span><br><span class="line"><span class="keyword">export</span> SCALA_HOME=/opt/kafka</span><br><span class="line"><span class="keyword">export</span> PATH=$PATH:$SCALA_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-拷贝到slave1和slave2节点"><a href="#2-3-拷贝到slave1和slave2节点" class="headerlink" title="2.3 拷贝到slave1和slave2节点"></a>2.3 拷贝到slave1和slave2节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/<span class="function">profile  <span class="title">slave2</span><span class="params">(slave1)</span>:/etc/profile</span></span><br></pre></td></tr></table></figure><h2 id="3-验证安装是否成功"><a href="#3-验证安装是否成功" class="headerlink" title="3. 验证安装是否成功"></a>3. 验证安装是否成功</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">scala</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Welcome to Scala 2.12.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_341).</span></span><br><span class="line"><span class="string">Type in expressions for evaluation. Or try :help.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">scala&gt; 11+6</span></span><br><span class="line"><span class="string">res0: Int = 17</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">scala&gt; 5</span></span><br><span class="line"><span class="string">res1: Int = 5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十三、Spark组件搭建之HA-Spark集群环境搭建(Yarn模式)(五)</title>
      <link href="/posts/924eec38.html"/>
      <url>/posts/924eec38.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-shapes modern"><p>简介: <a href="https://so.csdn.net/so/search?q=Spark&amp;spm=1001.2101.3001.7020"><strong>Spark</strong></a>客户端直接连接Yarn，不需要额外构建Spark集群。有yarn-client和yarn-cluster两种模式，主要区别在于：Driver程序的运行节点。<br><a href="https://so.csdn.net/so/search?q=yarn&amp;spm=1001.2101.3001.7020"><strong>yarn</strong></a>-client：Driver程序运行在客户端，适用于交互、调试，希望立即看到app的输出。</p></div><div class="tip bolt"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B(%E4%B8%89)Spark%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA(Standalone%E6%A8%A1%E5%BC%8F)%5D(https:/www.yuque.com/u25360462/nt1ri1/fchs9onh27cscex1?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7M9dh.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">十三、Spark组件搭建之Spark集群环境搭建(Standalone模式)(三)</div>            <div class="tag-link-sitename">简介:SparkStandalone是**Master-Slaves架构的集群模式**，和大部分的Master-Slaves结构集群类似，都存在着Master单点故障的问题。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B(%E5%9B%9B)HA-Spark%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA(Standalone%E6%A8%A1%E5%BC%8F)%5D(https:/www.yuque.com/u25360462/nt1ri1/drrs4br8o8b4q51g?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MWsm.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">十三、Spark组件搭建之HA-Spark集群环境搭建(Standalone模式)(四)</div>            <div class="tag-link-sitename">简介:SparkStandalone是**Master-Slaves架构的集群模式**，和大部分的Master-Slaves结构集群类似，都存在着Master单点故障的问题。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="1-集群配置"><a href="#1-集群配置" class="headerlink" title="1. 集群配置"></a>1. 集群配置</h2><h3 id="1-1-配置spark-env-sh-SPARK-HOME-conf-目录下"><a href="#1-1-配置spark-env-sh-SPARK-HOME-conf-目录下" class="headerlink" title="1.1 配置spark-env.sh,${SPARK_HOME}/conf/目录下"></a>1.1 配置<strong>spark-env.sh</strong>,<code>$&#123;SPARK_HOME&#125;/conf/</code>目录下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 添加:</span><br><span class="line"><span class="keyword">export</span> JAVA_HOME=/usr/java/jdk1<span class="number">.8</span><span class="number">.0</span>_341-amd64</span><br><span class="line"><span class="keyword">export</span> SCALA_HOME=/opt/scala</span><br><span class="line">YARN_CONF_DIR=/opt/hadoop/etc/hadoop</span><br><span class="line"><span class="keyword">export</span> SPARK_HISTORY_OPTS=<span class="string">&quot;-Dspark.history.ui.port=18080 -Dspark.history.retainedApplications=24 -Dspark.history.fs.logDirectory=hdfs://master:9000/spark-jobhistory&quot;</span></span><br><span class="line"><span class="keyword">export</span> SPARK_DAEMON_JAVA_OPTS=<span class="string">&quot;-Dspark.deploy.recoveryMode=ZOOKEEPER -Dspark.deploy.zookeeper.url=master:2181,slave1:2181,slave2:2181 -Dspark.deploy.zookeeper.dir=/opt/spark/data/&quot;</span></span><br></pre></td></tr></table></figure><h3 id="1-2-配置spark-defaults-conf"><a href="#1-2-配置spark-defaults-conf" class="headerlink" title="1.2 配置spark-defaults.conf"></a>1.2 <strong>配置spark-defaults.conf</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># spark.master                     spark:<span class="comment">//master:7077</span></span></span><br><span class="line">spark.master                     spark:<span class="comment">//master:7077,slave1:7077</span></span><br><span class="line">spark.eventLog.enabled           <span class="literal">true</span></span><br><span class="line">spark.eventLog.dir               hdfs:<span class="comment">//master:9000/spark-jobhistory</span></span><br><span class="line">spark.yarn.historyServer.address               master:<span class="number">18080</span></span><br></pre></td></tr></table></figure><h3 id="1-3-配置workers-lt-font-color-red-gt-（如果配置，可以跳过）-lt-font-gt"><a href="#1-3-配置workers-lt-font-color-red-gt-（如果配置，可以跳过）-lt-font-gt" class="headerlink" title="1.3 配置workers&lt;/font color=red&gt;（如果配置，可以跳过）&lt;/font&gt;"></a>1.3 <strong>配置workers</strong>&lt;/font color=red&gt;（如果配置，可以跳过）&lt;/font&gt;</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="1-4-配置hadoop的yarn-site-xml"><a href="#1-4-配置hadoop的yarn-site-xml" class="headerlink" title="1.4 配置hadoop的yarn-site.xml"></a>1.4 <strong>配置hadoop的yarn-site.xml</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 由于测试环境的虚拟机内存太少, 防止将来任务被意外杀死, 做如下配置 --&gt;</span><br><span class="line">&lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是<span class="literal">true</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是<span class="literal">true</span> --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-5-拷贝到slave1和slave2节点"><a href="#1-5-拷贝到slave1和slave2节点" class="headerlink" title="1.5 拷贝到slave1和slave2节点"></a>1.5 拷贝到slave1和slave2节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/spark/<span class="function">conf  <span class="title">slave2</span><span class="params">(slave1)</span>:/opt/spark/</span></span><br><span class="line"><span class="function">sudo scp -r /opt/hadoop/etc/hadoop/yarn-site.xml  slave2(slave1):/opt/hadoop/etc/hadoop/</span></span><br></pre></td></tr></table></figure><h2 id="2-启动群集"><a href="#2-启动群集" class="headerlink" title="2. 启动群集"></a>2. 启动群集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ HA-spark-allstart.sh(脚本)</span><br><span class="line">-------------------------&lt;-- <span class="string">&#x27;或者&#x27;</span> --&gt;-------------------------</span><br><span class="line"><span class="comment"># 启动ha-hadoop集群</span></span><br><span class="line">[huser@master bin]$ ./startdfs.sh(脚本)</span><br><span class="line"><span class="comment"># 在master启动spark集群</span></span><br><span class="line">[huser@master sbin]$ ./start-all.sh</span><br><span class="line"><span class="comment"># 在slave1上启动备Master</span></span><br><span class="line">[huser@slave1 sbin]$ ./start-master.sh</span><br><span class="line"><span class="comment"># 在master上启动任务历史服务器</span></span><br><span class="line">[huser@master sbin]$ ./start-history-server.sh</span><br></pre></td></tr></table></figure><h2 id="3-查看集群"><a href="#3-查看集群" class="headerlink" title="3. 查看集群"></a>3. 查看集群</h2><h3 id="3-1-jps进程查看"><a href="#3-1-jps进程查看" class="headerlink" title="3.1 jps进程查看"></a>3.1 jps进程查看</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">-----------master jps--------------</span><br><span class="line"><span class="number">27136</span> Master</span><br><span class="line"><span class="number">24961</span> QuorumPeerMain</span><br><span class="line"><span class="number">25937</span> NodeManager</span><br><span class="line"><span class="number">25587</span> JournalNode</span><br><span class="line"><span class="number">27203</span> Worker</span><br><span class="line"><span class="number">26149</span> JobHistoryServer</span><br><span class="line"><span class="number">27591</span> Jps</span><br><span class="line"><span class="number">25209</span> NameNode</span><br><span class="line"><span class="number">25785</span> DFSZKFailoverController</span><br><span class="line"><span class="number">25342</span> DataNode</span><br><span class="line">-----------slave1 jps--------------</span><br><span class="line"><span class="number">14130</span> Worker</span><br><span class="line"><span class="number">14195</span> Master</span><br><span class="line"><span class="number">14307</span> Jps</span><br><span class="line"><span class="number">12982</span> DataNode</span><br><span class="line"><span class="number">13190</span> DFSZKFailoverController</span><br><span class="line"><span class="number">12791</span> QuorumPeerMain</span><br><span class="line"><span class="number">13431</span> NodeManager</span><br><span class="line"><span class="number">13085</span> JournalNode</span><br><span class="line"><span class="number">12894</span> NameNode</span><br><span class="line"><span class="number">13342</span> ResourceManager</span><br><span class="line">-----------slave2 jps--------------</span><br><span class="line"><span class="number">14016</span> ResourceManager</span><br><span class="line"><span class="number">14818</span> Jps</span><br><span class="line"><span class="number">13638</span> DFSZKFailoverController</span><br><span class="line"><span class="number">13431</span> DataNode</span><br><span class="line"><span class="number">14679</span> Worker</span><br><span class="line"><span class="number">13534</span> JournalNode</span><br><span class="line"><span class="number">14142</span> NodeManager</span><br><span class="line"><span class="number">13247</span> QuorumPeerMain</span><br><span class="line"><span class="number">13343</span> NameNode</span><br></pre></td></tr></table></figure><h3 id="3-2-Web-UI查看"><a href="#3-2-Web-UI查看" class="headerlink" title="3.2 Web UI查看"></a>3.2 Web UI查看</h3><p>查看master日志信息<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@master sbin]$ <span class="built_in">cat</span> /opt/spark/logs/spark-huser-org.apache.spark.deploy.master.Master-1-master.out | grep MasterWebUI</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">22/11/08 16:37:29 INFO MasterWebUI: Bound MasterWebUI to 0.0.0.0, and started at http://master:8081</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>通过启动日志可以看到master的MasterWebUI的端口号为8081</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--master--MasterWebUI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MKeQ.png" alt="HA-spark--Standalone--master--MasterWebUI" title="HA-spark--Standalone--master--MasterWebUI"></p><p>查看slave1日志信息<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 sbin]$ cat /opt/spark/logs/spark-huser-org.apache.spark.deploy.master.Master<span class="number">-1</span>-slave1.out | grep MasterWebUI</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">22</span>/<span class="number">11</span>/<span class="number">08</span> <span class="number">16</span>:<span class="number">37</span>:<span class="number">39</span> INFO MasterWebUI: Bound MasterWebUI to <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>, <span class="keyword">and</span> started at http:<span class="comment">//slave1:8082</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>通过启动日志可以看到slave1的MasterWebUI的端口号为8082</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--slave1--MasterWebUI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MUTt.png" alt="HA-spark--Standalone--slave1--MasterWebUI" title="HA-spark--Standalone--slave1--MasterWebUI"></p><p>master上的任务历史服务器端口号为18080</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--master--MasterWebUI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7M6fC.png" alt="HA-spark--Standalone--master--HistoryServer" title="HA-spark--Standalone--master--HistoryServer"></p><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BHA-Spark%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA(Yarn%E6%A8%A1%E5%BC%8F)-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%5D(https:/mp.weixin.qq.com/s/qOWSgXY8y7Lk0JOELoie_Q)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MgKu.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">HA-Spark集群环境搭建(Yarn模式)</div>            <div class="tag-link-sitename">HA-Spark集群环境搭建(Yarn模式)-视频教程</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="4-计算-PI"><a href="#4-计算-PI" class="headerlink" title="4. 计算 PI"></a>4. 计算 PI</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[huser@master spark]$ bin/spark-submit --master yarn --class org.apache.spark.examples.SparkPi /opt/spark/examples/jars/spark-examples_2.12-3.1.3.jar 1000</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--executor-memory 1G 指定每个executor可用内存为1G</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--total-executor-cores 8 指定所有executor使用的cpu核数为8个</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--executor-cores 2 表示每个executor使用的 cpu 的核数</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Pi is roughly 3.1415244714152446</span></span><br><span class="line"><span class="string">2022-11-09 16:55:36,024 INFO server.AbstractConnector: Stopped Spark@182b435b&#123;HTTP/1.1, (http/1.1)&#125;&#123;0.0.0.0:4040&#125;</span></span><br><span class="line"><span class="string">2022-11-09 16:55:36,059 INFO ui.SparkUI: Stopped Spark web UI at http://master:4040</span></span><br><span class="line"><span class="string">2022-11-09 16:55:36,111 INFO cluster.YarnClientSchedulerBackend: Interrupting monitor thread</span></span><br><span class="line"><span class="string">2022-11-09 16:55:36,353 INFO cluster.YarnClientSchedulerBackend: Shutting down all executors</span></span><br><span class="line"><span class="string">2022-11-09 16:55:36,353 INFO cluster.YarnSchedulerBackend$YarnDriverEndpoint: Asking each executor to shut down</span></span><br><span class="line"><span class="string">2022-11-09 16:55:36,447 INFO cluster.YarnClientSchedulerBackend: YARN client scheduler backend Stopped</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,420 INFO spark.MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,529 INFO memory.MemoryStore: MemoryStore cleared</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,530 INFO storage.BlockManager: BlockManager stopped</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,585 INFO storage.BlockManagerMaster: BlockManagerMaster stopped</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,596 INFO scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,615 INFO spark.SparkContext: Successfully stopped SparkContext</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,691 INFO util.ShutdownHookManager: Shutdown hook called</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,691 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-6860512e-a45c-4717-b9a4-5eb730761572</span></span><br><span class="line"><span class="string">2022-11-09 16:55:37,728 INFO util.ShutdownHookManager: Deleting directory /tmp/spark-b5d11fa0-c090-4ef7-b1fb-5d8fb95e7edd</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>报错：<br><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BSpark%20%E5%BC%82%E5%B8%B8%E6%80%BB%E7%BB%93%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95_%E7%81%B5%E4%BD%91666%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%5D(https:/blog.csdn.net/onway_goahead/article/details/107688786?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-5-107688786-blog-107319283.pc_relevant_3mothn_strategy_recovery&spm=1001.2101.3001.4242.4&utm_relevant_index=7)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7M7Bo.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Spark 异常总结及解决办法</div>            <div class="tag-link-sitename">前言总结Spark开发中遇到的异常及解决办法，之前也写过几篇，之所以不再一个异常写一篇博客，是因为现在Spark</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div></p><p>WebUI查看应用执行资源分配情况：</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone(yarn)--master--MasterWebUI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MrFv.png" alt="HA-spark--Standalone(yarn)--master--MasterWebUI" title="HA-spark--Standalone(yarn)--master--MasterWebUI"></p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone(yarn)--slave1--yarn</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MVnE.png" alt="HA-spark--Standalone(yarn)--slave1--yarn" title="HA-spark--Standalone(yarn)--slave1--yarn"></p><p>最终计算结果如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">469</span> INFO scheduler.TaskSetManager: Finished task <span class="number">997.0</span> in stage <span class="number">0.0</span> (TID <span class="number">997</span>) in <span class="number">35</span> <span class="function">ms on <span class="title">master</span> <span class="params">(executor <span class="number">2</span>)</span> <span class="params">(<span class="number">998</span>/<span class="number">1000</span>)</span></span></span><br><span class="line"><span class="function">2022-11-09 18:<span class="number">22</span>:<span class="number">38</span>,<span class="number">469</span> INFO scheduler.TaskSetManager: Finished task <span class="number">998.0</span> in stage <span class="number">0.0</span> (TID <span class="number">998</span>) in <span class="number">21</span> ms on slave2 (executor <span class="number">1</span>) (<span class="number">999</span>/<span class="number">1000</span>)</span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">500</span> INFO scheduler.TaskSetManager: Finished task <span class="number">999.0</span> in stage <span class="number">0.0</span> (TID <span class="number">999</span>) in <span class="number">36</span> ms on master (executor <span class="number">2</span>) (<span class="number">1000</span>/<span class="number">1000</span>)</span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">506</span> INFO scheduler.DAGScheduler: ResultStage <span class="number">0</span> (reduce at SparkPi.scala:<span class="number">38</span>) finished in <span class="number">28.572</span> s</span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">501</span> INFO cluster.YarnScheduler: Removed TaskSet <span class="number">0.0</span>, whose tasks have all completed, from pool </span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">546</span> INFO scheduler.DAGScheduler: Job <span class="number">0</span> is finished. Cancelling potential speculative or zombie tasks for this job</span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">552</span> INFO cluster.YarnScheduler: Killing all running tasks in stage <span class="number">0</span>: Stage finished</span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">570</span> INFO scheduler.DAGScheduler: Job <span class="number">0</span> finished: reduce at SparkPi.scala:<span class="number">38</span>, took <span class="number">29.256770</span> s</span></span><br><span class="line"><span class="function">Pi is roughly <span class="number">3.14160799141608</span></span></span><br><span class="line"><span class="function"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">756</span> INFO server.AbstractConnector: Stopped Spark@<span class="number">182b</span>435b&#123;</span>HTTP/<span class="number">1.1</span>, (http/<span class="number">1.1</span>)&#125;&#123;<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">4040</span>&#125;</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">768</span> INFO ui.SparkUI: Stopped Spark web UI at http:<span class="comment">//master:4040</span></span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">804</span> INFO cluster.YarnClientSchedulerBackend: Interrupting monitor thread</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">889</span> INFO cluster.YarnClientSchedulerBackend: Shutting down all executors</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">890</span> INFO cluster.YarnSchedulerBackend$YarnDriverEndpoint: Asking each executor to shut down</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">38</span>,<span class="number">915</span> INFO cluster.YarnClientSchedulerBackend: YARN client scheduler backend Stopped</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">558</span> INFO spark.MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">792</span> INFO memory.MemoryStore: MemoryStore cleared</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">797</span> INFO storage.BlockManager: BlockManager stopped</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">818</span> INFO storage.BlockManagerMaster: BlockManagerMaster stopped</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">830</span> INFO scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">900</span> INFO spark.SparkContext: Successfully stopped SparkContext</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">931</span> INFO util.ShutdownHookManager: Shutdown hook called</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">932</span> INFO util.ShutdownHookManager: Deleting directory /tmp/spark<span class="number">-93</span>c34fa9-d1bb<span class="number">-4574</span>-a749<span class="number">-68424b</span>2b6b52</span><br><span class="line"><span class="number">2022</span><span class="number">-11</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">22</span>:<span class="number">39</span>,<span class="number">936</span> INFO util.ShutdownHookManager: Deleting directory /tmp/spark<span class="number">-2726b</span>04f<span class="number">-7</span>a71<span class="number">-44</span>d0<span class="number">-91</span>ce-a027bb47ea76</span><br></pre></td></tr></table></figure></p><p><strong>通过slave1上YARN的8088可以查看历史任务</strong></p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone(yarn)--slave1--yarn</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MYzY.png" alt="HA-spark--Standalone(yarn)--slave1--yarn" title="HA-spark--Standalone(yarn)--slave1--yarn"></p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone(yarn)--slave1--HistoryServer</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MhB9.png" alt="HA-spark--Standalone(yarn)--slave1--HistoryServer" title="HA-spark--Standalone(yarn)--slave1--HistoryServer"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十三、Spark组件搭建之HA-Spark集群环境搭建(Standalone模式)(四)</title>
      <link href="/posts/1ec96998.html"/>
      <url>/posts/1ec96998.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-shapes modern"><p>简介:SparkStandalone是<strong>Master-Slaves架构的集群模式</strong>，和大部分的Master-Slaves结构集群类似，都存在着Master单点故障的问题。</p><ul><li>spark的集群主要有三种运行模式<a href="https://cn.bing.com/search?q=sparkstandalone%E6%A8%A1%E5%BC%8F&amp;qs=n&amp;form=QBRE&amp;sp=-1&amp;pq=sparkstandalone%E6%A8%A1%E5%BC%8F&amp;sc=0-17&amp;sk=&amp;cvid=D98F9B81667C42C1A400D5113697851B&amp;ghsh=0&amp;ghacc=0&amp;ghpl="><strong>standalone</strong></a><strong>、</strong><a href="yarn"><strong>yarn</strong></a><strong>、</strong><a href="https://blog.csdn.net/chikoucha6215/article/details/100855233?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166784048216782417079675%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166784048216782417079675&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-100855233-null-null.142^v63^pc_rank_34_queryrelevant25,201^v3^control_1,213^v1^control&amp;utm_term=mesos&amp;spm=1018.2226.3001.4187"><strong>mesos</strong></a>，其中常被使用的是standalone和yarn</li><li>standalone模式，是spark自己实现的，它是一个资源调度<a href="https://so.csdn.net/so/search?q=%E6%A1%86%E6%9E%B6&amp;spm=1001.2101.3001.7020">框架</a>。</li><li>spark应用程序有一个Driver驱动，Driver可以运行在Client上也可以运行在master上。如果你使用spark-shell去提交job的话它会是运行在master上的，如果你使用spark-submit或者IDEA开发工具方式运行，那么它是运行在Client上的。这样我们知道了，Client的主体作用就是运行Driver。而master除了资源调度的作用还可以运行Driver。</li></ul></div><div class="tip bolt"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B(%E4%B8%89)Spark%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA(Standalone%E6%A8%A1%E5%BC%8F)%5D(https:/www.yuque.com/u25360462/nt1ri1/fchs9onh27cscex1?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7M9dh.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">十三、Spark组件搭建之Spark集群环境搭建(Standalone模式)(三)</div>            <div class="tag-link-sitename">简介:SparkStandalone是**Master-Slaves架构的集群模式**，和大部分的Master-Slaves结构集群类似，都存在着Master单点故障的问题。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="1-集群配置"><a href="#1-集群配置" class="headerlink" title="1. 集群配置"></a>1. 集群配置</h2><h3 id="1-1-配置spark-env-sh-SPARK-HOME-conf-目录下"><a href="#1-1-配置spark-env-sh-SPARK-HOME-conf-目录下" class="headerlink" title="1.1 配置spark-env.sh,${SPARK_HOME}/conf/ 目录下"></a>1.1 <strong>配置spark-env.sh</strong>,<code>$&#123;SPARK_HOME&#125;/conf/</code> 目录下</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> JAVA_HOME=/usr/java/jdk1<span class="number">.8</span><span class="number">.0</span>_341-amd64</span><br><span class="line"># 添加:</span><br><span class="line"><span class="keyword">export</span> SCALA_HOME=/opt/scala</span><br><span class="line"><span class="keyword">export</span> SPARK_HISTORY_OPTS=<span class="string">&quot;-Dspark.history.ui.port=18080 -Dspark.history.retainedApplications=24 -Dspark.history.fs.logDirectory=hdfs://master:9000/spark-jobhistory&quot;</span></span><br><span class="line"><span class="keyword">export</span> SPARK_DAEMON_JAVA_OPTS=<span class="string">&quot;-Dspark.deploy.recoveryMode=ZOOKEEPER -Dspark.deploy.zookeeper.url=master:2181,slave1:2181,slave2:2181 -Dspark.deploy.zookeeper.dir=/opt/spark/data/&quot;</span></span><br></pre></td></tr></table></figure><h3 id="1-2-配置spark-defaults-conf"><a href="#1-2-配置spark-defaults-conf" class="headerlink" title="1.2 配置spark-defaults.conf"></a>1.2 <strong>配置spark-defaults.conf</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># spark.master                     spark:<span class="comment">//master:7077</span></span></span><br><span class="line">spark.master                     spark:<span class="comment">//master:7077,slave1:7077</span></span><br><span class="line">spark.eventLog.enabled           <span class="literal">true</span></span><br><span class="line">spark.eventLog.dir               hdfs:<span class="comment">//master:9000/spark-jobhistory</span></span><br></pre></td></tr></table></figure><h3 id="1-3-配置workers（如果配置，可以跳过）"><a href="#1-3-配置workers（如果配置，可以跳过）" class="headerlink" title="1.3 配置workers（如果配置，可以跳过）"></a>1.3 <strong>配置workers</strong><font color=red>（如果配置，可以跳过）</font></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="1-4-拷贝到slave1和slave2节点"><a href="#1-4-拷贝到slave1和slave2节点" class="headerlink" title="1.4 拷贝到slave1和slave2节点"></a>1.4 拷贝到slave1和slave2节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/spark/<span class="function">conf  <span class="title">slave2</span><span class="params">(slave1)</span>:/opt/spark/</span></span><br></pre></td></tr></table></figure><h2 id="2-启动群集"><a href="#2-启动群集" class="headerlink" title="2. 启动群集"></a>2. 启动群集</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">huser@master</span> <span class="string">bin</span>]<span class="string">$</span> <span class="string">HA-spark-allstart.sh(脚本)</span></span><br><span class="line"><span class="string">-------------------------&lt;--</span> <span class="string">&#x27;或者&#x27;</span> <span class="string">--&gt;-------------------------</span></span><br><span class="line"><span class="comment"># 启动ha-hadoop集群</span></span><br><span class="line">[<span class="string">huser@master</span> <span class="string">bin</span>]<span class="string">$</span> <span class="string">./startdfs.sh(脚本)</span></span><br><span class="line"><span class="comment"># 在master启动spark集群</span></span><br><span class="line">[<span class="string">huser@master</span> <span class="string">sbin</span>]<span class="string">$</span> <span class="string">./start-all.sh</span></span><br><span class="line"><span class="comment"># 在slave1上启动备Master</span></span><br><span class="line">[<span class="string">huser@slave1</span> <span class="string">sbin</span>]<span class="string">$</span> <span class="string">./start-master.sh</span></span><br><span class="line"><span class="comment"># 在master上启动任务历史服务器</span></span><br><span class="line">[<span class="string">huser@master</span> <span class="string">sbin</span>]<span class="string">$</span> <span class="string">./start-history-server.sh</span></span><br></pre></td></tr></table></figure><h2 id="3-查看集群"><a href="#3-查看集群" class="headerlink" title="3. 查看集群"></a>3. 查看集群</h2><h3 id="3-1-jps进程查看"><a href="#3-1-jps进程查看" class="headerlink" title="3.1 jps进程查看"></a>3.1 jps进程查看</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-----------master jps--------------</span><br><span class="line"><span class="number">125346</span> DataNode</span><br><span class="line"><span class="number">124965</span> QuorumPeerMain</span><br><span class="line"><span class="number">125591</span> JournalNode</span><br><span class="line"><span class="number">125959</span> NodeManager</span><br><span class="line"><span class="number">126360</span> Worker</span><br><span class="line"><span class="number">126267</span> Master</span><br><span class="line"><span class="number">125213</span> NameNode</span><br><span class="line"><span class="number">126477</span> HistoryServer</span><br><span class="line"><span class="number">126541</span> Jps</span><br><span class="line"><span class="number">126172</span> JobHistoryServer</span><br><span class="line"><span class="number">125790</span> DFSZKFailoverController</span><br><span class="line">-----------slave1 jps--------------</span><br><span class="line"><span class="number">95617</span> DataNode</span><br><span class="line"><span class="number">96464</span> Worker</span><br><span class="line"><span class="number">96547</span> Master</span><br><span class="line"><span class="number">95429</span> QuorumPeerMain</span><br><span class="line"><span class="number">95957</span> ResourceManager</span><br><span class="line"><span class="number">95828</span> DFSZKFailoverController</span><br><span class="line"><span class="number">95723</span> JournalNode</span><br><span class="line"><span class="number">96619</span> Jps</span><br><span class="line"><span class="number">96042</span> NodeManager</span><br><span class="line"><span class="number">95532</span> NameNode</span><br><span class="line">-----------slave2 jps--------------</span><br><span class="line"><span class="number">92272</span> DataNode</span><br><span class="line"><span class="number">92483</span> DFSZKFailoverController</span><br><span class="line"><span class="number">93190</span> Worker</span><br><span class="line"><span class="number">92984</span> NodeManager</span><br><span class="line"><span class="number">92091</span> QuorumPeerMain</span><br><span class="line"><span class="number">92187</span> NameNode</span><br><span class="line"><span class="number">93259</span> Jps</span><br><span class="line"><span class="number">92378</span> JournalNode</span><br><span class="line"><span class="number">92860</span> ResourceManager</span><br></pre></td></tr></table></figure><h3 id="3-2-Web-UI查看"><a href="#3-2-Web-UI查看" class="headerlink" title="3.2 Web UI查看"></a>3.2 Web UI查看</h3><p>查看master日志信息<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@master sbin]$ cat /opt/spark/logs/spark-huser-org.apache.spark.deploy.master.Master<span class="number">-1</span>-master.out | grep MasterWebUI</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">22</span>/<span class="number">11</span>/<span class="number">08</span> <span class="number">16</span>:<span class="number">37</span>:<span class="number">29</span> INFO MasterWebUI: Bound MasterWebUI to <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>, <span class="keyword">and</span> started at http:<span class="comment">//master:8081</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>通过启动日志可以看到master的MasterWebUI的端口号为8081</p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--master--MasterWebUI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MwKT.png" alt="HA-spark--Standalone--master--MasterWebUI" title="HA-spark--Standalone--master--MasterWebUI"></p><p>查看slave1日志信息<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 sbin]$ cat /opt/spark/logs/spark-huser-org.apache.spark.deploy.master.Master<span class="number">-1</span>-slave1.out | grep MasterWebUI</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">22</span>/<span class="number">11</span>/<span class="number">08</span> <span class="number">16</span>:<span class="number">37</span>:<span class="number">39</span> INFO MasterWebUI: Bound MasterWebUI to <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>, <span class="keyword">and</span> started at http:<span class="comment">//slave1:8082</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>通过启动日志可以看到slave1的MasterWebUI的端口号为8082</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--slave1--MasterWebUI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MQiK.png" alt="HA-spark--Standalone--slave1--MasterWebUI" title="HA-spark--Standalone--slave1--MasterWebUI"></p><p>master上的任务历史服务器端口号为18080</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--master--HistoryServer</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MNF1.png" alt="HA-spark--Standalone--master--HistoryServer" title="HA-spark--Standalone--master--HistoryServer"></p><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="https://vip.helloimg.com/images/2023/12/18/o7Mpzb.jpg">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="">          <i class="anzhiyufont anzhiyu-icon-link" style=""></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">HA-Spark集群环境搭建(Standalone模式)</div>            <div class="tag-link-sitename">HA-Spark集群环境搭建(Standalone模式)-视频教程[HA-Spark集群环境搭建(Standalone模式)-视频教程](https://mp.weixin.qq.com/s/9EBu5GD_jHUoLfOL3mntvA)</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="4-计算-PI"><a href="#4-计算-PI" class="headerlink" title="4. 计算 PI"></a>4. 计算 PI</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[huser@master spark]$ bin/spark-submit --master spark://master:7077,slave1:7077,slave2:7077 --executor-memory 1G --total-executor-cores 2 --executor-cores 1 --class org.apache.spark.examples.SparkPi /opt/spark/examples/jars/spark-examples_2.12-3.1.3.jar 10000</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--executor-memory 1G 指定每个executor可用内存为1G</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--total-executor-cores 8 指定所有executor使用的cpu核数为8个</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--executor-cores 2 表示每个executor使用的 cpu 的核数</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Endpoint stopped!</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO MemoryStore: MemoryStore cleared</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO BlockManager: BlockManager stopped</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO BlockManagerMaster: BlockManagerMaster stopped</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO SparkContext: Successfully stopped SparkContext</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO ShutdownHookManager: Shutdown hook called</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-7a0bd8da-0f5f-43a2-adeb-6c48c3169cdc</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-ba12bd46-aaa1-4b2a-9a25-111bb963027c</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>报错：<br><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BSpark%20%E5%BC%82%E5%B8%B8%E6%80%BB%E7%BB%93%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95_%E7%81%B5%E4%BD%91666%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%5D(https:/blog.csdn.net/onway_goahead/article/details/107688786?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-5-107688786-blog-107319283.pc_relevant_3mothn_strategy_recovery&spm=1001.2101.3001.4242.4&utm_relevant_index=7)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7M7Bo.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Spark 异常总结及解决办法</div>            <div class="tag-link-sitename">前言总结Spark开发中遇到的异常及解决办法，之前也写过几篇，之所以不再一个异常写一篇博客，是因为现在Spark</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div></p><p>WebUI查看应用执行资源分配情况：</p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--master--PI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MDsD.png" alt="HA-spark--Standalone--master--PI" title="HA-spark--Standalone--master--PI"></p><font color=#425aef weight=bold style='display: flex; justify-content: center; align-items: center;'>HA-spark--Standalone--slave1--PI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MIvS.png" alt="HA-spark--Standalone--slave1--PI" title="HA-spark--Standalone--slave1--PI"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十三、Spark组件搭建之Spark集群环境搭建(Standalone模式)(三)</title>
      <link href="/posts/e1fbbea6.html"/>
      <url>/posts/e1fbbea6.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-shapes modern"><p>简介:SparkStandalone是<strong>Master-Slaves架构的集群模式</strong>，和大部分的Master-Slaves结构集群类似，都存在着Master单点故障的问题。</p><ul><li>spark的集群主要有三种运行模式<a href="https://cn.bing.com/search?q=sparkstandalone%E6%A8%A1%E5%BC%8F&amp;qs=n&amp;form=QBRE&amp;sp=-1&amp;pq=sparkstandalone%E6%A8%A1%E5%BC%8F&amp;sc=0-17&amp;sk=&amp;cvid=D98F9B81667C42C1A400D5113697851B&amp;ghsh=0&amp;ghacc=0&amp;ghpl="><strong>standalone</strong></a><strong>、</strong><a href="yarn"><strong>yarn</strong></a><strong>、</strong><a href="https://blog.csdn.net/chikoucha6215/article/details/100855233?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166784048216782417079675%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166784048216782417079675&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-100855233-null-null.142^v63^pc_rank_34_queryrelevant25,201^v3^control_1,213^v1^control&amp;utm_term=mesos&amp;spm=1018.2226.3001.4187"><strong>mesos</strong></a>，其中常被使用的是standalone和yarn</li><li>standalone模式，是spark自己实现的，它是一个资源调度<a href="https://so.csdn.net/so/search?q=%E6%A1%86%E6%9E%B6&amp;spm=1001.2101.3001.7020">框架</a>。</li><li>spark应用程序有一个Driver驱动，Driver可以运行在Client上也可以运行在master上。如果你使用spark-shell去提交job的话它会是运行在master上的，如果你使用spark-submit或者IDEA开发工具方式运行，那么它是运行在Client上的。这样我们知道了，Client的主体作用就是运行Driver。而master除了资源调度的作用还可以运行Driver。</li></ul></div><div class="tip bolt"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note warning simple"><p><strong>[</strong>Spark<strong>](<a href="https://spark.apache.org/downloads.html)压缩包----&gt;spark-3.1.3-bin-hadoop3.2.tgz">https://spark.apache.org/downloads.html)压缩包----&gt;spark-3.1.3-bin-hadoop3.2.tgz</a></strong></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1 解压并改名"></a>1.1 解压并改名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf spark-3.1.3-bin-hadoop3.2.tgz -C /opt/</span><br><span class="line"><span class="built_in">mv</span> spark-3.1.3-bin-hadoop3.2 spark</span><br></pre></td></tr></table></figure><h2 id="2-配置Spark环境变量"><a href="#2-配置Spark环境变量" class="headerlink" title="2. 配置Spark环境变量"></a>2. 配置Spark环境变量</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"><span class="comment"># 添加：</span></span><br><span class="line"><span class="comment"># spark</span></span><br><span class="line"><span class="built_in">export</span> SPARK_HOME=/opt/kafka</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SPARK_HOME</span>/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-拷贝到slave1和slave2节点"><a href="#2-3-拷贝到slave1和slave2节点" class="headerlink" title="2.3 拷贝到slave1和slave2节点"></a>2.3 拷贝到slave1和slave2节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure><h2 id="3-配置文件"><a href="#3-配置文件" class="headerlink" title="3. 配置文件"></a>3. 配置文件</h2><h3 id="3-1-配置spark-env-sh-SPARK-HOME-conf-目录下"><a href="#3-1-配置spark-env-sh-SPARK-HOME-conf-目录下" class="headerlink" title="3.1 配置spark-env.sh,${SPARK_HOME}/conf/ 目录下"></a>3.1 <strong>配置spark-env.sh</strong>,<code>$&#123;SPARK_HOME&#125;/conf/</code> 目录下</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> spark-env.sh.template spark-env.sh</span><br><span class="line"><span class="comment"># 添加:</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=/opt/scala</span><br><span class="line">SPARK_MASTER_HOST=master</span><br><span class="line"><span class="comment"># 默认端口就是7077, 可以省略不配</span></span><br><span class="line">SPARK_MASTER_PORT=7077</span><br></pre></td></tr></table></figure><h3 id="3-2-配置workers"><a href="#3-2-配置workers" class="headerlink" title="3.2 配置workers"></a>3.2 <strong>配置workers</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> workers.template workers</span><br><span class="line"><span class="comment"># 添加:</span></span><br><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="3-3-拷贝到slave1和slave2节点"><a href="#3-3-拷贝到slave1和slave2节点" class="headerlink" title="3.3 拷贝到slave1和slave2节点"></a>3.3 拷贝到slave1和slave2节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/spark  slave2(slave1):/opt/</span><br></pre></td></tr></table></figure><h2 id="4-启动群集"><a href="#4-启动群集" class="headerlink" title="4. 启动群集"></a>4. 启动群集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master sbin]$ ./start-all.sh</span><br></pre></td></tr></table></figure><h2 id="5-查看集群"><a href="#5-查看集群" class="headerlink" title="5. 查看集群"></a>5. 查看集群</h2><h3 id="5-1-jps进程查看"><a href="#5-1-jps进程查看" class="headerlink" title="5.1 jps进程查看"></a>5.1 jps进程查看</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">101990 Jps</span><br><span class="line">101944 Worker</span><br><span class="line">101870 Master</span><br></pre></td></tr></table></figure><h3 id="5-2-Web-UI查看"><a href="#5-2-Web-UI查看" class="headerlink" title="5.2 Web UI查看"></a>5.2 Web UI查看</h3><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>spark--Standalone</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MOYc.png" alt="spark--Standalone" title="spark--Standalone"></p><h2 id="6-计算-PI"><a href="#6-计算-PI" class="headerlink" title="6. 计算 PI"></a>6. 计算 PI</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[huser@master spark]$ bin/spark-submit --master spark://master:7077 --executor-memory 1G --total-executor-cores 2 --executor-cores 1 --class org.apache.spark.examples.SparkPi /opt/spark/examples/jars/spark-examples_2.12-3.1.3.jar 1000</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--executor-memory 1G 指定每个executor可用内存为1G</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--total-executor-cores 8 指定所有executor使用的cpu核数为8个</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--executor-cores 2 表示每个executor使用的 cpu 的核数</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Endpoint stopped!</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO MemoryStore: MemoryStore cleared</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO BlockManager: BlockManager stopped</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO BlockManagerMaster: BlockManagerMaster stopped</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO SparkContext: Successfully stopped SparkContext</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO ShutdownHookManager: Shutdown hook called</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-7a0bd8da-0f5f-43a2-adeb-6c48c3169cdc</span></span><br><span class="line"><span class="string">22/11/08 12:49:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-ba12bd46-aaa1-4b2a-9a25-111bb963027c</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>WebUI查看应用执行资源分配情况：</p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>spark--Standalone--PI</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7Mdeq.png" alt="spark--Standalone--PI" title="spark--Standalone--PI"></p><h2 id="7-配置任务历史服务器"><a href="#7-配置任务历史服务器" class="headerlink" title="7. 配置任务历史服务器"></a>7. 配置任务历史服务器</h2><p>在 Spark-shell 没有退出之前， 我们是可以看到正在执行的任务的日志情况：<font color=orange><a href="http://hadoop01:4040">http://hadoop01:4040</a></font>, 但是退出 Spark-shell 之后， 执行的所有任务记录全部丢失。所以需要配置任务的历史服务器, 方便在任何需要的时候去查看日志。</p><h3 id="7-1-配置spark-defaults-conf-进入-SPARK-HOME-conf目录下"><a href="#7-1-配置spark-defaults-conf-进入-SPARK-HOME-conf目录下" class="headerlink" title="7.1 配置spark-defaults.conf, 进入 ${SPARK_HOME}/conf目录下"></a>7.1 <strong>配置spark-defaults.conf</strong>, 进入 <code>$&#123;SPARK_HOME&#125;/conf</code>目录下</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> spark-defaults.conf.template spark-defaults.conf</span><br><span class="line">vim spark-defaults.conf</span><br><span class="line"><span class="comment"># 添加:</span></span><br><span class="line">spark.master                     spark://master:7077</span><br><span class="line">spark.eventLog.enabled           <span class="literal">true</span></span><br><span class="line">spark.eventLog.<span class="built_in">dir</span>               hdfs://master:9000/directory</span><br></pre></td></tr></table></figure><h3 id="7-2-配置spark-env-sh"><a href="#7-2-配置spark-env-sh" class="headerlink" title="7.2 配置spark-env.sh"></a>7.2 <strong>配置spark-env.sh</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> SPARK_HISTORY_OPTS=<span class="string">&quot;-Dspark.history.ui.port=18080 -Dspark.history.retainedApplications=30 -Dspark.history.fs.logDirectory=hdfs://master:9000/spark-jobhistory&quot;</span></span><br></pre></td></tr></table></figure><h3 id="7-3-拷贝到slave1和slave2节点"><a href="#7-3-拷贝到slave1和slave2节点" class="headerlink" title="7.3 拷贝到slave1和slave2节点"></a>7.3 拷贝到slave1和slave2节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/spark/conf/  slave2(slave1):/opt/spark/</span><br></pre></td></tr></table></figure><h3 id="7-4-启动"><a href="#7-4-启动" class="headerlink" title="7.4 启动"></a>7.4 启动</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ ./startdfs.<span class="built_in">sh</span>(脚本)  ----   启动集群</span><br><span class="line">[huser@master sbin]$ ./start-all.sh  ----   启动spark服务</span><br><span class="line">[huser@master sbin]$ ./start-history-server.sh  ----   启动spark日志</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">104222</span> HistoryServer</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="7-5-在HDFS上创建spark-jobhistory目录"><a href="#7-5-在HDFS上创建spark-jobhistory目录" class="headerlink" title="7.5 在HDFS上创建spark-jobhistory目录"></a>7.5 在HDFS上创建<code>spark-jobhistory目录</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">mkdir</span> /spark-jobhistory</span><br></pre></td></tr></table></figure><h3 id="7-6-jps进程查看"><a href="#7-6-jps进程查看" class="headerlink" title="7.6 jps进程查看"></a>7.6 jps进程查看</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ ./allJps.sh.sh(脚本)  ----   查看节点</span><br><span class="line">-----------master jps--------------</span><br><span class="line">109888 QuorumPeerMain</span><br><span class="line">110515 JournalNode</span><br><span class="line">110883 NodeManager</span><br><span class="line">111095 JobHistoryServer</span><br><span class="line">111990 HistoryServer</span><br><span class="line">110136 NameNode</span><br><span class="line">112139 Jps</span><br><span class="line">110714 DFSZKFailoverController</span><br><span class="line">110269 DataNode</span><br><span class="line">111405 Worker</span><br><span class="line">111279 Master</span><br><span class="line">-----------slave1 jps--------------</span><br><span class="line">90992 NameNode</span><br><span class="line">91504 NodeManager</span><br><span class="line">92483 Jps</span><br><span class="line">91077 DataNode</span><br><span class="line">90889 QuorumPeerMain</span><br><span class="line">91288 DFSZKFailoverController</span><br><span class="line">91418 ResourceManager</span><br><span class="line">92077 Worker</span><br><span class="line">91183 JournalNode</span><br><span class="line">-----------slave2 jps--------------</span><br><span class="line">86897 QuorumPeerMain</span><br><span class="line">86993 NameNode</span><br><span class="line">87185 JournalNode</span><br><span class="line">87667 ResourceManager</span><br><span class="line">88581 Jps</span><br><span class="line">87078 DataNode</span><br><span class="line">88153 Worker</span><br><span class="line">87290 DFSZKFailoverController</span><br><span class="line">87791 NodeManager</span><br></pre></td></tr></table></figure><h3 id="7-7-Web-UI查看"><a href="#7-7-Web-UI查看" class="headerlink" title="7.7 Web UI查看"></a>7.7 Web UI查看</h3><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>spark--Standalone--HistoryServer</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7Mv2r.png" alt="spark--Standalone--HistoryServer" title="spark--Standalone--HistoryServer"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十三、Spark组件搭建之Spark-Local模式环境搭建(二)</title>
      <link href="/posts/dc6661ea.html"/>
      <url>/posts/dc6661ea.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-history modern"><p>简介：Spark是一种<font color=red>快速、通用、可扩展的大数据分析引擎</font>，2009年诞生于加州大学伯克利分校AMPLab，2010年开源，2013年6月成为Apache孵化项目，2014年2月成为Apache顶级项目。目前，Spark生态系统已经发展成为一个包含多个子项目的集合，其中包含SparkSQL、SparkStreaming、GraphX、MLlib等子项目，Spark是基于内存计算的大数据并行计算框架。Spark基于内存计算，提高了在大数据环境下数据处理的实时性，同时保证了<font color=red>高容错性和高可伸缩性</font>，允许用户将Spark部署在大量廉价硬件之上，形成集群。Spark得到了众多大数据公司的支持，这些公司包括Hortonworks、IBM、Intel、Cloudera、MapR、Pivotal、百度、阿里、腾讯、京东、携程、优酷土豆。当前百度的Spark已应用于凤巢、大搜索、直达号、百度大数据等业务；阿里利用GraphX构建了大规模的图计算和图挖掘系统，实现了很多生产系统的推荐算法；腾讯Spark集群达到8000台的规模，是当前已知的世界上最大的Spark集群。</p><ul><li><strong>与Hadoop的MapReduce相比，Spark基于内存的运算要快100倍以上，基于硬盘的运算也要快10倍以上。Spark实现了高效的DAG(有向无环图)执行引擎，可以通过基于内存来高效处理数据流。</strong></li><li><strong>Spark支持Java、Python和Scala的API，还支持超过80种高级算法，使用户可以快速构建不同的应用。而且Spark支持交互式的Python和Scala的shell，可以非常方便地在这些shell中使用Spark集群来验证解决问题的方法。</strong></li><li><strong>Spark提供了统一的解决方案。Spark可以用于批处理、交互式查询（Spark SQL）、实时流处理（Spark Streaming）、机器学习（Spark MLlib）和图计算（GraphX）。这些不同类型的处理都可以在同一个应用中无缝使用。Spark统一的解决方案非常具有吸引力，毕竟任何公司都想用统一的平台去处理遇到的问题，减少开发和维护的人力成本和部署平台的物力成本。</strong></li><li><strong>Spark提供了统一的解决方案。Spark可以用于批处理、交互式查询（Spark SQL）、实时流处理（Spark Streaming）、机器学习（Spark MLlib）和图计算（GraphX）。这些不同类型的处理都可以在同一个应用中无缝使用。Spark统一的解决方案非常具有吸引力，毕竟任何公司都想用统一的平台去处理遇到的问题，减少开发和维护的人力成本和部署平台的物力成本。</strong></li></ul></div><div class="tip warning"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B(%E4%B8%80)Scala%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%5D(https:/www.yuque.com/u25360462/nt1ri1/grya7qs4bau5x7q0?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MliA.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">十三、Spark组件搭建之Scala环境搭建(一)</div>            <div class="tag-link-sitename">简介: 是一种多范式的编程语言，其设计的初衷是要集成面向对象编程和函数式编程的各种特性 。Scala 运 行 于Java平台（ Java 虚 拟 机 ）， 并 兼 容 现 有 的 Java 程 序 。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note info simple"><p><a href="https://spark.apache.org/downloads.html"><strong>Spark</strong></a>压缩包——&gt;<strong>spark-3.1.3-bin-hadoop3.2.tgz</strong></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1 解压并改名"></a>1.1 解压并改名</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf spark<span class="number">-3.1</span><span class="number">.3</span>-bin-hadoop3<span class="number">.2</span>.tgz -C /opt/</span><br><span class="line">mv spark<span class="number">-3.1</span><span class="number">.3</span>-bin-hadoop3<span class="number">.2</span> spark</span><br></pre></td></tr></table></figure><h2 id="2-配置Spark环境变量"><a href="#2-配置Spark环境变量" class="headerlink" title="2. 配置Spark环境变量"></a>2. 配置Spark环境变量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="meta"># spark</span></span><br><span class="line"><span class="keyword">export</span> SPARK_HOME=/opt/kafka</span><br><span class="line"><span class="keyword">export</span> PATH=$PATH:$SPARK_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-拷贝到slave1和slave2节点"><a href="#2-3-拷贝到slave1和slave2节点" class="headerlink" title="2.3 拷贝到slave1和slave2节点"></a>2.3 拷贝到slave1和slave2节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/<span class="function">profile  <span class="title">slave2</span><span class="params">(slave1)</span>:/etc/profile</span></span><br></pre></td></tr></table></figure><h2 id="3-配置spark-env-sh-SPARK-HOME-conf-目录下"><a href="#3-配置spark-env-sh-SPARK-HOME-conf-目录下" class="headerlink" title="3. 配置spark-env.sh,${SPARK_HOME}/conf/目录下"></a>3. <strong>配置spark-env.sh</strong>,<code>$&#123;SPARK_HOME&#125;/conf/</code>目录下</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cp spark-env.sh.<span class="keyword">template</span> spark-env.sh</span><br><span class="line"># 添加:</span><br><span class="line"><span class="keyword">export</span> JAVA_HOME=/usr/java/jdk1<span class="number">.8</span><span class="number">.0</span>_341-amd64</span><br><span class="line"><span class="keyword">export</span> SCALA_HOME=/opt/scala</span><br><span class="line">SPARK_LOCAL_IP=master</span><br><span class="line">    </span><br><span class="line"># Options read when launching programs locally with</span><br><span class="line"># ./bin/run-example <span class="keyword">or</span> ./bin/spark-submit</span><br><span class="line"># - HADOOP_CONF_DIR, to point Spark towards Hadoop configuration files</span><br><span class="line"># - SPARK_PUBLIC_DNS, to set the <span class="keyword">public</span> dns name of the driver program</span><br></pre></td></tr></table></figure><h2 id="4-启动测试"><a href="#4-启动测试" class="headerlink" title="4. 启动测试"></a>4. 启动测试</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ ./spark-shell</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">22</span>/<span class="number">11</span>/<span class="number">08</span> <span class="number">00</span>:<span class="number">34</span>:<span class="number">59</span> WARN NativeCodeLoader: Unable to load native-hadoop library <span class="keyword">for</span> your platform... <span class="keyword">using</span> builtin-java classes where applicable</span><br><span class="line">Using Spark<span class="number">&#x27;</span>s <span class="keyword">default</span> log4j profile: org/apache/spark/log4j-defaults.properties</span><br><span class="line">Setting <span class="keyword">default</span> log level to <span class="string">&quot;WARN&quot;</span>.</span><br><span class="line">To adjust logging level use sc.<span class="built_in">setLogLevel</span>(newLevel). For SparkR, <span class="function">use <span class="title">setLogLevel</span><span class="params">(newLevel)</span>.</span></span><br><span class="line"><span class="function">Spark context Web UI available at http://master:<span class="number">4040</span></span></span><br><span class="line"><span class="function">Spark context available as <span class="string">&#x27;sc&#x27;</span> (master =</span> local[*], app id = local<span class="number">-1667838916404</span>).</span><br><span class="line">Spark session available as <span class="string">&#x27;spark&#x27;</span>.</span><br><span class="line">Welcome to</span><br><span class="line">      ____              __</span><br><span class="line">     / __/__  ___ _____/ /__</span><br><span class="line">    _\ \/ _ \/ _ `/ __/  <span class="string">&#x27;_/</span></span><br><span class="line"><span class="string">   /___/ .__/\_,_/_/ /_/\_\   version 3.1.3</span></span><br><span class="line"><span class="string">      /_/</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">Using Scala version 2.12.10 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_341)</span></span><br><span class="line"><span class="string">Type in expressions to have them evaluated.</span></span><br><span class="line"><span class="string">Type :help for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">scala&gt; </span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="5-wordcount案例"><a href="#5-wordcount案例" class="headerlink" title="5. wordcount案例"></a>5. wordcount案例</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 准备一个需要统计词频的小文件，部分词频数据：</span><br><span class="line">● 支持消息的发布和订阅，类似于 RabbtMQ、ActiveMQ 等消息队列；</span><br><span class="line">● 支持数据实时处理；</span><br><span class="line">● 能保证消息的可靠性投递；</span><br><span class="line">● 支持消息的持久化存储，并通过多副本分布式的存储方案来保证消息的容错；</span><br><span class="line">● 高吞吐率，单 Broker 可以轻松处理数千个分区以及每秒百万级的消息量。</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Spark之WordCount案例实操：</span><br><span class="line">scala&gt; val result=sc.<span class="built_in">textFile</span>(<span class="string">&quot;file:///opt/spark/data/cs.txt&quot;</span>).<span class="built_in">flatMap</span>(_.<span class="built_in">split</span>(<span class="string">&quot;\t&quot;</span>)).<span class="built_in">map</span>((_,<span class="number">1</span>)).<span class="built_in">reduceByKey</span>(_ + _).collect</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">[Stage <span class="number">0</span>:&gt;                                                          (<span class="number">0</span> + <span class="number">1</span>) / </span><br><span class="line">result: Array[(String, Int)] = <span class="built_in">Array</span>((● 支持数据实时处理；,<span class="number">1</span>), (● 支持消息的持久化存储，并通过多副本分布式的存储方案来保证消息的容错；,<span class="number">1</span>), (● 支持消息的发布和订阅，类似于 RabbtMQ、ActiveMQ 等消息队列；,<span class="number">1</span>), (● 能保证消息的可靠性投递；,<span class="number">1</span>), (● 高吞吐率，单 Broker 可以轻松处理数千个分区以及每秒百万级的消息量。,<span class="number">1</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>查看 Spark Web UI 界面，端口为4040：</p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>spark--wordcount</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MT50.png" alt="spark--wordcount" title="spark--wordcount"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>五、HBase组件(hive模块等更新)</title>
      <link href="/posts/ff0c941c.html"/>
      <url>/posts/ff0c941c.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-file-word modern"><p>介绍：HBase是一个分布式的、面向列的开源数据库，该技术来源于 Fay Chang 所撰写的Google论文“Bigtable：一个结构化数据的<a href="https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F/6608875?fromModule=lemma_inlink"><strong>分布式存储系统</strong></a>”。就像Bigtable利用了Google文件系统（File System）所提供的分布式数据存储一样，HBase在Hadoop之上提供了类似于Bigtable的能力。HBase是Apache的Hadoop项目的子项目。HBase不同于一般的关系数据库，它是一个适合于非结构化数据存储的数据库。另一个不同的是HBase基于列的而不是基于行的模式。</p></div><div class="tip warning"><p>前提准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%BA%8C%E3%80%81zookeeper%E7%BB%84%E4%BB%B6%E6%90%AD%E5%BB%BA%5D(https:/www.yuque.com/u25360462/nt1ri1/wzn655?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7LkQP.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">二、zookeeper组件搭建</div>            <div class="tag-link-sitename">介绍：Zookeeper 是一个开源的分布式协调服务，目前由 Apache 进行维护。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note success simple"><p>需要的安装包：<a href="http://archive.apache.org/dist/hbase/"><strong>HBase</strong></a>镜像——&gt;<strong>hbase-1.4.13-bin.tar.gz</strong></p></div><h1 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h1><h3 id="4-1-1-软件下载并解压"><a href="#4-1-1-软件下载并解压" class="headerlink" title="4.1.1 软件下载并解压"></a>4.1.1 软件下载并解压</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://archive.apache.org/dist/hbase/1.4.13/hbase-1.4.13-bin.tar.gz</span><br><span class="line">tar -zxvf hbase-1.4.13-bin.tar.gz</span><br></pre></td></tr></table></figure><h3 id="4-1-2-改名"><a href="#4-1-2-改名" class="headerlink" title="4.1.2 改名"></a>4.1.2 改名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> hbase-1.4.13/ /opt/hbase</span><br></pre></td></tr></table></figure><h3 id="4-1-3-配置环境变量"><a href="#4-1-3-配置环境变量" class="headerlink" title="4.1.3 配置环境变量"></a>4.1.3 配置环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"><span class="comment"># HBASE_HOME</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/opt/hbase</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HBASE_HOME</span>/bin</span><br></pre></td></tr></table></figure><h3 id="4-1-4-生效并查看版本"><a href="#4-1-4-生效并查看版本" class="headerlink" title="4.1.4 生效并查看版本"></a>4.1.4 生效并查看版本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line">hbase</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Usage: hbase [&lt;options&gt;] &lt;command&gt; [&lt;args&gt;]</span></span><br><span class="line"><span class="string">Options:</span></span><br><span class="line"><span class="string">  --config DIR     Configuration direction to use. Default: ./conf</span></span><br><span class="line"><span class="string">  --hosts HOSTS    Override the list in &#x27;</span>regionservers<span class="string">&#x27; file</span></span><br><span class="line"><span class="string">  --auth-as-server Authenticate to ZooKeeper using servers configuration</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Commands:</span></span><br><span class="line"><span class="string">Some commands take arguments. Pass no args or -h for usage.</span></span><br><span class="line"><span class="string">  shell           Run the HBase shell</span></span><br><span class="line"><span class="string">  hbck            Run the hbase &#x27;</span>fsck<span class="string">&#x27; tool</span></span><br><span class="line"><span class="string">  snapshot        Tool for managing snapshots</span></span><br><span class="line"><span class="string">  snapshotinfo    Tool for dumping snapshot information</span></span><br><span class="line"><span class="string">  wal             Write-ahead-log analyzer</span></span><br><span class="line"><span class="string">  hfile           Store file analyzer</span></span><br><span class="line"><span class="string">  zkcli           Run the ZooKeeper shell</span></span><br><span class="line"><span class="string">  upgrade         Upgrade hbase</span></span><br><span class="line"><span class="string">  master          Run an HBase HMaster node</span></span><br><span class="line"><span class="string">  regionserver    Run an HBase HRegionServer node</span></span><br><span class="line"><span class="string">  zookeeper       Run a Zookeeper server</span></span><br><span class="line"><span class="string">  rest            Run an HBase REST server</span></span><br><span class="line"><span class="string">  thrift          Run the HBase Thrift server</span></span><br><span class="line"><span class="string">  thrift2         Run the HBase Thrift2 server</span></span><br><span class="line"><span class="string">  clean           Run the HBase clean up script</span></span><br><span class="line"><span class="string">  classpath       Dump hbase CLASSPATH</span></span><br><span class="line"><span class="string">  mapredcp        Dump CLASSPATH entries required by mapreduce</span></span><br><span class="line"><span class="string">  pe              Run PerformanceEvaluation</span></span><br><span class="line"><span class="string">  ltt             Run LoadTestTool</span></span><br><span class="line"><span class="string">  canary          Run the Canary tool</span></span><br><span class="line"><span class="string">  hbtop           Run the HBTop tool</span></span><br><span class="line"><span class="string">  version         Print the version</span></span><br><span class="line"><span class="string">  CLASSNAME       Run the class named CLASSNAME</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-1-5-拷贝到slave1和slave2节点"><a href="#4-1-5-拷贝到slave1和slave2节点" class="headerlink" title="4.1.5 拷贝到slave1和slave2节点"></a>4.1.5 拷贝到slave1和slave2节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure><h1 id="2-修改配置"><a href="#2-修改配置" class="headerlink" title="2. 修改配置"></a>2. 修改配置</h1><h3 id="4-2-1-添加存储元数据文件-创建在目录-opt-hbase下"><a href="#4-2-1-添加存储元数据文件-创建在目录-opt-hbase下" class="headerlink" title="4.2.1 添加存储元数据文件,创建在目录/opt/hbase下"></a>4.2.1 添加存储元数据文件,创建在<code>目录/opt/hbase下</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> tmp zookeeper_data</span><br></pre></td></tr></table></figure><h3 id="4-2-1-目录下的-opt-hbase-conf-配置hbase-env-sh-把原基础的配置信息全去掉"><a href="#4-2-1-目录下的-opt-hbase-conf-配置hbase-env-sh-把原基础的配置信息全去掉" class="headerlink" title="4.2.1 目录下的/opt/hbase/conf, 配置hbase-env.sh,把原基础的配置信息全去掉"></a>4.2.1 目录下的<code>/opt/hbase/conf</code>, <strong>配置hbase-env.sh</strong>,把原基础的配置信息全去掉</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="comment">#表示不引用hbase自带的zookeeper，用我们自己安装的</span></span><br><span class="line"><span class="built_in">export</span> HBASE_MANAGES_ZK=<span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="4-2-2-配置hbase-site-xml"><a href="#4-2-2-配置hbase-site-xml" class="headerlink" title="4.2.2 配置hbase-site.xml"></a>4.2.2 <strong>配置hbase-site.xml</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">    &lt;!-- 指定 <span class="title class_">HBase</span> 以分布式模式运行 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    &lt;!-- 指定 <span class="title class_">HBase</span> 数据存储路径为 <span class="variable constant_">HDFS</span> 上的 hbase 目录,hbase 目录不需要预先创建，程序会自动创</span><br><span class="line">建 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hacluster/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    &lt;!-- <span class="title class_">HBase</span>临时数据存储目录 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hbase/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    &lt;!-- 指定 zookeeper 地址和端口 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    &lt;!-- zookeeper数据存放位置 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.property.dataDir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hbase/zookeeper_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="4-2-3-配置regionservers服务器列表"><a href="#4-2-3-配置regionservers服务器列表" class="headerlink" title="4.2.3 配置regionservers服务器列表"></a>4.2.3 <strong>配置regionservers服务器列表</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="4-2-4-链接hdfs配置"><a href="#4-2-4-链接hdfs配置" class="headerlink" title="4.2.4 链接hdfs配置"></a>4.2.4 <strong>链接hdfs配置</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s <span class="variable">$HADOOP_HOME</span>/etc/hadoop/core-site.xml /opt/hbase/conf/core-site.xml</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$HADOOP_HOME</span>/etc/hadoop/hdfs-site.xml /opt/hbase/conf/hdfs-site.xml</span><br></pre></td></tr></table></figure><h3 id="4-2-5-拷贝到slave1和slave2节点"><a href="#4-2-5-拷贝到slave1和slave2节点" class="headerlink" title="4.2.5 拷贝到slave1和slave2节点"></a>4.2.5 拷贝到slave1和slave2节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/hbase/ slave1(slave2):/opt/</span><br></pre></td></tr></table></figure><h3 id="4-2-6-如果出现权限不够，因为拷贝文件的用户是root，要修改huser用户"><a href="#4-2-6-如果出现权限不够，因为拷贝文件的用户是root，要修改huser用户" class="headerlink" title="4.2.6 如果出现权限不够，因为拷贝文件的用户是root，要修改huser用户"></a>4.2.6 如果出现权限不够，因为拷贝文件的用户是root，要修改huser用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 opt]$ sudo <span class="built_in">chown</span> -R huser:huser hbase/</span><br><span class="line">[huser@slave2 opt]$ sudo <span class="built_in">chown</span> -R huser:huser hbase/</span><br></pre></td></tr></table></figure><h1 id="3-启动HBase"><a href="#3-启动HBase" class="headerlink" title="3. 启动HBase"></a>3. 启动HBase</h1><h3 id="4-3-1-执行启动，三台机一起启动"><a href="#4-3-1-执行启动，三台机一起启动" class="headerlink" title="4.3.1 执行启动，三台机一起启动"></a>4.3.1 执行启动，三台机一起启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 必须先开集群</span></span><br><span class="line">start-hbase.sh</span><br><span class="line"><span class="comment"># 关闭HBase</span></span><br><span class="line">stop-hbase.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">节点：HMaster</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>端口号为: 16010 三台机都有</p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hbase--HRegionServer--master</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7bQgT.png" alt="hbase--HRegionServer--master" title="hbase--HRegionServer--master"></p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hbase--HRegionServer--slave1</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7bza1.png" alt="hbase--HRegionServer--slave1" title="hbase--HRegionServer--slave1"></p><h1 id="4-Hive与Hbase整合"><a href="#4-Hive与Hbase整合" class="headerlink" title="4. Hive与Hbase整合"></a>4. Hive与Hbase整合</h1><font color=red>有需求，反馈更新</font>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>四、tez引擎组件</title>
      <link href="/posts/6e1f6090.html"/>
      <url>/posts/6e1f6090.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-dice modern"><p>简介：Tez采用了DAG（<a href="https://so.csdn.net/so/search?q=%E6%9C%89%E5%90%91%E6%97%A0%E7%8E%AF%E5%9B%BE&amp;spm=1001.2101.3001.7020"><strong>有向无环图</strong></a>）来组织MR任务（DAG中一个节点就是一个RDD，边表示对RDD的操作）。它的核心思想是把将Map任务和Reduce任务进一步拆分，Map任务拆分为Input-Processor-Sort-Merge-Output，Reduce任务拆分为Input-Shuffer-Sort-Merge-Process-output，Tez将若干小任务灵活重组，形成一个大的DAG作业。</p></div><div class="tip "><p>前提准备：</p></div><div class="note success simple"><p>需要的安装包：<a href="https://pan.baidu.com/s/1PePN7BXvQGheJxqT5bYYjQ#list/path=%2F"><strong>tez</strong></a>压缩包(提取码：i9yb)——&gt;<strong><em>tez-0.10.1-SNAPSHOT-minimal.tar.gz</em></strong><br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;  <strong><em>tez-0.10.1-SNAPSHOT.tar.gz</em></strong></p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%89%E3%80%81Hive%E7%BB%84%E4%BB%B6%E6%90%AD%E5%BB%BA--%3E%E5%86%85%E5%90%ABMySQL%E5%AE%89%E8%A3%85%5D(https:/www.yuque.com/u25360462/nt1ri1/zamxgf?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bvhc.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">三、Hive组件搭建-->内含MySQL安装</div>            <div class="tag-link-sitename">Hive：由Facebook开源用于解决海量结构化日志的数据统计。 Hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h2><h3 id="1-1-上传并解压"><a href="#1-1-上传并解压" class="headerlink" title="1.1 上传并解压"></a>1.1 上传并解压</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /opt/tez</span><br><span class="line">tar -zxvf /opt/software/tez-0.10.1-SNAPSHOT-minimal.tar.gz -C /opt/tez</span><br></pre></td></tr></table></figure><h3 id="1-2-上传至HDFS，存放tez依赖包"><a href="#1-2-上传至HDFS，存放tez依赖包" class="headerlink" title="1.2  上传至HDFS，存放tez依赖包"></a>1.2  上传至HDFS，存放tez依赖包</h3><font color=red size=3px weight=bold>注意: 要开集群</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">mkdir</span> /tez</span><br><span class="line">hdfs dfs -put /opt/tez-0.10.1-SNAPSHOT.tar.gz /tez</span><br></pre></td></tr></table></figure><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hive--tez引擎--存放tez依赖包</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7b0xq.png" alt="hive--tez引擎--存放tez依赖包" title="hive--tez引擎--存放tez依赖包"></p><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BHive%E5%AE%89%E8%A3%85%20Tez%20%E5%BC%95%E6%93%8E_%E6%89%9B%E9%BA%BB%E8%A2%8B%E7%9A%84%E5%B0%91%E5%B9%B4%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2_hive%20tez%5D(https:/blog.csdn.net/lzb348110175/article/details/117817055?app_version=5.10.0&code=app_1562916241&csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22117817055%22,%22source%22:%22qq672596289%22%7D&uLinkId=usr1mkqgl919blen&utm_source=app)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bNWr.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Hive安装 Tez</div>            <div class="tag-link-sitename">Hive安装 Tez 引擎_扛麻袋的少年的博客-CSDN博客_hive tez</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BHive%E6%9B%B4%E6%8D%A2Tez%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8E-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%5D(https:/mp.weixin.qq.com/s/BRz4uiogyMT4xta9N6IygA)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bNWr.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Hive更换Tez计算引擎</div>            <div class="tag-link-sitename">Hive更换Tez计算引擎-视频教程</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="2-修改配置"><a href="#2-修改配置" class="headerlink" title="2.修改配置"></a>2.修改配置</h2><h3 id="2-1-新建-tez-site-xml"><a href="#2-1-新建-tez-site-xml" class="headerlink" title="2.1 新建 tez-site.xml"></a>2.1 新建 <code>tez-site.xml</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$HADOOP_HOME</span>/etc/hadoop/tez-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.lib.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>$&#123;fs.defaultFS&#125;/tez/tez-0.10.1-SNAPSHOT.tar.gz<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.use.cluster.hadoop-libs<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.am.resource.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>1024<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.am.resource.cpu.vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.container.max.java.heap.fraction<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>0.4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.task.resource.memory.mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>1024<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>tez.task.resource.cpu.vcores<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="2-2-修改-Hadoop-环境变量"><a href="#2-2-修改-Hadoop-环境变量" class="headerlink" title="2.2 修改 Hadoop 环境变量"></a>2.2 <strong>修改 Hadoop 环境变量</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$HADOOP_HOME</span>/etc/hadoop/shellprofile.d/tez.sh</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hadoop_add_profile tez</span><br><span class="line"><span class="keyword">function</span> _tez_hadoop_classpath</span><br><span class="line">&#123;</span><br><span class="line"> hadoop_add_classpath <span class="string">&quot;<span class="variable">$HADOOP_HOME</span>/etc/hadoop&quot;</span> after</span><br><span class="line"> hadoop_add_classpath <span class="string">&quot;/opt/tez/*&quot;</span> after</span><br><span class="line"> hadoop_add_classpath <span class="string">&quot;/opt/tez/lib/*&quot;</span> after</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-修改-Hive-的计算引擎"><a href="#2-3-修改-Hive-的计算引擎" class="headerlink" title="2.3 修改 Hive 的计算引擎"></a>2.3 <strong>修改 Hive 的计算引擎</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$HIVE_HOME</span>/conf/hive-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.execution.engine<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>tez<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.tez.container.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1024<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="2-4-解决日志-Jar-包冲突"><a href="#2-4-解决日志-Jar-包冲突" class="headerlink" title="2.4 解决日志 Jar 包冲突"></a>2.4 解决日志 Jar 包冲突</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /opt/tez/slf4j-log4j12-1.7.10.jar</span><br></pre></td></tr></table></figure><h2 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试"></a>3.测试</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动Hive时，要启动集群</span></span><br><span class="line">[<span class="string">huser@master</span> <span class="string">~</span>]<span class="string">$</span> <span class="string">hive</span></span><br><span class="line"><span class="comment"># 创建一张测试表</span></span><br><span class="line"><span class="string">hive</span> <span class="string">(default)&gt;</span> <span class="string">create</span> <span class="string">table</span> <span class="string">ods_user(id</span> <span class="string">int,name</span> <span class="string">string);</span></span><br><span class="line"><span class="comment"># 插入数据</span></span><br><span class="line"><span class="string">hive</span> <span class="string">(default)&gt;</span> <span class="string">insert</span> <span class="string">into</span> <span class="string">ods_user</span> <span class="string">values(1,&quot;root&quot;);</span></span><br><span class="line"><span class="comment"># 验证数据是否插入成功</span></span><br><span class="line"><span class="string">hive</span> <span class="string">(default)&gt;</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ods_user;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">ods_user.id</span>    <span class="string">ods_user.name</span></span><br><span class="line"><span class="number">1</span>    <span class="string">xiaokang</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.301</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">1</span> <span class="string">row(s)</span></span><br></pre></td></tr></table></figure><h2 id="4-报错解决"><a href="#4-报错解决" class="headerlink" title="4. 报错解决"></a>4. 报错解决</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">hive&gt;</span> <span class="string">insert</span> <span class="string">into</span> <span class="string">test</span> <span class="string">values(1);</span></span><br><span class="line"><span class="string">Query</span> <span class="string">ID</span> <span class="string">=</span> <span class="string">huser_20221130013916_16e5ccf9-5b68-48bb-a967-287dabf447fa</span></span><br><span class="line"><span class="string">Total</span> <span class="string">jobs</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="string">Launching</span> <span class="string">Job</span> <span class="number">1</span> <span class="string">out</span> <span class="string">of</span> <span class="number">1</span></span><br><span class="line"><span class="attr">FAILED:</span> <span class="string">Execution</span> <span class="string">Error,</span> <span class="string">return</span> <span class="string">code</span> <span class="number">1</span> <span class="string">from</span> <span class="string">org.apache.hadoop.hive.ql.exec.tez.TezTask</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>尝试添加<code>/opt/hadoop/etc/hadoop目录</code>下的<code>yarn-site.xml文件</code>配置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">　　    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.resource.memory-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">　　    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">　　    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.scheduler.minimum-allocation-mb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">　　    <span class="tag">&lt;<span class="name">value</span>&gt;</span>2048<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十一、Flume组件搭建--_日志收集</title>
      <link href="/posts/1c48292.html"/>
      <url>/posts/1c48292.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-circle-half-stroke modern"><p>简介：<font color=red>Apache Flume</font>  是 Cloudera 公司开发，是一个分布式的、高可靠的、高可用的用于海量日志收集、聚合和传输的系统。它可以从不同的数据源收集数据，经过聚合后发送到存储系统中，通常用于日志数据的收集。Flume 分为 NG 和 OG (1.0 之前) 两个版本，NG 在 OG 的基础上进行了完全的重构，是目前使用最为广泛的版本。下面的介绍均以 NG 为基础。</p></div><div class="tip info"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note default simple"><p>需要的安装包：<a href="http://archive.apache.org/dist/flume/"><strong>flume</strong></a>压缩包——&gt;<strong>apache-flume-1.7.0-bin.tar.gz</strong></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1 解压并改名"></a>1.1 解压并改名</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-flume<span class="number">-1.9</span><span class="number">.0</span>-bin.tar.gz -C /opt/</span><br><span class="line">mv apache-flume<span class="number">-1.9</span><span class="number">.0</span> flume</span><br></pre></td></tr></table></figure><h2 id="2-配置flume环境变量"><a href="#2-配置flume环境变量" class="headerlink" title="2. 配置flume环境变量"></a>2. 配置flume环境变量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="meta"># flume</span></span><br><span class="line"><span class="keyword">export</span> FLUME_HOME=/opt/flume</span><br><span class="line"><span class="keyword">export</span> PATH=$PATH:$FLUME_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-拷贝到slave1和slave2节点"><a href="#2-3-拷贝到slave1和slave2节点" class="headerlink" title="2.3 拷贝到slave1和slave2节点"></a>2.3 拷贝到slave1和slave2节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure><h2 id="3-修改配置"><a href="#3-修改配置" class="headerlink" title="3. 修改配置"></a>3. 修改配置</h2><h3 id="3-1-进入安装目录下的-conf目录，拷贝-Flume-的环境配置模板-flume-env-sh-template"><a href="#3-1-进入安装目录下的-conf目录，拷贝-Flume-的环境配置模板-flume-env-sh-template" class="headerlink" title="3.1 进入安装目录下的 conf目录，拷贝 Flume 的环境配置模板 flume-env.sh.template"></a>3.1 进入安装目录下的 <code>conf目录</code>，拷贝 <strong>Flume</strong> 的环境配置模板 <strong>flume-env.sh.template</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp flume-env.sh.<span class="keyword">template</span> flume-env.sh</span><br></pre></td></tr></table></figure><h3 id="3-2-配置flume-env-sh"><a href="#3-2-配置flume-env-sh" class="headerlink" title="3.2 配置flume-env.sh"></a>3.2 <strong>配置flume-env.sh</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> JAVA_HOME=/usr/java/jdk1<span class="number">.8</span><span class="number">.0</span>_341-amd64</span><br></pre></td></tr></table></figure><h2 id="4-验证"><a href="#4-验证" class="headerlink" title="4. 验证"></a>4. 验证</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">flume-ng version</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Flume 1.9.0</span></span><br><span class="line"><span class="string">Source code repository: https://git-wip-us.apache.org/repos/asf/flume.git</span></span><br><span class="line"><span class="string">Revision: d4fcab4f501d41597bc616921329a4339f73585e</span></span><br><span class="line"><span class="string">Compiled by fszabo on Mon Dec 17 20:45:25 CET 2018</span></span><br><span class="line"><span class="string">From source with checksum 35db629a3bda49d23e9b3690c80737f9</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BFlume%E5%AE%89%E8%A3%85%E5%8F%8A%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%5D(https:/mp.weixin.qq.com/s/FtkDp8qwVxl85DXL9wEQ2Q)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MAYP.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Flume安装及基本使用</div>            <div class="tag-link-sitename">Flume安装及基本使用-视频教程</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="5-基本使用"><a href="#5-基本使用" class="headerlink" title="5. 基本使用"></a>5. 基本使用</h2><h3 id="5-1-新建配置文件telnet-logger-properties"><a href="#5-1-新建配置文件telnet-logger-properties" class="headerlink" title="5.1 新建配置文件telnet-logger.properties"></a>5.1 新建配置文件<strong>telnet-logger.properties</strong></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定agent的sources、channels、sinks</span></span><br><span class="line"><span class="string">a1.sources</span> <span class="string">=</span> <span class="string">s1</span></span><br><span class="line"><span class="string">a1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"><span class="string">a1.sinks</span> <span class="string">=</span> <span class="string">k1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置source属性</span></span><br><span class="line"><span class="string">a1.sources.s1.type</span> <span class="string">=</span> <span class="string">netcat</span></span><br><span class="line"><span class="string">a1.sources.s1.bind</span> <span class="string">=</span> <span class="string">master</span></span><br><span class="line"><span class="string">a1.sources.s1.port</span> <span class="string">=</span> <span class="number">44444</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置channel类型</span></span><br><span class="line"><span class="string">a1.channels.c1.type</span> <span class="string">=</span> <span class="string">memory</span></span><br><span class="line"><span class="string">a1.channels.c1.capacity</span> <span class="string">=</span> <span class="number">10000</span></span><br><span class="line"><span class="string">a1.channels.c1.transactionCapacity</span> <span class="string">=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置sink</span></span><br><span class="line"><span class="string">a1.sinks.k1.type</span> <span class="string">=</span> <span class="string">logger</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sources和channels绑定</span></span><br><span class="line"><span class="string">a1.sources.s1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sinks和channels绑定</span></span><br><span class="line"><span class="string">a1.sinks.k1.channel</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">NetCat Source ：监听一个指定端口，并接收监听到的数据（接收的数据是字符串形式）。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">NetCat Source 配置项说明:</span></span><br><span class="line"><span class="string">channels    |   绑定的通道</span></span><br><span class="line"><span class="string">    type    |   netcat</span></span><br><span class="line"><span class="string">    bind    |   指定要监听的主机</span></span><br><span class="line"><span class="string">    port    |   指定要监听的端口号</span></span><br><span class="line"><span class="string">    selector.*    |   选择器配置</span></span><br><span class="line"><span class="string">    interceptors.*    |   拦截器列表配置</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://vip.helloimg.com/images/2023/12/18/o7Mi2n.png" alt=""></p><h3 id="5-2-启动"><a href="#5-2-启动" class="headerlink" title="5.2 启动"></a>5.2 启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">flume-ng agent -n a1 -c /opt/flume/conf/ -f conf/telnet-logger.properties -Dflume.root.logger=INFO,console</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">SLF4J: Class path contains multiple SLF4J bindings.</span></span><br><span class="line"><span class="string">SLF4J: Found binding in [jar:file:/opt/flume/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span></span><br><span class="line"><span class="string">SLF4J: Found binding in [jar:file:/opt/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span></span><br><span class="line"><span class="string">SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.</span></span><br><span class="line"><span class="string">SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]</span></span><br><span class="line"><span class="string">2022-11-05 17:40:48,862 (main) [ERROR - org.apache.flume.node.Application.main(Application.java:374)] A fatal error occurred while running. Exception follows.</span></span><br><span class="line"><span class="string">org.apache.commons.cli.ParseException: The specified configuration file does not exist: /opt/bin/telnet-logger.properties</span></span><br><span class="line"><span class="string">at org.apache.flume.node.Application.main(Application.java:342)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">删掉一个jar包/opt/flume/lib/slf4j-log4j12-1.7.25.jar</span><br></pre></td></tr></table></figure><h3 id="5-3-测试"><a href="#5-3-测试" class="headerlink" title="5.3 测试"></a>5.3 测试</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">第一种：</span></span><br><span class="line"><span class="string">telnet</span> <span class="string">master</span> <span class="number">44444</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="string">证明成功，如果是下面一种，则按下面来:</span></span><br><span class="line">    </span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;bash: telnet: 未找到命令&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#解决方案：使用yum命令安装即可</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">yum</span> <span class="string">-y</span> <span class="string">install</span> <span class="string">telnet</span></span><br><span class="line"><span class="string">第二种：</span></span><br><span class="line"><span class="string">nc</span> <span class="string">master</span> <span class="number">44444</span></span><br><span class="line"><span class="comment"># sudo yum -y install nc</span></span><br></pre></td></tr></table></figure><h2 id="6-官方案例一"><a href="#6-官方案例一" class="headerlink" title="6. 官方案例一"></a>6. 官方案例一</h2><h3 id="6-1-新建配置文件execsource-properties"><a href="#6-1-新建配置文件execsource-properties" class="headerlink" title="6.1  新建配置文件execsource.properties"></a>6.1  新建配置文件<strong>execsource.properties</strong></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定agent的sources、channels、sinks</span></span><br><span class="line"><span class="string">a1.sources</span> <span class="string">=</span> <span class="string">s1</span></span><br><span class="line"><span class="string">a1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"><span class="string">a1.sinks</span> <span class="string">=</span> <span class="string">k1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置source属性 </span></span><br><span class="line"><span class="string">a1.sources.s1.type</span> <span class="string">=</span> <span class="string">exec</span></span><br><span class="line"><span class="string">a1.sources.s1.command</span> <span class="string">=</span> <span class="string">tail</span> <span class="string">-f</span> <span class="string">/opt/flume/data/log.txt</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置channel类型 </span></span><br><span class="line"><span class="string">a1.channels.c1.type</span> <span class="string">=</span> <span class="string">memory</span></span><br><span class="line"><span class="string">a1.channels.c1.capacity</span> <span class="string">=</span> <span class="number">10000</span></span><br><span class="line"><span class="string">a1.channels.c1.transactionCapacity</span> <span class="string">=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置sink</span></span><br><span class="line"><span class="string">a1.sinks.k1.type</span> <span class="string">=</span> <span class="string">logger</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sources和channels绑定</span></span><br><span class="line"><span class="string">a1.sources.s1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sinks和channels绑定</span></span><br><span class="line"><span class="string">a1.sinks.k1.channel</span> <span class="string">=</span> <span class="string">c1</span></span><br></pre></td></tr></table></figure><h3 id="6-2-启动"><a href="#6-2-启动" class="headerlink" title="6.2 启动"></a>6.2 启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flume-ng agent -n a1 -c /opt/flume/conf/ -f conf/execsource.properties -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><h3 id="6-3-测试"><a href="#6-3-测试" class="headerlink" title="6.3 测试"></a>6.3 测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/flume/data/log.txt</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">sdgfsdfg</span></span><br><span class="line"><span class="string">sdgfsdfg</span></span><br><span class="line"><span class="string">sdgfsdfg</span></span><br><span class="line"><span class="string">sdgfsdfg</span></span><br><span class="line"><span class="string">sdgfsdfgkldfjgkldj</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>使用 Flume 监听文件内容变动，将新添的内容输出到控制台</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MSX6.png" alt="使用 Flume 监听文件内容变动，将新添的内容输出到控制台" title="使用 Flume 监听文件内容变动，将新添的内容输出到控制台"></p><h2 id="7-官方案例二"><a href="#7-官方案例二" class="headerlink" title="7. 官方案例二"></a>7. 官方案例二</h2><h3 id="7-1-新建配置文件xinexecsource-properties"><a href="#7-1-新建配置文件xinexecsource-properties" class="headerlink" title="7.1 新建配置文件xinexecsource.properties"></a>7.1 新建配置文件<strong>xinexecsource.properties</strong></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定agent的sources、channels、sinks</span></span><br><span class="line"><span class="string">a1.sources</span> <span class="string">=</span> <span class="string">s1</span></span><br><span class="line"><span class="string">a1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"><span class="string">a1.sinks</span> <span class="string">=</span> <span class="string">k1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置source属性</span></span><br><span class="line"><span class="string">a1.sources.s1.type</span> <span class="string">=</span> <span class="string">spooldir</span></span><br><span class="line"><span class="string">a1.sources.s1.spoolDir</span> <span class="string">=</span> <span class="string">/opt/flume/data/</span></span><br><span class="line"><span class="string">a1.sources.s1.basenameHeader</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line"><span class="string">a1.sources.s1.basenameHeaderKey</span> <span class="string">=</span> <span class="string">fileName</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#配置channel类型</span></span><br><span class="line"><span class="string">a1.channels.c1.type</span> <span class="string">=</span> <span class="string">memory</span></span><br><span class="line"><span class="string">a1.channels.c1.capacity</span> <span class="string">=</span> <span class="number">10000</span></span><br><span class="line"><span class="string">a1.channels.c1.transactionCapacity</span> <span class="string">=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置sink</span></span><br><span class="line"><span class="string">a1.sinks.k1.type</span> <span class="string">=</span> <span class="string">hdfs</span></span><br><span class="line"><span class="string">a1.sinks.k1.hdfs.path</span> <span class="string">=</span> <span class="string">/flume/%y-%m-%d/%H/</span></span><br><span class="line"><span class="string">a1.sinks.k1.hdfs.filePrefix</span> <span class="string">=</span> <span class="string">%&#123;fileName&#125;</span></span><br><span class="line"><span class="comment">#生成的文件类型，默认是Sequencefile，可用DataStream，则为普通文本</span></span><br><span class="line"><span class="string">a1.sinks.k1.hdfs.fileType</span> <span class="string">=</span> <span class="string">DataStream</span></span><br><span class="line"><span class="string">a1.sinks.k1.hdfs.useLocalTimeStamp</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sources和channels绑定</span></span><br><span class="line"><span class="string">a1.sources.s1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sinks和channels绑定</span></span><br><span class="line"><span class="string">a1.sinks.k1.channel</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Spooling Directory Source 配置项说明:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">channels    |   绑定的通道</span></span><br><span class="line"><span class="string">type    |   spooldir</span></span><br><span class="line"><span class="string">spoolDir    |   读取文件的路径，即“搜集目录”</span></span><br><span class="line"><span class="string">【selector.*    |   选择器配置】</span></span><br><span class="line"><span class="string">【interceptors.*    |   拦截器列表配置】</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="7-2-启动"><a href="#7-2-启动" class="headerlink" title="7.2 启动"></a>7.2 启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flume-ng agent -n a1 -c /opt/flume/conf/ -f conf/xinexecsource.properties -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><h3 id="7-3-测试"><a href="#7-3-测试" class="headerlink" title="7.3 测试"></a>7.3 测试</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> 1.txt /opt/flume/data</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-07 22:33:57,624 (hdfs-k1-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:393)] Writer callback called.</span></span><br><span class="line"><span class="string">2022-11-07 22:33:57,624 (hdfs-k1-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter.doClose(BucketWriter.java:438)] Closing /flume/22-11-07/22//1.txt.1667831605570.tmp</span></span><br><span class="line"><span class="string">2022-11-07 22:33:57,681 (hdfs-k1-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$7.call(BucketWriter.java:681)] Renaming /flume/22-11-07/22/1.txt.1667831605570.tmp to /flume/22-11-07/22/1.txt.1667831605570</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><font color=red size=3px weight=bold>查看上传到 **HDFS** 上的文件内容与本地是否一致：</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">cat</span> /flume/22-11-07/22//1.txt.1667831605570.tmp</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">jdaljfaj</span></span><br><span class="line"><span class="string">ajlf;ajfa</span></span><br><span class="line"><span class="string">af;jfa;jfa</span></span><br><span class="line"><span class="string">faj;fja;</span></span><br><span class="line"><span class="string">afjfewjf;q</span></span><br><span class="line"><span class="string">[efjqa;f</span></span><br><span class="line"><span class="string">qafael;f</span></span><br><span class="line"><span class="string">an</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>flume--hdfs</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7M4dM.png" alt="flume--hdfs" title="flume--hdfs"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十二、Kafka组件搭建--_日志收集</title>
      <link href="/posts/115d586a.html"/>
      <url>/posts/115d586a.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-eye-outline modern"><p>简介：Kafka 由LinkedIn(领英)全球职场社交平台公司开发，贡献给Apache成为顶级项目，是一个分布式的流平台。它具有以下特点：</p><ul><li><font color=red>支持消息的发布和订阅，类似于 RabbtMQ、ActiveMQ 等消息队列；</font></li><li><font color=red>支持数据实时处理；</font></li><li><font color=red>能保证消息的可靠性投递；</font></li><li><font color=red>支持消息的持久化存储，并通过多副本分布式的存储方案来保证消息的容错；</font></li><li><font color=red>高吞吐率，单 Broker 可以轻松处理数千个分区以及每秒百万级的消息量。</font></li></ul></div><div class="tip success"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E5%8D%81%E3%80%81Flume%E7%BB%84%E4%BB%B6%E6%90%AD%E5%BB%BA--%3E%E6%97%A5%E5%BF%97%E6%94%B6%E9%9B%86%5D(https:/www.yuque.com/u25360462/nt1ri1/ilmsg4?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MnKR.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">十、Flume组件搭建-->日志收集</div>            <div class="tag-link-sitename">简介：<font color=red>Apache Flume</font> 是 Cloudera 公司开发，是一个分布式的、高可靠的、高可用的用于海量日志收集、聚合和传输的系统。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note primary simple"><p>需要的安装包：<a href="https://kafka.apache.org/downloads"><strong>kafka</strong></a>压缩包——&gt;<strong>kafka_2.12-3.0.0.tgz</strong></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1 解压并改名"></a>1.1 解压并改名</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf kafka_2<span class="number">.12</span><span class="number">-3.0</span><span class="number">.0</span>.tgz -C /opt/</span><br><span class="line">mv kafka_2<span class="number">.12</span><span class="number">-3.0</span><span class="number">.0</span> kafka</span><br></pre></td></tr></table></figure><h2 id="2-配置kafka环境变量"><a href="#2-配置kafka环境变量" class="headerlink" title="2. 配置kafka环境变量"></a>2. 配置kafka环境变量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="meta"># kafka</span></span><br><span class="line"><span class="keyword">export</span> KAFKA_HOME=/opt/kafka</span><br><span class="line"><span class="keyword">export</span> PATH=$PATH:$KAFKA_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-拷贝到slave1和slave2节点"><a href="#2-3-拷贝到slave1和slave2节点" class="headerlink" title="2.3 拷贝到slave1和slave2节点"></a>2.3 拷贝到slave1和slave2节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/<span class="function">profile  <span class="title">slave2</span><span class="params">(slave1)</span>:/etc/profile</span></span><br></pre></td></tr></table></figure><h2 id="3-修改配置"><a href="#3-修改配置" class="headerlink" title="3. 修改配置"></a>3. 修改配置</h2><h3 id="3-1-在-Kafka-安装目录下创建kafka-logs文件夹（用来存储分区信息的，不要把它与存放错误日志的目录混淆了，日志目录是配置在-log4j-properties-文件-里的）"><a href="#3-1-在-Kafka-安装目录下创建kafka-logs文件夹（用来存储分区信息的，不要把它与存放错误日志的目录混淆了，日志目录是配置在-log4j-properties-文件-里的）" class="headerlink" title="3.1 在 Kafka 安装目录下创建kafka-logs文件夹（用来存储分区信息的，不要把它与存放错误日志的目录混淆了，日志目录是配置在 log4j.properties 文件 里的）"></a>3.1 在 <code>Kafka</code> 安装目录下创建<code>kafka-logs文件夹</code>（用来存储分区信息的，不要把它与存放错误日志的目录混淆了，日志目录是配置在 <code>log4j.properties 文件</code> 里的）</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /opt/kafka/kafka-logs</span><br></pre></td></tr></table></figure><h3 id="3-2-配置server-properties"><a href="#3-2-配置server-properties" class="headerlink" title="3.2 配置server.properties"></a>3.2 <strong>配置server.properties</strong></h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># broker的全局唯一标识号，不能重复. 给集群中的每个broker配置一个不同的id</span></span><br><span class="line">broker.id=<span class="number">0</span></span><br><span class="line"># 分区数据的存储位置</span><br><span class="line">log.dirs=/opt/kafka/kafka-logs</span><br><span class="line"># 连接Zookeeper集群地址</span><br><span class="line">zookeeper.connect=master:<span class="number">2181</span>,slave1:<span class="number">2181</span>,slave2:<span class="number">2181</span></span><br></pre></td></tr></table></figure><h3 id="3-3-拷贝到slave1和slave2节点"><a href="#3-3-拷贝到slave1和slave2节点" class="headerlink" title="3.3 拷贝到slave1和slave2节点"></a>3.3 拷贝到slave1和slave2节点</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 分发之后需要修改 broker.<span class="built_in">id</span>( id 值一定不能重复 )的值，同时建议其他节点的环境变量也配置下。</span><br><span class="line">sudo scp -r /opt/kafka/  <span class="built_in">slave2</span>(slave1):/opt/</span><br></pre></td></tr></table></figure><h2 id="4-启动前-先启动zookeeper"><a href="#4-启动前-先启动zookeeper" class="headerlink" title="4. 启动前,先启动zookeeper"></a>4. 启动前,先启动zookeeper</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kafka-server-start.sh /opt/kafka/config/server.properties</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">[<span class="number">2022</span><span class="number">-11</span><span class="number">-07</span> <span class="number">22</span>:<span class="number">47</span>:<span class="number">20</span>,<span class="number">485</span>] INFO [Partition kkjjssdd<span class="number">-0</span> broker=<span class="number">1</span>] Log loaded <span class="keyword">for</span> partition kkjjssdd<span class="number">-0</span> with initial high watermark <span class="number">0</span> (kafka.cluster.Partition)</span><br><span class="line">[<span class="number">2022</span><span class="number">-11</span><span class="number">-07</span> <span class="number">22</span>:<span class="number">47</span>:<span class="number">20</span>,<span class="number">485</span>] INFO [Partition kkjjss<span class="number">-1</span> broker=<span class="number">1</span>] Log loaded <span class="keyword">for</span> partition kkjjss<span class="number">-1</span> with initial high watermark <span class="number">0</span> (kafka.cluster.Partition)</span><br><span class="line">[<span class="number">2022</span><span class="number">-11</span><span class="number">-07</span> <span class="number">22</span>:<span class="number">47</span>:<span class="number">20</span>,<span class="number">492</span>] INFO [BrokerToControllerChannelManager broker=<span class="number">1</span> name=alterIsr]: Recorded <span class="keyword">new</span> controller, from now on will use broker slave1:<span class="number">9092</span> (id: <span class="number">1</span> rack: null) (kafka.server.BrokerToControllerRequestThread)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="5-验证"><a href="#5-验证" class="headerlink" title="5. 验证"></a>5. 验证</h2><p>创建测试主题：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kafka-topics.sh --create --topic kkjjssdd --bootstrap-server master:9092,slave1:9092,slave2:9092 --partitions 2 --replication-factor 1</span><br><span class="line"></span><br><span class="line"><span class="comment">#kafka-topics.sh 任何和 topic 相关的操作都使用这个命令</span></span><br><span class="line"><span class="comment">#--create 表示创建一个 topic</span></span><br><span class="line"><span class="comment">#--zookeeper 指明任意一个 zookeeper 服务器地址</span></span><br><span class="line"><span class="comment">#--replication-factor 表示每个 topic 的副本数. 注意: 副本数必须小于等于 kafka 集群的数量.</span></span><br><span class="line"><span class="comment">#--partitions 这个 topic 的分区的数量</span></span><br><span class="line"><span class="comment">#--topic 这个 topic 的名字.</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Created topic kkjjssdd.</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br>创建完成后可以使用以下命令查看创建的主题信息：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kafka-topics.sh --list --bootstrap-server master:9092,slave1:9092,slave2:9092</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">kkjjssdd</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h1 id="Flume整合Kafka"><a href="#Flume整合Kafka" class="headerlink" title="Flume整合Kafka"></a>Flume整合Kafka</h1><h2 id="6-启动zookeeper，和kafka节点"><a href="#6-启动zookeeper，和kafka节点" class="headerlink" title="6. 启动zookeeper，和kafka节点"></a>6. 启动zookeeper，和kafka节点</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br><span class="line">kafka-server-start.sh /opt/kafka/config/server.properties</span><br></pre></td></tr></table></figure><h2 id="7-创建主题"><a href="#7-创建主题" class="headerlink" title="7. 创建主题"></a>7. 创建主题</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建主题</span></span><br><span class="line"><span class="string">kafka-topics.sh</span> <span class="string">--create</span> <span class="string">--zookeeper</span> <span class="string">master:2181</span> <span class="string">--topic</span> <span class="string">flume2kafka</span> <span class="string">--partitions</span> <span class="number">1</span> <span class="string">--replication-factor</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看创建的主题</span></span><br><span class="line"><span class="string">kafka-topics.sh</span> <span class="string">--zookeeper</span> <span class="string">master:2181</span> <span class="string">--list</span></span><br></pre></td></tr></table></figure><h2 id="8-启动kafka消费者"><a href="#8-启动kafka消费者" class="headerlink" title="8. 启动kafka消费者"></a>8. 启动kafka消费者</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kafka-console-consumer.sh --bootstrap-server master:9092 --topic flume2kafka</span><br></pre></td></tr></table></figure><h2 id="9-配置flume的文件"><a href="#9-配置flume的文件" class="headerlink" title="9. 配置flume的文件"></a>9. <strong>配置flume的文件</strong></h2><p>新建配置文件 <strong>flume-kafka.properties</strong>，文件内容如下：<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定agent的sources、channels、sinks</span></span><br><span class="line"><span class="string">a1.sources</span> <span class="string">=</span> <span class="string">s1</span></span><br><span class="line"><span class="string">a1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"><span class="string">a1.sinks</span> <span class="string">=</span> <span class="string">k1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置source属性</span></span><br><span class="line"><span class="string">a1.sources.s1.type</span> <span class="string">=</span> <span class="string">exec</span></span><br><span class="line"><span class="string">a1.sources.s1.command</span> <span class="string">=</span> <span class="string">tail</span> <span class="string">-f</span> <span class="string">/opt/kafka/data/kafka.log</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置channel类型</span></span><br><span class="line"><span class="string">a1.channels.c1.type</span> <span class="string">=</span> <span class="string">memory</span></span><br><span class="line"><span class="string">a1.channels.c1.capacity</span> <span class="string">=</span> <span class="number">10000</span></span><br><span class="line"><span class="string">a1.channels.c1.transactionCapacity</span> <span class="string">=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置sink</span></span><br><span class="line"><span class="comment">#设置Kafka接收器</span></span><br><span class="line"><span class="string">a1.sinks.k1.type</span> <span class="string">=</span> <span class="string">org.apache.flume.sink.kafka.KafkaSink</span></span><br><span class="line"><span class="comment">#设置Kafka地址</span></span><br><span class="line"><span class="string">a1.sinks.k1.kafka.bootstrap.servers</span> <span class="string">=</span> <span class="string">master:9092</span></span><br><span class="line"><span class="comment">#设置发送到Kafka上的主题</span></span><br><span class="line"><span class="string">a1.sinks.k1.kafka.topic</span> <span class="string">=</span> <span class="string">flume2kafka</span></span><br><span class="line"><span class="comment">#设置一批中消息的条数</span></span><br><span class="line"><span class="string">a1.sinks.k1.kafka.flumeBatchSize</span> <span class="string">=</span> <span class="number">6</span></span><br><span class="line"><span class="comment">#0代表不需要等待确认，1代表仅需要leader确认，-1代表所有副本确认</span></span><br><span class="line"><span class="string">a1.sinks.k1.kafka.producer.acks</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="comment">#设置 linger.ms=1，将达到减少发送的请求数量的效果，但对于在没有负载情况，将增加1ms的延迟。</span></span><br><span class="line"><span class="string">a1.sinks.k1.kafka.producer.linger.ms</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sources和channels绑定</span></span><br><span class="line"><span class="string">a1.sources.s1.channels</span> <span class="string">=</span> <span class="string">c1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将sinks和channels绑定</span></span><br><span class="line"><span class="string">a1.sinks.k1.channel</span> <span class="string">=</span> <span class="string">c1</span></span><br></pre></td></tr></table></figure></p><h2 id="10-启动Flume"><a href="#10-启动Flume" class="headerlink" title="10. 启动Flume"></a>10. 启动Flume</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> flume-ng agent -n a1 -c /op/flume/conf/ -f /opt/flume/conf/flume-kafka.properties -Dflume.root.logger=INFO,console &amp;&gt;&gt;flume-ng.out 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><h2 id="11-测试"><a href="#11-测试" class="headerlink" title="11. 测试"></a>11. 测试</h2><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>flume-kafka--flume2kafka</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7Mboz.png" alt="flume-kafka--flume2kafka" title="flume-kafka--flume2kafka"><br>向监听的 <code>/home/xiaokang/docker_teach/kafka.log</code> 文件中追加内容，查看 <code>Kafka</code> 消费者的输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> alfhlaflkaEJFl &gt;&gt; kafka.log</span><br><span class="line"><span class="built_in">echo</span> aflkajlkf &gt;&gt; kafka.log</span><br><span class="line"><span class="built_in">echo</span> afilajf &gt;&gt; kafka.log</span><br></pre></td></tr></table></figure><br>可以看到 <code>flume2kafka</code> 主题的消费端已经收到了对应的消息：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alfhlaflkaEJFl</span><br><span class="line">aflkajlkf</span><br><span class="line">afilajf</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十、Azkaban-two-server--工作流调度</title>
      <link href="/posts/1a829385.html"/>
      <url>/posts/1a829385.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-fire modern"><p>简介：two server mode（双进程服务模式 ）：存放元数据的数据库为 MySQL，MySQL 应采用主从模式进行备份和容错。这种模式下 webServer 和 executorServer 在不同进程中运行（ 同一服务器 ）。该模式适合生产环境，更新和升级时对用户的影响较小。</p></div><div class="tip "><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E5%85%AB%E3%80%81Azkaban-solo-server--%3E%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%B0%83%E5%BA%A6%5D(https:/www.yuque.com/u25360462/nt1ri1/fwil15?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MxoE.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">八、Azkaban-solo-server-->工作流调度</div>            <div class="tag-link-sitename">简介：Gradle是一款Google推出的 **基于JVM**、 通用灵活的 项目构建工具， 支持**Maven**，JCenter多种第三方仓库;支持传递性依赖管理、废弃了繁杂的xml文件，转而使用 **简洁的 、 支持多种语言** (例如：java、**groovy**等)的 build脚本文件。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BAzkaban-two-server%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%5D(https:/mp.weixin.qq.com/s/a8z5gqCrBaWzTYqohvKWfQ)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MESY.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Azkaban-two-server环境搭建</div>            <div class="tag-link-sitename">Azkaban-two-server环境搭建-视频教程</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-1-创建目录，并解压和改名"><a href="#1-1-创建目录，并解压和改名" class="headerlink" title="1-1 创建目录，并解压和改名"></a>1-1 创建目录，并解压和改名</h3><p><font color=red size=3px weight=bold>分别解压azkaban目录下的</font><br><strong>1.azkaban-web-server/build/distributions/azkaban-web-server-0.1.0-SNAPSHOT.tar.gz<br>2.azkaban-exec-server/build/distributions/azkaban-exec-server-0.1.0-SNAPSHOT.tar.gz<br>3.azkaban-db/build/distributions/azkaban-db-0.1.0-SNAPSHOT.tar.gz</strong></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">mkdir</span> <span class="string">/opt/azkaban-two</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-zxvf</span> <span class="string">azkaban-web-server-0.1.0-SNAPSHOT.tar.gz</span> <span class="string">-C</span> <span class="string">/opt/azkaben-two</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-zxvf</span> <span class="string">azkaban-exec-server-0.1.0-SNAPSHOT.tar.gz</span> <span class="string">-C</span> <span class="string">/opt/azkaben-two</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-zxvf</span> <span class="string">azkaban-web-server-0.1.0-SNAPSHOT.tar.gz</span> <span class="string">-C</span> <span class="string">/opt/azkaben-two</span></span><br><span class="line"><span class="string">mv</span> <span class="string">azkaban-web-server-0.1.0-SNAPSHOT/</span> <span class="string">web-server</span></span><br><span class="line"><span class="string">mv</span> <span class="string">azkaban-exec-server-0.1.0-SNAPSHOT/</span> <span class="string">executor-server</span></span><br><span class="line"><span class="string">mv</span> <span class="string">azkaban-db-0.1.0-SNAPSHOT/</span> <span class="string">sql-db</span></span><br></pre></td></tr></table></figure><h3 id="1-2-创建MySQL数据库"><a href="#1-2-创建MySQL数据库" class="headerlink" title="1-2 创建MySQL数据库"></a>1-2 创建MySQL数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database azkaban_two;</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;Query OK, 1 row affected (0.01 sec)&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; use azkaban_two;</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;Database changed&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="built_in">source</span> /opt/azkaban-two/azkaban-db/create-all-sql-0.1.0-SNAPSHOT.sql</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Query OK, 0 rows affected (0.09 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Query OK, 0 rows affected (0.02 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Query OK, 0 rows affected (0.02 sec)</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="1-3-生成密钥和证书"><a href="#1-3-生成密钥和证书" class="headerlink" title="1-3 生成密钥和证书"></a>1-3 生成密钥和证书</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[huserg@master azkaban-two]$ keytool -keystore /opt/azkaban-two/web-server/keystore -<span class="built_in">alias</span> huser -genkey -keyalg rsa</span><br><span class="line"></span><br><span class="line">keytool是 Java 数据证书的管理工具，使用户能够管理自己的公 /私钥 对及相关证书 。</span><br><span class="line">-keystore 指定密钥库的名称及位置 (产生的各类信息将存在 .keystore文件中)</span><br><span class="line">-genkey (或者 -genkeypair) 生成密钥对</span><br><span class="line">-<span class="built_in">alias</span> 为生成的密钥对指定别名，如果没有默认是 mykey</span><br><span class="line">-keyalg 指定密钥的算法 RSA/DSA，默认是 DSA</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Warning:</span></span><br><span class="line"><span class="string">JKS 密钥库使用专用格式。建议使用 &quot;keytool -importkeystore -srckeystore /opt/azkaban-two/web-server/keystore -destkeystore /opt/azkaban-two/web-server/keystore -deststoretype pkcs12&quot; 迁移到行业标准格式 PKCS12。</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="1-4-查看密钥库信息"><a href="#1-4-查看密钥库信息" class="headerlink" title="1-4 查看密钥库信息"></a>1-4 查看密钥库信息</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 web-server]$ keytool -list -keystore keystore</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">输入密钥库口令:  </span></span><br><span class="line"><span class="string">密钥库类型: JKS</span></span><br><span class="line"><span class="string">密钥库提供方: SUN</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">您的密钥库包含 1 个条目</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">huser, 2022-11-3, PrivateKeyEntry, </span></span><br><span class="line"><span class="string">证书指纹 (SHA-256): C7:07:73:D9:81:19:43:6F:C3:8E:5A:E4:0D:0F:08:AA:98:C4:0A:D9:C4:C7:5A:B1:27:E9:1B:80:2C:68:66:5D</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Warning:</span></span><br><span class="line"><span class="string">JKS 密钥库使用专用格式。建议使用 &quot;keytool -importkeystore -srckeystore keystore -destkeystore keystore -deststoretype pkcs12&quot; 迁移到行业标准格式 PKCS12。</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="2-web-服务器配置"><a href="#2-web-服务器配置" class="headerlink" title="2. web 服务器配置"></a>2. web 服务器配置</h2><h3 id="2-1-在web服务器目录下创建多级文件夹plugins-jobtypes："><a href="#2-1-在web服务器目录下创建多级文件夹plugins-jobtypes：" class="headerlink" title="2-1 在web服务器目录下创建多级文件夹plugins/jobtypes："></a>2-1 在web服务器目录下创建多级文件夹<code>plugins/jobtypes</code>：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /opt/azkaban-two/web-server/plugins/jobtypes</span><br></pre></td></tr></table></figure><h3 id="2-2-进入-azkaban-web-服务器安装目录的conf目录下，修改azkaban-properties"><a href="#2-2-进入-azkaban-web-服务器安装目录的conf目录下，修改azkaban-properties" class="headerlink" title="2-2 进入 azkaban web 服务器安装目录的conf目录下，修改azkaban.properties"></a>2-2 进入 <code>azkaban web</code> 服务器安装目录的<code>conf目录</code>下，修改<strong>azkaban.properties</strong></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Azkaban Personalization Settings</span></span><br><span class="line"><span class="string">azkaban.name=huser</span></span><br><span class="line"><span class="string">azkaban.label=huser-Azkaban</span></span><br><span class="line"><span class="string">azkaban.color=#FF3601</span></span><br><span class="line"><span class="string">azkaban.default.servlet.path=/index</span></span><br><span class="line"><span class="string">web.resource.dir=/opt/azkaban-two/web-server/web</span></span><br><span class="line"><span class="string">default.timezone.id=Asia/Shanghai</span></span><br><span class="line"><span class="comment"># Azkaban UserManager class</span></span><br><span class="line"><span class="string">user.manager.class=azkaban.user.XmlUserManager</span></span><br><span class="line"><span class="string">user.manager.xml.file=/opt/azkaban-two/web-server/conf/azkaban-users.xml</span></span><br><span class="line"><span class="comment"># Loader for projects</span></span><br><span class="line"><span class="string">executor.global.properties=/opt/azkaban-two/web-server/conf/global.properties</span></span><br><span class="line"><span class="string">azkaban.project.dir=projects</span></span><br><span class="line"><span class="comment"># Velocity dev mode</span></span><br><span class="line"><span class="string">velocity.dev.mode=false</span></span><br><span class="line"><span class="comment"># Azkaban Jetty server properties.</span></span><br><span class="line"><span class="string">jetty.ssl.port=8443</span></span><br><span class="line"><span class="string">jetty.port=8081</span></span><br><span class="line"><span class="string">jetty.keystore=/opt/azkaban-two/web-server/keystore</span></span><br><span class="line"><span class="string">jetty.password=123456</span></span><br><span class="line"><span class="string">jetty.keypassword=123456</span></span><br><span class="line"><span class="string">jetty.truststore=/opt/azkaban-two/web-server/keystore</span></span><br><span class="line"><span class="string">jetty.trustpassword=huser</span></span><br><span class="line"><span class="string">jetty.maxThreads=25</span></span><br><span class="line"><span class="comment"># Azkaban Executor settings</span></span><br><span class="line"><span class="string">executor.port=11241</span></span><br><span class="line"><span class="comment"># mail settings</span></span><br><span class="line"><span class="string">mail.sender=</span></span><br><span class="line"><span class="string">mail.host=</span></span><br><span class="line"><span class="comment"># User facing web server configurations used to construct the user facing server URLs. They are useful when there is a reverse proxy between Azkaban web servers and users.</span></span><br><span class="line"><span class="comment"># enduser -&gt; myazkabanhost:443 -&gt; proxy -&gt; localhost:8081</span></span><br><span class="line"><span class="comment"># when this parameters set then these parameters are used to generate email links.</span></span><br><span class="line"><span class="comment"># if these parameters are not set then jetty.hostname, and jetty.port(if ssl configured jetty.ssl.port) are used.</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_hostname=myazkabanhost.com</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_ssl_port=443</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_port=8081</span></span><br><span class="line"><span class="string">job.failure.email=</span></span><br><span class="line"><span class="string">job.success.email=</span></span><br><span class="line"><span class="string">lockdown.create.projects=false</span></span><br><span class="line"><span class="string">cache.directory=cache</span></span><br><span class="line"><span class="comment"># JMX stats</span></span><br><span class="line"><span class="string">jetty.connector.stats=true</span></span><br><span class="line"><span class="string">executor.connector.stats=true</span></span><br><span class="line"><span class="comment"># Azkaban plugin settings</span></span><br><span class="line"><span class="string">azkaban.jobtype.plugin.dir=/opt/azkaban-two/web-server/plugins/jobtypes</span></span><br><span class="line"><span class="comment"># Azkaban mysql settings by default. Users should configure their own username and password.</span></span><br><span class="line"><span class="string">database.type=mysql</span></span><br><span class="line"><span class="string">mysql.port=3306</span></span><br><span class="line"><span class="string">mysql.host=192.168.33.147</span></span><br><span class="line"><span class="string">mysql.database=azkaban_two</span></span><br><span class="line"><span class="string">mysql.user=root</span></span><br><span class="line"><span class="string">mysql.password=1</span></span><br><span class="line"><span class="string">mysql.numconnections=100</span></span><br><span class="line"><span class="comment">#Multiple Executor</span></span><br><span class="line"><span class="string">azkaban.use.multiple.executors=true</span></span><br><span class="line"><span class="string">azkaban.executorselector.filters=StaticRemainingFlowSize,CpuStatus</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.NumberOfAssignedFlowComparator=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.Memory=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.LastDispatched=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.CpuUsage=1</span></span><br></pre></td></tr></table></figure><h3 id="2-3-log4j-properties修改日志文件路径"><a href="#2-3-log4j-properties修改日志文件路径" class="headerlink" title="2-3 log4j.properties修改日志文件路径"></a>2-3 <strong>log4j.properties</strong>修改日志文件路径</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j.appender.server.File=/opt/azkaban-two/web-server/logs/azkaban-webserver.log</span><br></pre></td></tr></table></figure><h3 id="2-4-在azkaban-web-服务器安装目录的conf目录下，-按照如下配置修改-azkaban-users-xml文件，增加自定义管理员用户"><a href="#2-4-在azkaban-web-服务器安装目录的conf目录下，-按照如下配置修改-azkaban-users-xml文件，增加自定义管理员用户" class="headerlink" title="2-4 在azkaban web 服务器安装目录的conf目录下， 按照如下配置修改 azkaban-users.xml文件，增加自定义管理员用户"></a>2-4 在<code>azkaban web</code> 服务器安装目录的<code>conf目录</code>下， 按照如下配置修改 <code>azkaban-users.xml文件</code>，增加自定义管理员用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;azkaban-users&gt;</span><br><span class="line">  &lt;user <span class="built_in">groups</span>=<span class="string">&quot;azkaban&quot;</span> password=<span class="string">&quot;azkaban&quot;</span> roles=<span class="string">&quot;admin&quot;</span> username=<span class="string">&quot;azkaban&quot;</span>/&gt;</span><br><span class="line">  &lt;user <span class="built_in">groups</span>=<span class="string">&quot;azkaban&quot;</span> password=<span class="string">&quot;xiaokang&quot;</span> roles=<span class="string">&quot;admin&quot;</span> username=<span class="string">&quot;xiaokang&quot;</span>/&gt;</span><br><span class="line">  &lt;user password=<span class="string">&quot;metrics&quot;</span> roles=<span class="string">&quot;metrics&quot;</span> username=<span class="string">&quot;metrics&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;role name=<span class="string">&quot;admin&quot;</span> permissions=<span class="string">&quot;ADMIN&quot;</span>/&gt;</span><br><span class="line">  &lt;role name=<span class="string">&quot;metrics&quot;</span> permissions=<span class="string">&quot;METRICS&quot;</span>/&gt;</span><br><span class="line">&lt;/azkaban-users&gt;</span><br></pre></td></tr></table></figure><h2 id="3-Executor-服务器配置"><a href="#3-Executor-服务器配置" class="headerlink" title="3. Executor 服务器配置"></a>3. <strong>Executor</strong> 服务器配置</h2><h3 id="3-1-进入-azkaban-executor服务器安装目录的conf目录下，修改azkaban-properties"><a href="#3-1-进入-azkaban-executor服务器安装目录的conf目录下，修改azkaban-properties" class="headerlink" title="3-1  进入 azkaban executor服务器安装目录的conf目录下，修改azkaban.properties"></a>3-1  进入 <code>azkaban executor</code>服务器安装目录的<code>conf目录</code>下，修改<strong>azkaban.properties</strong></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Azkaban Personalization Settings</span></span><br><span class="line"><span class="string">default.timezone.id=Asia/Shanghai</span></span><br><span class="line"><span class="comment"># Azkaban UserManager class</span></span><br><span class="line"><span class="comment"># Loader for projects</span></span><br><span class="line"><span class="string">executor.global.properties=/opt/azkaban-two/executor-server/conf/global.properties</span></span><br><span class="line"><span class="string">azkaban.project.dir=projects</span></span><br><span class="line"><span class="string">azkaban.webserver.url=https://master:8443</span></span><br><span class="line"><span class="comment"># Azkaban plugin settings</span></span><br><span class="line"><span class="string">azkaban.jobtype.plugin.dir=/opt/azkaban-two/executor-server/plugins/jobtypes</span></span><br><span class="line"><span class="comment"># Azkaban mysql settings by default. Users should configure their own username and password.</span></span><br><span class="line"><span class="string">database.type=mysql</span></span><br><span class="line"><span class="string">mysql.port=3306</span></span><br><span class="line"><span class="string">mysql.host=192.168.33.147</span></span><br><span class="line"><span class="string">mysql.database=azkaban_two</span></span><br><span class="line"><span class="string">mysql.user=root</span></span><br><span class="line"><span class="string">mysql.password=1</span></span><br><span class="line"><span class="string">mysql.numconnections=100</span></span><br><span class="line"><span class="comment"># Azkaban Executor settings</span></span><br><span class="line"><span class="string">executor.maxThreads=50</span></span><br><span class="line"><span class="string">executor.flow.threads=30</span></span><br><span class="line"><span class="string">executor.port=11241</span></span><br></pre></td></tr></table></figure><h3 id="3-2-log4j-properties修改日志文件路径"><a href="#3-2-log4j-properties修改日志文件路径" class="headerlink" title="3-2 log4j.properties修改日志文件路径"></a>3-2 <strong>log4j.properties</strong>修改日志文件路径</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j.appender.server.File=/opt/azkaban-two/executor-server/logs/azkaban-execserver.log</span><br></pre></td></tr></table></figure><h2 id="4-启动"><a href="#4-启动" class="headerlink" title="4.启动"></a>4.启动</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># executor服务器bin目录下执行启动命令</span></span><br><span class="line">[huser@master bin]$ ./start-exec.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;AzkabanExecutorServer&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 手动激活executor服务器</span></span><br><span class="line">[huser@master ~]$ curl http://master:11241/executor?action=activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># web服务器bin目录下执行启动命令</span></span><br><span class="line">[huser@master bin]$ ./start-web.sh </span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;AzkabanWebServer&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><font color=red size=3px weight=bold>以下内容跟   <code>基本任务调度</code>  一样</font><br><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E5%85%AB%E3%80%81Azkaban-solo-server--%3E%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%B0%83%E5%BA%A6%5D(https:/www.yuque.com/u25360462/nt1ri1/fwil15?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7MxoE.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">八、Azkaban-solo-server-->工作流调度</div>            <div class="tag-link-sitename">简介：Gradle是一款Google推出的 **基于JVM**、 通用灵活的 项目构建工具， 支持**Maven**，JCenter多种第三方仓库;支持传递性依赖管理、废弃了繁杂的xml文件，转而使用 **简洁的 、 支持多种语言** (例如：java、**groovy**等)的 build脚本文件。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div></p><p><strong>Azkaban-multiple-executor的操作</strong>只是把Azkaban-two-server的文件发给三台机，在跟Azkaban-two-server的操作任务一样</p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>七、Sqoop组件搭建--数据迁移工具</title>
      <link href="/posts/da145f53.html"/>
      <url>/posts/da145f53.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-cube modern"><p>简介：Apache Sqoop 是一个常用的数据迁移工具，主要用于在不同存储系统之间实现数据的导入与导出：</p><ul><li>导入数据：从 MySQL、Oracle 等关系型数据库中导入数据到 HDFS、Hive、HBase 等分布式文件存储系统中；</li><li>导出数据：从分布式文件系统中导出数据到关系数据库中。</li></ul><p><strong>Sqoop名字的由来：SQL—-Hadoop=Sq+oop=Sqoop</strong></p></div><div class="tip sync"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note success simple"><p>需要的安装包：<a href="https://archive.apache.org/dist/sqoop/"><strong>Sqoop</strong></a>包—-&gt;<strong>sqoop-1.4.6.bin__hadoop-2.0.4-alpha.tar.gz</strong></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><h3 id="1-解压并改名"><a href="#1-解压并改名" class="headerlink" title="1. 解压并改名"></a>1. 解压并改名</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf sqoop<span class="number">-1.4</span><span class="number">.6</span>.bin__hadoop<span class="number">-2.0</span><span class="number">.4</span>-alpha.tar.gz -C /opt/</span><br><span class="line">mv sqoop<span class="number">-1.4</span><span class="number">.6</span>.bin__hadoop<span class="number">-2.0</span><span class="number">.4</span>-alpha/ sqoop</span><br></pre></td></tr></table></figure><h2 id="2-配置Sqoop环境变量"><a href="#2-配置Sqoop环境变量" class="headerlink" title="2. 配置Sqoop环境变量"></a>2. 配置Sqoop环境变量</h2><h3 id="2-1-配置Sqoop环境变量"><a href="#2-1-配置Sqoop环境变量" class="headerlink" title="2.1 配置Sqoop环境变量"></a>2.1 配置Sqoop环境变量</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="meta"># sqoop</span></span><br><span class="line">export SQOOP_HOME=/opt/sqoop</span><br><span class="line">export PATH=$PATH:$SQOOP_HOME/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h2 id="3-修改配置"><a href="#3-修改配置" class="headerlink" title="3. 修改配置"></a>3. 修改配置</h2><h3 id="3-1-配置sqoop-env-sh"><a href="#3-1-配置sqoop-env-sh" class="headerlink" title="3.1 配置sqoop-env.sh"></a>3.1 <strong>配置sqoop-env.sh</strong></h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 拷贝 Sqoop 的环境配置模板</span></span><br><span class="line">cp sqoop-env-template.cmd sqoop-env.sh</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line">export HADOOP_COMMON_HOME=/opt/hadoop</span><br><span class="line">export HADOOP_MAPRED_HOME=/opt/hadoop</span><br><span class="line">export HBASE_HOME=/opt/hbase</span><br><span class="line">export HIVE_HOME=/opt/hive</span><br><span class="line">export ZOOCFGDIR=/opt/zookeeper</span><br><span class="line">export ZOOKEEPER=/opt/zookeeper</span><br></pre></td></tr></table></figure><h3 id="3-2-拷贝数据库驱动"><a href="#3-2-拷贝数据库驱动" class="headerlink" title="3.2 拷贝数据库驱动"></a>3.2 拷贝数据库驱动</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp mysql-connector-java<span class="number">-5.1</span><span class="number">.37</span>.jar /opt/sqoop/lib</span><br></pre></td></tr></table></figure><h3 id="3-3-验证"><a href="#3-3-验证" class="headerlink" title="3.3 验证"></a>3.3 验证</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sqoop version</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Sqoop 1.4.7</span></span><br><span class="line"><span class="string">git commit id 2328971411f57f0cb683dfb79d19d4d19d185dd8</span></span><br><span class="line"><span class="string">Compiled by maugli on Thu Dec 21 15:59:58 STD 2017</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="4-Sqoop基本命令"><a href="#4-Sqoop基本命令" class="headerlink" title="4.Sqoop基本命令"></a>4.Sqoop基本命令</h2><h3 id="4-1-查看所有命令"><a href="#4-1-查看所有命令" class="headerlink" title="4.1 查看所有命令"></a>4.1 查看所有命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">help</span></span><br></pre></td></tr></table></figure><h3 id="4-2-查看某条命令的具体使用方法"><a href="#4-2-查看某条命令的具体使用方法" class="headerlink" title="4.2 查看某条命令的具体使用方法"></a>4.2 查看某条命令的具体使用方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">help</span> 命令名</span><br><span class="line"><span class="comment">#例如sqoop help import</span></span><br></pre></td></tr></table></figure><h2 id="5-Sqoop-与-MySQL"><a href="#5-Sqoop-与-MySQL" class="headerlink" title="5. Sqoop 与 MySQL"></a>5. Sqoop 与 MySQL</h2><h3 id="5-1-查询MySQL所有数据库"><a href="#5-1-查询MySQL所有数据库" class="headerlink" title="5.1 查询MySQL所有数据库"></a>5.1 查询MySQL所有数据库</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sqoop</span> <span class="string">list-databases</span> <span class="string">--connect</span> <span class="string">jdbc:mysql://192.168.33.171:3306</span> <span class="string">--username</span> <span class="string">root</span> <span class="string">--password</span> <span class="number">000000</span></span><br></pre></td></tr></table></figure><h3 id="5-2-查询指定数据库种所有数据表"><a href="#5-2-查询指定数据库种所有数据表" class="headerlink" title="5.2 查询指定数据库种所有数据表"></a>5.2 查询指定数据库种所有数据表</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sqoop</span> <span class="string">list-tables</span> <span class="string">--connect</span> <span class="string">jdbc:mysql://192.168.33.171:3306/mysql</span> <span class="string">--username</span> <span class="string">root</span> <span class="string">--password</span> <span class="number">000000</span></span><br></pre></td></tr></table></figure><h2 id="6-Sqoop-与-HDFS"><a href="#6-Sqoop-与-HDFS" class="headerlink" title="6. Sqoop 与 HDFS"></a>6. Sqoop 与 HDFS</h2><h3 id="6-1-MySQL数据导入到HDFS"><a href="#6-1-MySQL数据导入到HDFS" class="headerlink" title="6.1 MySQL数据导入到HDFS"></a>6.1 MySQL数据导入到HDFS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://192.168.33.171:3306/test \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--table runoob_tbl \</span><br><span class="line">--delete-target-dir \</span><br><span class="line">--target-dir /sqoop \</span><br><span class="line">--fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">-m 3</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--table help_keyword \    # 待导入的表</span></span><br><span class="line"><span class="string">--delete-target-dir \    # 目标目录存在则先删除</span></span><br><span class="line"><span class="string">--target-dir /sqoop \    # 导入的目标目录</span></span><br><span class="line"><span class="string">--fields-terminated-by &#x27;</span>\t<span class="string">&#x27; \    # 指定导出数据的分隔符</span></span><br><span class="line"><span class="string">-m 3    # 指定并行执行的 map tasks 数量  </span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="6-2-导入验证"><a href="#6-2-导入验证" class="headerlink" title="6.2 导入验证"></a>6.2 导入验证</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看导入后的目录</span></span><br><span class="line">hdfs dfs -<span class="built_in">ls</span> -R /sqoop</span><br><span class="line"><span class="comment"># 查看导入内容</span></span><br><span class="line">hdfs dfs -<span class="built_in">cat</span> /sqoop/part-m-00000</span><br></pre></td></tr></table></figure><h3 id="6-3-增量导入"><a href="#6-3-增量导入" class="headerlink" title="6.3 增量导入"></a>6.3 增量导入</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword \</span><br><span class="line">--target-dir /sqoop  \</span><br><span class="line">--append \</span><br><span class="line">--incremental  append  \             </span><br><span class="line">--fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">--check-column  help_keyword_id \</span><br><span class="line">--last-value 463  \ </span><br><span class="line">-m 1</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--fields-terminated-by &#x27;</span>\t<span class="string">&#x27; \    # 指定导出数据的分隔符</span></span><br><span class="line"><span class="string">--check-column  help_keyword_id \    # 指明用于增量导入的参考列</span></span><br><span class="line"><span class="string">--last-value 463  \    # 指定参考列上次导入的最大值 </span></span><br><span class="line"><span class="string">-m 1</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="6-4-HDFS数据导出到MySQL"><a href="#6-4-HDFS数据导出到MySQL" class="headerlink" title="6.4 HDFS数据导出到MySQL"></a>6.4 HDFS数据导出到MySQL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE help_keyword_from_hdfs LIKE help_keyword;</span><br><span class="line">sqoop <span class="built_in">export</span> \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword_from_hdfs \</span><br><span class="line">--export-dir /sqoop/* \</span><br><span class="line">--input-fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">-m 3</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--table help_keyword_from_hdfs \     # 导出数据存储在 MySQL 的 help_keyword_from_hdf 的表中</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>六、Kylin(麒麟)安装及基本使用--多维分析</title>
      <link href="/posts/e170afa6.html"/>
      <url>/posts/e170afa6.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-book modern"><p>简介:  <a href="https://kylin.apache.org/cn/"><strong>Apache Kylin™</strong></a>是一个开源的、分布式的分析引擎，提供 Hadoop/Spark 之上的 SQL 查询接口及多维分析（OLAP）能力以支持超大规模数据，最初由 eBay 开发并贡献至开源社区。它能在亚秒内查询巨大的表。Apache Kylin也是中国人主导的、唯一的Apache顶级开源项目，在开源社区有世界级的影响力。</p></div><div class="tip bolt"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%BA%8C%E3%80%81zookeeper%E7%BB%84%E4%BB%B6%E6%90%AD%E5%BB%BA%5D(https:/www.yuque.com/u25360462/nt1ri1/wzn655?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7LkQP.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">二、zookeeper组件搭建</div>            <div class="tag-link-sitename">介绍：Zookeeper 是一个开源的分布式协调服务，目前由 Apache 进行维护。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%89%E3%80%81Hive%E7%BB%84%E4%BB%B6%E6%90%AD%E5%BB%BA--%3E%E5%86%85%E5%90%ABMySQL%E5%AE%89%E8%A3%85%5D(https:/www.yuque.com/u25360462/nt1ri1/zamxgf?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bvhc.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">三、Hive组件搭建-->内含MySQL安装</div>            <div class="tag-link-sitename">Hive：由Facebook开源用于解决海量结构化日志的数据统计。 Hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E5%9B%9B%E3%80%81HBase%E7%BB%84%E4%BB%B6%5D(https:/www.yuque.com/u25360462/nt1ri1/rncd28?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bDDb.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">四、HBase组件</div>            <div class="tag-link-sitename">介绍：HBase是一个分布式的、面向列的开源数据库，该技术来源于 Fay Chang 所撰写的Google论文“Bigtable：一个结构化数据的分布式存储系统。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note primary simple"><p>需要的安装包：<a href="http://kylin.apache.org/cn/download/"><strong>Kylin(麒麟)</strong></a>包—-&gt;<strong>apache-kylin-4.0.2-bin.tar.gz</strong></p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BKylin(%E9%BA%92%E9%BA%9F)%E5%AE%89%E8%A3%85%E5%8F%8A%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%5D(https:/mp.weixin.qq.com/s/mfvldzG9VFU6_jZSUJFuSg)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7byG9.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Kylin(麒麟)安装及基本使用</div>            <div class="tag-link-sitename">Apache Kylin™是一个开源的、分布式的分析引擎，提供 Hadoop/Spark 之上的 SQL 查询接口及多维分析（OLAP）能力以支持超大规模数据，最初由 eBay 开发并贡献至开源社区。它能在亚秒内查询巨大的表。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BKylin%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2_%E5%BF%84%E5%87%9D%5E%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2_kylin%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F%E9%83%A8%E7%BD%B2%5D(https:/blog.csdn.net/weixin_43660536/article/details/119773857)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bjDY.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Kylin集群安装部署</div>            <div class="tag-link-sitename">这里目录标题3、`Kylin`集群安装部署3.1. 下载上传3.1.2 修改 hive 配置文件3.1.3 修改 hbase 配置文件3.1.4 配置 kylin 相关环境变量3.1.5 修改配置文件3.1.6 拷贝kylin到其他节点3.1.7 启动3.1.8 关机拍照3、Kylin集群安装部署安装前提OS: CentOS 7java 1.8zookeeper 3.4.5</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1 准备工作"></a>1 准备工作</h2><h3 id="1-解压并改名"><a href="#1-解压并改名" class="headerlink" title="1. 解压并改名"></a>1. 解压并改名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-kylin-4.0.2-bin.tar.gz -C /opt/</span><br><span class="line"><span class="built_in">mv</span> apache-kylin-4.0.2-bin kylin</span><br></pre></td></tr></table></figure><h2 id="2-配置Kylin环境变量"><a href="#2-配置Kylin环境变量" class="headerlink" title="2. 配置Kylin环境变量"></a>2. 配置Kylin环境变量</h2><h3 id="1-配置Kylin环境变量"><a href="#1-配置Kylin环境变量" class="headerlink" title="1. 配置Kylin环境变量"></a>1. 配置Kylin环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> KYLIN_HOME=/opt/kylin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$KYLIN_HOME</span>/bin</span><br></pre></td></tr></table></figure><h3 id="2-加载环境变量"><a href="#2-加载环境变量" class="headerlink" title="2. 加载环境变量"></a>2. 加载环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h2 id="3-修改配置"><a href="#3-修改配置" class="headerlink" title="3. 修改配置"></a>3. 修改配置</h2><p>3.1.1 配置<code>conf目录</code>下的<code>kylin.properties</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改成东八区, 否则会出现时间显示不准的问题</span></span><br><span class="line">kylin.web.timezone=GMT+8</span><br></pre></td></tr></table></figure><br>3.1.2 配置bin目录下的kylin.sh<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ -z <span class="variable">$reload_dependency</span> &amp;&amp; `<span class="built_in">ls</span> -1 <span class="variable">$&#123;dir&#125;</span>/cached-* 2&gt;/dev/null | <span class="built_in">wc</span> -l` -eq 5 ]]</span><br><span class="line">   <span class="keyword">then</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;Using cached dependency...&quot;</span></span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hive-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hbase-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hadoop-conf-dir.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-kafka-dependency.sh</span><br><span class="line">       <span class="comment">#source $&#123;dir&#125;/cached-spark-dependency.sh</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hive-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hbase-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hadoop-conf-dir.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-kafka-dependency.sh</span><br><span class="line">       <span class="comment">#source $&#123;dir&#125;/find-spark-dependency.sh</span></span><br><span class="line">   <span class="keyword">fi</span></span><br></pre></td></tr></table></figure><br>3.1.3 配置HBased的<strong>hbase-site.xml</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--指定 zookeeper 地址--&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master,slave1,slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><h2 id="4-启动Kylin"><a href="#4-启动Kylin" class="headerlink" title="4. 启动Kylin"></a>4. 启动Kylin</h2><p><strong>4.1.1 启动Kylin之前确保HDFS、YARN、Zookeeper、HBase已经启动</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kylin.sh start</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">A new Kylin instance is started by root. To stop it, run &#x27;</span>kylin.sh stop<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Check the log at /opt/kylin/logs/kylin.log</span></span><br><span class="line"><span class="string">Web UI is at http://master:7070/kylin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">A new Kylin instance is started by root. To stop it, run &#x27;</span>kylin.sh stop<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Check the log at /opt/kylin/logs/kylin.log</span></span><br><span class="line"><span class="string">Web UI is at http://slave1:7070/kylin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">A new Kylin instance is started by root. To stop it, run &#x27;</span>kylin.sh stop<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Check the log at /opt/kylin/logs/kylin.log</span></span><br><span class="line"><span class="string">Web UI is at http://slave2:7070/kylin</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">访问 https://slave2:7070/kylin ；默认的用户名和密码为 ADMIN 和 KYLIN</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>九、Azkaban-solo-server--工作流调度</title>
      <link href="/posts/682fb25a.html"/>
      <url>/posts/682fb25a.html</url>
      
        <content type="html"><![CDATA[<h1 id="1-Gradle安装"><a href="#1-Gradle安装" class="headerlink" title="1. Gradle安装"></a>1. <a href="https://blog.csdn.net/qq_42055933/article/details/125923776?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166737555116782395381760%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166737555116782395381760&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125923776-null-null.142^v62^pc_rank_34_queryrelevant25,201^v3^control_1,213^v1^control&amp;utm_term=Gradle&amp;spm=1018.2226.3001.4187"><strong>Gradle</strong></a>安装</h1><div class="note green anzhiyufont anzhiyu-icon-gear modern"><p>简介：Gradle是一款Google推出的 <strong>基于JVM</strong>、 通用灵活的 项目构建工具， 支持<a href="https://so.csdn.net/so/search?q=Maven&amp;spm=1001.2101.3001.7020"><strong>Maven</strong></a>，JCenter多种第三方仓库;支持传递性依赖管理、废弃了繁杂的xml文件，转而使用 <strong>简洁的 、 支持多种语言</strong> (例如：java、<a href="https://so.csdn.net/so/search?q=groovy&amp;spm=1001.2101.3001.7020"><strong>groovy</strong></a>等)的 build脚本文件 。</p></div><div class="tip bell"><p>前置准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="note warning modern"><p>需要的安装包： <strong><a href="https://gradle.org/releases/">Gradle</a>包—-&gt;gradle-4.6-all.zip</strong></p></div><font color=red size=3px weight=bold>注意：有版本依赖，过高的版本会报错</font>## 1-1 准备工作### 1-1-1 下载zip解压组件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install unzip</span><br></pre></td></tr></table></figure>### 1-1-2 解压并改名<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unzip gradle-4.6-all.zip -r /opt/</span><br><span class="line"><span class="built_in">mv</span> gradle-4.6 gradle</span><br></pre></td></tr></table></figure>## 1-2 配置Gradle环境变量### 1-2-1 配置Gradle环境变量<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line">添加：</span><br><span class="line"><span class="comment"># gradle</span></span><br><span class="line"><span class="built_in">export</span> GRADLE_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> GRADLE_USER_HOME=/opt/gradle</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GRADLE_HOME</span>/bin</span><br></pre></td></tr></table></figure>### 1-2-2 加载环境变量<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>## 1-3 修改配置### 1-3-1 创建本地目录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /opt/gradle/gradle_repository</span><br></pre></td></tr></table></figure>### 1-3-2 新创建文件并配置 `init.gradle`**（ init.gradle就相当于maven中的settings.xml）**配置在`/opt/gradle/init.d`<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123; url <span class="string">&#x27;file:///opt/maven/maven_repository&#x27;</span>&#125;</span><br><span class="line">        <span class="built_in">mavenLocal</span>()</span><br><span class="line">        maven &#123; name <span class="string">&quot;Alibaba&quot;</span> ; url <span class="string">&quot;https://maven.aliyun.com/repository/public&quot;</span> &#125;</span><br><span class="line">        maven &#123; name <span class="string">&quot;Bstek&quot;</span> ; url <span class="string">&quot;http://nexus.bsdn.org/content/groups/public/&quot;</span> &#125;</span><br><span class="line">        <span class="built_in">mavenCentral</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildscript &#123; </span><br><span class="line">        repositories &#123; </span><br><span class="line">            maven &#123; name <span class="string">&quot;Alibaba&quot;</span> ; url <span class="string">&#x27;https://maven.aliyun.com/repository/public&#x27;</span> &#125;</span><br><span class="line">            maven &#123; name <span class="string">&quot;Bstek&quot;</span> ; url <span class="string">&#x27;http://nexus.bsdn.org/content/groups/public/&#x27;</span> &#125;</span><br><span class="line">            maven &#123; name <span class="string">&quot;M2&quot;</span> ; url <span class="string">&#x27;https://plugins.gradle.org/m2/&#x27;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>## 1-4 验证### 1-4-1 是否安装成功<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[huser@master bin]$ ./gradle -v</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"><span class="string">Gradle 4.6.0</span></span><br><span class="line"><span class="string">------------------------------------------------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Build time:   2022-10-17 07:44:02 UTC</span></span><br><span class="line"><span class="string">Revision:     a6198e44749b18b37e26b3b3467db17e034bcff4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Kotlin:       1.4.20</span></span><br><span class="line"><span class="string">Groovy:       2.5.12</span></span><br><span class="line"><span class="string">Ant:          Apache Ant(TM) version 1.10.9 compiled on September 27 2020</span></span><br><span class="line"><span class="string">JVM:          1.8.0_341 (Oracle Corporation 25.341-b10)</span></span><br><span class="line"><span class="string">OS:           Linux 3.10.0-862.el7.x86_64 amd64</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><br><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BAzkaban-solo-server%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B%5D(https:/mp.weixin.qq.com/s/qNGI1iJVvnrjrz8z83B0Qg)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7labz.jpg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">Azkaban-solo-server环境搭建</div>            <div class="tag-link-sitename">Azkaban-solo-server环境搭建-视频教程</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div># 2. [**Azkaban-solo-server**](https://azkaban.readthedocs.io/en/latest/containerization-design.html)安装<div class="note green anzhiyufont anzhiyu-icon-gear modern"><p>简介：solo-server mode（单服务模式）：元数据默认存放在内置的 H2 数据库，该模式中 webServer(管理服务器) 和 executorServer(执行服务器) 运行在同一个进程中，进程名是 AzkabanSingleServer 。该模式适用于小规模工作流的调度，适合用于尝试和了解azkaban的功能。</p></div><div class="note primary simple"><p>需要的安装包： <strong><a href="https://github.com/azkaban/azkaban/releases">azkaban</a>包—-&gt;azkaban-3.57.0.tar.gz</strong></p></div>## 2-1 准备工作### 2-1-1 解压并改名<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf azkaban-3.57.0.tar.gz</span><br><span class="line"><span class="built_in">mv</span> azkaban-3.57.0 azkaban</span><br></pre></td></tr></table></figure>## 2-2 源码编译### 2-2-1 查看Azkaban 依赖 Gradle 版本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/azkaban/gradle/wrapper/gradle-wrapper.properties</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Copyright 2018 LinkedIn Corp.</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not</span></span><br><span class="line"><span class="string"># use this file except in compliance with the License. You may obtain a copy of</span></span><br><span class="line"><span class="string"># the License at</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="string"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></span><br><span class="line"><span class="string"># WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the</span></span><br><span class="line"><span class="string"># License for the specific language governing permissions and limitations under</span></span><br><span class="line"><span class="string"># the License.</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">distributionBase=GRADLE_USER_HOME</span></span><br><span class="line"><span class="string">distributionPath=wrapper/dists</span></span><br><span class="line"><span class="string">zipStoreBase=GRADLE_USER_HOME</span></span><br><span class="line"><span class="string">zipStorePath=wrapper/dists</span></span><br><span class="line"><span class="string">distributionUrl=https\://services.gradle.org/distributions/gradle-4.6-all.zip</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>### 2-2-2 拷贝对应gradle版本和修改`gradle-wrapper.properties`中的 **distributionUrl 属性**，指明使用本地的 `gradle`<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> gradle-4.6-all.zip /opt/azkaban/gradle/wrapper/</span><br><span class="line">vim /opt/azkaban/gradle/wrapper/gradle-wrapper.properties</span><br><span class="line">修改为：</span><br><span class="line">distributionUrl=gradle-4.6-all.zip</span><br></pre></td></tr></table></figure>### 2-2-3 在安装目录下执行编译命令<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@master azkaban]$ ./gradlew distTar</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">BUILD SUCCESSFUL in 25s</span></span><br><span class="line"><span class="string">54 actionable tasks: 5 executed, 49 up-to-date</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>### 2-2-4 报错解决<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Parallel execution with configuration on demand is an incubating feature.</span><br><span class="line"></span><br><span class="line">FAILURE: Build failed with an exception.</span><br><span class="line"></span><br><span class="line">* Where:</span><br><span class="line">Build file <span class="string">&#x27;/opt/azkaban/build.gradle&#x27;</span> line: 41</span><br><span class="line"></span><br><span class="line">* What went wrong:</span><br><span class="line">A problem occurred evaluating root project <span class="string">&#x27;azkaban&#x27;</span>.</span><br><span class="line">&gt; Failed to apply plugin [<span class="built_in">id</span> <span class="string">&#x27;com.cinnober.gradle.semver-git&#x27;</span>]</span><br><span class="line">   &gt; Cannot run program <span class="string">&quot;git&quot;</span> (<span class="keyword">in</span> directory <span class="string">&quot;/opt/azkaban&quot;</span>): error=2, 没有那个文件或目录</span><br><span class="line"></span><br><span class="line">* Try:</span><br><span class="line">Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more <span class="built_in">log</span> output. Run with --scan to get full insights.</span><br><span class="line"></span><br><span class="line">* Get more <span class="built_in">help</span> at https://help.gradle.org</span><br><span class="line"></span><br><span class="line">BUILD FAILED <span class="keyword">in</span> 1s</span><br><span class="line"></span><br><span class="line">解决方案：下载组件，因为linux没有下载git的渠道</span><br><span class="line">sudo yum -y install git</span><br><span class="line">sudo yum -y install gcc-c++</span><br></pre></td></tr></table></figure>## 2-3 Solo Server 模式部署### 2-3-1 解压编译后的`Solo Server`模式安装包,并改名<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/azkaban/azkaban-solo-server/build/distributions/</span><br><span class="line">tar -zxvf azkaban-solo-server-0.1.0-SNAPSHOT.tar.gz -C /opt/</span><br><span class="line"><span class="built_in">mv</span> azkaban-solo-server-0.1.0-SNAPSHOT/ azkaban-solo-serve</span><br></pre></td></tr></table></figure>### 2-3-2 修改时区，进入`conf目录`，修改**azkaban.properties**<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim azkaban.properties</span><br><span class="line">修改为：</span><br><span class="line">default.timezone.id=Asia/Shanghai</span><br></pre></td></tr></table></figure>### 2-3-3 启动，执行启动命令，需要注意的是一定要在根目录下执行，不能进入 `bin目录`下执行，不然会抛出 `Cannot find 'database.properties'` 异常。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@master azkaban-solo-server]$ bin/start-solo.sh </span><br></pre></td></tr></table></figure>### 2-3-4 验证#### 第一种：<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">114226</span> AzkabanSingleServer</span><br><span class="line"><span class="number">114238</span> Jps</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"># 如果节点占用端口，如：</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="number">114226</span> AzkabanSingleServer</span><br><span class="line"><span class="number">113927</span> GradleDaemon</span><br><span class="line"><span class="number">110906</span> DataXExecutorApplication</span><br><span class="line"><span class="number">114238</span> Jps</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">就直接卡掉</span><br><span class="line">kill <span class="number">-9</span> <span class="number">113927</span> <span class="number">110906</span></span><br></pre></td></tr></table></figure>#### 第二种：验证方式二：访问 8081 端口，查看 Web UI 界面，默认的登录名密码都是 `azkaban`，如果需要修改或新增用户，可以在 `conf/azkaban-users.xml` 文件中进行配置：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;azkaban-users&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">user</span> <span class="attr">groups</span>=<span class="string">&quot;azkaban&quot;</span> <span class="attr">password</span>=<span class="string">&quot;azkaban&quot;</span> <span class="attr">roles</span>=<span class="string">&quot;admin&quot;</span> <span class="attr">username</span>=<span class="string">&quot;azkaban&quot;</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">user</span> <span class="attr">password</span>=<span class="string">&quot;metrics&quot;</span> <span class="attr">roles</span>=<span class="string">&quot;metrics&quot;</span> <span class="attr">username</span>=<span class="string">&quot;metrics&quot;</span>/&gt;</span></span></span><br><span class="line"></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">role</span> <span class="attr">name</span>=<span class="string">&quot;admin&quot;</span> <span class="attr">permissions</span>=<span class="string">&quot;ADMIN&quot;</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">role</span> <span class="attr">name</span>=<span class="string">&quot;metrics&quot;</span> <span class="attr">permissions</span>=<span class="string">&quot;METRICS&quot;</span>/&gt;</span></span></span><br><span class="line">&lt;/azkaban-users&gt;</span><br></pre></td></tr></table></figure><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>Azkaban-solo-server</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MPdC.png" alt="Azkaban-solo-server" title="Azkaban-solo-server"></p><h2 id="2-3-基本任务调度"><a href="#2-3-基本任务调度" class="headerlink" title="2-3 基本任务调度"></a>2-3 基本任务调度</h2><h3 id="2-3-1-新建项目"><a href="#2-3-1-新建项目" class="headerlink" title="2-3-1 新建项目"></a>2-3-1 新建项目</h3><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>Azkaban 主界面创建一个新项目</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MXMu.png" alt="Azkaban 主界面创建一个新项目" title="Azkaban 主界面创建一个新项目"></p><h3 id="2-3-2-任务配置"><a href="#2-3-2-任务配置" class="headerlink" title="2-3-2 任务配置"></a>2-3-2 任务配置</h3><p>新建任务配置文件 huser.job，内容如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#command.job</span></span><br><span class="line"><span class="built_in">type</span>=<span class="built_in">command</span></span><br><span class="line"><span class="built_in">command</span>=<span class="built_in">echo</span> <span class="string">&#x27;Hello Azkaban,Flow-1.0!xk1181259634!$$$$!  Azkaban &#x27;</span></span><br></pre></td></tr></table></figure><br> 通过 Web UI 界面上传：<br> <font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>Azkaban-solo-server—打包上传</font></p><p><img src="https://vip.helloimg.com/images/2023/12/18/o7M3Xt.png" alt="Azkaban-solo-server--打包上传" title="Azkaban-solo-server--打包上传"></p><h3 id="2-3-4-执行任务，-点击页面上的-Execute-Flow-执行任务："><a href="#2-3-4-执行任务，-点击页面上的-Execute-Flow-执行任务：" class="headerlink" title="2-3-4 执行任务， 点击页面上的 Execute Flow 执行任务："></a>2-3-4 执行任务， 点击页面上的 Execute Flow 执行任务：</h3> <font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>Azkaban-solo-server--执行任务</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7MaVQ.png" alt="Azkaban-solo-server--执行任务" title="Azkaban-solo-server--执行任务"></p><h3 id="2-3-5-执行结果，点击-Log-可以查看到任务的执行日志"><a href="#2-3-5-执行结果，点击-Log-可以查看到任务的执行日志" class="headerlink" title="2-3-5 执行结果，点击 Log 可以查看到任务的执行日志"></a>2-3-5 执行结果，点击 Log 可以查看到任务的执行日志</h3>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三、Hive组件搭建--内含MySQL安装</title>
      <link href="/posts/e3a54e89.html"/>
      <url>/posts/e3a54e89.html</url>
      
        <content type="html"><![CDATA[<div class="tip error"><p>前提准备：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%BA%8C%E3%80%81zookeeper%E7%BB%84%E4%BB%B6%E6%90%AD%E5%BB%BA%5D(https:/www.yuque.com/u25360462/nt1ri1/wzn655?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7LkQP.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">二、zookeeper组件搭建</div>            <div class="tag-link-sitename">介绍：Zookeeper 是一个开源的分布式协调服务，目前由 Apache 进行维护。</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="tip ban"><p>需要的安装包：</p></div><p>1.<a href="https://dev.mysql.com/downloads/file/?id=514685"><strong>MySQL</strong></a>压缩包—-&gt;mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar<br>2.<a href="https://dlcdn.apache.org/hive/"><strong>Hive</strong></a>压缩包—-&gt;apache-hive-2.3.4-bin.tar.gz<br>3.<a href="https://dev.mysql.com/downloads/connector/j/"><strong>MySQL的jar</strong></a>包—-&gt;mysql-connector-java-5.1.37.jar<br>4.<a href="https://www.apache.org/dyn/closer.lua/tez/0.9.2/"><strong>tez引擎</strong></a>包—-&gt;apache-tez-0.9.2-bin.tar.gz</p><h1 id="一、CentOS7-x安装MYSQL8-0-19"><a href="#一、CentOS7-x安装MYSQL8-0-19" class="headerlink" title="一、CentOS7.x安装MYSQL8.0.19"></a>一、CentOS7.x安装MYSQL8.0.19</h1><font color=red size=3px>跟Hive组件一起连用，如果不需要，可以跳过</font><details class="folding-tag" yellow><summary> MySQL 8.0新特性： </summary>              <div class='content'>              <ul><li>1、默认字符集由latin1变为utf8mb4</li><li>2、MyISAM系统表全部换成InnoDB表</li><li>3、自增主键AUTO_INCREMENT的值支持持久化</li><li>4、InnoDB表的DDL支持事务完整性</li><li>5、支持在线修改全局参数并持久化</li><li>6、新增降序索引</li><li>7、对于group by字段不再隐式排序</li><li>8、大幅改进了对JSON的支持</li><li>9、支持redo和undo日志加密</li><li>10、InnoDB select for update跳过锁等待</li><li>11、在SQL语法中增加SET_VAR语法</li><li>12、使用INVISIBLE关键字在创建表或进行表变更中设置索引是否可见</li><li>13、支持直方图</li><li>14、新增innodb_dedicated_server参数</li><li>15、日志分类更详细</li><li>16、undo空间自动回收</li><li>17、新增资源组功能，用于调控线程优先级及绑定CPU</li><li>18、增加角色管理</li></ul>              </div>            </details><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B009-%E5%B0%9A%E7%A1%85%E8%B0%B7-Hive-%E9%85%8D%E7%BD%AEHive%E5%85%83%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%BAMySQL&%E5%86%8D%E6%AC%A1%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95_%E5%93%94%E5%93%A9%E5%93%94%E5%93%A9_bilibili%5D(https:/www.bilibili.com/video/BV1EZ4y1G7iL/?p=9&spm_id_from=pageDriver&vd_source=da2acaac8a1d2357dae9e3de7ea3357e)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/18/o7bdwh.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">尚硅谷-Hive-配置Hive元数据存储为MySQL</div>            <div class="tag-link-sitename">009-尚硅谷-Hive-配置Hive元数据存储为MySQL&再次启动测试_哔哩哔哩_bilibili</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div>## 1. 安装文件### 1.1 关闭[**firewalld**](https://so.csdn.net/so/search?q=firewalld&urw=)和[**selinux**](https://so.csdn.net/so/search?q=selinux&urw=)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="string">&#x27;查看防火墙&#x27;</span>&gt; systemctl status firewalld</span><br><span class="line">&lt;<span class="string">&#x27;关闭防火墙&#x27;</span>&gt; sudo systemctl stop firewalld</span><br><span class="line">&lt;<span class="string">&#x27;关闭selinux&#x27;</span>&gt; sudo vim /etc/selinux/config</span><br><span class="line">修改为:</span><br><span class="line">      SELINUX=disabled</span><br><span class="line">      SELINUXTYPE=targeted</span><br><span class="line">&lt;<span class="string">&#x27;查看selinux&#x27;</span>&gt; sestatus</span><br></pre></td></tr></table></figure>### 1.2 删除CentOS 7.x自带的[**MariaDB**](https://so.csdn.net/so/search?q=MariaDB&urw=)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="string">&#x27;查看mariadb&#x27;</span>&gt; rpm -qa | grep -i mariadb</span><br><span class="line">mariadb-libs-5.5.56-2.el7.x86_64</span><br><span class="line">&lt;<span class="string">&#x27;删掉mariadb&#x27;</span>&gt; sudo rpm -e --nodeps mariadb-libs-5.5.56-2.el7.x86_64</span><br></pre></td></tr></table></figure>### <font color=red>(可跳过)</font>1.3 删除原有的MySQL<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="string">&#x27;查看MySQL&#x27;</span>&gt; rpm -qa | grep -i mysql</span><br><span class="line">&lt;<span class="string">&#x27;卸载MySQL&#x27;</span>&gt; sudo yum -y remove <span class="string">&#x27;文件&#x27;</span></span><br><span class="line">&lt;<span class="string">&#x27;查找MySQL相关目录&#x27;</span>&gt; sudo find / -name mysql</span><br><span class="line">&lt;<span class="string">&#x27;删除MySQL相关目录&#x27;</span>&gt; sudo <span class="built_in">rm</span> -rf <span class="string">&#x27;文件&#x27;</span></span><br></pre></td></tr></table></figure>### 1.4 下载并安装[**MySQL8.0**](https://blog.csdn.net/young_0609/article/details/109015666)<font color=red>这里直接使用`mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar`就行了不用wget下载</font><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wegt 不能执行,就直接下载wegt组件 ---&gt;  sudo yum -y install wget</span></span><br><span class="line"><span class="string">wget</span> <span class="string">https://cdn.mysql.com//Downloads/MySQL-Cluster-8.0/mysql-cluster-community-8.0.31-1.el9.x86_64.rpm-bundle.tar</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-xf</span> <span class="string">mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar</span> <span class="string">-C</span> <span class="string">/opt/</span></span><br></pre></td></tr></table></figure><h3 id="1-5-压缩MySQL运行包"><a href="#1-5-压缩MySQL运行包" class="headerlink" title="1.5 压缩MySQL运行包"></a>1.5 压缩MySQL运行包</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">sudo</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">mysql-community-common-5.7.28-1.el7.x86_64.rpm</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">mysql-community-libs-5.7.28-1.el7.x86_64.rpm</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">mysql-community-libs-compat-5.7.28-1.el7.x86_64.rpm</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">mysql-community-client-5.7.28-1.el7.x86_64.rpm</span></span><br><span class="line"><span class="string">sudo</span> <span class="string">rpm</span> <span class="string">-ivh</span> <span class="string">mysql-community-server-5.7.28-1.el7.x86_64.rpm</span></span><br></pre></td></tr></table></figure><h3 id="1-6-如果mysql-community-server-5-7-28-1-el7-x86-64-rpm安装报错，就下载MySQL-server依赖包"><a href="#1-6-如果mysql-community-server-5-7-28-1-el7-x86-64-rpm安装报错，就下载MySQL-server依赖包" class="headerlink" title="1.6 如果mysql-community-server-5.7.28-1.el7.x86_64.rpm安装报错，就下载MySQL-server依赖包"></a>1.6 如果<code>mysql-community-server-5.7.28-1.el7.x86_64.rpm</code>安装报错，就下载MySQL-server依赖包</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">yum</span> <span class="string">-y</span> <span class="string">install</span> <span class="string">libaio</span></span><br></pre></td></tr></table></figure><h2 id="2-配置MySQL文件并启动"><a href="#2-配置MySQL文件并启动" class="headerlink" title="2. 配置MySQL文件并启动"></a>2. 配置MySQL文件并启动</h2><h3 id="2-1-查看datadir的值"><a href="#2-1-查看datadir的值" class="headerlink" title="2.1 查看datadir的值"></a>2.1 查看datadir的值</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/my.cnf</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"># For advice on how to change settings please see</span></span><br><span class="line"><span class="string"># http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Remove leading # and set to the amount of RAM for the most important data</span></span><br><span class="line"><span class="string"># cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.</span></span><br><span class="line"><span class="string"># innodb_buffer_pool_size = 128M</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Remove leading # to turn on a very important data integrity option: logging</span></span><br><span class="line"><span class="string"># changes to the binary log between backups.</span></span><br><span class="line"><span class="string"># log_bin</span></span><br><span class="line"><span class="string">#</span></span><br><span class="line"><span class="string"># Remove leading # to set options mainly useful for reporting servers.</span></span><br><span class="line"><span class="string"># The server defaults are faster for transactions and fast SELECTs.</span></span><br><span class="line"><span class="string"># Adjust sizes as needed, experiment to find the optimal values.</span></span><br><span class="line"><span class="string"># join_buffer_size = 128M</span></span><br><span class="line"><span class="string"># sort_buffer_size = 2M</span></span><br><span class="line"><span class="string"># read_rnd_buffer_size = 2M</span></span><br><span class="line"><span class="string">datadir=/var/lib/mysql</span></span><br><span class="line"><span class="string">socket=/var/lib/mysql/mysql.sock</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Disabling symbolic-links is recommended to prevent assorted security risks</span></span><br><span class="line"><span class="string">symbolic-links=0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">log-error=/var/log/mysqld.log</span></span><br><span class="line"><span class="string">pid-file=/var/run/mysqld/mysqld.pid</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-删除-var-lib-mysql目录下的所有内容："><a href="#2-2-删除-var-lib-mysql目录下的所有内容：" class="headerlink" title="2.2 删除/var/lib/mysql目录下的所有内容："></a>2.2 删除<code>/var/lib/mysql目录</code>下的所有内容：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> -rf ./*// 注意执行命令,删错了重来(传说中的：删库跑路)</span><br><span class="line"><span class="comment">#查看内容:</span></span><br><span class="line">sudo <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><h3 id="2-3-初始化数据库"><a href="#2-3-初始化数据库" class="headerlink" title="2.3 初始化数据库"></a>2.3 <a href="https://blog.csdn.net/liuwkk/article/details/110627234"><strong>初始化</strong></a>数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mysqld --initialize --user=mysql</span><br></pre></td></tr></table></figure><h3 id="2-4-查看临时生成的root用户的密码"><a href="#2-4-查看临时生成的root用户的密码" class="headerlink" title="2.4 查看临时生成的root用户的密码"></a>2.4 查看临时生成的root用户的密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cat</span> /var/log/mysqld.log</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.104258Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.525465Z 0 [Warning] InnoDB: New log files created, LSN=45790</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.703239Z 0 [Warning] InnoDB: Creating foreign key constraint system tables.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.822416Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: 2b9e4e23-635e-11ed-a517-000c29b25ef7.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:22.826219Z 0 [Warning] Gtid table is not ready to be used. Table &#x27;</span>mysql.gtid_executed<span class="string">&#x27; cannot be opened.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:23.146937Z 0 [Warning] CA certificate ca.pem is self signed.</span></span><br><span class="line"><span class="string">2022-11-13T14:19:23.425713Z 1 [Note] A temporary password is generated for root@localhost: ?yr6d34alX5q</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 密码:  ?yr6d34alX5q</span></span><br></pre></td></tr></table></figure><h3 id="2-5-启动MySQL及查看启动状态"><a href="#2-5-启动MySQL及查看启动状态" class="headerlink" title="2.5 启动MySQL及查看启动状态"></a>2.5 启动MySQL及查看启动状态</h3><font color=red size=3px>不是管理者需要sudo</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">service mysqld start</span><br><span class="line">service mysqld status</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Redirecting to /bin/systemctl status mysqld.service</span></span><br><span class="line"><span class="string">● mysqld.service - MySQL Server</span></span><br><span class="line"><span class="string">   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)</span></span><br><span class="line"><span class="string">   Active: active (running) since 日 2022-11-13 22:24:37 CST; 18s ago</span></span><br><span class="line"><span class="string">     Docs: man:mysqld(8)</span></span><br><span class="line"><span class="string">           http://dev.mysql.com/doc/refman/en/using-systemd.html</span></span><br><span class="line"><span class="string">  Process: 42313 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span></span><br><span class="line"><span class="string">  Process: 42296 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)</span></span><br><span class="line"><span class="string"> Main PID: 42316 (mysqld)</span></span><br><span class="line"><span class="string">   CGroup: /system.slice/mysqld.service</span></span><br><span class="line"><span class="string">           └─42316 /usr/sbin/mysqld --daemonize --pid-file=/var/run...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">11月 13 22:24:36 master systemd[1]: Starting MySQL Server...</span></span><br><span class="line"><span class="string">11月 13 22:24:37 master systemd[1]: Started MySQL Server.</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#  running 证明已开启</span></span><br><span class="line"><span class="comment">#  dead 证明已关闭</span></span><br></pre></td></tr></table></figure><h3 id="2-6-登录-lt-—-gt-登出"><a href="#2-6-登录-lt-—-gt-登出" class="headerlink" title="2.6  登录 &lt;! —- !&gt; 登出"></a>2.6  <strong>登录</strong> &lt;! —- !&gt; <strong>登出</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">Enter password:<span class="string">&#x27;?yr6d34alX5q(临时密码)&#x27;</span></span><br><span class="line"><span class="comment"># Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span><br><span class="line"><span class="comment"># Your MySQL connection id is 16</span></span><br><span class="line"><span class="comment"># Server version: 8.0.20 MySQL Community Server - GPL</span></span><br><span class="line"><span class="comment"># Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="comment"># Oracle is a registered trademark of Oracle Corporation and/or its</span></span><br><span class="line"><span class="comment"># affiliates. Other names may be trademarks of their respective</span></span><br><span class="line"><span class="comment"># owners.</span></span><br><span class="line"><span class="comment"># Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span></span><br><span class="line"><span class="comment"># mysql&gt; </span></span><br></pre></td></tr></table></figure><h2 id="3-MySQL配置向导"><a href="#3-MySQL配置向导" class="headerlink" title="3. MySQL配置向导"></a>3. MySQL配置向导</h2><h3 id="3-1-修改root用户密码"><a href="#3-1-修改root用户密码" class="headerlink" title="3.1 修改root用户密码"></a>3.1 修改root用户密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改MySQL的root密码,使及密码生效</span></span><br><span class="line">mysql&gt; <span class="built_in">set</span> password = password(<span class="string">&quot;新密码&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="3-2-进去mysql库中-修改mysqlku下的user表中的root用户允许任意ip连接-并及时生效"><a href="#3-2-进去mysql库中-修改mysqlku下的user表中的root用户允许任意ip连接-并及时生效" class="headerlink" title="3.2 进去mysql库中, 修改mysqlku下的user表中的root用户允许任意ip连接, 并及时生效"></a>3.2 进去mysql库中, 修改mysqlku下的user表中的root用户允许任意ip连接, 并及时生效</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">msyql&gt; show databases;---&gt; 查看数据库</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| Database           |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">| information_schema |</span></span><br><span class="line"><span class="string">| mysql              |</span></span><br><span class="line"><span class="string">| performance_schema |</span></span><br><span class="line"><span class="string">| sys                |</span></span><br><span class="line"><span class="string">+--------------------+</span></span><br><span class="line"><span class="string">4 rows in set (0.01 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; show tables;---&gt; 查看数据表</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+---------------------------+</span></span><br><span class="line"><span class="string">| Tables_in_mysql           |</span></span><br><span class="line"><span class="string">+---------------------------+</span></span><br><span class="line"><span class="string">| columns_priv              |</span></span><br><span class="line"><span class="string">| db                        |</span></span><br><span class="line"><span class="string">| engine_cost               |</span></span><br><span class="line"><span class="string">| event                     |</span></span><br><span class="line"><span class="string">| func                      |</span></span><br><span class="line"><span class="string">| general_log               |</span></span><br><span class="line"><span class="string">| gtid_executed             |</span></span><br><span class="line"><span class="string">| help_category             |</span></span><br><span class="line"><span class="string">| help_keyword              |</span></span><br><span class="line"><span class="string">| help_relation             |</span></span><br><span class="line"><span class="string">| help_topic                |</span></span><br><span class="line"><span class="string">| innodb_index_stats        |</span></span><br><span class="line"><span class="string">| innodb_table_stats        |</span></span><br><span class="line"><span class="string">| ndb_binlog_index          |</span></span><br><span class="line"><span class="string">| plugin                    |</span></span><br><span class="line"><span class="string">| proc                      |</span></span><br><span class="line"><span class="string">| procs_priv                |</span></span><br><span class="line"><span class="string">| proxies_priv              |</span></span><br><span class="line"><span class="string">| server_cost               |</span></span><br><span class="line"><span class="string">| servers                   |</span></span><br><span class="line"><span class="string">| slave_master_info         |</span></span><br><span class="line"><span class="string">| slave_relay_log_info      |</span></span><br><span class="line"><span class="string">| slave_worker_info         |</span></span><br><span class="line"><span class="string">| slow_log                  |</span></span><br><span class="line"><span class="string">| tables_priv               |</span></span><br><span class="line"><span class="string">| time_zone                 |</span></span><br><span class="line"><span class="string">| time_zone_leap_second     |</span></span><br><span class="line"><span class="string">| time_zone_name            |</span></span><br><span class="line"><span class="string">| time_zone_transition      |</span></span><br><span class="line"><span class="string">| time_zone_transition_type |</span></span><br><span class="line"><span class="string">| user                      |</span></span><br><span class="line"><span class="string">+---------------------------+</span></span><br><span class="line"><span class="string">31 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 先进到mysql里，use mysql;</span></span><br><span class="line">mysql&gt; <span class="keyword">select</span> Host,User from user;---&gt; 查user表中的root用户</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| Host      | User          |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| localhost | mysql.session |</span></span><br><span class="line"><span class="string">| localhost | mysql.sys     |</span></span><br><span class="line"><span class="string">| localhost | root          |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">3 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; update mysql.user <span class="built_in">set</span> host=<span class="string">&quot;%&quot;</span> <span class="built_in">where</span> user=<span class="string">&quot;root&quot;</span>; ---&gt; 修改权限</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Query OK, 1 row affected (0.01 sec)</span></span><br><span class="line"><span class="string">Rows matched: 1  Changed: 1  Warnings: 0</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; <span class="keyword">select</span> Host,User from user;---&gt; 查user表中的root用户</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| Host      | User          |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">| %         | root          |</span></span><br><span class="line"><span class="string">| localhost | mysql.session |</span></span><br><span class="line"><span class="string">| localhost | mysql.sys     |</span></span><br><span class="line"><span class="string">+-----------+---------------+</span></span><br><span class="line"><span class="string">3 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mysql&gt; flush privileges;---&gt; 及时生效</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Query OK, 0 rows affected (0.00 sec)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="4-测试连接"><a href="#4-测试连接" class="headerlink" title="4. 测试连接"></a>4. 测试连接</h2><h3 id="4-1-mysql连接测试"><a href="#4-1-mysql连接测试" class="headerlink" title="4.1 mysql连接测试"></a>4.1 mysql连接测试</h3><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hive--mysql--连接测试</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7bWD5.png" alt="hive--mysql--连接测试" title="hive--mysql--连接测试"></p><h3 id="4-2-连接成功"><a href="#4-2-连接成功" class="headerlink" title="4.2 连接成功"></a>4.2 连接成功</h3><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hive--mysql--连接成功</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7bTHA.png" alt="hive--mysql--连接成功" title="hive--mysql--连接成功"></p><h1 id="二、-Hive组件搭建"><a href="#二、-Hive组件搭建" class="headerlink" title="二、 Hive组件搭建"></a>二、 <a href="https://blog.csdn.net/zmzdmx/article/details/108776666?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166719648416782427496026%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166719648416782427496026&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-108776666-null-null.142^v62^pc_rank_34_queryrelevant25,201^v3^control_1,213^v1^control&amp;utm_term=hive&amp;spm=1018.2226.3001.4187"><strong>Hive</strong></a>组件搭建</h1><div class="tip bell"><p>Hive：由Facebook开源用于解决海量结构化日志的数据统计。<br>Hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能。</p></div><div class="note default simple"><p><a href="https://www.yuque.com/attachments/yuque/0/2022/txt/33576317/1670333072537-0121e833-6fe6-4dfd-a9aa-bb50d0deb3b5.txt"><strong>Hive数据源</strong></a></p></div><h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1 准备工作"></a>1 准备工作</h2><h3 id="1-1-解压并改名"><a href="#1-1-解压并改名" class="headerlink" title="1.1  解压并改名"></a>1.1  解压并改名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-hive-2.3.4-bin.tar.gz -C /opt/</span><br><span class="line"><span class="built_in">mv</span> apache-hive-2.3.4-bin hive</span><br></pre></td></tr></table></figure><h2 id="2-配置Hive环境变量"><a href="#2-配置Hive环境变量" class="headerlink" title="2. 配置Hive环境变量"></a>2. 配置Hive环境变量</h2><h3 id="2-1-配置Hive环境变量"><a href="#2-1-配置Hive环境变量" class="headerlink" title="2.1 配置Hive环境变量"></a>2.1 配置Hive环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/hive</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span><br><span class="line">如果报错，试着修改以下内容：</span><br><span class="line"><span class="built_in">export</span> HBASE_HOME =/opt/hive</span><br><span class="line"><span class="built_in">export</span> PATH = <span class="variable">$PATH</span>:<span class="variable">$HBASE_HOME</span>/bin</span><br></pre></td></tr></table></figure><h3 id="2-2-加载环境变量"><a href="#2-2-加载环境变量" class="headerlink" title="2.2 加载环境变量"></a>2.2 加载环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><h3 id="2-3-解决日志jar包冲突"><a href="#2-3-解决日志jar包冲突" class="headerlink" title="2.3 解决日志jar包冲突"></a>2.3 解决日志jar包冲突</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.6.2.jar <span class="variable">$HIVE_HOME</span>/lib/log4j-slf4j-impl-2.6.2.bak</span><br></pre></td></tr></table></figure><h3 id="2-4-初始化元数据库"><a href="#2-4-初始化元数据库" class="headerlink" title="2.4 初始化元数据库"></a>2.4 初始化元数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive] bin/schematool -dbType derby -initSchema</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: com.google.common.base.Preconditions.checkArgument(ZLjava/lang/String;Ljava/lang/Object;)V</span></span><br><span class="line"><span class="string">at org.apache.hadoop.conf.Configuration.set(Configuration.java:1357)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.conf.Configuration.set(Configuration.java:1338)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.mapred.JobConf.setJar(JobConf.java:536)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.mapred.JobConf.setJarByClass(JobConf.java:554)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.mapred.JobConf.&lt;init&gt;(JobConf.java:448)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.conf.HiveConf.initialize(HiveConf.java:4045)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.conf.HiveConf.&lt;init&gt;(HiveConf.java:4008)</span></span><br><span class="line"><span class="string">at org.apache.hive.beeline.HiveSchemaTool.&lt;init&gt;(HiveSchemaTool.java:82)</span></span><br><span class="line"><span class="string">at org.apache.hive.beeline.HiveSchemaTool.main(HiveSchemaTool.java:1117)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span></span><br><span class="line"><span class="string">at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span></span><br><span class="line"><span class="string">at java.lang.reflect.Method.invoke(Method.java:498)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.run(RunJar.java:323)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.main(RunJar.java:236)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="若报错则尝试-2-5-初始化如果报错，就把hadoop的guava包替换到hive的guava包"><a href="#若报错则尝试-2-5-初始化如果报错，就把hadoop的guava包替换到hive的guava包" class="headerlink" title="(若报错则尝试)2.5 初始化如果报错，就把hadoop的guava包替换到hive的guava包"></a><font color=red>(若报错则尝试)</font>2.5 初始化如果报错，就把hadoop的<strong>guava包</strong>替换到hive的<strong>guava包</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$HIVE_HOME</span>/lib/guava-14.0.1.jar</span><br><span class="line"><span class="built_in">cp</span> <span class="variable">$HADOOP_HOME</span>/share/hadoop/common/lib/guava-27.0-jre.jar <span class="variable">$HIVE_HOME</span>/lib/</span><br></pre></td></tr></table></figure><h3 id="2-6-再次初始化元数据库-没有报错，可跳过"><a href="#2-6-再次初始化元数据库-没有报错，可跳过" class="headerlink" title="2.6 再次初始化元数据库(没有报错，可跳过)"></a>2.6 再次初始化元数据库<font color=red>(没有报错，可跳过)<font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[huser@master hive] bin/schematool -dbType derby -initSchema</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Metastore connection URL: jdbc:derby:;databaseName=metastore_db;create=true</span></span><br><span class="line"><span class="string">Metastore Connection Driver : org.apache.derby.jdbc.EmbeddedDriver</span></span><br><span class="line"><span class="string">Metastore connection User: APP</span></span><br><span class="line"><span class="string">Starting metastore schema initialization to 2.3.0</span></span><br><span class="line"><span class="string">Initialization script hive-schema-2.3.0.derby.sql</span></span><br><span class="line"><span class="string">Initialization script completed</span></span><br><span class="line"><span class="string">schemaTool completed</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="2-7-验证时，先开集群"><a href="#2-7-验证时，先开集群" class="headerlink" title="2.7 验证时，先开集群"></a>2.7 验证时，先开<font color=red>集群</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 /] hive</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-2.3.4.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">hive&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="3-Hive存储命令行"><a href="#3-Hive存储命令行" class="headerlink" title="3. Hive存储命令行"></a>3. Hive存储命令行</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">测试：</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">databases;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">default</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.464</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">1</span> <span class="string">row(s)</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">create</span> <span class="string">database</span> <span class="string">test1;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.111</span> <span class="string">seconds</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">databases;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">default</span></span><br><span class="line"><span class="string">test1</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.026</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">2</span> <span class="string">row(s)</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">use</span> <span class="string">test1</span> <span class="string">;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.028</span> <span class="string">seconds</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">tables;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.029</span> <span class="string">seconds</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">create</span> <span class="string">table</span> <span class="string">students(</span></span><br><span class="line"><span class="string">id</span> <span class="string">bigint</span> <span class="string">comment</span> <span class="string">&#x27;学生id&#x27;</span><span class="string">,</span></span><br><span class="line"><span class="string">name</span> <span class="string">string</span> <span class="string">comment</span> <span class="string">&#x27;学生姓名&#x27;</span><span class="string">,</span></span><br><span class="line"><span class="string">age</span> <span class="string">int</span> <span class="string">comment</span> <span class="string">&#x27;学生年龄&#x27;</span><span class="string">,</span></span><br><span class="line"><span class="string">gender</span> <span class="string">string</span> <span class="string">comment</span> <span class="string">&#x27;学生性别&#x27;</span><span class="string">,</span></span><br><span class="line"><span class="string">clazz</span> <span class="string">string</span> <span class="string">comment</span> <span class="string">&#x27;学生班级&#x27;</span></span><br><span class="line"><span class="string">)comment</span> <span class="string">&#x27;学生信息表&#x27;</span></span><br><span class="line"><span class="string">row</span> <span class="string">format</span> <span class="string">delimited</span> <span class="string">fields</span> <span class="string">terminated</span> <span class="string">by</span> <span class="string">&#x27;,&#x27;</span><span class="string">;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.424</span> <span class="string">seconds</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">tables;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">students</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.025</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">1</span> <span class="string">row(s)</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">desc</span> <span class="string">students;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">id</span>                  <span class="string">bigint</span>              <span class="string">??id</span>                </span><br><span class="line"><span class="string">name</span>                <span class="string">string</span>              <span class="string">????</span>                </span><br><span class="line"><span class="string">age</span>                 <span class="string">int</span>                 <span class="string">????</span>                </span><br><span class="line"><span class="string">gender</span>              <span class="string">string</span>              <span class="string">????</span>                </span><br><span class="line"><span class="string">clazz</span>               <span class="string">string</span>              <span class="string">????</span>                </span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.077</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">5</span> <span class="string">row(s)</span></span><br><span class="line"></span><br><span class="line"><span class="string">exit;（退出命令）</span></span><br></pre></td></tr></table></figure><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hive--hdfs--测试</font><p><img src="https://vip.helloimg.com/images/2023/12/18/o7bOC0.png" alt="hive--hdfs--测试" title="hive--hdfs--测试"></p><h2 id="4-解决报错"><a href="#4-解决报错" class="headerlink" title="4. 解决报错"></a>4. 解决报错</h2><h3 id="4-1-启动HIVE失败（jar包冲突）"><a href="#4-1-启动HIVE失败（jar包冲突）" class="headerlink" title="4.1 启动HIVE失败（jar包冲突）"></a>4.1 启动HIVE失败（jar包冲突）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">SLF4J: Found binding in [jar:file:/home/hdp/hive/lib/log4j-slf4j-impl-2.17.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span></span><br><span class="line"><span class="string">SLF4J: Found binding in [jar:file:/home/hdp/hadoop-3.2.1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.</span></span><br><span class="line"><span class="string">SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]</span></span><br><span class="line"><span class="string">HiveSchemaTool:Parsing failed.  Reason: Missing required option: [-help print this message, -alterCatalog Alter a catalog, requires --catalogLocation and/or --catalogDescription parameter as well, -initSchemaTo Schema initialization to a version, -upgradeSchemaFrom Schema upgrade from a version, -moveDatabase Move a database between catalogs.  Argument is the database name. Requires --fromCatalog and --toCatalog parameters as well, -moveTable Move a table to a different database.  Argument is the table name. Requires --fromCatalog, --toCatalog, --fromDatabase, and --toDatabase  parameters as well., -initSchema Schema initialization, -createCatalog Create a catalog, requires --catalogLocation parameter as well, -upgradeSchema Schema upgrade, -info Show config and schema details, -validate Validate the database]</span></span><br><span class="line"><span class="string">usage: schemaTool…………………………………………</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">解决方案：</span><br><span class="line"><span class="comment"># cd /opt/hive/lib</span></span><br><span class="line"><span class="comment"># ls log4j-*</span></span><br><span class="line"><span class="built_in">rm</span> -rf log4j-slf4j-impl-2.17.1.jar</span><br></pre></td></tr></table></figure><h3 id="4-2-格式化失败"><a href="#4-2-格式化失败" class="headerlink" title="4.2 格式化失败"></a>4.2 格式化失败</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">java.lang.IncompatibleClassChangeError: Found class jline.Terminal, but interface was expected</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">解决方案：</span><br><span class="line"><span class="comment"># 把高等级的guava.jar文件添加：进入hive/lib</span></span><br><span class="line"><span class="built_in">cp</span> /opt/hadoop/share/hadoop/common/lib/guava-27.0-jre.jar /opt/hive/lib</span><br></pre></td></tr></table></figure><h3 id="4-3-元数据出错"><a href="#4-3-元数据出错" class="headerlink" title="4.3 元数据出错"></a>4.3 元数据出错</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">FAILED: HiveException java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 元数据出错</span></span><br><span class="line">解决方案：</span><br><span class="line">./hive --service metastore &amp;</span><br><span class="line">然后重新启动  hive</span><br><span class="line"><span class="comment"># hive-site.xml出错</span></span><br></pre></td></tr></table></figure><h3 id="4-4-metastore-启动出错解决"><a href="#4-4-metastore-启动出错解决" class="headerlink" title="4.4 metastore 启动出错解决"></a>4.4 metastore 启动出错解决</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">MetaException(message:Version information not found in metastore.)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.RetryingHMSHandler.&lt;init&gt;(RetryingHMSHandler.java:84)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.java:93)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:8661)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.java:8656)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.startMetaStore(HiveMetaStore.java:8926)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.hive.metastore.HiveMetaStore.main(HiveMetaStore.java:8843)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span></span><br><span class="line"><span class="string">at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)</span></span><br><span class="line"><span class="string">at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)</span></span><br><span class="line"><span class="string">at java.lang.reflect.Method.invoke(Method.java:498)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.run(RunJar.java:221)</span></span><br><span class="line"><span class="string">at org.apache.hadoop.util.RunJar.main(RunJar.java:136)</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># hive metastore进程 已经有启动过了，应该讲相关的进程kill 掉。</span></span><br><span class="line">ps -ef |grep  hive </span><br><span class="line"><span class="comment"># huser     11025   3408  0 12:57 pts/1    00:00:00 grep --color=auto hive</span></span><br><span class="line"><span class="comment"># 将hive 相关进程kill 掉。然后重新启动：</span></span><br><span class="line">./hive --service metastore</span><br><span class="line"><span class="comment"># 同理如果 运行 </span></span><br><span class="line">./hive  --service hiveserver2 </span><br><span class="line"><span class="comment"># 出现 0.0.0.0/0.0.0.0:10000端口的错误，也可能是已经存在了相关的进程，将其杀掉重新启动就能解决</span></span><br><span class="line">没有出错，则</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-10-31 12:41:16: Starting HiveServer2</span></span><br><span class="line"><span class="string">Hive Session ID = 5e7ae187-9f27-4a22-8a81-c05dcf390598</span></span><br><span class="line"><span class="string">Hive Session ID = 570423cb-4125-4c95-9f83-5c256e9583fe</span></span><br><span class="line"><span class="string">Hive Session ID = ff65d2e0-6ead-4850-9d0c-38270c3e35a2</span></span><br><span class="line"><span class="string">Hive Session ID = 5cd156e1-3b30-4ce6-8c64-b00ef3ae7457</span></span><br><span class="line"><span class="string">..............</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 另外就是hive-site.xml的报错</span></span><br><span class="line">添加：</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;datanucleus.metadata.validate&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;hive.metastore.schema.verification&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;&lt;property&gt;</span><br><span class="line">&lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">&lt;name&gt;datanucleus.schema.autoCreateAll&lt;/name&gt;</span><br><span class="line">&lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="comment"># 最后提醒：在xml配置文件中，在标签之间不要有空格！！！因为读取xml文件时是按标签读取的</span></span><br></pre></td></tr></table></figure><h1 id="三-Hive元数据配置到MySQL"><a href="#三-Hive元数据配置到MySQL" class="headerlink" title="三. Hive元数据配置到MySQL"></a>三. Hive元数据配置到MySQL</h1><h2 id="1-拷贝数据库驱动"><a href="#1-拷贝数据库驱动" class="headerlink" title="1. 拷贝数据库驱动"></a>1. 拷贝数据库驱动</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自行下载拷贝并上传</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-5.1.48.jar /opt/hive/lib/</span><br></pre></td></tr></table></figure><h2 id="2-配置Metastore到MySQL，目录-opt-hive-conf"><a href="#2-配置Metastore到MySQL，目录-opt-hive-conf" class="headerlink" title="2. 配置Metastore到MySQL，目录/opt/hive/conf"></a>2. 配置<strong>Metastore</strong>到MySQL，<code>目录/opt/hive/conf</code></h2><h3 id="2-1-创建并配置hive-site-xml"><a href="#2-1-创建并配置hive-site-xml" class="headerlink" title="2.1 创建并配置hive-site.xml"></a>2.1 <strong>创建并配置hive-site.xml</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的URL --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://slave1:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的Driver--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- jdbc连接的username--&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- jdbc连接的password --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>000000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- Hive默认在HDFS的工作目录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- Hive 元数据存储版本的验证 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!--元数据存储授权--&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>datanucleus.schema.autoCreateAll<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="可跳过-2-2-配置日志文件位置-amp-打印当前库名mysql表头信息"><a href="#可跳过-2-2-配置日志文件位置-amp-打印当前库名mysql表头信息" class="headerlink" title="(可跳过)2.2 配置日志文件位置&amp;打印当前库名mysql表头信息"></a><font color=red>(可跳过)</font>2.2 配置日志文件位置&amp;打印当前库名mysql表头信息</h3><h4 id="2-2-1-防止直接修改出错，先将需要配置的文件复制一份再修改"><a href="#2-2-1-防止直接修改出错，先将需要配置的文件复制一份再修改" class="headerlink" title="2.2.1  #防止直接修改出错，先将需要配置的文件复制一份再修改"></a>2.2.1  #防止直接修改出错，先将需要配置的文件复制一份再修改</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /opt/hive/conf</span></span><br><span class="line"><span class="built_in">cp</span> hive-env.sh.template hive-env.sh</span><br><span class="line"><span class="built_in">cp</span> hive-log4j.properties.template hive-log4j.properties</span><br><span class="line"><span class="built_in">cp</span> hive-default.xml.template hive-default.xml</span><br></pre></td></tr></table></figure><h4 id="2-2-2-配置hive-env-sh"><a href="#2-2-2-配置hive-env-sh" class="headerlink" title="2.2.2 配置hive-env.sh"></a>2.2.2 <strong>配置hive-env.sh</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim hive-env.sh</span><br><span class="line">添加：</span><br><span class="line">HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> HIVE_CONF_DIR=/opt/hive/conf</span><br><span class="line"><span class="built_in">export</span> HIVE_AUX_JARS_PATH=/opt/hive/lib</span><br></pre></td></tr></table></figure><h4 id="2-2-3-配置hive-log4j-properties"><a href="#2-2-3-配置hive-log4j-properties" class="headerlink" title="2.2.3 配置hive-log4j.properties"></a>2.2.3 <strong>配置hive-log4j.properties</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim hive-log4j.properties</span><br><span class="line">添加：</span><br><span class="line">hive.log.dir=/opt/hive/log</span><br></pre></td></tr></table></figure><h4 id="2-2-4-创建并配置hive-site-xml"><a href="#2-2-4-创建并配置hive-site-xml" class="headerlink" title="2.2.4 创建并配置hive-site.xml"></a>2.2.4 <strong>创建并配置hive-site.xml</strong></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的URL --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://slave1:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的Driver--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- jdbc连接的username--&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- jdbc连接的password --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>000000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- Hive默认在HDFS的工作目录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!--</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">  &lt;!-- Hive 元数据存储版本的验证 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!--元数据存储授权--&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>datanucleus.schema.autoCreateAll<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">--&gt;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.header<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.current.db<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h4 id="2-2-5-启动Hive"><a href="#2-2-5-启动Hive" class="headerlink" title="2.2.5 启动Hive"></a>2.2.5 启动Hive</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive] bin/hive</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-2.3.4.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">hive(default)&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="可跳过-2-3-配置信息位置-amp-优先级"><a href="#可跳过-2-3-配置信息位置-amp-优先级" class="headerlink" title="(可跳过)2.3 配置信息位置&amp;优先级"></a><font color=red>(可跳过)</font>2.3 配置信息位置&amp;优先级</h3><h4 id="2-3-1-查看当前所有的配置信息"><a href="#2-3-1-查看当前所有的配置信息" class="headerlink" title="2.3.1 查看当前所有的配置信息"></a>2.3.1 查看当前所有的配置信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; <span class="built_in">set</span>;</span><br></pre></td></tr></table></figure><h4 id="2-3-2-命令行参数方式"><a href="#2-3-2-命令行参数方式" class="headerlink" title="2.3.2 命令行参数方式"></a>2.3.2 命令行参数方式</h4><p>注意: 仅对本次hive启动有效<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive -hiveconf hive.cli.print.current.db=<span class="literal">false</span>;</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-2.3.4.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">hive&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">hive&gt; <span class="built_in">set</span> hive.cli.print.current.db=<span class="literal">true</span>;</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">hive(default)&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 查看参数设置</span></span><br><span class="line">hive(default)&gt; <span class="built_in">set</span> mapred.reduce.tasks;</span><br><span class="line"><span class="comment"># 在HQL中使用SET关键字设定参数</span></span><br><span class="line">hive(default)&gt; <span class="built_in">set</span> mapred.reduce.tasks=10;</span><br></pre></td></tr></table></figure></p><h3 id="2-4-登录MySQL"><a href="#2-4-登录MySQL" class="headerlink" title="2.4 登录MySQL"></a>2.4 登录MySQL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p000000</span><br></pre></td></tr></table></figure><h3 id="2-5-新建Hive元数据库"><a href="#2-5-新建Hive元数据库" class="headerlink" title="2.5 新建Hive元数据库"></a>2.5 新建Hive元数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database metastore; </span><br><span class="line">mysql&gt; quit;</span><br></pre></td></tr></table></figure><h3 id="2-6-初始化Hive元数据库"><a href="#2-6-初始化Hive元数据库" class="headerlink" title="2.6 初始化Hive元数据库"></a>2.6 初始化Hive元数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql -verbose</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">No rows affected (0.001 seconds)</span></span><br><span class="line"><span class="string">0: jdbc:mysql://slave1:3306/metastore&gt; !closeall</span></span><br><span class="line"><span class="string">Closing: 0: jdbc:mysql://slave1:3306/metastore?useSSL=false</span></span><br><span class="line"><span class="string">beeline&gt; </span></span><br><span class="line"><span class="string">beeline&gt; Initialization script completed</span></span><br><span class="line"><span class="string">schemaTool completed</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="3-再次启动hive"><a href="#3-再次启动hive" class="headerlink" title="3. 再次启动hive"></a>3. 再次启动hive</h2><h3 id="3-1-启动Hive"><a href="#3-1-启动Hive" class="headerlink" title="3.1 启动Hive"></a>3.1 启动Hive</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive</span><br></pre></td></tr></table></figure><h3 id="3-2-使用Hive"><a href="#3-2-使用Hive" class="headerlink" title="3.2 使用Hive"></a>3.2 使用Hive</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">databases;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">default</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.032</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">1</span> <span class="string">row(s)</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">create</span> <span class="string">table</span> <span class="string">ts(id</span> <span class="string">string);</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">1.062</span> <span class="string">seconds</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ts;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.349</span> <span class="string">seconds</span></span><br><span class="line"><span class="comment"># 这里没有数据</span></span><br><span class="line"><span class="comment"># 所以创建文件数据并上传hdfs</span></span><br><span class="line">[<span class="string">huser@slave1</span> <span class="string">hive</span>]<span class="string">$</span> <span class="string">vim</span> <span class="string">id.txt</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">10086</span></span><br><span class="line"><span class="string">10083</span></span><br><span class="line"><span class="string">12183273</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">[<span class="string">huser@slave1</span> <span class="string">hive</span>]<span class="string">$</span> <span class="string">hadoop</span> <span class="string">fs</span> <span class="string">-put</span> <span class="string">id.txt</span> <span class="string">/user/hive/warehouse/ts</span></span><br><span class="line"><span class="number">2022-11-26 15:00:51</span><span class="string">,884</span> <span class="attr">INFO sasl.SaslDataTransferClient: SASL encryption trust check:</span> <span class="string">localHostTrusted</span> <span class="string">=</span> <span class="literal">false</span><span class="string">,</span> <span class="string">remoteHostTrusted</span> <span class="string">=</span> <span class="literal">false</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ts;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="number">10086</span></span><br><span class="line"><span class="number">10083</span></span><br><span class="line"><span class="number">12183273</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.621</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">3</span> <span class="string">row(s)</span></span><br></pre></td></tr></table></figure><h2 id="4-使用元数据服务的方式访问Hive"><a href="#4-使用元数据服务的方式访问Hive" class="headerlink" title="4. 使用元数据服务的方式访问Hive"></a>4. 使用元数据服务的方式访问Hive</h2><h3 id="4-1-连接存储元数据地址，需要修改hive-site-xml"><a href="#4-1-连接存储元数据地址，需要修改hive-site-xml" class="headerlink" title="4.1 连接存储元数据地址，需要修改hive-site.xml"></a>4.1 连接存储元数据地址，需要<strong>修改hive-site.xml</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定存储元数据要连接的地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>thrift://slave1:9083<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="4-2-启动Hive"><a href="#4-2-启动Hive" class="headerlink" title="4.2 启动Hive"></a>4.2 启动Hive</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive --service metastore</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-26 15:33:16: Starting Hive Metastore Server</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 注意：启动后窗口不能再操作，需打开一个新的shell窗口做别的操作</span></span><br><span class="line">[huser@slave1 hive]$ bin/hive</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Logging initialized using configuration in jar:file:/opt/hive/lib/hive-common-3.1.2.jar!/hive-log4j2.properties Async: true</span></span><br><span class="line"><span class="string">Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.</span></span><br><span class="line"><span class="string">Hive Session ID = 59776f1a-d2d0-48ca-afb7-2de366803efb</span></span><br><span class="line"><span class="string">hive&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-3-测试"><a href="#4-3-测试" class="headerlink" title="4.3 测试"></a>4.3 测试</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">databases;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">default</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.871</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">1</span> <span class="string">row(s)</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">show</span> <span class="string">tables;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="string">ts</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">0.126</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">1</span> <span class="string">row(s)</span></span><br><span class="line"><span class="string">hive&gt;</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ts;</span></span><br><span class="line"><span class="string">OK</span></span><br><span class="line"><span class="number">10086</span></span><br><span class="line"><span class="number">10083</span></span><br><span class="line"><span class="number">12183273</span></span><br><span class="line"><span class="attr">Time taken:</span> <span class="number">4.242</span> <span class="string">seconds,</span> <span class="attr">Fetched:</span> <span class="number">3</span> <span class="string">row(s)</span></span><br></pre></td></tr></table></figure><h2 id="5-使用JDBC方式访问Hive"><a href="#5-使用JDBC方式访问Hive" class="headerlink" title="5. 使用JDBC方式访问Hive"></a>5. 使用JDBC方式访问Hive</h2><h3 id="5-1-在hive-site-xml文件中添加如下配置信息"><a href="#5-1-在hive-site-xml文件中添加如下配置信息" class="headerlink" title="5.1 在hive-site.xml文件中添加如下配置信息"></a>5.1 在<code>hive-site.xml文件</code>中添加如下配置信息</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定hiveserver2连接的host --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 指定hiveserver2连接的端口号 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="5-2-启动metastore"><a href="#5-2-启动metastore" class="headerlink" title="5.2 启动metastore"></a>5.2 <strong>启动metastore</strong></h3><p>注意：启动后窗口不能再操作，需打开一个新的shell窗口做别的操作<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive --service metastore</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">2022-11-26 15:33:16: Starting Hive Metastore Server</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h3 id="5-2-启动hiveserver2"><a href="#5-2-启动hiveserver2" class="headerlink" title="5.2 启动hiveserver2"></a>5.2 <strong>启动hiveserver2</strong></h3><p>注意：启动后窗口不能再操作，需打开一个新的shell窗口做别的操作<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/hive --service hiveserver2</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">which: no hbase in (/opt/hbase/bin:/opt/hive/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/usr/java/jdk1.8.0_341-amd64/bin:/opt/hadoop/bin:/opt/hadoop/sbin:/opt/zookeeper/bin:/opt/sqoop/bin:/opt/bin:/opt/maven/bin:/opt/maven/bin:/opt/flume/bin:/opt/kafka/bin:/opt/kafka/bin:/opt/kafka/bin:/bin:/home/huser/.local/bin:/home/huser/bin)</span></span><br><span class="line"><span class="string">2022-11-26 17:29:52: Starting HiveServer2</span></span><br><span class="line"><span class="string">Hive Session ID = 04c9025c-ba79-42de-8f2a-96de660072c8</span></span><br><span class="line"><span class="string">Hive Session ID = 6936bbd6-c52e-4523-bfea-016a7b62f0fc</span></span><br><span class="line"><span class="string">Hive Session ID = b16222cb-6a9e-4866-b08c-9f11de650f6a</span></span><br><span class="line"><span class="string">Hive Session ID = a36d5961-078f-4a70-9649-8113e32dc1d1</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h3 id="5-3-启动beeline客户端"><a href="#5-3-启动beeline客户端" class="headerlink" title="5.3 启动beeline客户端"></a>5.3 <strong>启动beeline客户端</strong></h3><p>注意：1.启动后窗口不能再操作，需打开一个新的shell窗口做别的操作</p><ol><li>等hiveserver2服务完全开启, 否则直接报拒绝连接<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 hive]$ bin/beeline -u jdbc:hive2://slave1:10000 -n huser</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;Connecting to jdbc:hive2://slave1:10000</span></span><br><span class="line"><span class="string">Connected to: Apache Hive (version 3.1.2)</span></span><br><span class="line"><span class="string">Driver: Hive JDBC (version 3.1.2)</span></span><br><span class="line"><span class="string">Transaction isolation: TRANSACTION_REPEATABLE_READ</span></span><br><span class="line"><span class="string">Beeline version 3.1.2 by Apache Hive</span></span><br><span class="line"><span class="string">0: jdbc:hive2://slave1:10000&gt;</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="5-4-测试"><a href="#5-4-测试" class="headerlink" title="5.4 测试"></a>5.4 测试</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">0:</span> <span class="string">jdbc:hive2://slave1:10000&gt;</span> <span class="string">show</span> <span class="string">databases;</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Compiling</span> <span class="string">command(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756):</span> <span class="string">show</span> <span class="string">databases</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Semantic</span> <span class="string">Analysis</span> <span class="string">Completed</span> <span class="string">(retrial</span> <span class="string">=</span> <span class="literal">false</span><span class="string">)</span></span><br><span class="line"><span class="attr">INFO  : Returning Hive schema:</span> <span class="string">Schema(fieldSchemas:[FieldSchema(name:database_name,</span> <span class="string">type:string,</span> <span class="string">comment:from</span> <span class="string">deserializer)],</span> <span class="string">properties:null)</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Completed</span> <span class="string">compiling</span> <span class="string">command(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756);</span> <span class="attr">Time taken:</span> <span class="number">0.383</span> <span class="string">seconds</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Executing</span> <span class="string">command(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756):</span> <span class="string">show</span> <span class="string">databases</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Starting</span> <span class="string">task</span> [<span class="string">Stage-0:DDL</span>] <span class="string">in</span> <span class="string">serial</span> <span class="string">mode</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Completed</span> <span class="string">executing</span> <span class="string">command(queryId=huser_20221126171309_51ccbfac-4e21-44e5-a036-9716d3631756);</span> <span class="attr">Time taken:</span> <span class="number">0.093</span> <span class="string">seconds</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="string">+----------------+</span></span><br><span class="line"><span class="string">|</span> <span class="string">database_name</span>  <span class="string">|</span></span><br><span class="line"><span class="string">+----------------+</span></span><br><span class="line"><span class="string">|</span> <span class="string">default</span>        <span class="string">|</span></span><br><span class="line"><span class="string">+----------------+</span></span><br><span class="line"><span class="number">1</span> <span class="string">row</span> <span class="string">selected</span> <span class="string">(0.914</span> <span class="string">seconds)</span></span><br><span class="line"><span class="attr">0:</span> <span class="string">jdbc:hive2://slave1:10000&gt;</span> <span class="string">show</span> <span class="string">tables;</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Compiling</span> <span class="string">command(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1):</span> <span class="string">show</span> <span class="string">tables</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Semantic</span> <span class="string">Analysis</span> <span class="string">Completed</span> <span class="string">(retrial</span> <span class="string">=</span> <span class="literal">false</span><span class="string">)</span></span><br><span class="line"><span class="attr">INFO  : Returning Hive schema:</span> <span class="string">Schema(fieldSchemas:[FieldSchema(name:tab_name,</span> <span class="string">type:string,</span> <span class="string">comment:from</span> <span class="string">deserializer)],</span> <span class="string">properties:null)</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Completed</span> <span class="string">compiling</span> <span class="string">command(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1);</span> <span class="attr">Time taken:</span> <span class="number">0.172</span> <span class="string">seconds</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Executing</span> <span class="string">command(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1):</span> <span class="string">show</span> <span class="string">tables</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Starting</span> <span class="string">task</span> [<span class="string">Stage-0:DDL</span>] <span class="string">in</span> <span class="string">serial</span> <span class="string">mode</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Completed</span> <span class="string">executing</span> <span class="string">command(queryId=huser_20221126171531_76ed2baf-f3af-4809-8b83-e34bf6b223d1);</span> <span class="attr">Time taken:</span> <span class="number">0.053</span> <span class="string">seconds</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">|</span> <span class="string">tab_name</span>  <span class="string">|</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">|</span> <span class="string">ts</span>        <span class="string">|</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="number">1</span> <span class="string">row</span> <span class="string">selected</span> <span class="string">(0.322</span> <span class="string">seconds)</span></span><br><span class="line"><span class="attr">0:</span> <span class="string">jdbc:hive2://slave1:10000&gt;</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ts;</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Compiling</span> <span class="string">command(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3):</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ts</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Semantic</span> <span class="string">Analysis</span> <span class="string">Completed</span> <span class="string">(retrial</span> <span class="string">=</span> <span class="literal">false</span><span class="string">)</span></span><br><span class="line"><span class="attr">INFO  : Returning Hive schema:</span> <span class="string">Schema(fieldSchemas:[FieldSchema(name:ts.id,</span> <span class="string">type:string,</span> <span class="string">comment:null)],</span> <span class="string">properties:null)</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Completed</span> <span class="string">compiling</span> <span class="string">command(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3);</span> <span class="attr">Time taken:</span> <span class="number">3.368</span> <span class="string">seconds</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Executing</span> <span class="string">command(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3):</span> <span class="string">select</span> <span class="string">*</span> <span class="string">from</span> <span class="string">ts</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Completed</span> <span class="string">executing</span> <span class="string">command(queryId=huser_20221126171609_87fc3173-f1a7-42cb-969c-302e73df63b3);</span> <span class="attr">Time taken:</span> <span class="number">0.032</span> <span class="string">seconds</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">OK</span></span><br><span class="line"><span class="attr">INFO  :</span> <span class="string">Concurrency</span> <span class="string">mode</span> <span class="string">is</span> <span class="string">disabled,</span> <span class="string">not</span> <span class="string">creating</span> <span class="string">a</span> <span class="string">lock</span> <span class="string">manager</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">|</span>   <span class="string">ts.id</span>   <span class="string">|</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="string">|</span> <span class="number">10086</span>     <span class="string">|</span></span><br><span class="line"><span class="string">|</span> <span class="number">10083</span>     <span class="string">|</span></span><br><span class="line"><span class="string">|</span> <span class="number">12183273</span>  <span class="string">|</span></span><br><span class="line"><span class="string">+-----------+</span></span><br><span class="line"><span class="number">3</span> <span class="string">rows</span> <span class="string">selected</span> <span class="string">(4.477</span> <span class="string">seconds)</span></span><br></pre></td></tr></table></figure><h3 id="5-5-拒接连接报错"><a href="#5-5-拒接连接报错" class="headerlink" title="5.5 拒接连接报错"></a>5.5 拒接连接报错</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to jdbc:hive2://slave1:10000</span></span><br><span class="line"><span class="string">22/11/26 17:29:24 [main]: WARN jdbc.HiveConnection: Failed to connect to slave1:10000</span></span><br><span class="line"><span class="string">Could not open connection to the HS2 server. Please check the server URI and if the URI is correct, then ask the administrator to check the server status.</span></span><br><span class="line"><span class="string">Error: Could not open client transport with JDBC Uri: jdbc:hive2://slave1:10000: java.net.ConnectException: 拒绝连接 (Connection refused) (state=08S01,code=0)</span></span><br><span class="line"><span class="string">Beeline version 3.1.2 by Apache Hive</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 解决</span></span><br><span class="line">1. 等hiveserver2服务完全开启</span><br><span class="line">2. 修改hadoop目录下的hdfs-site.xml和core-site.xml的文件</span><br></pre></td></tr></table></figure><h3 id="5-6-解决方案"><a href="#5-6-解决方案" class="headerlink" title="5.6 解决方案:"></a>5.6 解决方案:</h3><strong>注意：以下配置文件里出现的“huser”请换成您自己的用户名！！！</strong><h4 id="5-6-1-在hdfs-site-xml文件中添加如下内容（路径：-HADOOP-HOME-etc-hadoop）"><a href="#5-6-1-在hdfs-site-xml文件中添加如下内容（路径：-HADOOP-HOME-etc-hadoop）" class="headerlink" title="5.6.1 在hdfs-site.xml文件中添加如下内容（路径：$HADOOP_HOME/etc/hadoop）"></a>5.6.1 在<code>hdfs-site.xml文件</code>中添加如下内容<code>（路径：$HADOOP_HOME/etc/hadoop）</code></h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h4 id="5-6-2-在core-site-xml文件中添加如下内容："><a href="#5-6-2-在core-site-xml文件中添加如下内容：" class="headerlink" title="5.6.2 在core-site.xml文件中添加如下内容："></a>5.6.2 在<code>core-site.xml文件</code>中添加如下内容：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hadoop.proxyuser.huser.hosts&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;slave1&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hadoop.proxyuser.huser.groups&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;10000&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><strong> 提示：配置的时候一定要注意细节哦，不然容易启动报错哦！！！其次记得分发改了的文件，并且重新启动相应的集群哦！！！</strong></li></ol>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>二、zookeeper组件搭建</title>
      <link href="/posts/9dacd182.html"/>
      <url>/posts/9dacd182.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-fish modern"><p>介绍：Zookeeper 是一个开源的分布式协调服务，目前由 Apache 进行维护。Zookeeper 可以用于实现分布式系统中常见的发布/订阅、负载均衡、命令服务、分布式协调/通知、集群管理、Master 选举、分布式锁和分布式队列等功能。</p></div><p><strong><em>特点：</em></strong><br><strong>顺序一致性</strong>：从一个客户端发起的事务请求，最终都会严格按照其发起顺序被应用到 Zookeeper 中；<br><strong>原子性</strong>：所有事务请求的处理结果在整个集群中所有机器上都是一致的；不存在部分机器应用了该事务，而另一部分没有应用的情况；<br><strong>单一视图</strong>：所有客户端看到的服务端数据模型都是一致的；<br><strong>可靠性</strong>：一旦服务端成功应用了一个事务，则其引起的改变会一直保留，直到被另外一个事务所更改；<br><strong>实时性</strong>：一旦一个事务被成功应用后，Zookeeper 可以保证客户端立即可以读取到这个事务变更后的最新状态的数据。</p><div class="note success simple"><p>需要的安装包：<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/"><strong>zookeeper</strong></a>压缩包——&gt;<em>apache-zookeeper-3.7.1-bin.tar.gz</em></p></div><font color=red>可以跳过观看，跟集群环境搭建高可用版本配置的文件相同</font><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h2 id="5-配置zookeeper文件"><a href="#5-配置zookeeper文件" class="headerlink" title="5.配置zookeeper文件"></a>5.配置<a href="https://so.csdn.net/so/search?q=zookeeper&amp;urw="><strong>zookeeper</strong></a>文件</h2><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>5.1.1 在Linux系统下的软件包导入</p><p>5.1.2 解压hadoop到目录下的/opt<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf apache-zookeeper-3.7.1-bin.tar.gz -C /opt/</span><br></pre></td></tr></table></figure></p><p>5.1.3  改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mv</span> apache-zookeeper-3.7.1-bin zookeeper</span><br></pre></td></tr></table></figure></p><p>5.1.4 改权限<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R huser:huser zookeeper</span><br><span class="line"></span><br><span class="line"><span class="comment"># drwxr-xr-x.   4 huser huser   37 10月 29 14:22 zookeeper</span></span><br></pre></td></tr></table></figure></p><h3 id="2-配置zookeeper环境"><a href="#2-配置zookeeper环境" class="headerlink" title="2.配置zookeeper环境"></a>2.配置zookeeper环境</h3><p>4.2.1 <strong>配置</strong><font color=pink><strong><em>zookeeper</em></strong></font><strong>环境并且生效</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># ZOOKEEPER_HOME</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br></pre></td></tr></table></figure></p><p>4.2.2  加载环境变量并查看<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></p><p>4.2.3 拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure></p><h3 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3.修改配置文件"></a>3.修改配置文件</h3><p>5.3.1 进入安装目录的 conf/ 目录下，拷贝配置样本并进行修改：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cd $ZOOKEEPER_HOME/conf</span></span><br><span class="line"><span class="built_in">cd</span> /opt/zookeeper/conf</span><br></pre></td></tr></table></figure></p><p>5.3.2 改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure></p><p>5.3.3 修改配置文件<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">vim</span> <span class="string">zoo.cfg</span></span><br><span class="line"><span class="string">修改为：</span></span><br><span class="line">      <span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line">      <span class="string">tickTime=2000</span></span><br><span class="line">      <span class="comment"># The number of ticks that the initial </span></span><br><span class="line">      <span class="comment"># synchronization phase can take</span></span><br><span class="line">      <span class="string">initLimit=10</span></span><br><span class="line">      <span class="comment"># The number of ticks that can pass between </span></span><br><span class="line">      <span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line">      <span class="string">syncLimit=5</span></span><br><span class="line">      <span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line">      <span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line">      <span class="comment"># example sakes.</span></span><br><span class="line">      <span class="string">dataDir=/opt/zookeeper/data</span></span><br><span class="line">      <span class="comment"># the port at which the clients will connect</span></span><br><span class="line">      <span class="string">clientPort=2181</span></span><br><span class="line"><span class="string">添加：</span></span><br><span class="line">      <span class="string">dataLogDir=/opt/zookeeper/logs</span></span><br><span class="line">      <span class="string">server.1=master:2888:3888</span></span><br><span class="line">      <span class="string">server.2=slave1:2888:3888</span></span><br><span class="line">      <span class="string">server.3=slave2:2888:3888</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#配置参数说明：</span></span><br><span class="line"><span class="comment">#    ·tickTime：用于计算的基础时间单元。比如 session 超时：N*tickTime；</span></span><br><span class="line"><span class="comment">#    ·initLimit：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；</span></span><br><span class="line"><span class="comment">#    ·syncLimit：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；</span></span><br><span class="line"><span class="comment">#    ·dataDir：数据存储位置；</span></span><br><span class="line"><span class="comment">#    ·dataLogDir：日志目录；</span></span><br><span class="line"><span class="comment">#    ·clientPort：用于客户端连接的端口，默认 2181</span></span><br></pre></td></tr></table></figure></p><p>5.3.4  拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/zookeeper  slave2(slave1):/opt/</span><br></pre></td></tr></table></figure></p><h3 id="4-标识节点"><a href="#4-标识节点" class="headerlink" title="4.标识节点"></a>4.标识节点</h3><p>5.4.1 创建存储目录（先 <code>cd /opt/zookeeper</code>）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> data logs</span><br></pre></td></tr></table></figure></p><p>5.4.2 创建并写入节点标识到 <code>myid</code> 文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave1主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave2主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;3&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br></pre></td></tr></table></figure></p><p>5.4.3 验证节点标识<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> myid(<span class="built_in">cat</span> /opt/zookeeper/data/myid)</span><br></pre></td></tr></table></figure></p><h3 id="5-启动zookeeper"><a href="#5-启动zookeeper" class="headerlink" title="5.启动zookeeper"></a>5.启动zookeeper</h3><p>5.5.1 启动QuorumPeerMain节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br></pre></td></tr></table></figure></p><p>5.5.2 查看集群<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh status</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">ZooKeeper JMX enabled by default</span></span><br><span class="line"><span class="string">Using config: /opt/zookeeper/bin/../conf/zoo.cfg</span></span><br><span class="line"><span class="string">Client port found: 2181. Client address: localhost. Client SSL: false.</span></span><br><span class="line"><span class="string">Mode: follower</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一、集群环境搭建高可用版本配置</title>
      <link href="/posts/5a2ba262.html"/>
      <url>/posts/5a2ba262.html</url>
      
        <content type="html"><![CDATA[<div class="note green anzhiyufont anzhiyu-icon-ic_train modern"><p>介绍：<strong>HDFS</strong> （<strong>Hadoop Distributed File System</strong>）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。<br>特点：<br>高容错：由于 HDFS 采用数据的多副本方案，所以部分硬件的损坏不会导致全部数据的丢失。<br>高吞吐量：HDFS 设计的重点是支持高吞吐量的数据访问，而不是低延迟的数据访问。<br>大文件支持：HDFS 适合于大文件的存储，文档的大小应该是是 GB 到 TB 级别的。<br>简单一致性模型：HDFS 更适合于一次写入多次读取 (write-once-read-many) 的访问模型。支持将内容追加到文件末尾，但不支持数据的随机访问，不能从文件任意位置新增数据。<br>跨平台移植性：HDFS 具有良好的跨平台移植性，这使得其他大数据计算框架都将其作为数据持久化存储的首选方案。</p></div><div class="tip home"><p>前提观看：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5BVMware%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%87%8C%E9%9D%A2%E6%B2%A1%E7%BD%91%E7%BB%9C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95_%E5%8D%91%E5%BE%AE%E5%B0%8F%E8%83%A1%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%5D(https:/blog.csdn.net/huyinghao03/article/details/127419315?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.n)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7etzE.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、VMware无法启动虚拟机里面没网络解决方法_卑微小胡的博客-CSDN博客</div>            <div class="tag-link-sitename">在真机win+R输入：services.msc找到图片下的几个服务启动就好了。我一开始只启动VMware NAT Servise服务发</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="tip success"><p>如果电脑没有虚拟网卡Vmnet1和Vmnet8，如下方案：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E5%85%B3%E4%BA%8EvmWare%E5%AE%89%E8%A3%85%E5%90%8E%E6%B2%A1%E6%9C%89%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1Vmnet1%E5%92%8CVmnet8_kingheart_%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2_vmware%E5%AE%89%E8%A3%85%E5%90%8E%E6%B2%A1%E6%9C%89%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1%5D(https:/blog.csdn.net/kingheart_/article/details/127434816?app_version=5.11.1&code=app_1562916241&csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22127434816%22,%22source%22:%22qq672596289%22%7D&uLinkId=usr1mkqgl919blen&utm_source=app)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7esiv.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">关于vmWare安装后没有虚拟网卡Vmnet1和Vmnet8_kingheart_的博客-CSDN博客_vmware安装后没有虚拟网卡</div>            <div class="tag-link-sitename">视频和百度学习 https://blog.csdn.net/kingheart_/article/details/127434816</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><div class="tip cogs"><p>需要的安装包：</p></div><p>1.<a href="https://archive.kernel.org/centos-vault/7.5.1804/isos/x86_64/"><strong>CentOS</strong></a>镜像——&gt;<em>CentOS-7.5-x86_64-DVD-1804.iso</em><br>2.<a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html"><strong>jdk</strong></a>压缩包——&gt;<em>jdk-8u341-linux-x64.rpm</em><br>3.<a href="http://archive.apache.org/dist/hadoop/common/"><strong>hadoop</strong></a>压缩包——&gt;<em>hadoop-3.2.1.tar.gz</em><br>4.<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/"><strong>zookeeper</strong></a>压缩包——&gt;<em>apache-zookeeper-3.7.1-bin.tar.gz</em></p><h2 id="1-网络配置"><a href="#1-网络配置" class="headerlink" title="1.网络配置"></a>1.网络配置</h2><h3 id="1-1修改主机名和修改虚拟机IP地址，以及添加主机映射"><a href="#1-1修改主机名和修改虚拟机IP地址，以及添加主机映射" class="headerlink" title="1.1修改主机名和修改虚拟机IP地址，以及添加主机映射"></a>1.1修改<a href="https://so.csdn.net/so/search?q=%E4%B8%BB%E6%9C%BA%E5%90%8D&amp;spm=1001.2101.3001.7020"><strong>主机名</strong></a>和修改虚拟机IP地址，以及添加主机映射</h3><p>1.1.1 修改<a href="https://so.csdn.net/so/search?q=%E8%99%9A%E6%8B%9F%E6%9C%BA&amp;spm=1001.2101.3001.7020"><strong>虚拟机</strong></a>IP地址<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/sysconfig/network-scripts/ifcfg-ens33</span><br><span class="line">          修改:</span><br><span class="line">                  BOOTPROTO=<span class="keyword">static</span></span><br><span class="line">                  ONBOOT=yes</span><br><span class="line">          添加内容：</span><br><span class="line">                IPADRR = <span class="number">192.168</span><span class="number">.33</span><span class="number">.147</span>(匿)</span><br><span class="line">                GATEWAY = <span class="number">192.168</span><span class="number">.33</span><span class="number">.2</span></span><br><span class="line">                NETMASK = <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">                DNS1=<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br><span class="line"></span><br><span class="line">sudo vim /etc/sysconfig/network(可以不配)</span><br><span class="line">        添加内容：</span><br><span class="line">                NETWORKING=yes</span><br><span class="line">HOSTNAME=master</span><br></pre></td></tr></table></figure></p><p>1.1.2 重启网络<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network start</span><br></pre></td></tr></table></figure></p><p>1.1.3 下载<code>vim</code>和<code>net-tools</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install vim</span><br><span class="line">sudo yum -y install net-tools</span><br><span class="line"></span><br><span class="line">修改字体缩进格式</span><br><span class="line">sudo vim /etc/vimrc</span><br><span class="line">        添加  <span class="built_in">set</span> ts=4</span><br></pre></td></tr></table></figure></p><p>1.1.4 添加主机<a href="https://so.csdn.net/so/search?q=%E6%98%A0%E5%B0%84&amp;urw="><strong>映射</strong></a>（方便后面免密连接)<br><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br><span class="line"></span><br><span class="line">修改内容（如）：</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.147</span> master</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.148</span> slave1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.149</span> slave2</span><br></pre></td></tr></table></figure></p><p>1.1.5 关闭<a href="https://so.csdn.net/so/search?q=防火墙&amp;urw="><strong>防火墙</strong></a><br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop firewalld(.service)</span><br><span class="line"></span><br><span class="line">开机，重启自动关闭</span><br><span class="line">sudo systemctl disable firewalld(.service)</span><br></pre></td></tr></table></figure></p><p>1.1.6 查看防火墙<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure></p><p>1.1.7 关闭<a href="https://so.csdn.net/so/search?q=selinux&amp;urw="><strong>selinux</strong></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/selinux/config</span><br><span class="line">修改为：</span><br><span class="line">    SELINUX=disabled</span><br></pre></td></tr></table></figure></p><p>1.1.8 克隆slave1和slave2,先关机，修改各网络IP地址<br><br></p><p>1.1.9 修改每个主机名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hostname </span><br><span class="line"></span><br><span class="line">修改内容（如）：</span><br><span class="line">主机：master</span><br><span class="line">节点：slave1</span><br><span class="line">节点：slave2</span><br><span class="line">改完重启：reboot</span><br></pre></td></tr></table></figure></p><h3 id="1-2-生成公钥和私钥"><a href="#1-2-生成公钥和私钥" class="headerlink" title="1.2 生成公钥和私钥"></a>1.2 生成<a href="https://so.csdn.net/so/search?q=公钥&amp;urw="><strong>公钥</strong></a>和<a href="https://so.csdn.net/so/search?q=私钥&amp;urw="><strong>私钥</strong></a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>1.2.1 将公钥拷贝到要免密登录的目标机器上<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub master</span><br><span class="line"></span><br><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub slave1</span><br><span class="line"></span><br><span class="line">ssh-copy-id -i ~/.ssh/id_rsa.pub slave2</span><br></pre></td></tr></table></figure></p><p>1.2.2 验证<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /home/huser/.ssh/authorized_keys</span><br></pre></td></tr></table></figure></p><h2 id="2-配置时间服务器"><a href="#2-配置时间服务器" class="headerlink" title="2.配置时间服务器"></a>2.配置<a href="https://so.csdn.net/so/search?q=时间服务器&amp;urw="><strong>时间服务器</strong></a></h2><h3 id="2-1-检查ntp包是否安装"><a href="#2-1-检查ntp包是否安装" class="headerlink" title="2.1 检查ntp包是否安装"></a>2.1 检查ntp包是否安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep ntp</span><br></pre></td></tr></table></figure><p>2.1.1 没有，则安装ntp包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install ntp</span><br></pre></td></tr></table></figure></p><p>2.1.2 设置时间配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 ~]$ sudo vim /etc/ntp.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改一（设置本地网络上的主机不受限制）</span></span><br><span class="line"><span class="comment">#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap 为</span></span><br><span class="line">restrict 192.168.33.0 mask 255.255.255.0 nomodify notrap</span><br><span class="line"><span class="comment">#修改二（添加默认的一个内部时钟数据，使用它为局域网用户提供服务）</span></span><br><span class="line">server 127.127.1.0</span><br><span class="line">fudge 127.127.1.0 stratum 10</span><br><span class="line"><span class="comment">#修改三（设置为不采用公共的服务器）</span></span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst 为</span><br><span class="line"><span class="comment">#server 0.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 1.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 2.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 3.centos.pool.ntp.org iburst</span></span><br></pre></td></tr></table></figure></p><p>2.1.3  设置BIOS与系统时间同步<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 ~]$ sudo vim /etc/sysconfig/ntpd</span><br><span class="line"></span><br><span class="line"><span class="comment">#增加如下内容（让硬件时间与系统时间一起同步）</span></span><br><span class="line">OPTIONS=<span class="string">&quot;-u ntp:ntp -p /var/run/ntpd.pid -g&quot;</span></span><br><span class="line">SYNC_HWCLOCK=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure></p><p>2.1.4 启动ntp服务并测试<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 ~]$ sudo systemctl start ntpd</span><br><span class="line">[huser@slave1 ~]$ systemctl status ntpd</span><br><span class="line"><span class="comment">#设置ntp服务开机自启</span></span><br><span class="line">[huser@slave1 ~]$ sudo systemctl <span class="built_in">enable</span> ntpd.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line">[huser@slave1 ~]$ ntpstat</span><br><span class="line">synchronised to <span class="built_in">local</span> net (127.127.1.0) at stratum 11</span><br><span class="line">   time correct to within 3948 ms</span><br><span class="line">   polling server every 64 s</span><br><span class="line">[huser@slave1 ~]$ sudo ntpq -p</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">     remote           refid      st t when poll reach   delay   offset  jitter</span></span><br><span class="line"><span class="string">==============================================================================</span></span><br><span class="line"><span class="string">*LOCAL(0)        .LOCL.          10 l   26   64    3    0.000    0.000   0.000</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p><h3 id="2-2-其它节点与时间服务器同步时间"><a href="#2-2-其它节点与时间服务器同步时间" class="headerlink" title="2.2 其它节点与时间服务器同步时间"></a>2.2 其它节点与时间服务器同步时间</h3><p>2.2.1 关闭非时间服务器的ntp服务<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop ntpd</span><br></pre></td></tr></table></figure></p><p>2.2.2 手动同步<br>前提：每台节点必须安装ntp包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave2 ~]$ sudo ntpdate hadoop02</span><br><span class="line">24 Nov 11:25:13 ntpdate[2878]: step time server 192.168.239.125 offset 24520304.363894 sec</span><br><span class="line">[huser@slave2 ~]$ <span class="built_in">date</span> </span><br><span class="line">2020年 11月 24日 星期二 11:25:20 CST</span><br></pre></td></tr></table></figure></p><p>2.2.3 定时同步(可跳过)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install crond</span><br><span class="line">sudo vim /etc/crontab</span><br><span class="line"></span><br><span class="line">编写定时任务如下：</span><br><span class="line">*/1 * * * * /usr/sbin/ntpdate hadoop02</span><br><span class="line">*/1 * * * * /usr/bin/echo <span class="string">&quot;文件&quot;</span> &gt;&gt; ~/<span class="string">&quot;目录&quot;</span></span><br></pre></td></tr></table></figure></p><p>2.2.4 加载任务，生效(可跳过)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo crontab /etc/crontab</span><br></pre></td></tr></table></figure></p><p>2.2.5 修改时间服务器时间(可跳过)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">date</span> -s <span class="string">&quot;2020-11-24 11:24:11&quot;</span></span><br></pre></td></tr></table></figure></p><p>2.2.6 查看是否时间服务器同步<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">date</span></span><br></pre></td></tr></table></figure></p><h2 id="3-配置JDk"><a href="#3-配置JDk" class="headerlink" title="3.配置JDk"></a>3.配置JDk</h2><p>3.1.1 在Linux系统下的软件包导入</p><p>3.1.2 <strong>解压JDk</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.zp文件：tar -zxvf jdk-8u341-linux-x64.tar.gz -C /usr/java</span><br><span class="line">.rpm文件：先把文件复制指定目录  <span class="built_in">cp</span> /home/huser/jdk-8u341-linux-x64.rpm /usr/java</span><br><span class="line">        解压                sudo rpm -ivh jdk-8u341-linux-x64.rpm</span><br></pre></td></tr></table></figure></p><p>3.1.3 <strong>配置JDK环境变量</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure></p><p>3.1.4 加载环境变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></p><p>3.1.5 查看java版本信息<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">java version &quot;</span>1.8.0_201<span class="string">&quot;</span></span><br><span class="line"><span class="string">Java(TM) SE Runtime Environment (build 1.8.0_201-b09)</span></span><br><span class="line"><span class="string">Java HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode)</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">java</span><br><span class="line">javac</span><br></pre></td></tr></table></figure><br>3.1.7  拷贝到slave1和slave2节点<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /usr/java/jdk1.8.0_341-amd64  slave2(slave1):/usr/java/</span><br><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure></p><h2 id="4-配置hadoop文件"><a href="#4-配置hadoop文件" class="headerlink" title="4.配置hadoop文件"></a>4.配置hadoop文件</h2><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><p>4.1.1 在Linux系统下的软件包导入<br><br></p><p>4.1.2 解压hadoop到目录下的/opt<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf hadoop-3.2.1.tar.gz -C /opt/</span><br></pre></td></tr></table></figure></p><p>4.1.3 改<a href="https://so.csdn.net/so/search?q=权限&amp;urw="><strong>权限</strong></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R huser:huser /opt</span><br><span class="line"></span><br><span class="line"><span class="comment"># drwxr-xr-x.   4 huser huser   37 10月 29 14:22 opt</span></span><br></pre></td></tr></table></figure></p><p>4.1.4  改名<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> hadoop-3.2.1 hadoop</span><br></pre></td></tr></table></figure></p><h3 id="2-配置hadoop环境"><a href="#2-配置hadoop环境" class="headerlink" title="2.配置hadoop环境"></a>2.配置hadoop环境</h3><p>4.2.1 配置hadoop环境并且生效<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure></p><p>4.2.2  加载环境变量并查看<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line">hadoop version</span><br><span class="line"><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">Hadoop 2.7.7</span></span><br><span class="line"><span class="string">Subversion Unknown -r c1aad84bd27cd79c3d1a7dd58202a8c3ee1ed3ac</span></span><br><span class="line"><span class="string">Compiled by stevel on 2018-07-18T22:47Z</span></span><br><span class="line"><span class="string">Compiled with protoc 2.5.0</span></span><br><span class="line"><span class="string">From source with checksum 792e15d20b12c74bd6f19a1fb886490</span></span><br><span class="line"><span class="string">This command was run using /opt/hadoop/share/hadoop/common/hadoop-common-2.7.7.jar</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></p><p>4.2.3  创建文件（作用：放置数据源）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/tmp</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/journalnode_data</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/edits</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/datanode_data</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/hadoop/dfs/namenode_data</span><br><span class="line"></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 datanode_data</span></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 edits</span></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 journalnode_data</span></span><br><span class="line"><span class="comment">#drwxrwxr-x 2 huser huser 6 10月 28 12:32 namenode_data</span></span><br><span class="line"><span class="comment"># root ---&gt; huser</span></span><br><span class="line"><span class="comment">#chown -R huser:huser hadoop</span></span><br></pre></td></tr></table></figure></p><h3 id="3-配置集群文件-在-opt-hadoop-etc-hadoop目录里"><a href="#3-配置集群文件-在-opt-hadoop-etc-hadoop目录里" class="headerlink" title="3.配置集群文件,在/opt/hadoop/etc/hadoop目录里"></a>3.配置<a href="https://so.csdn.net/so/search?q=集群&amp;urw="><strong>集群</strong></a>文件,在<code>/opt/hadoop/etc/hadoop目录</code>里</h3><p>4.2.1 <strong>配置hadoop-env.sh</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim hadoop-env.sh</span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure></p><p>4.2.2 <strong>配置yarn-env.sh</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-env.sh</span><br><span class="line">修改内容：</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure></p><p>4.3.3   <strong>配置core-site.xml</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">    &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hdfs://hacluster&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--用来指定hadoop运行时产生文件的存放目录--&gt;</span><br><span class="line">    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;file:///opt/hadoop/tmp&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--设置缓存大小，默认4kb--&gt;</span><br><span class="line">    &lt;name&gt;io.file.buffer.size&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;4096&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定zookeeper的存放地址 --&gt;</span><br><span class="line">    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master:2181,slave1:2181,slave2:2181&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.4 <strong>配置hdfs-site.xml</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--数据块默认大小128M--&gt;</span><br><span class="line">     &lt;name&gt;dfs.block.size&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;134217728&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--副本数量，不配置的话默认为3--&gt;</span><br><span class="line">     &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;3&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--namenode节点数据（元数据）的存放位置--&gt;</span><br><span class="line">     &lt;name&gt;dfs.name.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;file:///opt/hadoop/dfs/namenode_data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--datanode节点数据（元数据）的存放位置--&gt;</span><br><span class="line">     &lt;name&gt;dfs.data.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;file:///opt/hadoop/dfs/datanode_data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.datanode.max.transfer.threads&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;4096&lt;/value&gt;</span><br><span class="line">     &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">     &lt;name&gt;dfs.nameservices&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;hacluster&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- hacluster集群下有两个namenode，分别为nn1,nn2 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.namenodes.hacluster&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;nn1,nn2,nn3&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- nn1的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.rpc-address.hacluster.nn1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:9000&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.servicepc-address.hacluster.nn1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:53310&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.http-address.hacluster.nn1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:50070&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- nn2的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.rpc-address.hacluster.nn2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:9000&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.servicepc-address.hacluster.nn2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:53310&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.http-address.hacluster.nn2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:50070&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line">&lt;!-- nn3的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.rpc-address.hacluster.nn3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:9000&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.servicepc-address.hacluster.nn3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:53310&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.http-address.hacluster.nn3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:50070&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定namenode的元数据在JournalNode上存放的位置 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;qjournal://master:8485;slave1:8485;slave2:8485/hacluster&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/opt/hadoop/dfs/journalnode_data&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- namenode操作日志的存放位置 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.namenode.edits.dir&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/opt/hadoop/dfs/edits&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 开启namenode故障转移自动切换 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.automatic-failover.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置失败自动切换实现方式 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.client.failover.proxy.provider.hacluster&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置隔离机制 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;sshfence&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 使用隔离机制需要SSH免密登录 --&gt;</span><br><span class="line">     &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/home/huser/.ssh/id_rsa&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--hdfs文件操作权限,<span class="literal">false</span>为不验证--&gt;</span><br><span class="line">     &lt;name&gt;dfs.permissions&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.5 <strong>配置mapred-site.xml</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果有mapred-site.xml，直接跳过</span><br><span class="line">没有：<span class="built_in">cp</span> mapred-site.xml.template mapred-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim mapred-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定mapreduce运行在yarn上--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--配置任务历史服务器地址--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master:10020&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--配置任务历史服务器web-UI地址--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master:19888&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--开启uber模式--&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.job.ubertask.enable&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.6 配置yarn-site.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;!-- 开启Yarn高可用 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定Yarn集群在zookeeper上注册的节点名 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;hayarn&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定两个ResourceManager的名称 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;rm1,rm2,rm3&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- ========== rm1 的配置 ========== --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定rm1的主机 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 rm1 的 web 端地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.webapp.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8088&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定 rm1 的内部通信地址 --&gt; </span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8032&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.scheduler.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8030&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定供 NM 连接的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm1&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:8031&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- ========== rm2 的配置 ========== --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定rm2的主机 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 rm2 的 web 端地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.webapp.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8088&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定 rm2 的内部通信地址 --&gt; </span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8032&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 AM 向 rm2 申请资源的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.scheduler.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8030&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定供 NM 连接的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm2&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave1:8031&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!-- ========== rm3 的配置 ========== --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 指定rm3的主机 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 rm3 的 web 端地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.webapp.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8088&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定 rm3 的内部通信地址 --&gt; </span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8032&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 指定 AM 向 rm3 申请资源的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.scheduler.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8030&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定供 NM 连接的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.resource-tracker.address.rm3&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2:8031&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置zookeeper的地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;master:2181,slave1:2181,slave2:2181&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 开启Yarn恢复机制 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.recovery.enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!-- 配置执行ResourceManager恢复机制实现类 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.store.class&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--指定主resourcemanager的地址--&gt;</span><br><span class="line">     &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;slave2&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--NodeManager获取数据的方式--&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 环境变量的继承 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.env-whitelist&lt;/name&gt;</span><br><span class="line">&lt;value&gt;JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--开启日志聚集功能--&gt;</span><br><span class="line">     &lt;name&gt;yarn.log-aggregation-enable&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">true</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line"> &lt;!-- 设置日志聚集服务器地址 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.log.server.url&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;http://master:19888/jobhistory/logs&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--配置日志保留7天--&gt;</span><br><span class="line">     &lt;name&gt;yarn.log-aggregation.retain-seconds&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;604800&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!--Spark--&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">   &lt;!-- 指定类的位置和文件配置位置 --&gt;</span><br><span class="line">     &lt;name&gt;yarn.application.classpath&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> &lt;property&gt;</span><br><span class="line">&lt;!-- 配置HDFS网页登录使用的静态用户为huser--&gt;</span><br><span class="line">     &lt;name&gt;hadoop.http.staticuser.user&lt;/name&gt;</span><br><span class="line">     &lt;value&gt;huser&lt;/value&gt;</span><br><span class="line"> &lt;/property&gt;</span><br></pre></td></tr></table></figure><p>4.3.7 <strong>配置slaves</strong></p><font color=red>hadoop3.3.0版本是 workers</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim slaves</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure>4.3.8  拷贝到slave1和slave2节点,并改权限<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/hadoop  slave2(slave1):/opt/</span><br><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br><span class="line"><span class="comment"># 因为拷贝过去的文件是root权限,所以要改huser用户</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R huser:huser /opt</span><br></pre></td></tr></table></figure>## 5.配置zookeeper文件### 1.准备工作5.1.1 **在Linux系统下的软件包导入**<br>**5.1.2 解压hadoop到目录下的/opt**<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf apache-zookeeper-3.7.1-bin.tar.gz -C /opt/</span><br></pre></td></tr></table></figure>5.1.3  改名<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mv</span> apache-zookeeper-3.7.1-bin zookeeper</span><br></pre></td></tr></table></figure>5.1.4 改权限（如果是普通用户要加 sudo ）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R huser:huser zookeeper</span><br><span class="line"></span><br><span class="line"><span class="comment"># drwxr-xr-x.   4 huser huser   37 10月 29 14:22 zookeeper</span></span><br></pre></td></tr></table></figure>### 2.配置zookeeper环境4.2.1 **配置**`zookeeper`**环境并且生效**<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># ZOOKEEPER_HOME</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br></pre></td></tr></table></figure>4.2.2  加载环境变量并查看<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>4.2.3 拷贝到slave1和slave2节点<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /etc/profile  slave2(slave1):/etc/profile</span><br></pre></td></tr></table></figure>### 3.修改配置文件5.3.1 进入安装目录的 conf/ 目录下，拷贝配置样本并进行修改：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/zookeeper/conf</span><br></pre></td></tr></table></figure>5.3.2 改名<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure>5.3.3 修改配置文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">vim zoo.cfg</span><br><span class="line">修改为：</span><br><span class="line">      <span class="comment"># The number of milliseconds of each tick</span></span><br><span class="line">      tickTime=2000</span><br><span class="line">      <span class="comment"># The number of ticks that the initial </span></span><br><span class="line">      <span class="comment"># synchronization phase can take</span></span><br><span class="line">      initLimit=10</span><br><span class="line">      <span class="comment"># The number of ticks that can pass between </span></span><br><span class="line">      <span class="comment"># sending a request and getting an acknowledgement</span></span><br><span class="line">      syncLimit=5</span><br><span class="line">      <span class="comment"># the directory where the snapshot is stored.</span></span><br><span class="line">      <span class="comment"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line">      <span class="comment"># example sakes.</span></span><br><span class="line">      dataDir=/opt/zookeeper/data</span><br><span class="line">      <span class="comment"># the port at which the clients will connect</span></span><br><span class="line">      clientPort=2181</span><br><span class="line">添加：</span><br><span class="line">dataLogDir=/opt/zookeeper/logs</span><br><span class="line">server.1=master:2888:3888</span><br><span class="line">server.2=slave1:2888:3888</span><br><span class="line">server.3=slave2:2888:3888</span><br><span class="line"></span><br><span class="line"><span class="comment">#配置参数说明：</span></span><br><span class="line"><span class="comment">#    ·tickTime：用于计算的基础时间单元。比如 session 超时：N*tickTime；</span></span><br><span class="line"><span class="comment">#    ·initLimit：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；</span></span><br><span class="line"><span class="comment">#    ·syncLimit：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；</span></span><br><span class="line"><span class="comment">#    ·dataDir：数据存储位置；</span></span><br><span class="line"><span class="comment">#    ·dataLogDir：日志目录；</span></span><br><span class="line"><span class="comment">#    ·clientPort：用于客户端连接的端口，默认 2181</span></span><br></pre></td></tr></table></figure>5.3.4  拷贝到slave1和slave2节点<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo scp -r /opt/zookeeper  slave2(slave1):/opt/</span><br><span class="line"><span class="comment"># 因为拷贝过去的文件是root权限,所以要改huser用户</span></span><br><span class="line"><span class="comment"># 下面是slave2 slave3 的操作</span></span><br><span class="line">sudo <span class="built_in">chown</span> -R huser:huser /opt/zookeeper</span><br></pre></td></tr></table></figure>### 4.标识节点5.4.1 创建存储目录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> data logs(<span class="built_in">cd</span> /opt/zookeeper)</span><br></pre></td></tr></table></figure>5.4.2 创建并写入节点标识到 myid 文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># master主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave1主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br><span class="line"><span class="comment"># slave2主机</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;3&quot;</span> &gt;&gt; /opt/zookeeper/data/myid</span><br></pre></td></tr></table></figure>5.4.3 验证节点标识<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> myid(<span class="built_in">cat</span> /opt/zookeeper/data/myid)</span><br></pre></td></tr></table></figure>### 5.启动zookeeper5.5.1 启动QuorumPeerMain节点<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br></pre></td></tr></table></figure>5.5.2 查看集群<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh status</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">ZooKeeper JMX enabled by default</span></span><br><span class="line"><span class="string">Using config: /opt/zookeeper/bin/../conf/zoo.cfg</span></span><br><span class="line"><span class="string">Client port found: 2181. Client address: localhost. Client SSL: false.</span></span><br><span class="line"><span class="string">Mode: follower</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>## 6. 启动集群6.1.1 启动journalnode，三台机器都要这一步操作（仅第一次启动hadoop时，需要这一步操作）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start journalnode</span><br></pre></td></tr></table></figure>6.1.2 在master主机上执行格式化操作，格式化namenode<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure>6.1.3 复制Namenode元数据到slave1和slave2<font color=red>如果没有权限，就在代码前面加---> sudo</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r  <span class="variable">$HADOOP_HOME</span>/dfs/namenode_data/ slave1(slave2):<span class="variable">$HADOOP_HOME</span>/dfs/</span><br></pre></td></tr></table></figure>6.1.4 格式化zkfc<font color=red>slave1或slave2【二者选其一即可】</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs zkfc -formatZK</span><br></pre></td></tr></table></figure>6.1.5 启动集群<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动dfs服务(master)</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"><span class="comment"># 启动yarn服务(slave2)</span></span><br><span class="line">start-yarn.sh</span><br><span class="line"><span class="comment"># 启动任务历史服务器(master)</span></span><br><span class="line">mr-jobhistory-daemon.sh start historyserver</span><br><span class="line"><span class="comment"># ResourceManager(slave1)</span></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br><span class="line"><span class="comment"># 暴力启动</span></span><br><span class="line">start-all.sh</span><br><span class="line"><span class="comment"># 关闭集群</span></span><br><span class="line">stop-all.sh</span><br></pre></td></tr></table></figure>6.1.6 查看[**节点**](https://so.csdn.net/so/search?q=节点&urw=)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">=============== master ===============</span></span><br><span class="line"><span class="string">50385 JournalNode</span></span><br><span class="line"><span class="string">50673 ResourceManager</span></span><br><span class="line"><span class="string">50115 NameNode</span></span><br><span class="line"><span class="string">45528 QuorumPeerMain</span></span><br><span class="line"><span class="string">50216 DataNode</span></span><br><span class="line"><span class="string">50538 DFSZKFailoverController</span></span><br><span class="line"><span class="string">51098 Jps</span></span><br><span class="line"><span class="string">50780 NodeManager</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">=============== slave1 ===============</span></span><br><span class="line"><span class="string">5777 NodeManager</span></span><br><span class="line"><span class="string">4310 NameNode</span></span><br><span class="line"><span class="string">4487 DataNode</span></span><br><span class="line"><span class="string">5608 ResourceManager</span></span><br><span class="line"><span class="string">5147 DFSZKFailoverController</span></span><br><span class="line"><span class="string">6811 Jps</span></span><br><span class="line"><span class="string">1260 QuorumPeerMain</span></span><br><span class="line"><span class="string">4860 JournalNode</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">=============== slave2 ===============</span></span><br><span class="line"><span class="string">5059 DFSZKFailoverController</span></span><br><span class="line"><span class="string">4484 DataNode</span></span><br><span class="line"><span class="string">5636 NodeManager</span></span><br><span class="line"><span class="string">4793 JournalNode</span></span><br><span class="line"><span class="string">4187 NameNode</span></span><br><span class="line"><span class="string">1262 QuorumPeerMain</span></span><br><span class="line"><span class="string">5486 ResourceManager</span></span><br><span class="line"><span class="string">7263 Jps</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>6.1.7 查看[**NameNode**](https://so.csdn.net/so/search?q=NameNode&urw=)和[**ResourceManager**](https://so.csdn.net/so/search?q=ResourceManager&urw=)的状态<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#【 查看NameNode的状态】</span></span><br><span class="line">[huser@master ~]$ hdfs haadmin -getServiceState nn1---&gt;   active</span><br><span class="line">[huser@master ~]$ hdfs haadmin -getServiceState nn2---&gt;   standby</span><br><span class="line">[huser@master ~]$ hdfs haadmin -getServiceState nn3---&gt;   standby</span><br><span class="line"></span><br><span class="line"><span class="comment">#【查看ResourceManager的状态】</span></span><br><span class="line">[huser@slave1(slave2) ~]$ yarn rmadmin -getServiceState rm1---&gt;   standby</span><br><span class="line">[huser@slave1(slave2) ~]$ yarn rmadmin -getServiceState rm2---&gt;   active</span><br></pre></td></tr></table></figure>## 7.集群[**二次启动**](https://so.csdn.net/so/search?q=二次启动&urw=)### 1 启动集群<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master   ---&gt;     start-dfs.sh</span><br><span class="line">slave2   ---&gt;     start-yarn.sh</span><br><span class="line">slave1   ---&gt;     yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure>注意：HA集群都启动好之后，杀掉一个active的NameNode之后，发现另一个NameNode并不能自动切换成active，而还是standby，经过查看日志发现如下错误：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[huser@slave1 logs]$ <span class="built_in">tail</span> -100 hadoop-xiaokang-zkfc-hadoop02.log</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span>PATH=<span class="variable">$PATH</span>:/sbin:/usr/sbin fuser -v -k -n tcp 9000 via ssh: bash: fuser: 未找到命令<span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>解决方法：（NameNode节点上安装上psmisc即可）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install psmisc</span><br></pre></td></tr></table></figure>### 2. 集群开启脚本`/opt/bin`#### 2.1 启动集群脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">vim start-dfs.sh </span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#启动zk集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;zkServer.sh start&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#休眠1s</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#启动hdfs集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;start-dfs.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 启动yarn服务</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;start-yarn.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 启动任务历史服务器(master)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;mr-jobhistory-daemon.sh start historyserver&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 启动ResourceManager(slave1)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;yarn-daemon.sh start resourcemanager&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure>#### 2.2 关闭集群脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">vim stop-dfs.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#关闭zk集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;zkServer.sh stop&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">#休眠1s</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#关闭hdfs集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;stop-dfs.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭yarn服务</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave2 </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;stop-yarn.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭任务历史服务器(master)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;mr-jobhistory-daemon.sh stop historyserver&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭ResourceManager(slave1)</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;yarn-daemon.sh stop resourcemanager&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure>#### 2.3 查看节点脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim allJps.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment">#查看当前节点的角色进程</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span>     </span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;-----------<span class="variable">$node</span> jps--------------&quot;</span></span><br><span class="line">   ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;jps&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>#### 2.4 HBase启动和关闭脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim hbase-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.1 启动集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动HBase</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;start-hbase.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"></span><br><span class="line">vim hbase-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.2 关闭集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭HBase</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;stop-hbase.sh&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br></pre></td></tr></table></figure>#### 2.5 Kylin启动和关闭脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vim kylin-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.4 HBase启动脚本   下面添加：：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动Kylin</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;kylin.sh start&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"></span><br><span class="line">vim kylin-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.4 HBase关闭脚本   下面添加：：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭Kylin</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master slave1 slave2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;kylin.sh stop&quot;</span> </span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br></pre></td></tr></table></figure>#### 2.6 spark启动和关闭脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">vim spark-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.1 启动集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 开启任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br><span class="line"></span><br><span class="line">vim spark-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.2 关闭集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure>#### 2.7 HA-spark启动和关闭脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">vim HA-spark-allstart.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.1 启动集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;cd /opt/spark/sbin;source /etc/profile;bash /opt/spark/sbin/start-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 开启Master</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-master.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 开启任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/start-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br><span class="line"></span><br><span class="line">vim HA-spark-allstop.sh</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&lt;&lt;&lt;------2.2 关闭集群脚本   下面添加：-----&gt;&gt;&gt;&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 关闭Spark集群</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-all.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭Master</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> slave1</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-master.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment"># 关闭任务历史服务器</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> master</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">ssh <span class="variable">$node</span> <span class="string">&quot;source /etc/profile;bash /opt/spark/sbin/stop-history-server.sh&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="comment">#调用allJps.sh</span></span><br><span class="line">bash allJps.sh</span><br></pre></td></tr></table></figure>#### 2.8  配置shell环境变量并更新<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br><span class="line"><span class="comment"># shell </span></span><br><span class="line"><span class="built_in">export</span> SHELL_HOME=/opt/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SHELL_HOME</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>#### 2.8 权限和启动脚本<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一种：</span><br><span class="line"><span class="built_in">chmod</span> +x startdfs.sh</span><br><span class="line"><span class="built_in">chmod</span> +x allJps.sh</span><br><span class="line"><span class="built_in">chmod</span> +x stopdfs.sh</span><br><span class="line">bash startdfs.sh</span><br><span class="line">第二种：</span><br><span class="line"><span class="built_in">chmod</span> -R 777 bin/</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line">startdfs.sh</span><br></pre></td></tr></table></figure>#### 2.9 vim快捷键<font color=green>:%s/要替换的值/替换后的值</font>#### 2.10 执行脚本去到脚本所在的目录然后 `./脚本名`例如`./start-dfs.sh`  切记!!!!!!!!!!!<font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hdfs--namenode--master</font><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xVSu.png" alt="hdfs--namenode--master" title="hdfs--namenode--master"><br><br></p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hdfs--namenode--slave1</font><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xjmY.png" alt="hdfs--namenode--slave1" title="hdfs--namenode--slave1"><br><br></p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hdfs--namenode--slave2</font><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xh5E.png" alt="hdfs--namenode--slave2" title="hdfs--namenode--slave2"><br><br></p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hdfs--yarn</font><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xYpv.png" alt="hdfs--yarn" title="hdfs--yarn"><br><br></p><font color=#425aef weight=bolder style='display: flex; justify-content: center; align-items: center;'>hdfs--JobHistoty</font><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xrot.png" alt="hdfs-JobHistoty" title="hdfs-JobHistoty"></p><h2 id="8-web端hadoop-hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法"><a href="#8-web端hadoop-hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法" class="headerlink" title="8. web端hadoop hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法"></a>8. web端hadoop hdfs管理界面，关于hdfs突然无法上传下载文件的解决方法</h2><h3 id="1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可"><a href="#1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可" class="headerlink" title="1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可"></a>1、刚开始是可以对文件及文件夹进行增删改操作的，现在突然操作不了的，请检查下本地电脑的hosts文件，是否已经成功添加虚拟机ip地址的映射及主节点、从节点的ip地址。注意映射是否被注释掉，如是把注释去掉即可</h3><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xyYX.png" alt="捕获.PNG"><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 apps.corel.com</span><br><span class="line">127.0.0.1 mc.corel.com</span><br><span class="line">127.0.0.1 origin-mc.corel.com</span><br><span class="line">127.0.0.1 iws.corel.com</span><br><span class="line">127.0.0.1 activate.navicat.com</span><br><span class="line">192.168.33.132 master(例)</span><br><span class="line">192.168.33.133 slave1(例)</span><br><span class="line">192.168.33.134 slave2(例)</span><br><span class="line">192.168.33.170 a1(例)</span><br><span class="line">192.168.33.171 a2(例)</span><br><span class="line">192.168.33.172 a3(例)</span><br></pre></td></tr></table></figure></p><h3 id="2-更改环境变量-可以跳过"><a href="#2-更改环境变量-可以跳过" class="headerlink" title="2. 更改环境变量(可以跳过)"></a>2. 更改环境变量(可以跳过)</h3><p><img src="https://vip.helloimg.com/images/2023/12/15/o7xud9.png" alt="20201021221301809.png"></p><h3 id="3-用户权限问题"><a href="#3-用户权限问题" class="headerlink" title="3. 用户权限问题"></a>3. 用户权限问题</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -<span class="built_in">chmod</span> 777 <span class="string">&quot;文件&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>完全分布式和Hadoop高可用集群的核心文件</title>
      <link href="/posts/7355e8ed.html"/>
      <url>/posts/7355e8ed.html</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>前提观看：</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="/%5B%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%5D(https:/www.yuque.com/yuqueyonghub89qji/xc0gbs/kusqdo?view=doc_embed)">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://vip.helloimg.com/images/2023/12/15/o7ex2Q.png)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">一、集群环境搭建高可用版本配置</div>            <div class="tag-link-sitename">介绍：HDFS （Hadoop Distributed File System）是Hadoop下的分布式文件系统，具有高容错(fault-tolerant)、高吞吐量(high throughput)等特性，可以部署在低成本(low-cost)的硬件上。特点：高容错：由于 HDFS 采用数据的... HADOOP</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><h1 id="相同文件配置"><a href="#相同文件配置" class="headerlink" title="相同文件配置"></a>相同文件配置</h1><h2 id="workers"><a href="#workers" class="headerlink" title="workers"></a>workers</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h2 id="hadoop-env-sh"><a href="#hadoop-env-sh" class="headerlink" title="hadoop-env.sh"></a>hadoop-env.sh</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/module/jdk1.8.0_321</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure><h1 id="完全分布式"><a href="#完全分布式" class="headerlink" title="完全分布式"></a>完全分布式</h1><h2 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定<span class="title class_">NameNode</span>的地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:8020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 指定hadoop数据的存储目录 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- nn web端访问地址--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9870<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 2nn web端访问地址--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9868<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 不开启权限检查 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="yarn-site-xml"><a href="#yarn-site-xml" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 指定<span class="variable constant_">MR</span>走shuffle --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> </span><br><span class="line">&lt;!-- 指定<span class="title class_">ResourceManager</span>的地址--&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> </span><br><span class="line">&lt;!-- 环境变量的继承 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&lt;!-- 开启日志聚集功能 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 设置日志聚集服务器地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span>  </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- 设置日志保留时间为<span class="number">7</span>天 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="mapred-site-xml"><a href="#mapred-site-xml" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">    &lt;!-- 指定<span class="title class_">MapReduce</span>程序运行在<span class="title class_">Yarn</span>上 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.map.env<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>HADOOP_MAPRED_HOME=/opt/hadoop<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.reduce.env<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>HADOOP_MAPRED_HOME=/opt/hadoop<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    </span><br><span class="line">    &lt;!-- 历史服务器端地址 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">     </span><br><span class="line">    &lt;!-- 历史服务器web端地址 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">    </span><br><span class="line">    &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀</span><br><span class="line">掉，默认是 <span class="literal">true</span> --&gt; </span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span> </span><br><span class="line">    &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀</span><br><span class="line">掉，默认是 <span class="literal">true</span> --&gt; </span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span> </span><br></pre></td></tr></table></figure><h1 id="Hadoop高可用集群"><a href="#Hadoop高可用集群" class="headerlink" title="Hadoop高可用集群"></a>Hadoop高可用集群</h1><h2 id="core-site-xml-1"><a href="#core-site-xml-1" class="headerlink" title="core-site.xml"></a>core-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--用来指定hadoop运行时产生文件的存放目录--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--设置缓存大小，默认4kb--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--指定zookeeper的存放地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>ha.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="hdfs-site-xml-1"><a href="#hdfs-site-xml-1" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--数据块默认大小128M--&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.block.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--副本数量，不配置的话默认为3--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--namenode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/namenode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--datanode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/datanode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.max.transfer.threads<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- hacluster集群下有两个namenode，分别为nn1,nn2 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.namenodes.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>nn1,nn2,nn3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn1的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn2的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- nn3的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定namenode的元数据在JournalNode上存放的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.shared.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>qjournal://master:8485;slave1:8485;slave2:8485/hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.journalnode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/journalnode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- namenode操作日志的存放位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/edits<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启namenode故障转移自动切换 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.automatic-failover.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置失败自动切换实现方式 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.failover.proxy.provider.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置隔离机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.methods<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>sshfence<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 使用隔离机制需要SSH免密登录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/huser/.ssh/id_rsa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--hdfs文件操作权限,false为不验证--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="yarn-site-xml-1"><a href="#yarn-site-xml-1" class="headerlink" title="yarn-site.xml"></a>yarn-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;!-- 开启<span class="title class_">Yarn</span>高可用 --&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定Yarn集群在zookeeper上注册的节点名 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.cluster-id<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hayarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定两个ResourceManager的名称 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.rm-ids<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>rm1,rm2,rm3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm1 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm1的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm1 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm1 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm2 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm2的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm2 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm2 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm2 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm3 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm3的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm3 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm3 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm3 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置zookeeper的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.zk-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启Yarn恢复机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.recovery.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置执行ResourceManager恢复机制实现类 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.store.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定主resourcemanager的地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--NodeManager获取数据的方式--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 环境变量的继承 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--开启日志聚集功能--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 设置日志聚集服务器地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--配置日志保留7天--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--<span class="title class_">Spark</span>--&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定类的位置和文件配置位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="mapred-site-xml-1"><a href="#mapred-site-xml-1" class="headerlink" title="mapred-site.xml"></a>mapred-site.xml</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定mapreduce运行在yarn上--&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器web-UI地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--开启uber模式--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>快速搭建大数据平台环境（简约版）</title>
      <link href="/posts/9a48b9a4.html"/>
      <url>/posts/9a48b9a4.html</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>需要的安装包：</p></div><ol><li><a href="https://www.centos.org/download/"><strong>CentOS</strong></a>镜像——&gt;<em>CentOS-7.5-x86_64-DVD-1804.iso</em></li><li><a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html"><strong>jdk</strong></a>压缩包——&gt;jdk-8u341-linux-x64.rpm</li><li><a href="http://archive.apache.org/dist/hadoop/common/"><strong>hadoop</strong></a>压缩包——&gt;hadoop-3.2.1.tar.gz</li><li><a href="https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/"><strong>zookeeper</strong></a>压缩包——&gt;apache-zookeeper-3.7.1-bin.tar.gz</li><li><a href="https://dev.mysql.com/downloads/file/?id=514685"><strong>MySQL</strong></a>压缩包—-&gt;mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar</li><li><a href="https://dlcdn.apache.org/hive/"><strong>Hive</strong></a>压缩包—-&gt;apache-hive-2.3.4-bin.tar.gz</li><li><a href="https://dev.mysql.com/downloads/connector/j/"><strong>MySQL的jar</strong></a>包—-&gt;mysql-connector-java-5.1.37.jar</li><li><a href="http://kylin.apache.org/cn/download/"><strong>Kylin(麒麟)</strong></a>包—-&gt;apache-kylin-4.0.2-bin.tar.gz</li><li><a href="http://datax-opensource.oss-cn-hangzhou.aliyuncs.com/datax.tar.gz"><strong>DataX</strong></a>包—-&gt;datax.tar.gz</li><li><a href="https://archive.apache.org/dist/maven/maven-3/"><strong>Maven</strong></a>包—-&gt;apache-maven-3.6.3-bin.tar.gz</li><li><a href="https://github.com/WeiYe-Jing/datax-web/archive/v-2.1.2.tar.gz"><strong>datax-web</strong></a>包—-&gt;datax-web-v-2.1.2.tar.gz</li><li><a href="https://gradle.org/releases/"><strong>Gradle</strong></a>包—-&gt;gradle-4.6-all.zip</li><li><a href="https://github.com/azkaban/azkaban/releases"><strong>azkaban</strong></a>包—-&gt;azkaban-3.57.0.tar.gz</li><li><a href="http://archive.apache.org/dist/flume/"><strong>flume</strong></a>压缩包——&gt;apache-flume-1.7.0-bin.tar.gz</li><li><a href="https://kafka.apache.org/downloads"><strong>kafka</strong></a>压缩包——&gt;kafka_2.12-3.0.0.tgz</li><li><a href="https://www.scala-lang.org/download/2.11.12.html"><strong>Scala</strong></a>压缩包——&gt;scala-2.12.8.tgz</li><li><a href="https://spark.apache.org/downloads.html"><strong>Spark</strong></a>压缩包——&gt;spark-3.1.3-bin-hadoop3.2.tgz</li><li><a href="https://archive.apache.org/dist/flink/"><strong>flink</strong></a>压缩包——&gt;flink-1.13.0-bin-scala_2.12.tgz<h1 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1. 环境准备"></a>1. 环境准备</h1><h2 id="1-1-修改-IP"><a href="#1-1-修改-IP" class="headerlink" title="1.1  修改 IP"></a>1.1  修改 IP</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/sysconfig/network-scripts/ifcfg-ens33</span><br><span class="line">          修改:</span><br><span class="line">                  <span class="variable constant_">BOOTPROTO</span>=<span class="keyword">static</span></span><br><span class="line">                  <span class="variable constant_">ONBOOT</span>=yes</span><br><span class="line">          添加内容：</span><br><span class="line">                <span class="variable constant_">IPADRR</span> = <span class="number">192.168</span><span class="number">.33</span><span class="number">.147</span>(匿)</span><br><span class="line">                <span class="variable constant_">GATEWAY</span> = <span class="number">192.168</span><span class="number">.33</span><span class="number">.2</span></span><br><span class="line">                <span class="variable constant_">NETMASK</span> = <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">                <span class="title class_">DNS1</span>=<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br><span class="line"></span><br><span class="line">sudo vim /etc/sysconfig/<span class="title function_">network</span>(可以不配)</span><br><span class="line">        添加内容：</span><br><span class="line">                <span class="variable constant_">NETWORKING</span>=yes</span><br><span class="line"><span class="variable constant_">HOSTNAME</span>=master</span><br></pre></td></tr></table></figure></li></ol><h2 id="1-2-修改主机名及主机名和-IP-地址的映射"><a href="#1-2-修改主机名及主机名和-IP-地址的映射" class="headerlink" title="1.2 修改主机名及主机名和 IP 地址的映射"></a>1.2 修改主机名及主机名和 IP 地址的映射</h2><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br><span class="line"></span><br><span class="line">修改内容（如）：</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.147</span> master</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.148</span> slave1</span><br><span class="line"><span class="number">192.168</span>.<span class="number">33.149</span> slave2</span><br></pre></td></tr></table></figure><h2 id="1-3-关闭防火墙"><a href="#1-3-关闭防火墙" class="headerlink" title="1.3 关闭防火墙"></a>1.3 关闭防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop firewalld(.service)</span><br><span class="line"></span><br><span class="line">开机，重启自动关闭</span><br><span class="line">sudo systemctl <span class="built_in">disable</span> firewalld(.service)</span><br></pre></td></tr></table></figure><h2 id="1-4-ssh-免密登录"><a href="#1-4-ssh-免密登录" class="headerlink" title="1.4 ssh 免密登录"></a>1.4 ssh 免密登录</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ssh-keygen</span> <span class="string">-t</span> <span class="string">rsa</span></span><br><span class="line"></span><br><span class="line"><span class="string">ssh-copy-id</span> <span class="string">-i</span> <span class="string">~/.ssh/id_rsa.pub</span> <span class="string">master</span></span><br><span class="line"><span class="string">ssh-copy-id</span> <span class="string">-i</span> <span class="string">~/.ssh/id_rsa.pub</span> <span class="string">slave1</span></span><br><span class="line"><span class="string">ssh-copy-id</span> <span class="string">-i</span> <span class="string">~/.ssh/id_rsa.pub</span> <span class="string">slave2</span></span><br></pre></td></tr></table></figure><h1 id="2-创建文件"><a href="#2-创建文件" class="headerlink" title="2. 创建文件"></a>2. 创建文件</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 记得：要改文件权限 root ---&gt; huser&lt;font&gt;</span></span><br><span class="line"><span class="comment"># hadoop集群文件</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/tmp</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/journalnode_data</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/edits</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/datanode_data</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/hadoop/dfs/namenode_data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># zookeeper文件</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">data</span> <span class="string">logs(cd</span> <span class="string">/opt/zookeeper)</span></span><br><span class="line"><span class="string">myid(--</span></span><br><span class="line"><span class="comment"># master主机</span></span><br><span class="line"><span class="string">echo</span> <span class="string">&quot;1&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">/opt/zookeeper/data/myid</span></span><br><span class="line"><span class="comment"># slave1主机</span></span><br><span class="line"><span class="string">echo</span> <span class="string">&quot;2&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">/opt/zookeeper/data/myid</span></span><br><span class="line"><span class="comment"># slave2主机</span></span><br><span class="line"><span class="string">echo</span> <span class="string">&quot;3&quot;</span> <span class="string">&gt;&gt;</span> <span class="string">/opt/zookeeper/data/myid</span></span><br><span class="line"><span class="string">--)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MySQL 存储文件</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/mysql/data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HDFS 存放tez依赖包</span></span><br><span class="line"><span class="string">hdfs</span> <span class="string">dfs</span> <span class="string">-mkdir</span> <span class="string">/tez</span></span><br><span class="line"><span class="string">hdfs</span> <span class="string">dfs</span> <span class="string">-put</span> <span class="string">apache-tez-0.9.2-bin.tar.gz</span> <span class="string">/tez</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># maven 创建本地目录</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/opt/maven/maven_repository</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gradle 创建本地目录</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/opt/gradle/gradle_repository</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Azkaban-solo-server 新创建文件并配置 init.gradle</span></span><br><span class="line"><span class="string">vim</span> <span class="string">/opt/gradle/gradle_repository</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Azkaban-two-server 在web服务器目录下创建多级文件夹plugins/jobtypes</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/opt/azkaban-two/web-server/plugins/jobtypes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  Kafka 存储分区信息</span></span><br><span class="line"><span class="string">mkdir</span> <span class="string">/opt/kafka/kafka-logs</span></span><br></pre></td></tr></table></figure><h1 id="3-下载组件"><a href="#3-下载组件" class="headerlink" title="3.下载组件"></a>3.下载组件</h1><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(文件修改)sudo yum -<span class="function">y install <span class="title">vim</span></span></span><br><span class="line"><span class="function">(<span class="params">设置及功能</span>)sudo yum install net-<span class="title">tools</span></span></span><br><span class="line"><span class="function">(<span class="params">时间戳</span>)sudo yum -y install <span class="title">ntp</span></span></span><br><span class="line"><span class="function">(<span class="params">定时同步时间</span>)sudo yum -y install <span class="title">crond</span></span></span><br><span class="line"><span class="function">(<span class="params">解决日志发现错误NameNode</span>)sudo yum -y install <span class="title">psmisc</span></span></span><br><span class="line"><span class="function">(<span class="params">网页wegt组件</span>)sudo yum -y install <span class="title">wegt</span></span></span><br><span class="line"><span class="function">(<span class="params">安装MySQL</span>)sudo yum -y install mysql-community-<span class="title">server</span></span></span><br><span class="line"><span class="function">(<span class="params">更新源</span>)sudo yum -y <span class="title">update</span></span></span><br><span class="line"><span class="function">(<span class="params">安装mysql</span>)sudo yum -y install mysql-server mysql-<span class="title">client</span></span></span><br><span class="line"><span class="function">(<span class="params">zip解压</span>)sudo yun -y install <span class="title">unzip</span></span></span><br><span class="line"><span class="function">(<span class="params">git下载组件</span>)sudo yum -y install <span class="title">git</span></span></span><br><span class="line"><span class="function">(<span class="params">编译环境</span>)sudo yum -y install gcc-c++</span></span><br><span class="line"><span class="function">(<span class="params">测试网络及端口</span>)sudo yum -y install <span class="title">telnet</span></span></span><br><span class="line"><span class="function">(<span class="params">网络工具</span>)sudo yum -y install nc</span></span><br></pre></td></tr></table></figure><h1 id="4-文件修改"><a href="#4-文件修改" class="headerlink" title="4. 文件修改"></a>4. 文件修改</h1><h2 id="1-集群环境搭建高可用版本配置"><a href="#1-集群环境搭建高可用版本配置" class="headerlink" title="1. 集群环境搭建高可用版本配置"></a>1. <a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo"><strong>集群环境搭建高可用版本配置</strong></a></h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">文件缩进  )<span class="string">&#x27;net-tools&#x27;</span>(  ---&gt;$ sudo vim /etc/vimrc</span><br><span class="line">        添加  <span class="keyword">set</span> ts=<span class="number">4</span></span><br><span class="line"></span><br><span class="line">设置时间  )<span class="string">&#x27;ntp&#x27;</span>(  ---&gt;$ sudo vim /etc/ntp.conf</span><br><span class="line"><span class="meta">#修改一（设置本地网络上的主机不受限制）</span></span><br><span class="line"><span class="meta">#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap 为</span></span><br><span class="line">restrict <span class="number">192.168</span><span class="number">.33</span><span class="number">.0</span> mask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> nomodify notrap</span><br><span class="line"><span class="meta">#修改二（添加默认的一个内部时钟数据，使用它为局域网用户提供服务）</span></span><br><span class="line">server <span class="number">127.127</span><span class="number">.1</span><span class="number">.0</span></span><br><span class="line">fudge <span class="number">127.127</span><span class="number">.1</span><span class="number">.0</span> stratum <span class="number">10</span></span><br><span class="line"><span class="meta">#修改三（设置为不采用公共的服务器）</span></span><br><span class="line">server <span class="number">0.</span>centos.pool.ntp.org iburst</span><br><span class="line">server <span class="number">1.</span>centos.pool.ntp.org iburst</span><br><span class="line">server <span class="number">2.</span>centos.pool.ntp.org iburst</span><br><span class="line">server <span class="number">3.</span>centos.pool.ntp.org iburst 为</span><br><span class="line"><span class="meta">#server 0.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="meta">#server 1.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="meta">#server 2.centos.pool.ntp.org iburst</span></span><br><span class="line"><span class="meta">#server 3.centos.pool.ntp.org iburst</span></span><br><span class="line"></span><br><span class="line">设置BIOS与系统时间同步  )<span class="string">&#x27;ntp&#x27;</span>(    ---&gt;$ sudo vim /etc/sysconfig/ntpd</span><br><span class="line"><span class="meta">#增加如下内容（让硬件时间与系统时间一起同步）</span></span><br><span class="line">      OPTIONS=<span class="string">&quot;-u ntp:ntp -p /var/run/ntpd.pid -g&quot;</span></span><br><span class="line">      SYNC_HWCLOCK=yes</span><br><span class="line"></span><br><span class="line">定时同步    )<span class="string">&#x27;crond&#x27;</span>(  ---&gt;$ sudo vim /etc/crontab</span><br><span class="line">编写定时任务如下：</span><br><span class="line">*/<span class="number">1</span> * * * * /usr/sbin/ntpdate hadoop02</span><br><span class="line">*/<span class="number">1</span> * * * * /usr/bin/echo <span class="string">&quot;文件&quot;</span> &gt;&gt; ~/<span class="string">&quot;目录&quot;</span></span><br></pre></td></tr></table></figure><h2 id="2-Hive组件搭建"><a href="#2-Hive组件搭建" class="headerlink" title="2. Hive组件搭建"></a>2. <a href="https://www.yuque.com/u25360462/nt1ri1/zamxgf"><strong>Hive组件搭建</strong></a></h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">关闭selinux  )<span class="string">&#x27;selinux&#x27;</span>(   ---&gt;$ sudo vim /etc/selinux/config</span><br><span class="line">修改为:</span><br><span class="line">      SELINUX=disabled</span><br><span class="line">      SELINUXTYPE=targeted</span><br><span class="line"></span><br><span class="line">my.cnf )<span class="string">&#x27;mysql&#x27;</span>(   ---&gt;$ sudo vim /etc/my.cnf</span><br><span class="line">没有my.cnf的文件内容添加: </span><br><span class="line">[<span class="meta">mysqld</span>]</span><br><span class="line">basedir=/opt/mysql/</span><br><span class="line">datadir=/opt/mysql/data/</span><br><span class="line">socket=/tmp/mysql.sock</span><br><span class="line">character-<span class="keyword">set</span>-server=UTF8MB4</span><br><span class="line">有my.cnf的文件内容,则添加:<span class="string">&#x27;[mysqld]&#x27;</span>,注释<span class="string">&#x27;[mysqld_safe]&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="3-Maven—-gt-DataX组件搭建"><a href="#3-Maven—-gt-DataX组件搭建" class="headerlink" title="3. Maven—&gt;DataX组件搭建"></a>3. <a href="https://www.yuque.com/u25360462/nt1ri1/fhwgf3"><strong>Maven</strong></a>—&gt;DataX组件搭建</h2><h3 id="3-1-配置setting-xml"><a href="#3-1-配置setting-xml" class="headerlink" title="3.1 配置setting.xml"></a>3.1 配置<em>setting.xml</em></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置本地仓库地址 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>/opt/maven/maven_repository<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span></span><br><span class="line">&lt;!-- 阿里云仓库 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span></span><br><span class="line">&lt;!-- <span class="title class_">Java</span>的<span class="variable constant_">JDK</span>版本 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">profile</span>&gt;</span>    </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.8<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="4-Azkaban-solo-server—-gt-工作流调度"><a href="#4-Azkaban-solo-server—-gt-工作流调度" class="headerlink" title="4. Azkaban-solo-server—&gt;工作流调度"></a>4. <a href="https://www.yuque.com/u25360462/nt1ri1/fwil15"><strong>Azkaban-solo-server</strong></a>—&gt;工作流调度</h2><h3 id="1-Gradle—-gt-Azkaban-solo-server"><a href="#1-Gradle—-gt-Azkaban-solo-server" class="headerlink" title="1. Gradle—&gt;Azkaban-solo-server"></a>1. <a href="https://www.yuque.com/u25360462/nt1ri1/fwil15"><strong>Gradle</strong></a>—&gt;Azkaban-solo-server</h3><h4 id="4-1-新创建文件并配置-init-gradle-配置在-opt-gradle-init-d"><a href="#4-1-新创建文件并配置-init-gradle-配置在-opt-gradle-init-d" class="headerlink" title="4.1 新创建文件并配置 init.gradle,配置在/opt/gradle/init.d"></a>4.1 新创建文件并配置 <font color=red>init.gradle</font>,配置在<code>/opt/gradle/init.d</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">all&lt;&gt;projects &#123;</span><br><span class="line">    rpositories </span><br><span class="line">      &gt;  maven &#123; url <span class="string">&#x27;file:///opt/maven/maven_repository&#x27;</span>&#125;</span><br><span class="line">        mavenLocal()</span><br><span class="line">        maven &#123; name <span class="string">&quot;Alibaba&quot;</span> ; url <span class="string">&quot;https://maven.aliyun.com/repository/public&quot;</span> &#125;</span><br><span class="line">        maven &#123; name <span class="string">&quot;Bstek&quot;</span> ; url <span class="string">&quot;http://nexus.bsdn.org/content/groups/public/&quot;</span> &#125;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    buildscript &#123; </span><br><span class="line">        repositories &#123; </span><br><span class="line">            maven &#123; name <span class="string">&quot;Alibaba&quot;</span> ; url <span class="string">&#x27;https://maven.aliyun.com/repository/public&#x27;</span> &#125;</span><br><span class="line">            maven &#123; name <span class="string">&quot;Bstek&quot;</span> ; url <span class="string">&#x27;http://nexus.bsdn.org/content/groups/public/&#x27;</span> &#125;</span><br><span class="line">            maven &#123; name <span class="string">&quot;M2&quot;</span> ; url <span class="string">&#x27;https://plugins.gradle.org/m2/&#x27;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-Azkaban-solo-server安装"><a href="#2-Azkaban-solo-server安装" class="headerlink" title="2. Azkaban-solo-server安装"></a>2. Azkaban-solo-server安装</h3><h4 id="4-2-拷贝对应gradle版本和修改gradle-wrapper-properties-中的-distributionUrl-属性，指明使用本地的-gradle-vim-opt-azkaban-gradle-wrapper-gradle-wrapper-properties"><a href="#4-2-拷贝对应gradle版本和修改gradle-wrapper-properties-中的-distributionUrl-属性，指明使用本地的-gradle-vim-opt-azkaban-gradle-wrapper-gradle-wrapper-properties" class="headerlink" title="4.2 拷贝对应gradle版本和修改gradle-wrapper.properties 中的 distributionUrl 属性，指明使用本地的 gradle---vim /opt/azkaban/gradle/wrapper/gradle-wrapper.properties"></a>4.2 拷贝对应<font color=green size=4>gradle</font>版本和修改<code>gradle-wrapper.properties</code> 中的 <code>distributionUrl</code> 属性，指明使用本地的 <code>gradle---vim /opt/azkaban/gradle/wrapper/gradle-wrapper.properties</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">distributionUrl=gradle-4.6-all.zip</span><br></pre></td></tr></table></figure><h4 id="4-3-修改时区，进入conf目录，修改azkaban-properties"><a href="#4-3-修改时区，进入conf目录，修改azkaban-properties" class="headerlink" title="4.3 修改时区，进入conf目录，修改azkaban.properties"></a>4.3 修改时区，进入conf目录，修改azkaban.properties</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default.timezone.id=Asia/Shanghai</span><br></pre></td></tr></table></figure><h2 id="5-Azkaban-two-server—-gt-工作流调度"><a href="#5-Azkaban-two-server—-gt-工作流调度" class="headerlink" title="5. Azkaban-two-server—&gt;工作流调度"></a>5. <a href="https://www.yuque.com/u25360462/nt1ri1/ba4s1h"><strong>Azkaban-two-server</strong></a>—&gt;工作流调度</h2><h3 id="5-1-web-服务器配置"><a href="#5-1-web-服务器配置" class="headerlink" title="5.1 web 服务器配置"></a>5.1 web 服务器配置</h3><h4 id="5-1-1-进入-azkaban-web-服务器安装目录的conf目录下，修改azkaban-properties"><a href="#5-1-1-进入-azkaban-web-服务器安装目录的conf目录下，修改azkaban-properties" class="headerlink" title="5.1.1 进入 azkaban web 服务器安装目录的conf目录下，修改azkaban.properties"></a>5.1.1 进入 <code>azkaban web</code> 服务器安装目录的<code>conf目录</code>下，修改<font color=red>azkaban.properties</font></h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Azkaban Personalization Settings</span></span><br><span class="line"><span class="string">azkaban.name=huser</span></span><br><span class="line"><span class="string">azkaban.label=huser-Azkaban</span></span><br><span class="line"><span class="string">azkaban.color=#FF3601</span></span><br><span class="line"><span class="string">azkaban.default.servlet.path=/index</span></span><br><span class="line"><span class="string">web.resource.dir=/opt/azkaban-two/web-server/web</span></span><br><span class="line"><span class="string">default.timezone.id=Asia/Shanghai</span></span><br><span class="line"><span class="comment"># Azkaban UserManager class</span></span><br><span class="line"><span class="string">user.manager.class=azkaban.user.XmlUserManager</span></span><br><span class="line"><span class="string">user.manager.xml.file=/opt/azkaban-two/web-server/conf/azkaban-users.xml</span></span><br><span class="line"><span class="comment"># Loader for projects</span></span><br><span class="line"><span class="string">executor.global.properties=/opt/azkaban-two/web-server/conf/global.properties</span></span><br><span class="line"><span class="string">azkaban.project.dir=projects</span></span><br><span class="line"><span class="comment"># Velocity dev mode</span></span><br><span class="line"><span class="string">velocity.dev.mode=false</span></span><br><span class="line"><span class="comment"># Azkaban Jetty server properties.</span></span><br><span class="line"><span class="string">jetty.ssl.port=8443</span></span><br><span class="line"><span class="string">jetty.port=8081</span></span><br><span class="line"><span class="string">jetty.keystore=/opt/azkaban-two/web-server/keystore</span></span><br><span class="line"><span class="string">jetty.password=123456</span></span><br><span class="line"><span class="string">jetty.keypassword=123456</span></span><br><span class="line"><span class="string">jetty.truststore=/opt/azkaban-two/web-server/keystore</span></span><br><span class="line"><span class="string">jetty.trustpassword=huser</span></span><br><span class="line"><span class="string">jetty.maxThreads=25</span></span><br><span class="line"><span class="comment"># Azkaban Executor settings</span></span><br><span class="line"><span class="string">executor.port=11241</span></span><br><span class="line"><span class="comment"># mail settings</span></span><br><span class="line"><span class="string">mail.sender=</span></span><br><span class="line"><span class="string">mail.host=</span></span><br><span class="line"><span class="comment"># User facing web server configurations used to construct the user facing server URLs. They are useful when there is a reverse proxy between Azkaban web servers and users.</span></span><br><span class="line"><span class="comment"># enduser -&gt; myazkabanhost:443 -&gt; proxy -&gt; localhost:8081</span></span><br><span class="line"><span class="comment"># when this parameters set then these parameters are used to generate email links.</span></span><br><span class="line"><span class="comment"># if these parameters are not set then jetty.hostname, and jetty.port(if ssl configured jetty.ssl.port) are used.</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_hostname=myazkabanhost.com</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_ssl_port=443</span></span><br><span class="line"><span class="comment"># azkaban.webserver.external_port=8081</span></span><br><span class="line"><span class="string">job.failure.email=</span></span><br><span class="line"><span class="string">job.success.email=</span></span><br><span class="line"><span class="string">lockdown.create.projects=false</span></span><br><span class="line"><span class="string">cache.directory=cache</span></span><br><span class="line"><span class="comment"># JMX stats</span></span><br><span class="line"><span class="string">jetty.connector.stats=true</span></span><br><span class="line"><span class="string">executor.connector.stats=true</span></span><br><span class="line"><span class="comment"># Azkaban plugin settings</span></span><br><span class="line"><span class="string">azkaban.jobtype.plugin.dir=/opt/azkaban-two/web-server/plugins/jobtypes</span></span><br><span class="line"><span class="comment"># Azkaban mysql settings by default. Users should configure their own username and password.</span></span><br><span class="line"><span class="string">database.type=mysql</span></span><br><span class="line"><span class="string">mysql.port=3306</span></span><br><span class="line"><span class="string">mysql.host=192.168.33.147</span></span><br><span class="line"><span class="string">mysql.database=azkaban_two</span></span><br><span class="line"><span class="string">mysql.user=root</span></span><br><span class="line"><span class="string">mysql.password=1</span></span><br><span class="line"><span class="string">mysql.numconnections=100</span></span><br><span class="line"><span class="comment">#Multiple Executor</span></span><br><span class="line"><span class="string">azkaban.use.multiple.executors=true</span></span><br><span class="line"><span class="string">azkaban.executorselector.filters=StaticRemainingFlowSize,CpuStatus</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.NumberOfAssignedFlowComparator=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.Memory=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.LastDispatched=1</span></span><br><span class="line"><span class="string">azkaban.executorselector.comparator.CpuUsage=1</span></span><br></pre></td></tr></table></figure><h4 id="5-1-2-log4j-properties修改日志文件路径"><a href="#5-1-2-log4j-properties修改日志文件路径" class="headerlink" title="5.1.2  log4j.properties修改日志文件路径"></a>5.1.2  log4j.properties修改日志文件路径</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j.appender.server.File=/opt/azkaban-two/web-server/logs/azkaban-webserver.log</span><br></pre></td></tr></table></figure><h4 id="5-1-3-在azkaban-web-服务器安装目录的conf目录下，-按照如下配置修改-azkaban-users-xml文件，增加自定义管理员用户"><a href="#5-1-3-在azkaban-web-服务器安装目录的conf目录下，-按照如下配置修改-azkaban-users-xml文件，增加自定义管理员用户" class="headerlink" title="5.1.3 在azkaban web 服务器安装目录的conf目录下， 按照如下配置修改 azkaban-users.xml文件，增加自定义管理员用户"></a>5.1.3 在<code>azkaban web</code> 服务器安装目录的<code>conf目录</code>下， 按照如下配置修改 <code>azkaban-users.xml文件</code>，增加自定义管理员用户</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;azkaban-users&gt;</span><br><span class="line">  &lt;user <span class="built_in">groups</span>=<span class="string">&quot;azkaban&quot;</span> password=<span class="string">&quot;azkaban&quot;</span> roles=<span class="string">&quot;admin&quot;</span> username=<span class="string">&quot;azkaban&quot;</span>/&gt;</span><br><span class="line">  &lt;user <span class="built_in">groups</span>=<span class="string">&quot;azkaban&quot;</span> password=<span class="string">&quot;xiaokang&quot;</span> roles=<span class="string">&quot;admin&quot;</span> username=<span class="string">&quot;xiaokang&quot;</span>/&gt;</span><br><span class="line">  &lt;user password=<span class="string">&quot;metrics&quot;</span> roles=<span class="string">&quot;metrics&quot;</span> username=<span class="string">&quot;metrics&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;role name=<span class="string">&quot;admin&quot;</span> permissions=<span class="string">&quot;ADMIN&quot;</span>/&gt;</span><br><span class="line">  &lt;role name=<span class="string">&quot;metrics&quot;</span> permissions=<span class="string">&quot;METRICS&quot;</span>/&gt;</span><br><span class="line">&lt;/azkaban-users&gt;</span><br></pre></td></tr></table></figure><h3 id="2-Executor-服务器配置"><a href="#2-Executor-服务器配置" class="headerlink" title="2. Executor 服务器配置"></a>2. Executor 服务器配置</h3><h4 id="5-2-1-进入-azkaban-executor-服务器安装目录的conf目录下，修改azkaban-properties"><a href="#5-2-1-进入-azkaban-executor-服务器安装目录的conf目录下，修改azkaban-properties" class="headerlink" title="5.2.1 进入 azkaban executor 服务器安装目录的conf目录下，修改azkaban.properties"></a>5.2.1 进入 <code>azkaban executor</code> 服务器安装目录的<code>conf目录</code>下，修改<font color=red>azkaban.properties</font></h4><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Azkaban Personalization Settings</span></span><br><span class="line"><span class="literal">default</span>.timezone.id=Asia/Shanghai</span><br><span class="line"><span class="meta"># Azkaban UserManager class</span></span><br><span class="line"><span class="meta"># Loader for projects</span></span><br><span class="line">executor.<span class="keyword">global</span>.properties=/opt/azkaban-two/executor-server/conf/<span class="keyword">global</span>.properties</span><br><span class="line">azkaban.project.dir=projects</span><br><span class="line">azkaban.webserver.url=https:<span class="comment">//master:8443</span></span><br><span class="line"><span class="meta"># Azkaban plugin settings</span></span><br><span class="line">azkaban.jobtype.plugin.dir=/opt/azkaban-two/executor-server/plugins/jobtypes</span><br><span class="line"><span class="meta"># Azkaban mysql settings by default. Users should configure their own username and password.</span></span><br><span class="line">database.type=mysql</span><br><span class="line">mysql.port=<span class="number">3306</span></span><br><span class="line">mysql.host=<span class="number">192.168</span><span class="number">.33</span><span class="number">.147</span></span><br><span class="line">mysql.database=azkaban_two</span><br><span class="line">mysql.user=root</span><br><span class="line">mysql.password=<span class="number">1</span></span><br><span class="line">mysql.numconnections=<span class="number">100</span></span><br><span class="line"><span class="meta"># Azkaban Executor settings</span></span><br><span class="line">executor.maxThreads=<span class="number">50</span></span><br><span class="line">executor.flow.threads=<span class="number">30</span></span><br><span class="line">executor.port=<span class="number">11241</span></span><br></pre></td></tr></table></figure><h4 id="5-2-2-log4j-properties修改日志文件路径"><a href="#5-2-2-log4j-properties修改日志文件路径" class="headerlink" title="5.2.2 log4j.properties修改日志文件路径"></a>5.2.2 <font color=red>log4j.properties</font>修改日志文件路径</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log4j.appender.server.File=/opt/azkaban-two/executor-server/logs/azkaban-execserver.log</span><br></pre></td></tr></table></figure><h1 id="5-环境文件配置"><a href="#5-环境文件配置" class="headerlink" title="5. 环境文件配置"></a>5. 环境文件配置</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br><span class="line"><span class="comment"># HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br><span class="line"><span class="comment"># ZOOKEEPER_HOME</span></span><br><span class="line"><span class="built_in">export</span> ZOOKEEPER_HOME=/opt/zookeeper</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ZOOKEEPER_HOME</span>/bin</span><br><span class="line"><span class="comment"># HIVE_HOME(HBASE_HOME)</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/hive</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HIVE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># HBASE_HOME</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/opt/hbase</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HBASE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># sqoop</span></span><br><span class="line"><span class="built_in">export</span> SQOOP_HOME=/opt/sqoop</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SQOOP_HOME</span>/bin</span><br><span class="line"><span class="comment"># shell </span></span><br><span class="line"><span class="built_in">export</span> SHELL_HOME=/opt/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SHELL_HOME</span></span><br><span class="line"><span class="comment"># maven</span></span><br><span class="line"><span class="built_in">export</span> MAVEN_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$MAVEN_HOME</span>/bin</span><br><span class="line"><span class="comment"># gradle</span></span><br><span class="line"><span class="built_in">export</span> GRADLE_HOME=/opt/maven</span><br><span class="line"><span class="built_in">export</span> GRADLE_USER_HOME=/opt/gradle</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GRADLE_HOME</span>/bin</span><br><span class="line"><span class="comment"># flume</span></span><br><span class="line"><span class="built_in">export</span> FLUME_HOME=/opt/flume</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$FLUME_HOME</span>/bin</span><br><span class="line"><span class="comment"># kafka</span></span><br><span class="line"><span class="built_in">export</span> KAFKA_HOME=/opt/kafka</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$KAFKA_HOME</span>/bin</span><br><span class="line"><span class="comment"># scala</span></span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=/opt/scala</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SCALA_HOME</span>/bin</span><br><span class="line"><span class="comment"># spark</span></span><br><span class="line"><span class="built_in">export</span> SPARK_HOME=/opt/spark</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SPARK_HOME</span>/bin</span><br><span class="line"><span class="comment"># flink</span></span><br><span class="line"><span class="built_in">export</span> FILNK_HOME=/opt/flink</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$FLINK_HOME</span>/bin</span><br></pre></td></tr></table></figure><h1 id="6-集群环境文件配置"><a href="#6-集群环境文件配置" class="headerlink" title="6. 集群环境文件配置"></a>6. 集群环境文件配置</h1><h2 id="1-配置hdfs"><a href="#1-配置hdfs" class="headerlink" title="1. 配置hdfs"></a>1. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/kusqdo"><strong>hdfs</strong></a></h2><h3 id="1-1-配置hadoop-env-sh"><a href="#1-1-配置hadoop-env-sh" class="headerlink" title="1.1 配置hadoop-env.sh"></a>1.1 配置<font color=purple>hadoop-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure><h3 id="1-2-配置hadoop-yarn-sh"><a href="#1-2-配置hadoop-yarn-sh" class="headerlink" title="1.2 配置hadoop-yarn.sh"></a>1.2 配置<font color=purple>hadoop-yarn.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure><h3 id="1-3-配置core-site-xml"><a href="#1-3-配置core-site-xml" class="headerlink" title="1.3 配置core-site.xml"></a>1.3 配置<font color=purple>core-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">       &lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span><br><span class="line">       <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">       <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">   &lt;/property&gt;</span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="comment">&lt;!--用来指定hadoop运行时产生文件的存放目录--&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="comment">&lt;!--设置缓存大小，默认4kb--&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>io.file.buffer.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">   <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="comment">&lt;!--指定zookeeper的存放地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>ha.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-4-配置hdfs-site-xml"><a href="#1-4-配置hdfs-site-xml" class="headerlink" title="1.4 配置hdfs-site.xml"></a>1.4 配置<font color=purple>hdfs-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"> &lt;property&gt;</span><br><span class="line">     &lt;!--数据块默认大小128M--&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.block.size<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>134217728<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--副本数量，不配置的话默认为3--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--namenode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/namenode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--datanode节点数据（元数据）的存放位置--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///opt/hadoop/dfs/datanode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.max.transfer.threads<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>4096<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定hadoop集群在zookeeper上注册的节点名--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- hacluster集群下有两个namenode，分别为nn1,nn2 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.namenodes.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>nn1,nn2,nn3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn1的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- nn2的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line">&lt;!-- nn3的rpc、servicepc和http通信 --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.servicepc-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:53310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.hacluster.nn3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定namenode的元数据在JournalNode上存放的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.shared.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>qjournal://master:8485;slave1:8485;slave2:8485/hacluster<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.journalnode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/journalnode_data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- namenode操作日志的存放位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/dfs/edits<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启namenode故障转移自动切换 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.automatic-failover.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置失败自动切换实现方式 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.failover.proxy.provider.hacluster<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置隔离机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.methods<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>sshfence<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 使用隔离机制需要SSH免密登录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/huser/.ssh/id_rsa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--hdfs文件操作权限,false为不验证--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-5-配置mapred-site-xml"><a href="#1-5-配置mapred-site-xml" class="headerlink" title="1.5 配置mapred-site.xml"></a>1.5 配置<font color=purple>mapred-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;!--指定mapreduce运行在yarn上--&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--配置任务历史服务器web-UI地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!--开启uber模式--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.job.ubertask.enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-6-配置yarn-site-xml"><a href="#1-6-配置yarn-site-xml" class="headerlink" title="1.6 配置yarn-site.xml"></a>1.6 配置<font color=purple>yarn-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">     &lt;!-- 开启<span class="title class_">Yarn</span>高可用 --&gt;</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"> &lt;/property&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定Yarn集群在zookeeper上注册的节点名 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.cluster-id<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>hayarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定两个ResourceManager的名称 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.rm-ids<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>rm1,rm2,rm3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm1 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm1的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm1 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm1 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm1 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm2 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm2的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm2 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm2 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm2 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave1:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!-- ========== rm3 的配置 ========== --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 指定rm3的主机 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 rm3 的 web 端地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定 rm3 的内部通信地址 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8032<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 指定 AM 向 rm3 申请资源的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定供 NM 连接的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address.rm3<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2:8031<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置zookeeper的地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.zk-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:2181,slave1:2181,slave2:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 开启Yarn恢复机制 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.recovery.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- 配置执行ResourceManager恢复机制实现类 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.store.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.yarn.server.resourcemanager.recovery.ZKRMStateStore<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--指定主resourcemanager的地址--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--NodeManager获取数据的方式--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 环境变量的继承 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.env-whitelist<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--开启日志聚集功能--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="comment">&lt;!-- 设置日志聚集服务器地址 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://master:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!--配置日志保留7天--&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--<span class="title class_">Spark</span>--&gt;</span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.pmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> &lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是 <span class="literal">true</span> --&gt;</span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.vmem-check-enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"> <span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="comment">&lt;!-- 指定类的位置和文件配置位置 --&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/hadoop/etc/hadoop:/opt/hadoop/share/hadoop/common/lib/*:/opt/hadoop/share/hadoop/common/*:/opt/hadoop/share/hadoop/hdfs:/opt/hadoop/share/hadoop/hdfs/lib/*:/opt/hadoop/share/hadoop/hdfs/*:/opt/hadoop/share/hadoop/mapreduce/lib/*:/opt/hadoop/share/hadoop/mapreduce/*:/opt/hadoop/share/hadoop/yarn:/opt/hadoop/share/hadoop/yarn/lib/*:/opt/hadoop/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="1-7-配置slaves"><a href="#1-7-配置slaves" class="headerlink" title="1.7  配置slaves"></a>1.7  配置<font color=purple>slaves</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h2 id="2-配置zookeeper-—-gt-zoo-sample-cfg-—-gt-zoo-cfg"><a href="#2-配置zookeeper-—-gt-zoo-sample-cfg-—-gt-zoo-cfg" class="headerlink" title="2. 配置zookeeper —&gt;zoo_sample.cfg —&gt; zoo.cfg"></a>2. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/wzn655"><strong>zookeeper</strong></a> —&gt;<code>zoo_sample.cfg</code> —&gt; <code>zoo.cfg</code></h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">修改为：</span><br><span class="line">      <span class="meta"># The number of milliseconds of each tick</span></span><br><span class="line">      tickTime=<span class="number">2000</span></span><br><span class="line">      <span class="meta"># The number of ticks that the initial </span></span><br><span class="line">      <span class="meta"># synchronization phase can take</span></span><br><span class="line">      initLimit=<span class="number">10</span></span><br><span class="line">      <span class="meta"># The number of ticks that can pass between </span></span><br><span class="line">      <span class="meta"># sending a request and getting an acknowledgement</span></span><br><span class="line">      syncLimit=<span class="number">5</span></span><br><span class="line">      <span class="meta"># the directory where the snapshot is stored.</span></span><br><span class="line">      <span class="meta"># do not use /tmp for storage, /tmp here is just </span></span><br><span class="line">      <span class="meta"># example sakes.</span></span><br><span class="line">      dataDir=/opt/zookeeper/data</span><br><span class="line">      <span class="meta"># the port at which the clients will connect</span></span><br><span class="line">      clientPort=<span class="number">2181</span></span><br><span class="line">添加：</span><br><span class="line">      dataLogDir=/opt/zookeeper/logs</span><br><span class="line">      server<span class="number">.1</span>=master:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">      server<span class="number">.2</span>=slave1:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">      server<span class="number">.3</span>=slave2:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#配置参数说明：</span></span><br><span class="line"><span class="meta">#    ·tickTime：用于计算的基础时间单元。比如 session 超时：N*tickTime；</span></span><br><span class="line"><span class="meta">#    ·initLimit：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；</span></span><br><span class="line"><span class="meta">#    ·syncLimit：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；</span></span><br><span class="line"><span class="meta">#    ·dataDir：数据存储位置；</span></span><br><span class="line"><span class="meta">#    ·dataLogDir：日志目录；</span></span><br><span class="line"><span class="meta">#    ·clientPort：用于客户端连接的端口，默认 2181</span></span><br></pre></td></tr></table></figure><h2 id="3-配置hive"><a href="#3-配置hive" class="headerlink" title="3. 配置hive"></a>3. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/zamxgf"><strong>hive</strong></a></h2><h3 id="3-1-配置hive-env-sh"><a href="#3-1-配置hive-env-sh" class="headerlink" title="3.1 配置hive-env.sh"></a>3.1 配置<font color=purple>hive-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HADOOP_HOME=/opt/hadoop</span><br><span class="line"><span class="built_in">export</span> HIVE_CONF_DIR=/opt/hive/conf</span><br><span class="line"><span class="built_in">export</span> HIVE_AUX_JARS_PATH=/opt/hive/lib</span><br></pre></td></tr></table></figure><h3 id="3-2-配置hive-log4j-properties"><a href="#3-2-配置hive-log4j-properties" class="headerlink" title="3.2 配置hive-log4j.properties"></a>3.2 配置<font color=purple>hive-log4j.properties</font></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive.log.dir=/opt/hive/log</span><br></pre></td></tr></table></figure><h3 id="3-3-创建并配置hive-site-xml"><a href="#3-3-创建并配置hive-site-xml" class="headerlink" title="3.3 创建并配置hive-site.xml"></a>3.3 创建并配置<font color=purple>hive-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=<span class="string">&quot;text/xsl&quot;</span> href=<span class="string">&quot;configuration.xsl&quot;</span>?&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的URL --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://master:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的Driver--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- jdbc连接的username--&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- jdbc连接的password --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>&#x27;密码&#x27;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- Hive默认在HDFS的工作目录 --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- Hive 元数据存储版本的验证 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!--元数据存储授权--&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>datanucleus.schema.autoCreateAll<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="4-配置HBase"><a href="#4-配置HBase" class="headerlink" title="4. 配置HBase"></a>4. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/rncd28"><strong>HBase</strong></a></h2><h3 id="4-1-配置hbase-env-sh"><a href="#4-1-配置hbase-env-sh" class="headerlink" title="4.1 配置hbase-env.sh"></a>4.1 配置<font color=purple>hbase-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="comment">#表示不引用hbase自带的zookeeper，用我们自己安装的</span></span><br><span class="line"><span class="built_in">export</span> HBASE_MANAGES_ZK=<span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="4-2-配置hbase-site-xml"><a href="#4-2-配置hbase-site-xml" class="headerlink" title="4.2  配置hbase-site.xml"></a>4.2  配置<font color=purple>hbase-site.xml</font></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!-- hbase 在 zookeeper 中的缓冲的节点目录  --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>zookeeper.znode.parent<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>//opt/hbase/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 指定 hbase 在 HDFS 上存储的路径 mycluster为hdfs的nameservice名称--&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://mycluster/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- 指定 zk 的地址,多个用&quot;,&quot;分割 --&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master,slave1,slave2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="4-3-配置regionservers服务器列表"><a href="#4-3-配置regionservers服务器列表" class="headerlink" title="4.3  配置regionservers服务器列表"></a>4.3  配置<font color=purple>regionservers</font>服务器列表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h2 id="5-配置Kylin-麒麟"><a href="#5-配置Kylin-麒麟" class="headerlink" title="5. 配置Kylin(麒麟)"></a>5. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/agzot9"><strong>Kylin(麒麟</strong>)</a></h2><h3 id="5-1-配置conf目录下的kylin-properties"><a href="#5-1-配置conf目录下的kylin-properties" class="headerlink" title="5.1 配置conf目录下的kylin.properties"></a>5.1 配置<code>conf目录</code>下的<font color=red>kylin.properties</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 改成东八区, 否则会出现时间显示不准的问题</span></span><br><span class="line">kylin.web.timezone=GMT+8</span><br></pre></td></tr></table></figure><h3 id="5-2-配置bin目录下的kylin-sh"><a href="#5-2-配置bin目录下的kylin-sh" class="headerlink" title="5.2 配置bin目录下的kylin.sh"></a>5.2 配置bin目录下的kylin.sh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ -z <span class="variable">$reload_dependency</span> &amp;&amp; `<span class="built_in">ls</span> -1 <span class="variable">$&#123;dir&#125;</span>/cached-* 2&gt;/dev/null | <span class="built_in">wc</span> -l` -eq 5 ]]</span><br><span class="line">   <span class="keyword">then</span></span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;Using cached dependency...&quot;</span></span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hive-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hbase-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-hadoop-conf-dir.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/cached-kafka-dependency.sh</span><br><span class="line">       <span class="comment">#source $&#123;dir&#125;/cached-spark-dependency.sh</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hive-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hbase-dependency.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-hadoop-conf-dir.sh</span><br><span class="line">       <span class="built_in">source</span> <span class="variable">$&#123;dir&#125;</span>/find-kafka-dependency.sh</span><br><span class="line">       <span class="comment">#source $&#123;dir&#125;/find-spark-dependency.sh</span></span><br><span class="line">   <span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h2 id="6-配置Sqoop"><a href="#6-配置Sqoop" class="headerlink" title="6. 配置Sqoop"></a>6. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/hp4a5r"><strong>Sqoop</strong></a></h2><h3 id="6-1-配置sqoop-env-sh"><a href="#6-1-配置sqoop-env-sh" class="headerlink" title="6.1 配置sqoop-env.sh"></a>6.1 配置<font color=purple>sqoop-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拷贝 Sqoop 的环境配置模板</span></span><br><span class="line"><span class="built_in">cp</span> sqoop-env-template.cmd sqoop-env.sh</span><br><span class="line"></span><br><span class="line">修改内容：</span><br><span class="line"><span class="comment">#Set path to where bin/hadoop is available</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=/opt/hadoop</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set path to where hadoop-*-core.jar is available</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=/opt/hadoop</span><br><span class="line"></span><br><span class="line"><span class="comment">#set the path to where bin/hbase is available</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/opt/hbase</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set the path to where bin/hive is available</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/opt/hive</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set the path for where zookeper config dir is</span></span><br><span class="line"><span class="built_in">export</span> ZOOCFGDIR=/opt/zookeeper/conf</span><br></pre></td></tr></table></figure><h2 id="7-配置Flume"><a href="#7-配置Flume" class="headerlink" title="7. 配置Flume"></a>7. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/ilmsg4"><strong>Flume</strong></a></h2><h3 id="7-1-配置flume-env-sh"><a href="#7-1-配置flume-env-sh" class="headerlink" title="7.1 配置flume-env.sh"></a>7.1 配置<font color=purple>flume-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br></pre></td></tr></table></figure><h3 id="7-2-新建配置文件telnet-logger-properties"><a href="#7-2-新建配置文件telnet-logger-properties" class="headerlink" title="7.2  新建配置文件telnet-logger.properties"></a>7.2  新建配置文件<font color=red>telnet-logger.properties</font></h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#指定agent的sources、channels、sinks</span></span><br><span class="line">a1.sources = s1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sinks = k1</span><br><span class="line"></span><br><span class="line"><span class="meta">#配置source属性</span></span><br><span class="line">a1.sources.s1.type = netcat</span><br><span class="line">a1.sources.s1.bind = master</span><br><span class="line">a1.sources.s1.port = <span class="number">44444</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#配置channel类型</span></span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = <span class="number">10000</span></span><br><span class="line">a1.channels.c1.transactionCapacity = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#配置sink</span></span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line"><span class="meta">#将sources和channels绑定</span></span><br><span class="line">a1.sources.s1.channels = c1</span><br><span class="line"></span><br><span class="line"><span class="meta">#将sinks和channels绑定</span></span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><h2 id="8-配置kafka"><a href="#8-配置kafka" class="headerlink" title="8. 配置kafka"></a>8. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/ais8mvhduvvmrp1f"><strong>kafka</strong></a></h2><h3 id="8-1-配置server-properties"><a href="#8-1-配置server-properties" class="headerlink" title="8.1 配置server.properties"></a>8.1 配置<font color=red>server.properties</font></h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># broker的全局唯一标识号，不能重复. 给集群中的每个broker配置一个不同的id</span></span><br><span class="line">broker.id=<span class="number">0</span></span><br><span class="line"><span class="meta"># 分区数据的存储位置</span></span><br><span class="line">log.dirs=/opt/kafka/kafka-logs</span><br><span class="line"><span class="meta"># 连接Zookeeper集群地址</span></span><br><span class="line">zookeeper.connect=master:<span class="number">2181</span>,slave1:<span class="number">2181</span>,slave2:<span class="number">2181</span></span><br></pre></td></tr></table></figure><h2 id="9-配置Spark"><a href="#9-配置Spark" class="headerlink" title="9. 配置Spark"></a>9. 配置<a href="https://www.yuque.com/u25360462/nt1ri1/pgd5fk7fsd12wlxt"><strong>Spark</strong></a></h2><h3 id="9-1-配置spark-env-sh"><a href="#9-1-配置spark-env-sh" class="headerlink" title="9.1 配置spark-env.sh"></a>9.1 配置<font color=purple>spark-env.sh</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_341-amd64</span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=/opt/scala</span><br><span class="line">YARN_CONF_DIR=/opt/hadoop/etc/hadoop</span><br><span class="line"><span class="built_in">export</span> SPARK_HISTORY_OPTS=<span class="string">&quot;-Dspark.history.ui.port=18080 -Dspark.history.retainedApplications=24 -Dspark.history.fs.logDirectory=hdfs://master:9000/spark-jobhistory&quot;</span></span><br><span class="line"><span class="built_in">export</span> SPARK_DAEMON_JAVA_OPTS=<span class="string">&quot;-Dspark.deploy.recoveryMode=ZOOKEEPER -Dspark.deploy.zookeeper.url=master:2181,slave1:2181,slave2:2181 -Dspark.deploy.zookeeper.dir=/opt/spark/data/&quot;</span></span><br></pre></td></tr></table></figure><h3 id="9-2-配置spark-defaults-conf"><a href="#9-2-配置spark-defaults-conf" class="headerlink" title="9.2 配置spark-defaults.conf"></a>9.2 配置<font color=purple>spark-defaults.conf</font></h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># spark.master                    spark://master:7077</span></span><br><span class="line"><span class="string">spark.master</span>                     <span class="string">spark://master:7077,slave1:7077</span></span><br><span class="line"><span class="string">spark.eventLog.enabled</span>           <span class="literal">true</span></span><br><span class="line"><span class="string">spark.eventLog.dir</span>               <span class="string">hdfs://master:9000/spark-jobhistory</span></span><br><span class="line"><span class="string">spark.yarn.historyServer.address</span>               <span class="string">master:18080</span></span><br></pre></td></tr></table></figure><h3 id="9-3-配置workers"><a href="#9-3-配置workers" class="headerlink" title="9.3 配置workers"></a>9.3 配置<font color=purple>workers</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">slave1</span><br><span class="line">slave2</span><br></pre></td></tr></table></figure><h3 id="9-4-配置hadoop的yarn-site-xml"><a href="#9-4-配置hadoop的yarn-site-xml" class="headerlink" title="9.4 配置hadoop的yarn-site.xml"></a>9.4 配置hadoop的<font color=purple>yarn-site.xml</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 由于测试环境的虚拟机内存太少, 防止将来任务被意外杀死, 做如下配置 --&gt;</span><br><span class="line">&lt;!--是否启动一个线程检查每个任务正使用的物理内存量，如果任务超出分配值，则直接将其杀掉，默认是<span class="literal">true</span> --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.pmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;!--是否启动一个线程检查每个任务正使用的虚拟内存量，如果任务超出分配值，则直接将其杀掉，默认是<span class="literal">true</span> --&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.vmem-check-enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;<span class="literal">false</span>&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.log.server.url&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;http://master:19888/jobhistory/logs&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure><h1 id="7-启动命令"><a href="#7-启动命令" class="headerlink" title="7. 启动命令"></a>7. 启动命令</h1><h2 id="1-启动zookeeper"><a href="#1-启动zookeeper" class="headerlink" title="1. 启动zookeeper"></a>1. 启动zookeeper</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(启动QuorumPeerMain节点) ---  zkServer.<span class="function">sh <span class="title">start</span></span></span><br><span class="line"><span class="function">(<span class="params">关闭QuorumPeerMain节点</span>) ---  zkServer.sh <span class="title">stop</span></span></span><br><span class="line"><span class="function">(<span class="params">查看zookeeper集群</span>) ---  zkServer.sh <span class="title">status</span></span></span><br><span class="line"><span class="function">(<span class="params">格式化zkfc</span>) ---  hdfs zkfc -formatZK</span></span><br></pre></td></tr></table></figure><h2 id="2-启动hdfs集群"><a href="#2-启动hdfs集群" class="headerlink" title="2. 启动hdfs集群"></a>2. 启动hdfs集群</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># journalnode</span></span><br><span class="line">(启动journalnode节点) ---  hadoop-daemon.<span class="function">sh start <span class="title">journalnode</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">(<span class="params">关闭journalnode节点</span>) ---  hadoop-daemon.sh stop journalnode</span></span><br><span class="line"><span class="function"># <span class="title">hdfs</span></span></span><br><span class="line"><span class="function">(<span class="params">格式化namenode</span>) ---  hdfs namenode -<span class="title">format</span></span></span><br><span class="line"><span class="function">(<span class="params">启动dfs服务</span>) ---  start-dfs.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">启动yarn服务</span>) ---  start-yarn.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">启动hdfs集群</span>) ---  start-all.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">关闭hdfs集群</span>) ---  stop-all.sh</span></span><br><span class="line"><span class="function"># <span class="title">namenode</span></span></span><br><span class="line"><span class="function">(<span class="params">启动namenode节点</span>) ---  hadoop-daemon.sh start <span class="title">namenode</span></span></span><br><span class="line"><span class="function">(<span class="params">关闭namenode节点</span>) ---  hadoop-daemon.sh stop namenode</span></span><br><span class="line"><span class="function">&lt;&#x27;查看NameNode的状态&#x27;&gt; ---$ hdfs haadmin -getServiceState nn1---&gt;   active</span></span><br><span class="line"><span class="function">&lt;&#x27;查看NameNode的状态&#x27;&gt; ---$ hdfs haadmin -getServiceState nn2---&gt;   standby</span></span><br><span class="line"><span class="function">&lt;&#x27;查看NameNode的状态&#x27;&gt; ---$ hdfs haadmin -getServiceState nn3---&gt;   standby</span></span><br><span class="line"><span class="function"># <span class="title">historyserver</span></span></span><br><span class="line"><span class="function">(<span class="params">启动任务历史服务器</span>) ---  mr-jobhistory-daemon.sh start historyserver</span></span><br><span class="line"><span class="function"># <span class="title">ResourceManager</span></span></span><br><span class="line"><span class="function">(<span class="params">启动ResourceManager节点</span>) --- yarn-daemon.sh start resourcemanager</span></span><br><span class="line"><span class="function">&lt;&#x27;查看ResourceManager的状态&#x27;&gt; ---$ yarn rmadmin -getServiceState rm1---&gt;   standby</span></span><br><span class="line"><span class="function">&lt;&#x27;查看ResourceManager的状态&#x27;&gt; ---$ yarn rmadmin -getServiceState rm2---&gt;   <span class="title">active</span></span></span><br><span class="line"><span class="function">(<span class="params">查看节点</span>) ---  jps</span></span><br></pre></td></tr></table></figure><h2 id="3-启动hive"><a href="#3-启动hive" class="headerlink" title="3. 启动hive"></a>3. 启动hive</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(格式化hive) ---  schematool -dbType mysql -initSchema</span><br><span class="line">(格式化hive) ---  schematool -initSchema -<span class="function">dbType <span class="title">derby</span></span></span><br><span class="line"><span class="function">(<span class="params">启动hive</span>) ---  <span class="title">hive</span></span></span><br><span class="line"><span class="function">(<span class="params">启动metastore</span>) ---  hive --service <span class="title">metastore</span></span></span><br><span class="line"><span class="function">(<span class="params">启动hiveserver2</span>) ---  hive  --service hiveserver2 </span></span><br></pre></td></tr></table></figure><h2 id="4-启动HBase"><a href="#4-启动HBase" class="headerlink" title="4. 启动HBase"></a>4. 启动HBase</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(启动HBase) ---  start-hbase.sh</span><br><span class="line">(关闭HBase) ---  stop-hbase.sh</span><br></pre></td></tr></table></figure><h2 id="5-启动Kylin"><a href="#5-启动Kylin" class="headerlink" title="5. 启动Kylin"></a>5. 启动Kylin</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(启动Kylin) ---  kylin.sh start</span><br><span class="line">(关闭Kylin) ---  kylin.sh stop</span><br></pre></td></tr></table></figure><h2 id="6-Sqoop命令"><a href="#6-Sqoop命令" class="headerlink" title="6. Sqoop命令"></a>6. Sqoop命令</h2><h4 id="6-1-1-查看所有命令"><a href="#6-1-1-查看所有命令" class="headerlink" title="6.1.1 查看所有命令"></a>6.1.1 查看所有命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">help</span></span><br></pre></td></tr></table></figure><h4 id="6-1-2-查看某条命令的具体使用方法"><a href="#6-1-2-查看某条命令的具体使用方法" class="headerlink" title="6.1.2 查看某条命令的具体使用方法"></a>6.1.2 查看某条命令的具体使用方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqoop <span class="built_in">help</span> 命令名</span><br><span class="line"><span class="comment">#例如sqoop help import</span></span><br></pre></td></tr></table></figure><h3 id="2-Sqoop-与-MySQL"><a href="#2-Sqoop-与-MySQL" class="headerlink" title="2. Sqoop 与 MySQL"></a>2. Sqoop 与 MySQL</h3><h4 id="6-2-1-查询MySQL所有数据库"><a href="#6-2-1-查询MySQL所有数据库" class="headerlink" title="6.2.1 查询MySQL所有数据库"></a>6.2.1 查询MySQL所有数据库</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-databases --connect jdbc:mysql://192.168.33.147:3306 --username root --password 123456</span><br></pre></td></tr></table></figure><h4 id="6-2-2-查询指定数据库种所有数据表"><a href="#6-2-2-查询指定数据库种所有数据表" class="headerlink" title="6.2.2 查询指定数据库种所有数据表"></a>6.2.2 查询指定数据库种所有数据表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-tables --connect jdbc:mysql://192.168.33.147:3306/familyaccount --username root --password 123456</span><br></pre></td></tr></table></figure><h3 id="3-Sqoop-与-HDFS"><a href="#3-Sqoop-与-HDFS" class="headerlink" title="3. Sqoop 与 HDFS"></a>3. Sqoop 与 HDFS</h3><h4 id="6-3-1-MySQL数据导入到HDFS"><a href="#6-3-1-MySQL数据导入到HDFS" class="headerlink" title="6.3.1 MySQL数据导入到HDFS"></a>6.3.1 MySQL数据导入到HDFS</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword \</span><br><span class="line">--delete-target-dir \</span><br><span class="line">--target-dir /sqoop \</span><br><span class="line">--fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">-m 3</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--table help_keyword \    # 待导入的表</span></span><br><span class="line"><span class="string">--delete-target-dir \    # 目标目录存在则先删除</span></span><br><span class="line"><span class="string">--target-dir /sqoop \    # 导入的目标目录</span></span><br><span class="line"><span class="string">--fields-terminated-by &#x27;</span>\t<span class="string">&#x27; \    # 指定导出数据的分隔符</span></span><br><span class="line"><span class="string">-m 3    # 指定并行执行的 map tasks 数量  </span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="6-3-2-导入验证"><a href="#6-3-2-导入验证" class="headerlink" title="6.3.2 导入验证"></a>6.3.2 导入验证</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看导入后的目录</span></span><br><span class="line">hdfs dfs -<span class="built_in">ls</span> -R /sqoop</span><br><span class="line"><span class="comment"># 查看导入内容</span></span><br><span class="line">hdfs dfs -<span class="built_in">cat</span> /sqoop/part-m-00000</span><br></pre></td></tr></table></figure><h4 id="6-3-3-增量导入"><a href="#6-3-3-增量导入" class="headerlink" title="6.3.3 增量导入"></a>6.3.3 增量导入</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">sqoop import \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword \</span><br><span class="line">--target-dir /sqoop  \</span><br><span class="line">--append \</span><br><span class="line">--incremental  append  \             </span><br><span class="line">--fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">--check-column  help_keyword_id \</span><br><span class="line">--last-value 463  \ </span><br><span class="line">-m 1</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--fields-terminated-by &#x27;</span>\t<span class="string">&#x27; \    # 指定导出数据的分隔符</span></span><br><span class="line"><span class="string">--check-column  help_keyword_id \    # 指明用于增量导入的参考列</span></span><br><span class="line"><span class="string">--last-value 463  \    # 指定参考列上次导入的最大值 </span></span><br><span class="line"><span class="string">-m 1</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="6-3-4-hdfs数据导出到MySQL"><a href="#6-3-4-hdfs数据导出到MySQL" class="headerlink" title="6.3.4 hdfs数据导出到MySQL"></a>6.3.4 hdfs数据导出到MySQL</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE help_keyword_from_hdfs LIKE help_keyword;</span><br><span class="line">sqoop <span class="built_in">export</span> \</span><br><span class="line">--connect jdbc:mysql://192.168.33.147:3306/mysql \</span><br><span class="line">--username root \</span><br><span class="line">--password 123456 \</span><br><span class="line">--table help_keyword_from_hdfs \</span><br><span class="line">--export-dir /sqoop/* \</span><br><span class="line">--input-fields-terminated-by <span class="string">&#x27;\t&#x27;</span> \</span><br><span class="line">-m 3</span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">--table help_keyword_from_hdfs \     # 导出数据存储在 MySQL 的 help_keyword_from_hdf 的表中</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="7-DataX命令"><a href="#7-DataX命令" class="headerlink" title="7.  DataX命令"></a>7.  DataX命令</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">----------------DataX----------------</span><br><span class="line">(运行自检脚本) --- bin/datax.py job/job.json</span><br><span class="line">(运行Job) --- /opt/datax/bin/datax.py 目录/文件.json</span><br><span class="line">(MySQL数据导入到HDFS官方json配置模板)</span><br><span class="line">python /opt/datax/bin/datax.py -r mysqlreader -<span class="function">w <span class="title">hdfswriter</span></span></span><br><span class="line"><span class="function">(<span class="params">HDFS数据导出到MySQL官方json配置模板</span>)</span></span><br><span class="line"><span class="function">python /opt/datax/bin/datax.py -r hdfsreader -w mysqlwriter</span></span><br><span class="line"><span class="function">----------------Maven----------------</span></span><br><span class="line"><span class="function">(<span class="params">打包jar到本地仓库</span>)</span></span><br><span class="line"><span class="function">mvn install:install-file -Dfile</span>=/opt/bin/mysql-connector-java<span class="number">-5.1</span><span class="number">.37</span>.jar  -DgroupId=cool.huser -DartifactId=mysql-connector -Dversion=<span class="number">5.1</span><span class="number">.37</span> -Dpackaging=jar</span><br><span class="line">(编译打包) --- <span class="function">mvn clean <span class="title">install</span></span></span><br><span class="line"><span class="function">(<span class="params">执行安装脚本</span>) --- ./install.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">启动datax-admin和datax-executor服务</span>) --- ./start-all.<span class="title">sh</span></span></span><br><span class="line"><span class="function">(<span class="params">WebUI查看</span>) --- tail -50f /opt/datax-web/modules/datax-admin/bin/console.<span class="keyword">out</span></span></span><br></pre></td></tr></table></figure><h2 id="8-Azkaban-solo-server命令"><a href="#8-Azkaban-solo-server命令" class="headerlink" title="8. Azkaban-solo-server命令"></a>8. Azkaban-solo-server命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">----------------<span class="title class_">Gradle</span>----------------</span><br><span class="line">(验证是否安装成功) --- [huser@master bin]$ ./gradle -v</span><br><span class="line">----------------<span class="title class_">Azkaban</span>----------------</span><br><span class="line">(执行编译) --- [huser@master azkaban]$ ./gradlew distTar</span><br><span class="line">(查看节点) --- jps</span><br><span class="line"># 注意：不能进入 bin 目录下执行，不然会抛出 <span class="title class_">Cannot</span> find <span class="string">&#x27;database.properties&#x27;</span> 异常</span><br><span class="line">(执行启动) --- [huser@master azkaban-solo-server]$ bin/start-solo.<span class="property">sh</span> </span><br></pre></td></tr></table></figure><h2 id="9-Azkaban-two-server命令"><a href="#9-Azkaban-two-server命令" class="headerlink" title="9. Azkaban-two-server命令"></a>9. Azkaban-two-server命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">----------------executor----------------</span><br><span class="line">(启动命令executor服务器) --- [huser@master bin]$ ./start-exec.<span class="property">sh</span></span><br><span class="line">(关闭命令executor服务器) --- [huser@master bin]$ ./shutdown-exec.<span class="property">sh</span></span><br><span class="line">(手动激活executor服务器) --- curl <span class="attr">http</span>:<span class="comment">//master:11241/executor?action=activate</span></span><br><span class="line">----------------web----------------</span><br><span class="line"># web服务器bin目录下执行启动命令</span><br><span class="line">(启动命令web服务器) --- [huser@master bin]$ ./start-web.<span class="property">sh</span></span><br><span class="line">(关闭命令web服务器) --- [huser@master bin]$ ./shutdown-web.<span class="property">sh</span></span><br></pre></td></tr></table></figure><h2 id="10-Flume命令"><a href="#10-Flume命令" class="headerlink" title="10. Flume命令"></a>10. Flume命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(验证是否安装成功) --- flume-ng version</span><br><span class="line">(启动命令<span class="title class_">Flume</span>) --- flume-ng agent -n a1 -c /opt/flume/conf/ -f conf/telnet-logger.<span class="property">properties</span> -<span class="title class_">Dflume</span>.<span class="property">root</span>.<span class="property">logger</span>=<span class="variable constant_">INFO</span>,<span class="variable language_">console</span></span><br></pre></td></tr></table></figure><h2 id="11-kafka命令"><a href="#11-kafka命令" class="headerlink" title="11. kafka命令"></a>11. kafka命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(启动kafka节点) ---  kafka-server-start.<span class="property">sh</span> /opt/kafka/config/server.<span class="property">properties</span></span><br><span class="line">(关闭kafka节点) ---  kafka-server-stop.<span class="property">sh</span> /opt/kafka/config/server.<span class="property">properties</span></span><br><span class="line">(创建测试主题) --- kafka-topics.<span class="property">sh</span> --create --topic kkjjssdd --bootstrap-server <span class="attr">master</span>:<span class="number">9092</span>,<span class="attr">slave1</span>:<span class="number">9092</span>,<span class="attr">slave2</span>:<span class="number">9092</span> --partitions <span class="number">2</span> --replication-factor <span class="number">1</span></span><br><span class="line">(查看创建列表) ---  kafka-topics.<span class="property">sh</span> --list --bootstrap-server <span class="attr">master</span>:<span class="number">9092</span>,<span class="attr">slave1</span>:<span class="number">9092</span>,<span class="attr">slave2</span>:<span class="number">9092</span></span><br></pre></td></tr></table></figure><h2 id="12-Spark命令"><a href="#12-Spark命令" class="headerlink" title="12. Spark命令"></a>12. Spark命令</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(启动spark集群) --- [huser@slave1 sbin]$ ./start-all.<span class="property">sh</span></span><br><span class="line">(关闭spark集群) ---  [huser@slave1 sbin]$ ./stop-all.<span class="property">sh</span></span><br><span class="line">(启动master节点) --- [huser@slave1 sbin]$ ./start-master.<span class="property">sh</span></span><br><span class="line">(关闭master节点) ---  [huser@slave1 sbin]$ ./stop-master.<span class="property">sh</span></span><br><span class="line">(启动任务历史服务器) --- [huser@slave1 sbin]$ ./start-history-server.<span class="property">sh</span></span><br><span class="line">(关闭任务历史服务器) ---  [huser@slave1 sbin]$ ./stop-history-server.<span class="property">sh</span></span><br><span class="line">(<span class="title class_">Web</span> <span class="variable constant_">UI</span>查看) --- cat /opt/spark/logs/spark-huser-org.<span class="property">apache</span>.<span class="property">spark</span>.<span class="property">deploy</span>.<span class="property">master</span>.<span class="property">Master</span>-<span class="number">1</span>-master.<span class="property">out</span> | grep <span class="title class_">MasterWebUI</span></span><br><span class="line">(计算 <span class="variable constant_">PI</span>) --- [huser@master spark]$ bin/spark-submit --master yarn --<span class="keyword">class</span> <span class="title class_">org</span>.<span class="property">apache</span>.<span class="property">spark</span>.<span class="property">examples</span>.<span class="property">SparkPi</span> /opt/spark/examples/jars/spark-examples_2<span class="number">.12</span>-<span class="number">3.1</span><span class="number">.3</span>.<span class="property">jar</span> <span class="number">1000</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据应用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 大数据应用 </tag>
            
            <tag> HADOOP集群搭建 </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>js教程</title>
      <link href="/posts/5023fd11.html"/>
      <url>/posts/5023fd11.html</url>
      
        <content type="html"><![CDATA[<p>复习：</p><p>splice() 方法用于添加或删除数组中的元素。</p><p><strong>注意：</strong>这种方法会改变原始数组。</p><ol><li><strong>删除数组：</strong></li></ol><p>splice(起始位置， 删除的个数)</p><p>比如：1</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">1</span>) <span class="comment">// 删除green元素</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr) <span class="comment">// [&#x27;red, &#x27;blue&#x27;]</span></span><br></pre></td></tr></table></figure><ol><li><strong>添加元素</strong></li></ol><p>splice(起始位置，删除个数，添加数组元素)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>]</span><br><span class="line"><span class="comment">//arr.splice(1, 0, &#x27;pink&#x27;) // 在索引号是1的位置添加 pink</span></span><br><span class="line"><span class="comment">//console.log(arr) // [&#x27;red&#x27;, &#x27;pink&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;]</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;pink&#x27;</span>, <span class="string">&#x27;hotpink&#x27;</span>) <span class="comment">// 在索引号是1的位置添加 pink  hotpink</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr) <span class="comment">// [&#x27;red&#x27;, &#x27;pink&#x27;, &#x27;hotpink&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;]</span></span><br></pre></td></tr></table></figure><h1 id="Web-APIs-第1天笔记"><a href="#Web-APIs-第1天笔记" class="headerlink" title="Web APIs - 第1天笔记"></a>Web APIs - 第1天笔记</h1><blockquote><p>了解 DOM 的结构并掌握其基本的操作，体验 DOM 的在开发中的作用</p></blockquote><ul><li>知道 ECMAScript 与 JavaScript 的关系</li><li>了解 DOM 的相关概念及DOM 的本质是一个对象</li><li>掌握查找节点的基本方法</li><li>掌握节点属性和文本的操作</li><li>能够使用间歇函数创建定时任务</li></ul><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote><p>知道 ECMAScript 与 JavaScript 的关系，Web APIs 是浏览器扩展的功能。</p></blockquote><p>严格意义上讲，我们在 JavaScript 阶段学习的知识绝大部分属于 ECMAScript 的知识体系，ECMAScript 简称 ES 它提供了一套语言标准规范，如变量、数据类型、表达式、语句、函数等语法规则都是由 ECMAScript 规定的。浏览器将 ECMAScript 大部分的规范加以实现，并且在此基础上又扩展一些实用的功能，这些被扩展出来的内容我们称为 Web APIs。</p><p><img src="./assets/guide.png" alt="guide"></p><p>ECMAScript 运行在浏览器中然后再结合 Web APIs 才是真正的 JavaScript，Web APIs 的核心是 DOM 和 BOM。</p><p>扩展阅读：ECMAScript 规范在不断的更新中，存在多个不同的版本，早期的版本号采用数字顺序编号如 ECMAScript3、ECMAScript5，后来由于更新速度较快便采用年份做为版本号，如 ECMAScript2017、ECMAScript2018 这种格式，ECMAScript6 是 2015 年发布的，常叫做 EMCAScript2015。</p><p>关于 JavaScript 历史的<a href="https://javascript.ruanyifeng.com/introduction/history.html">扩展阅读</a>。</p><blockquote><p>知道 DOM 相关的概念，建立对 DOM 的初步认识，学习 DOM 的基本操作，体会 DOM 的作用</p></blockquote><p>DOM（Document Object Model）是将整个 HTML 文档的每一个标签元素视为一个对象，这个对象下包含了许多的属性和方法，通过操作这些属性或者调用这些方法实现对 HTML 的动态更新，为实现网页特效以及用户交互提供技术支撑。</p><p>简言之 DOM 是用来动态修改 HTML 的，其目的是开发网页特效及用户交互。</p><p>观察一个小例子：</p><p><img src="assets/demo.gif" alt="demo"></p><p>上述的例子中当用户分分别点击【开始】或【结束】按钮后，通过右侧调试窗口可以观察到 html 标签的内容在不断的发生改变，这便是通过 DOM 实现的。</p><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="DOM-树"><a href="#DOM-树" class="headerlink" title="DOM 树"></a>DOM 树</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  文本</span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>链接名<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如下图所示，将 HTML 文档以树状结构直观的表现出来，我们称之为文档树或 DOM 树，<strong>文档树直观的体现了标签与标签之间的关系。</strong></p><p><img src="./assets/web-api.jpg" alt="dom"></p><h4 id="DOM-节点"><a href="#DOM-节点" class="headerlink" title="DOM 节点"></a>DOM 节点</h4><p>节点是文档树的组成部分，<strong>每一个节点都是一个 DOM 对象</strong>，主要分为元素节点、属性节点、文本节点等。</p><ol><li>【元素节点】其实就是 HTML 标签，如上图中 <code>head</code>、<code>div</code>、<code>body</code> 等都属于元素节点。</li><li>【属性节点】是指 HTML 标签中的属性，如上图中 <code>a</code> 标签的 <code>href</code> 属性、<code>div</code> 标签的 <code>class</code> 属性。</li><li>【文本节点】是指 HTML 标签的文字内容，如 <code>title</code> 标签中的文字。</li><li>【根节点】特指 <code>html</code> 标签。</li><li>其它…</li></ol><h4 id="document"><a href="#document" class="headerlink" title="document"></a>document</h4><p><code>document</code> 是 JavaScript 内置的专门用于 DOM 的对象，该对象包含了若干的属性和方法，<code>document</code> 是学习 DOM 的核心。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// document 是内置的对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// console.log(typeof document);</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 通过 document 获取根节点</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>); <span class="comment">// 对应 html 标签</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 2. 通过 document 节取 body 节点</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">body</span>); <span class="comment">// 对应 body 标签</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 3. 通过 document.write 方法向网页输出内容</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上述列举了 <code>document</code> 对象的部分属性和方法，我们先对 <code>document</code> 有一个整体的认识。</p><h2 id="获取DOM对象"><a href="#获取DOM对象" class="headerlink" title="获取DOM对象"></a>获取DOM对象</h2><ol><li>querySelector   满足条件的第一个元素</li><li>querySelectorAll  满足条件的元素集合 返回伪数组</li><li>了解其他方式<ol><li>getElementById</li><li>getElementsByTagName</li></ol></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>DOM - 查找节点<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>查找元素类型节点<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>从整个 DOM 树中查找 DOM 节点是学习 DOM 的第一个步骤。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p&#x27;</span>)  <span class="comment">// 获取第一个p元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> lis = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;li&#x27;</span>)  <span class="comment">// 获取第一个p元素</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>总结：</p><ul><li>document.getElementById 专门获取元素类型节点，根据标签的 <code>id</code>  属性查找</li><li>任意 DOM 对象都包含 nodeType 属性，用来检检测节点类型</li></ul><h2 id="操作元素内容"><a href="#操作元素内容" class="headerlink" title="操作元素内容"></a>操作元素内容</h2><p>通过修改 DOM 的文本内容，动态改变网页的内容。</p><ol><li><code>innerText</code> 将文本内容添加/更新到任意标签位置，<strong>文本中包含的标签不会被解析。</strong></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// innerText 将文本内容添加/更新到任意标签位置</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> intro = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// intro.innerText = &#x27;嗨~ 我叫李雷！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// intro.innerText = &#x27;&lt;h4&gt;嗨~ 我叫李雷！&lt;/h4&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li><code>innerHTML</code> 将文本内容添加/更新到任意标签位置，<strong>文本中包含的标签会被解析。</strong></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// innerHTML 将文本内容添加/更新到任意标签位置</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> intro = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  intro.<span class="property">innerHTML</span> = <span class="string">&#x27;嗨~ 我叫韩梅梅！&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  intro.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;h4&gt;嗨~ 我叫韩梅梅！&lt;/h4&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>总结：如果文本内容中包含 <code>html</code> 标签时推荐使用 <code>innerHTML</code>，否则建议使用 <code>innerText</code> 属性。</p><h2 id="操作元素属性"><a href="#操作元素属性" class="headerlink" title="操作元素属性"></a>操作元素属性</h2><p>有3种方式可以实现对属性的修改：</p><h4 id="常用属性修改"><a href="#常用属性修改" class="headerlink" title="常用属性修改"></a>常用属性修改</h4><ol><li>直接能过属性名修改，最简洁的语法</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 获取 img 对应的 DOM 元素</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> pic = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.pic&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 2. 修改属性</span></span></span><br><span class="line"><span class="language-javascript">  pic.<span class="property">src</span> = <span class="string">&#x27;./images/lion.webp&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  pic.<span class="property">width</span> = <span class="number">400</span>;</span></span><br><span class="line"><span class="language-javascript">  pic.<span class="property">alt</span> = <span class="string">&#x27;图片不见了...&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="控制样式属性"><a href="#控制样式属性" class="headerlink" title="控制样式属性"></a>控制样式属性</h4><ol><li>应用【修改样式】，通过修改行内样式 <code>style</code> 属性，实现对样式的动态修改。</li></ol><p>通过元素节点获得的 <code>style</code> 属性本身的数据类型也是对象，如 <code>box.style.color</code>、<code>box.style.width</code> 分别用来获取元素节点 CSS 样式的 <code>color</code> 和 <code>width</code> 的值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习 - 修改样式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>随便一些文本内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">width</span> = <span class="string">&#x27;300px&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// css 属性的 - 连接符与 JavaScript 的 减运算符</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 冲突，所以要改成驼峰法</span></span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;pink&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>任何标签都有 <code>style</code> 属性，通过 <code>style</code> 属性可以动态更改网页标签的样式，如要遇到 <code>css</code> 属性中包含字符 <code>-</code> 时，要将 <code>-</code> 去掉并将其后面的字母改成大写，如 <code>background-color</code> 要写成 <code>box.style.backgroundColor</code></p><ol><li>操作类名(className) 操作CSS</li></ol><p>如果修改的样式比较多，直接通过style属性修改比较繁琐，我们可以通过借助于css类名的形式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>练习 - 修改样式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.pink</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: pink;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: hotpink;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>随便一些文本内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取 DOM 节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.intro&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    box.<span class="property">className</span> = <span class="string">&#x27;pink&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>1.由于class是关键字, 所以使用className去代替</p><p>2.className是使用新值换旧值, 如果需要添加一个类,需要保留之前的类名</p></blockquote><ol><li>通过 classList 操作类控制CSS</li></ol><p>为了解决className 容易覆盖以前的类名，我们可以通过classList方式追加和删除类名</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: hotpink;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-left</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;one&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1.获取元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// let box = document.querySelector(&#x27;css选择器&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// add是个方法 添加  追加</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// box.classList.add(&#x27;active&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// remove() 移除 类</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// box.classList.remove(&#x27;one&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 切换类</span></span></span><br><span class="line"><span class="language-javascript">        box.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;one&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="操作表单元素属性"><a href="#操作表单元素属性" class="headerlink" title="操作表单元素属性"></a>操作表单元素属性</h4><p>表单很多情况，也需要修改属性，比如点击眼睛，可以看到密码，本质是把表单类型转换为文本框</p><p>正常的有属性有取值的跟其他的标签属性没有任何区别</p><p>获取:DOM对象.属性名</p><p>设置:DOM对象.属性名= 新值</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;请输入&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">disabled</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;agree&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1. 获取元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. 取值或者设置值  得到input里面的值可以用 value</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// console.log(input.value)</span></span></span><br><span class="line"><span class="language-javascript">        input.<span class="property">value</span> = <span class="string">&#x27;小米手机&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        input.<span class="property">type</span> = <span class="string">&#x27;password&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. 启用按钮</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// disabled 不可用   =  false  这样可以让按钮启用</span></span></span><br><span class="line"><span class="language-javascript">        btn.<span class="property">disabled</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3. 勾选复选框</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> checkbox = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.agree&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        checkbox.<span class="property">checked</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="自定义属性"><a href="#自定义属性" class="headerlink" title="自定义属性"></a>自定义属性</h4><p>标准属性: 标签天生自带的属性 比如class id title等, 可以直接使用点语法操作比如： disabled、checked、selected</p><p>自定义属性：</p><p>在html5中推出来了专门的data-自定义属性  </p><p>在标签上一律以data-开头</p><p>在DOM对象上一律以dataset对象方式获取</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span>&gt;</span> 自定义属性 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1. 获取元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 2. 获取自定义属性值</span></span></span><br><span class="line"><span class="language-javascript">         <span class="variable language_">console</span>.<span class="title function_">log</span>(div.<span class="property">dataset</span>.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">      </span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="间歇函数"><a href="#间歇函数" class="headerlink" title="间歇函数"></a>间歇函数</h2><blockquote><p>知道间歇函数的作用，利用间歇函数创建定时任务。</p></blockquote><p><code>setInterval</code> 是 JavaScript 中内置的函数，它的作用是间隔固定的时间自动重复执行另一个函数，也叫定时器函数。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 1. 定义一个普通函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">repeat</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不知疲倦的执行下去....&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 2. 使用 setInterval 调用 repeat 函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 间隔 1000 毫秒，重复调用 repeat</span></span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setInterval</span>(repeat, <span class="number">1000</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="今日单词"><a href="#今日单词" class="headerlink" title="今日单词"></a>今日单词</h2><div class="table-container"><table><thead><tr><th>单词</th><th>说明</th><th>解释</th></tr></thead><tbody><tr><td>setInterval</td><td>定时器</td><td>setInterval(repeat, 1000)</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Photoshop</title>
      <link href="/posts/ec54ee2f.html"/>
      <url>/posts/ec54ee2f.html</url>
      
        <content type="html"><![CDATA[<p>前置准备：<br><a href="https://www.yuque.com/yuqueyonghub89qji/ctd2b5/int42sxavx9n5bmu?view=doc_embed">Photoshop安装教程</a><br><a href="https://www.yuque.com/yuqueyonghub89qji/ctd2b5/soygm9tgu96z7qp0?view=doc_embed">基础篇</a></p><p>参考视频：<br><a href="https://player.bilibili.com/player.html?bvid=BV1YW411e7n5&amp;p=41&amp;page=41&amp;autoplay=0">点击查看【bilibili】</a></p><p>素材：<br><img src="https://cdn.nlark.com/yuque/0/2023/jpeg/33576317/1678793990491-1fd0285b-0e48-4d67-8e1d-9253f3a8e6a1.jpeg#averageHue=%23f5f5f5&amp;clientId=u5ec6d62c-f69a-4&amp;from=drop&amp;id=u565e3c34&amp;originHeight=523&amp;originWidth=1024&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=118800&amp;status=done&amp;style=none&amp;taskId=u45d9f87e-b893-4f4c-9c7d-a3d353ddc1a&amp;title=" alt="B005.jpg"></p><p>第一步：用钢笔工具抠图</p><ol><li>用<code>钢笔工具（P）</code>，把需要的部分选出一个区域，再点击<code>蒙版</code></li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678796532252-75e7e079-2b00-42cb-8174-8bf66b307680.png#averageHue=%23d9d9d9&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u7c071555&amp;originHeight=800&amp;originWidth=1448&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=347122&amp;status=done&amp;style=none&amp;taskId=u11cd86d3-68d0-4479-b35d-67475c61f9b&amp;title=" alt="1.png"><br>第二步：在蒙版内抠图</p><ol><li>用<code>钢笔工具（P）</code>，把需要的部分选出一个区域</li><li>设置<code>排除重叠形状</code></li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678797845859-fbe25c7e-1820-4ca4-b460-c14ccaff95f3.png#averageHue=%23868584&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u6bb86614&amp;originHeight=189&amp;originWidth=254&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=8625&amp;status=done&amp;style=none&amp;taskId=uc72bb46e-8e27-42a3-bfde-658bf44b215&amp;title=" alt="1.png"><br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678797478623-f4c55f6a-fa35-4eda-bd19-4cb5007c1897.png#averageHue=%23dadada&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u56ab52e6&amp;originHeight=596&amp;originWidth=1319&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=264106&amp;status=done&amp;style=none&amp;taskId=u96d095f3-7e2e-42c0-8b21-c5e3e3a822c&amp;title=" alt="1.png"><br>第三步：创建新的背景</p><ol><li>添加图层后，填充前景色，并选择颜色，按<code>Alt+delete</code>填充颜色</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678797943775-c226815f-9a31-457f-bb8c-9f84fa8e5607.png#averageHue=%23565656&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=u0ee0aaac&amp;originHeight=575&amp;originWidth=255&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=19709&amp;status=done&amp;style=none&amp;taskId=u156c80f9-21da-4cbb-89e9-e0826b54b8b&amp;title=" alt="1.png"><br>第四步：用钢笔工具对局部地方进行竞精细的抠图</p><ol><li>注意：抠图的过程，点击<code>蒙版</code>在进行<code>钢笔工具</code>描边，描完点击<code>回车</code></li><li>如果抠图不满意，则用<code>选择工具（A）</code>对线条进行修改</li></ol><p><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678798452992-a4311dab-0184-4bf5-bafc-ab682bcbd4fa.png#averageHue=%23777574&amp;clientId=u5ec6d62c-f69a-4&amp;from=ui&amp;id=uf7ba6eb6&amp;originHeight=534&amp;originWidth=1041&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=235668&amp;status=done&amp;style=none&amp;taskId=uf8d08489-5bf3-4a67-9bdf-ff3edd82586&amp;title=" alt="1.png"><br>最终效果：<br><img src="https://cdn.nlark.com/yuque/0/2023/png/33576317/1678798684612-9d557d97-cf23-4b38-8ddb-6139c5c7575d.png#averageHue=%2308c615&amp;clientId=u5ec6d62c-f69a-4&amp;from=drop&amp;id=ue29268ca&amp;originHeight=523&amp;originWidth=1024&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=184570&amp;status=done&amp;style=none&amp;taskId=u5f42e432-3518-402e-8556-72b41355f30&amp;title=" alt="B005.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>6</title>
      <link href="/posts/1db87a14.html"/>
      <url>/posts/1db87a14.html</url>
      
        <content type="html"><![CDATA[<h1 id="夏至"><a href="#夏至" class="headerlink" title="夏至"></a>夏至</h1><blockquote><p>一生的时间很短<br>短到不过是两颗心之间的距离<br>一生的时间也很长<br>不如我们试着走走看</p></blockquote><div class="tip "><p>6</p></div>]]></content>
      
      
      
        <tags>
            
            <tag> 6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/4a17b156.html"/>
      <url>/posts/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title></title>
      <link href="/manifest.json"/>
      <url>/manifest.json</url>
      
        <content type="html"><![CDATA[{"name":"知安`Blog","short_name":"知安","theme_color":"#3b70fc","background_color":"#3b70fc","display":"standalone","scope":"/","start_url":"/","icons":[{"src":"/img/siteicon/16.png","sizes":"16x16","type":"image/png"},{"src":"/img/siteicon/32.png","sizes":"32x32","type":"image/png"},{"src":"/img/siteicon/48.png","sizes":"48x48","type":"image/png"},{"src":"/img/siteicon/64.png","sizes":"64x64","type":"image/png"},{"src":"/img/siteicon/128.png","sizes":"128x128","type":"image/png"},{"src":"/img/siteicon/144.png","sizes":"144x144","type":"image/png"},{"src":"/img/siteicon/512.png","sizes":"512x512","type":"image/png"}],"splash_pages":null}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>便携小空调 - 为你的夏日带去清凉!</title>
      <link href="/air-conditioner/index.html"/>
      <url>/air-conditioner/index.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>终于为博客安装上了便携小空调</p></blockquote><style>.copyright-box a {  border-bottom: none !important;  padding: 0 !important;}</style><p><div id="air-conditioner-vue"></div></p><script defer data-pjax src='https://npm.elemecdn.com/anzhiyu-air-conditioner@1.0.1/index.3f125bc6.js'></script>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/custom.css"/>
      <url>/css/custom.css</url>
      
        <content type="html"><![CDATA[#page:has(#anMusic-page) {    border: 0;    box-shadow: none !important;    padding: 0 !important;    background: transparent !important;  }  #an_music_bg {    display: none;    filter: blur(63px);    opacity: 0.6;    position: fixed;    z-index: -999;    background-attachment: local;    background-position: center center;    background-size: cover;    background-repeat: no-repeat;    width: 200%;    height: 200%;    top: -50%;    left: -50%;    transform: rotate(0deg);  }  body:has(#anMusic-page) #an_music_bg {    display: block;  }    body:has(#anMusic-page) {    background: rgb(13, 13, 13);  }    #anMusic-page meting-js .aplayer {    display: flex;    flex-direction: row-reverse;    background: rgba(0, 0, 0, 0);    border: none;    box-shadow: none;  }    body:has(#anMusic-page) #web_bg {    display: none;  }  body:has(#anMusic-page) #footer,  body:has(#anMusic-page) #nav-music {    display: none;  }    #anMusic-page .aplayer-body {    width: 40%;    height: 75vh;  }    #anMusic-page ol > li:hover {    background: #ffffff33;    border-radius: 6px;  }  #anMusic-page .aplayer-pic {    float: none;    width: 180px;    height: 180px;    border-radius: 12px;    margin: auto;    left: 0;    right: 0;  }    #anMusic-page .aplayer-info {    margin: 0 20px 0 20px;    border-bottom: none;  }    #anMusic-page .aplayer-info .aplayer-music {    text-align: center;    height: auto;    margin: 15px;  }    #anMusic-page .aplayer-info .aplayer-music .aplayer-author,  #anMusic-page .aplayer-info .aplayer-music .aplayer-title {    font-size: 2rem;    font-weight: 700;    color: #fff;  }    #anMusic-page .aplayer-info .aplayer-lrc {    height: 800%;    margin-top: 80px;    mask-image: linear-gradient(to bottom, #000, #000, #000, #000, #000, #000, #000, #000, #000, #000, #0000, #0000);  }  #anMusic-page .aplayer-info .aplayer-lrc p {    font-size: 14px;    color: #fff;  }  #anMusic-page .aplayer .aplayer-lrc:after,  #anMusic-page .aplayer .aplayer-lrc:before {    display: none;  }    /* 控制器 */  #anMusic-page .aplayer-info .aplayer-controller {    position: fixed;    max-width: 1500px;    margin: auto;    left: 0;    right: 0;    bottom: 50px;  }  #anMusic-page .aplayer-info .aplayer-controller .aplayer-bar-wrap {    margin: 0 160px 0 150px;  }  #anMusic-page .aplayer-info .aplayer-controller .aplayer-played {    background: var(--anzhiyu-white) !important;  }  #anMusic-page .aplayer-info .aplayer-controller .aplayer-thumb {    -webkit-transform: none;    transform: none;    background: #fff !important;  }  #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-back,  #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-forward,  #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-play {    display: inline;    position: fixed;  }  #anMusic-page .aplayer-info .aplayer-time {    position: absolute;    width: 100%;    bottom: 21px;    height: 0;    display: flex;    justify-content: flex-end;  }  #anMusic-page .aplayer-info .aplayer-time .aplayer-time-inner {    margin-right: 18px;    margin-top: -8px;  }  #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-back {    position: absolute;    left: 0;  }  #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-play {    position: absolute;    left: 40px;  }  #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-forward {    position: absolute;    left: 80px;  }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon {    width: 2rem;    height: 2rem;    margin-left: 15px;  }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-menu {    display: none;  }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon path {    fill: var(--anzhiyu-white);    opacity: 0.8;  }    #anMusic-page .aplayer-list {    width: 60%;    max-height: none !important;    height: 100%;  }  #anMusic-page ol {    max-height: 75vh !important;    padding-right: 25px;  }  #anMusic-page ol > li {    border-top: 1px solid transparent;    font-size: 14px;  }  #anMusic-page ol > li.aplayer-list-light {    background: rgb(255 255 255 / 20%);    border-radius: 6px;  }    #anMusic-page ol > li span {    color: var(--anzhiyu-white);  }    #anMusic-page ol > li.aplayer-list-light .aplayer-list-cur {    display: none;  }  #anMusic-page ol > li span.aplayer-list-author {    opacity: 0.6;  }  #anMusic-page #anMusicSwitching .anzhiyufont{    font-size: 21px;  }  #anMusic-page #anMusicSwitching .p1 {      animation: warn 2s cubic-bezier(0, 0, 0.28, 1.44) infinite;  }  #anMusic-page #anMusicSwitching .p2 {      animation: warn2 2s ease-out infinite  }  @keyframes warn {      0% {          transform: scale(1.2);          opacity: 0      }      25% {          transform: scale(1.4);          opacity: .1      }      50% {          transform: scale(1.6);          opacity: .3      }      75% {          transform: scale(1.8);          opacity: .5      }      100% {          transform: scale(2);          opacity: 0      }  }  @keyframes warn2 {      0% {          transform: scale(1.2);          opacity: 0      }      25% {          transform: scale(1.2);          opacity: .1      }      50% {          transform: scale(1.2);          opacity: .3      }      75% {          transform: scale(1.5);          opacity: .5      }      100% {          transform: scale(1.8);          opacity: 0      }  }  /* 导航栏 */  .page:has(#anMusic-page) #nav {    backdrop-filter: none !important;    background: 0 0 !important;    border-bottom: none !important;  }    .page:has(#anMusic-page) #page-header.not-top-img #nav a,  .page:has(#anMusic-page) #page-header #nav .back-home-button {    color: var(--anzhiyu-white);  }    body:has(#anMusic-page) .s-sticker div {    color: var(--anzhiyu-white) !important;  }    body:has(#anMusic-page) .aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-loop {    margin-right: 15px;  }    [data-theme="dark"] .page:has(#anMusic-page) #page-header:before {    background-color: transparent;  }    /* **** 移动端样式 ***** */  @media screen and (max-width: 768px) {    body:has(#anMusic-page) #rightside {      display: none;    }    body:has(#anMusic-page) #content-inner,    body:has(#anMusic-page) #page {      z-index: auto;    }    /* 歌曲列表 */    #anMusic-page .aplayer-list {      position: fixed;      z-index: 1002;      width: 100%;      bottom: -76%;      left: 0;      background: var(--sidebar-bg);      height: auto;      border-radius: 15px 15px 0px 0px;      padding: 15px 0px;    }    #anMusic-page .aplayer-list.aplayer-list-hide {      bottom: 0% !important;    }    #anMusic-page ol {      max-height: 60vh !important;      padding-right: 0px;    }    #anMusic-page ol > li {      display: flex;      margin: 0 10px;    }    #anMusic-page ol > li span {      color: var(--font-color);    }    #anMusic-page ol > li span.aplayer-list-title {      width: 30%;    }    #anMusic-page ol > li.aplayer-list-light {      background: #33a673;      padding: 5px 20px;      border-radius: 10px;    }    #anMusic-page ol > li.aplayer-list-light span {      color: #fff;    }    #anMusic-page ol > li span.aplayer-list-title {      max-width: 55%;      width: auto;      display: -webkit-box;      -webkit-line-clamp: 1;      overflow: hidden;      -webkit-box-orient: vertical;    }    #anMusic-page ol > li span.aplayer-list-author {      position: absolute;      right: 10px;      width: auto;      max-width: 35%;      display: -webkit-box;      -webkit-line-clamp: 1;      overflow: hidden;      -webkit-box-orient: vertical;    }    #anMusic-page ol > li.aplayer-list-light span.aplayer-list-author {      right: 15px;    }    /* 歌词信息 */    #anMusic-page .aplayer-body {      width: 100%;        position: fixed;      margin: auto;      left: 0;      right: 0;      top: 100px;    }    #anMusic-page .aplayer-info .aplayer-lrc {      margin-top: 40px;      height: auto;      max-height: 200%;      min-height: 100%;      mask-image: linear-gradient(to bottom, #000, #000, #000, #000, #0000, #0000);    }    #anMusic-page .aplayer-info .aplayer-lrc p.aplayer-lrc-current {      color: #33a673;    }    /* 控制按键和进度条 */    #anMusic-page .aplayer-info .aplayer-controller {      width: 100%;      bottom: 100px;    }    #anMusic-page .aplayer-info .aplayer-controller .aplayer-bar-wrap {      margin: 0 30px;    }    #anMusic-page .aplayer-info .aplayer-time {      bottom: -40px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-time-inner {      position: absolute;      width: 100%;      margin-right: 0;      margin-top: -33px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-time-inner .aplayer-dtime {      position: absolute;      right: 30px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-time-inner .aplayer-ptime {      position: absolute;      left: 35px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-back {      margin: auto;      right: 110px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-play {      margin: auto;      right: 0;      left: 0;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-forward {      margin: auto;      left: 110px;      right: 0;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-order {      position: absolute;      left: 22px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-loop {      position: absolute;      right: 25px;    }    #anMusic-page .aplayer-info .aplayer-time .aplayer-icon-menu {      display: inline;      position: absolute;      right: 25px;      top: -90px;    }    #anMusic-page .aplayer-volume-bar-wrap {      bottom: 0px;      right: 7px;    }    #anMusic-page .aplayer .aplayer-info .aplayer-controller .aplayer-volume-wrap {      left: -66px;    }  }/* 设置首页标签大小(位于文章标题的上方小标签) *//* 最新标签 */#recent-posts > .recent-post-item .recent-post-info .recent-post-info-top .newPost{  font-size: .8rem;  color: rgb(105 105 114 / 80%);}/* 未读标签 */#recent-posts > .recent-post-item .unvisited-post{  font-size: .8rem;  color: rgb(105 105 114 / 80%);}/* 自定义标签 */#recent-posts > .recent-post-item .recent-post-info .recent-post-info-top .article-categories-original{  font-size: .8rem;  color: rgb(105 105 114 / 80%);}/* 设置文章标题 */#recent-posts > .recent-post-item .recent-post-info .article-title{  line-height: 40px;  width: 102%;}/* 设置文章下方标签 */#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap{  bottom: 5px;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .post-meta-date{  margin-bottom: -25px;}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/title.js"/>
      <url>/js/title.js</url>
      
        <content type="html"><![CDATA[//动态标题var OriginTitile = document.title;var titleTime;document.addEventListener("visibilitychange", function () {  if (document.hidden) {    //离开当前页面时标签显示内容    document.title = "w(ﾟДﾟ)w 不要走！再看看嘛！";    clearTimeout(titleTime);  } else {    //返回当前页面时标签显示内容    document.title = "♪(^∇^*)欢迎肥来！" + OriginTitile;    //两秒后变回正常标题    titleTime = setTimeout(function () {      document.title = OriginTitile;    }, 2000);  }});]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>分类</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>bangumis</title>
      <link href="/bangumis/index.html"/>
      <url>/bangumis/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>link</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[<div class="flink"><div class="flink-name"><font color=#1f2d3d weight=bold>网站</></div> <div class="flink-list"><div class="anzhiyu-flink-list">            <div class="flink-list-item">              <a href="https://www.youtube.com/" title="Youtube" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="https://i.loli.net/2020/05/14/9ZkGg8v3azHJfM1.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Youtube" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">Youtube</div>                  <div class="flink-item-desc" title="视频网站">视频网站</div>                </div>              </a>            </div>            <div class="flink-list-item">              <a href="https://www.weibo.com/" title="Weibo" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="https://i.loli.net/2020/05/14/TLJBum386vcnI1P.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Weibo" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">Weibo</div>                  <div class="flink-item-desc" title="中国最大社交分享平台">中国最大社交分享平台</div>                </div>              </a>            </div>            <div class="flink-list-item">              <a href="https://twitter.com/" title="Twitter" class="cf-friends-link" target="_blank">                <div class="flink-item-icon">                  <img class="no-lightbox cf-friends-avatar" src="https://i.loli.net/2020/05/14/5VyHPQqR6LWF39a.png" onerror='this.onerror=null;this.src="/img/friend_404.gif"' alt="Twitter" />                </div>                <div class="flink-item-info">                  <div class="flink-item-name">Twitter</div>                  <div class="flink-item-desc" title="社交分享平台">社交分享平台</div>                </div>              </a>            </div></div></div></div><h2 id="我的友链"><a href="#我的友链" class="headerlink" title="我的友链"></a><font color=#1f2d3d weight=bold style='position: relative;margin: 20px 0 14px;'>我的友链</></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- name: 知安</span><br><span class="line">  link: https://xin0203xin0203.github.io/</span><br><span class="line">  avatar: https://vip.helloimg.com/images/2023/12/19/o7THQ5.jpg</span><br><span class="line">  descr: </span><br><span class="line">  siteshot: https://cdn.staticaly.com/gh/MengNianxiaoyao/blogimages@main/siteicon/lwtxiaoyao.top.png</span><br></pre></td></tr></table></figure>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>音乐馆</title>
      <link href="/music/index.html"/>
      <url>/music/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>标签</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/coin/coin.css"/>
      <url>/css/coin/coin.css</url>
      
        <content type="html"><![CDATA[.tip-button {    border: 0;    border-radius: 0.25rem;    cursor: pointer;    font-size: 20px;    font-weight: 600;    height: 2.6rem;    margin-bottom: -4rem;    outline: 0;    position: relative;    top: 0;    transform-origin: 0% 100%;    transition: transform 50ms ease-in-out;    width: auto;    -webkit-tap-highlight-color: transparent;  }  .tip-button:active {    transform: rotate(4deg);  }  .tip-button.clicked {    animation: 150ms ease-in-out 1 shake;    pointer-events: none;  }  .tip-button.clicked .tip-button__text {    opacity: 0;    transition: opacity 100ms linear 200ms;  }  .tip-button.clicked::before {    height: 0.5rem;    width: 60%;    background: $button-hover-color;  }  .tip-button.clicked .coin {    transition: margin-bottom 1s linear 200ms;    margin-bottom: 0;  }  .tip-button.shrink-landing::before {    transition: width 200ms ease-in;    width: 0;  }  .tip-button.coin-landed::after {    opacity: 1;    transform: scale(1);    transform-origin: 50% 100%;  }  .tip-button.coin-landed .coin-wrapper {    background: radial-gradient(circle at 35% 97%, rgba(3, 16, 50, 0.4) 0.04rem, transparent 0.04rem), radial-gradient(circle at 45% 92%, rgba(3, 16, 50, 0.4) 0.04rem, transparent 0.02rem), radial-gradient(circle at 55% 98%, rgba(3, 16, 50, 0.4) 0.04rem, transparent 0.04rem), radial-gradient(circle at 65% 96%, rgba(3, 16, 50, 0.4) 0.06rem, transparent 0.06rem);    background-position: center bottom;    background-size: 100%;    bottom: -1rem;    opacity: 0;    transform: scale(2) translateY(-10px);  }  .tip-button__text {    color: #fff;    margin-right: 1.8rem;    opacity: 1;    position: relative;    transition: opacity 100ms linear 500ms;    z-index: 3;    font-size: 18px;  }  .tip-button::before {    border-radius: 0.25rem;    bottom: 0;    content: '';    display: block;    height: 100%;    left: 50%;    position: absolute;    transform: translateX(-50%);    transition: height 250ms ease-in-out 400ms, width 250ms ease-in-out 300ms;    width: 100%;    z-index: 2;  }  .tip-button::after {    bottom: -1rem;    color: white;    content: 'ヾ(≧O≦)〃嗷~'; /*点击后显示的内容*/    height: 141%;    left: 0;    opacity: 0;    position: absolute;    pointer-events: none;    text-align: center;    transform: scale(0);    transform-origin: 50% 20%;    transition: transform 200ms cubic-bezier(0, 0, 0.35, 1.43);    width: 100%;    z-index: 1;  }    .coin-wrapper {    background: none;    bottom: 0;    height: 18rem;    left: 0;    opacity: 1;    overflow: hidden;    pointer-events: none;    position: absolute;    transform: none;    transform-origin: 50% 100%;    transition: opacity 200ms linear 100ms, transform 300ms ease-out;    width: 100%;  }    .coin {    --front-y-multiplier: 0;    --back-y-multiplier: 0;    --coin-y-multiplier: 0;    --coin-x-multiplier: 0;    --coin-scale-multiplier: 0;    --coin-rotation-multiplier: 0;    --shine-opacity-multiplier: 0.4;    --shine-bg-multiplier: 50%;    bottom: calc(var(--coin-y-multiplier) * 1rem - 3.5rem);    height: 3.5rem;    margin-bottom: 3.05rem;    position: absolute;    right: calc(var(--coin-x-multiplier) * 34% + 16%);    transform: translateX(50%) scale(calc(0.4 + var(--coin-scale-multiplier))) rotate(calc(var(--coin-rotation-multiplier) * -1deg));    transition: opacity 100ms linear 200ms;    width: 3.5rem;    z-index: 3;  }  .coin__front, .coin__middle, .coin__back, .coin::before, .coin__front::after, .coin__back::after {    border-radius: 50%;    box-sizing: border-box;    height: 100%;    left: 0;    position: absolute;    width: 100%;    z-index: 3;  }  .coin__front {    background: radial-gradient(circle at 50% 50%, transparent 50%, rgba(115, 124, 153, 0.4) 54%, #c2cadf 54%), linear-gradient(210deg, #8590b3 32%, transparent 32%), linear-gradient(150deg, #8590b3 32%, transparent 32%), linear-gradient(to right, #8590b3 22%, transparent 22%, transparent 78%, #8590b3 78%), linear-gradient(to bottom, #fcfaf9 44%, transparent 44%, transparent 65%, #fcfaf9 65%, #fcfaf9 71%, #8590b3 71%), linear-gradient(to right, transparent 28%, #fcfaf9 28%, #fcfaf9 34%, #8590b3 34%, #8590b3 40%, #fcfaf9 40%, #fcfaf9 47%, #8590b3 47%, #8590b3 53%, #fcfaf9 53%, #fcfaf9 60%, #8590b3 60%, #8590b3 66%, #fcfaf9 66%, #fcfaf9 72%, transparent 72%);    background-color: #8590b3;    background-size: 100% 100%;    transform: translateY(calc(var(--front-y-multiplier) * 0.3181818182rem / 2)) scaleY(var(--front-scale-multiplier));  }  .coin__front::after {    background: rgba(0, 0, 0, 0.2);    content: '';    opacity: var(--front-y-multiplier);  }  .coin__middle {    background: #737c99;    transform: translateY(calc(var(--middle-y-multiplier) * 0.3181818182rem / 2)) scaleY(var(--middle-scale-multiplier));  }  .coin__back {    background: radial-gradient(circle at 50% 50%, transparent 50%, rgba(115, 124, 153, 0.4) 54%, #c2cadf 54%), radial-gradient(circle at 50% 40%, #fcfaf9 23%, transparent 23%), radial-gradient(circle at 50% 100%, #fcfaf9 35%, transparent 35%);    background-color: #8590b3;    background-size: 100% 100%;    transform: translateY(calc(var(--back-y-multiplier) * 0.3181818182rem / 2)) scaleY(var(--back-scale-multiplier));  }  .coin__back::after {    background: rgba(0, 0, 0, 0.2);    content: '';    opacity: var(--back-y-multiplier);  }  .coin::before {    background: radial-gradient(circle at 25% 65%, transparent 50%, rgba(255, 255, 255, 0.9) 90%), linear-gradient(55deg, transparent calc(var(--shine-bg-multiplier) + 0%), #e9f4ff calc(var(--shine-bg-multiplier) + 0%), transparent calc(var(--shine-bg-multiplier) + 50%));    content: '';    opacity: var(--shine-opacity-multiplier);    transform: translateY(calc(var(--middle-y-multiplier) * 0.3181818182rem / -2)) scaleY(var(--middle-scale-multiplier)) rotate(calc(var(--coin-rotation-multiplier) * 1deg));    z-index: 10;  }  .coin::after {    background: #737c99;    content: '';    height: 0.3181818182rem;    left: 0;    position: absolute;    top: 50%;    transform: translateY(-50%);    width: 100%;    z-index: 2;  }    @keyframes shake {    0% {      transform: rotate(4deg);    }    66% {      transform: rotate(-4deg);    }    100% {      transform: rotate();    }  }]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/local_search/local-search.js"/>
      <url>/js/local_search/local-search.js</url>
      
        <content type="html"><![CDATA["use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return i};var i={},t=Object.prototype,s=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},n=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",o=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function c(t,e,r,n){var o,a,i,c,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),n=new b(n||[]);return e._invoke=(o=t,a=r,i=n,c="suspendedStart",function(t,e){if("executing"===c)throw new Error("Generator is already running");if("completed"===c){if("throw"===t)throw e;return x()}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var n=e.iterator[r.method];if(void 0===n){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return l;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}n=u(n,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,l;n=n.arg;return n?n.done?(r[e.resultName]=n.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,l):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,l)}(r,i);if(r){if(r===l)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===c)throw c="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);c="executing";r=u(o,a,i);if("normal"===r.type){if(c=i.done?"completed":"suspendedYield",r.arg===l)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(c="completed",i.method="throw",i.arg=r.arg)}}),e}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=c;var l={};function h(){}function f(){}function d(){}var e={},y=(a(e,n,function(){return this}),Object.getPrototypeOf),y=y&&y(y(L([]))),p=(y&&y!==t&&s.call(y,n)&&(e=y),d.prototype=h.prototype=Object.create(e));function m(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function v(i,c){var e;this._invoke=function(r,n){function t(){return new c(function(t,e){!function e(t,r,n,o){var a,t=u(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==_typeof(r)&&s.call(r,"__await")?c.resolve(r.__await).then(function(t){e("next",t,n,o)},function(t){e("throw",t,n,o)}):c.resolve(r).then(function(t){a.value=t,n(a)},function(t){return e("throw",t,n,o)});o(t.arg)}(r,n,t,e)})}return e=e?e.then(t,t):t()}}function g(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(g,this),this.reset(!0)}function L(e){if(e){var r,t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(s.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:x}}function x(){return{value:void 0,done:!0}}return a(p,"constructor",f.prototype=d),a(d,"constructor",f),f.displayName=a(d,o,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t},i.awrap=function(t){return{__await:t}},m(v.prototype),a(v.prototype,r,function(){return this}),i.AsyncIterator=v,i.async=function(t,e,r,n,o){void 0===o&&(o=Promise);var a=new v(c(t,e,r,n),o);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},m(p),a(p,o,"Generator"),a(p,n,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),i.keys=function(r){var t,n=[];for(t in r)n.push(t);return n.reverse(),function t(){for(;n.length;){var e=n.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=L,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function t(t,e){return a.type="throw",a.arg=r,n.next=t,e&&(n.method="next",n.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],a=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var i=s.call(o,"catchLoc"),c=s.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,n,o=this.tryEntries[e];if(o.tryLoc===t)return"throw"===(r=o.completion).type&&(n=r.arg,w(o)),n}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:L(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},i}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){var r;if(t)return"string"==typeof t?_arrayLikeToArray(t,e):"Map"===(r="Object"===(r=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function asyncGeneratorStep(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _asyncToGenerator(c){return function(){var t=this,i=arguments;return new Promise(function(e,r){var n=c.apply(t,i);function o(t){asyncGeneratorStep(n,e,r,o,a,"next",t)}function a(t){asyncGeneratorStep(n,e,r,o,a,"throw",t)}o(void 0)})}}window.addEventListener("load",function(){function t(){var t=document.body.style;t.width="100%",t.overflow="hidden",btf.animateIn(n,"to_show 0.5s"),btf.animateIn(document.querySelector("#local-search .search-dialog"),"titleScale 0.5s"),setTimeout(function(){document.querySelector("#local-search-input input").focus()},100),r||(c(),r=!0),document.addEventListener("keydown",function t(e){"Escape"===e.code&&(a(),document.removeEventListener("keydown",t))})}function e(){document.querySelector("#search-button > .search").addEventListener("click",t),document.querySelector("#menu-search").addEventListener("click",t)}var r=!1,o=[],n=document.getElementById("search-mask"),a=function(){var t=document.body.style;t.width="",t.overflow="",btf.animateOut(document.querySelector("#local-search .search-dialog"),"search_close .5s"),btf.animateOut(n,"to_hide 0.5s")},i=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var r,n,o,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,fetch(e);case 3:if(n=t.sent,/\.json$/.test(e))return t.next=7,n.json();t.next=10;break;case 7:r=t.sent,t.next=20;break;case 10:return t.next=12,n.text();case 12:return o=t.sent,t.next=15,(new window.DOMParser).parseFromString(o,"text/xml");case 15:return o=t.sent,t.next=18,o;case 18:a=t.sent,r=_toConsumableArray(a.querySelectorAll("entry")).map(function(t){var r=[],e=(t.querySelector("tags")&&t.querySelector("tags").getElementsByTagName("tag")&&Array.prototype.forEach.call(t.querySelector("tags").getElementsByTagName("tag"),function(t,e){r.push(t.textContent)}),t.querySelector("content")&&t.querySelector("content").textContent),n=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,o=e.match(/<img.*?(?:>|\/>)/gi),a=[];if(o)for(var i=0;i<o.length;i++){var c=o[i].match(n);c[1].indexOf("http")||a.push(c[1])}return{title:t.querySelector("title").textContent,content:e,url:t.querySelector("url").textContent,tags:r,oneImage:a&&a[0]}});case 20:return n.ok&&((a=document.getElementById("loading-database")).nextElementSibling.style.display="block",a.remove()),t.abrupt("return",r);case 22:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),c=function(){GLOBAL_CONFIG.localSearch.preload||(o=i(GLOBAL_CONFIG.localSearch.path));var t=document.querySelector("#local-search-input input"),r=document.getElementById("local-search-results"),n=document.getElementById("loading-status");t.addEventListener("input",function(){var m,e=this,v=this.value.trim().toLowerCase().split(/[\s]+/),g=(""!==v[0]&&(n.innerHTML='<i class="fas fa-spinner fa-pulse"></i>'),r.innerHTML="",'<div class="search-result-list">');v.length<=0||(m=0,o.then(function(t){t.forEach(function(t){var r,n=!0,o=t.title?t.title.trim().toLowerCase():"",e=t.tags,a=null!=(a=t.oneImage)?a:"",i=t.content?t.content.trim().replace(/<[^>]+>/g,"").toLowerCase():"",t=t.url.startsWith("/")?t.url:GLOBAL_CONFIG.root+t.url,c=-1,s=-1;if(""!==o||""!==i?v.forEach(function(t,e){r=o.indexOf(t),c=i.indexOf(t),r<0&&c<0?n=!1:(c<0&&(c=0),0===e&&(s=c))}):n=!1,n){if(0<=s){var u=s-30,l=s+100,h="",f="",d=(0===(u=u<0?0:u)?l=100:h="...",l>i.length?l=i.length:f="...",i.substring(u,l));if(v.forEach(function(t){var e=new RegExp(t,"gi");d=d.replace(e,'<span class="search-keyword">'+t+"</span>"),o=o.replace(e,'<span class="search-keyword">'+t+"</span>")}),g=(g=(g+='<div class="local-search__hit-item">')+(a?'<div class="search-left"><img src='.concat(a," alt=").concat(a," data-fancybox='gallery'>"):'<div class="search-left" style="width:0">'))+"</div>"+(a?'<div class="search-right"><a href="'+t+'" class="search-result-title">'+o+"</a>":'<div class="search-right" style="width: 100%"><a href="'+t+'" class="search-result-title">'+o+"</a>"),m+=1,""!==i&&(g+='<p class="search-result" onclick="pjax.loadUrl(`'+t+'`)">'+h+d+f+"</p>"),e.length){g+='<div class="search-result-tags">';for(var y=0;y<e.length;y++){var p=e[y].trim();g+='<a class="tag-list" href="/tags/'+p+'/" data-pjax-state="" one-link-mark="yes">#'+p+"</a>"}g+="</div>"}}g+="</div></div>"}}),0===m&&(g+='<div id="local-search__hits-empty">'+GLOBAL_CONFIG.localSearch.languages.hits_empty.replace(/\$\{query}/,e.value.trim())+"</div>"),g+="</div>",r.innerHTML=g,""!==v[0]&&(n.innerHTML=""),window.pjax&&window.pjax.refresh(r)}))})};e(),document.querySelector("#local-search .search-close-button").addEventListener("click",a),n.addEventListener("click",a),GLOBAL_CONFIG.localSearch.preload&&(o=i(GLOBAL_CONFIG.localSearch.path)),window.addEventListener("pjax:complete",function(){btf.isHidden(n)||a(),e()})});]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/coin/coin.js"/>
      <url>/js/coin/coin.js</url>
      
        <content type="html"><![CDATA[window.onload = function () {  const outside_reward_button = document.querySelector(".reward-button");  outside_reward_button.addEventListener("click",viewModal);  const body = document.getElementsByTagName("body")[0];  body.addEventListener("click", hideModal);  const modal_reward_main = document.querySelector(".reward-main");  // 防止点击 modal 列表时列表消失  modal_reward_main.addEventListener("click",(e)=>{stopProp(e);})  function viewModal (e) {    stopProp(e);  // 防止事件冒泡导致触发body上绑定的点击事件    const disp = modal_reward_main.style.display;    modal_reward_main.style.display = disp === "none" ? "flex" : "none";  }  function hideModal () {    modal_reward_main.style.display = "none";  }  /**   * 阻止事件冒泡  */  function stopProp (e) {    e.stopPropagation ? e.stopPropagation() : e.cancelBubble = true;  }}var tipButtons = document.querySelectorAll('.tip-button')function coinAudio() {  var coinAudio = document.getElementById("coinAudio");  if (coinAudio) {    coinAudio.play();//有音频时播放  }}// Loop through all buttons (allows for multiple buttons on page)tipButtons.forEach((button) => {  var coin = button.querySelector('.coin')  // The larger the number, the slower the animation  coin.maxMoveLoopCount = 90  button.addEventListener('click', () => {    if (/Android|webOS|BlackBerry/i.test(navigator.userAgent)) return true; //媒体选择    if (button.clicked) return    button.classList.add('clicked')    // Wait to start flipping th coin because of the button tilt animation    setTimeout(() => {      // Randomize the flipping speeds just for fun      coin.sideRotationCount = Math.floor(Math.random() * 5) * 90      coin.maxFlipAngle = (Math.floor(Math.random() * 4) + 3) * Math.PI      button.clicked = true      flipCoin()      coinAudio()    }, 50)  })  var flipCoin = () => {    coin.moveLoopCount = 0    flipCoinLoop()  }  var resetCoin = () => {    coin.style.setProperty('--coin-x-multiplier', 0)    coin.style.setProperty('--coin-scale-multiplier', 0)    coin.style.setProperty('--coin-rotation-multiplier', 0)    coin.style.setProperty('--shine-opacity-multiplier', 0.4)    coin.style.setProperty('--shine-bg-multiplier', '50%')    coin.style.setProperty('opacity', 1)    // Delay to give the reset animation some time before you can click again    setTimeout(() => {      button.clicked = false    }, 300)  }  var flipCoinLoop = () => {    coin.moveLoopCount++    var percentageCompleted = coin.moveLoopCount / coin.maxMoveLoopCount    coin.angle = -coin.maxFlipAngle * Math.pow((percentageCompleted - 1), 2) + coin.maxFlipAngle    // Calculate the scale and position of the coin moving through the air    coin.style.setProperty('--coin-y-multiplier', -11 * Math.pow(percentageCompleted * 2 - 1, 4) + 11)    coin.style.setProperty('--coin-x-multiplier', percentageCompleted)    coin.style.setProperty('--coin-scale-multiplier', percentageCompleted * 0.6)    coin.style.setProperty('--coin-rotation-multiplier', percentageCompleted * coin.sideRotationCount)    // Calculate the scale and position values for the different coin faces    // The math uses sin/cos wave functions to similate the circular motion of 3D spin    coin.style.setProperty('--front-scale-multiplier', Math.max(Math.cos(coin.angle), 0))    coin.style.setProperty('--front-y-multiplier', Math.sin(coin.angle))    coin.style.setProperty('--middle-scale-multiplier', Math.abs(Math.cos(coin.angle), 0))    coin.style.setProperty('--middle-y-multiplier', Math.cos((coin.angle + Math.PI / 2) % Math.PI))    coin.style.setProperty('--back-scale-multiplier', Math.max(Math.cos(coin.angle - Math.PI), 0))    coin.style.setProperty('--back-y-multiplier', Math.sin(coin.angle - Math.PI))    coin.style.setProperty('--shine-opacity-multiplier', 4 * Math.sin((coin.angle + Math.PI / 2) % Math.PI) - 3.2)    coin.style.setProperty('--shine-bg-multiplier', -40 * (Math.cos((coin.angle + Math.PI / 2) % Math.PI) - 0.5) + '%')    // Repeat animation loop    if (coin.moveLoopCount < coin.maxMoveLoopCount) {      if (coin.moveLoopCount === coin.maxMoveLoopCount - 6) button.classList.add('shrink-landing')      window.requestAnimationFrame(flipCoinLoop)    } else {      button.classList.add('coin-landed')      coin.style.setProperty('opacity', 0)      setTimeout(() => {        button.classList.remove('clicked', 'shrink-landing', 'coin-landed')        setTimeout(() => {          resetCoin()        }, 300)      }, 1500)    }  }})]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/music/music.js"/>
      <url>/js/music/music.js</url>
      
        <content type="html"><![CDATA[var anzhiyu = {  // 音乐节目切换背景  changeMusicBg: function (isChangeBg = true) {    if (window.location.pathname != "/music/") {      return;    }    const anMusicBg = document.getElementById("an_music_bg");    if (isChangeBg) {      // player listswitch 会进入此处      const musiccover = document.querySelector("#anMusic-page .aplayer-pic");      anMusicBg.style.backgroundImage = musiccover.style.backgroundImage;    } else {      // 第一次进入，绑定事件，改背景      let timer = setInterval(() => {        const musiccover = document.querySelector("#anMusic-page .aplayer-pic");        // 确保player加载完成        console.info(anMusicBg);        if (musiccover) {          clearInterval(timer);          anMusicBg.style.backgroundImage = musiccover.style.backgroundImage;          // 绑定事件          anzhiyu.addEventListenerChangeMusicBg();          // 暂停nav的音乐          if (            document.querySelector("#nav-music meting-js").aplayer &&            !document.querySelector("#nav-music meting-js").aplayer.audio.paused          ) {            anzhiyu.musicToggle();          }        }      }, 100);    }  },  addEventListenerChangeMusicBg: function () {    const anMusicPage = document.getElementById("anMusic-page");    const aplayerIconMenu = anMusicPage.querySelector(".aplayer-info .aplayer-time .aplayer-icon-menu");    anMusicPage.querySelector("meting-js").aplayer.on("loadeddata", function () {      anzhiyu.changeMusicBg();      console.info("player loadeddata");    });    aplayerIconMenu.addEventListener("click", function () {      document.getElementById("menu-mask").style.display = "block";      document.getElementById("menu-mask").style.animation = "0.5s ease 0s 1 normal none running to_show";    });    document.getElementById("menu-mask").addEventListener("click", function () {      if (window.location.pathname != "/music/") return;      anMusicPage.querySelector(".aplayer-list").classList.remove("aplayer-list-hide");    });  },};// 调用anzhiyu.changeMusicBg(false);]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/music/Meting2.min.js"/>
      <url>/js/music/Meting2.min.js</url>
      
        <content type="html"><![CDATA["use strict";function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}class MetingJSElement extends HTMLElement{connectedCallback(){window.APlayer&&window.fetch&&(this._init(),this._parse())}disconnectedCallback(){this.lock||this.aplayer.destroy()}_camelize(a){return a.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(a,b)=>b.toUpperCase())}_init(){let a={};for(let b=0;b<this.attributes.length;b+=1)a[this._camelize(this.attributes[b].name)]=this.attributes[b].value;let b=["server","type","id","api","auth","auto","lock","name","title","artist","author","url","cover","pic","lyric","lrc"];this.meta={};for(var c=0;c<b.length;c++){let d=b[c];this.meta[d]=a[d],delete a[d]}this.config=a,this.api=this.meta.api||window.meting_api||"https://api.i-meto.com/meting/api?server=:server&type=:type&id=:id&r=:r",this.meta.auto&&this._parse_link()}_parse_link(){let a=[["music.163.com.*song.*id=(\\d+)","netease","song"],["music.163.com.*album.*id=(\\d+)","netease","album"],["music.163.com.*artist.*id=(\\d+)","netease","artist"],["music.163.com.*playlist.*id=(\\d+)","netease","playlist"],["music.163.com.*discover/toplist.*id=(\\d+)","netease","playlist"],["y.qq.com.*song/(\\w+).html","tencent","song"],["y.qq.com.*album/(\\w+).html","tencent","album"],["y.qq.com.*singer/(\\w+).html","tencent","artist"],["y.qq.com.*playsquare/(\\w+).html","tencent","playlist"],["y.qq.com.*playlist/(\\w+).html","tencent","playlist"],["xiami.com.*song/(\\w+)","xiami","song"],["xiami.com.*album/(\\w+)","xiami","album"],["xiami.com.*artist/(\\w+)","xiami","artist"],["xiami.com.*collect/(\\w+)","xiami","playlist"]];for(var b=0;b<a.length;b++){let c=a[b],d=new RegExp(c[0]),e=d.exec(this.meta.auto);if(null!==e)return this.meta.server=c[1],this.meta.type=c[2],void(this.meta.id=e[1])}}_parse(){if(this.meta.url){let a={name:this.meta.name||this.meta.title||"Audio name",artist:this.meta.artist||this.meta.author||"Audio artist",url:this.meta.url,cover:this.meta.cover||this.meta.pic,lrc:this.meta.lrc||this.meta.lyric||"",type:this.meta.type||"auto"};return a.lrc||(this.meta.lrcType=0),this.innerText&&(a.lrc=this.innerText,this.meta.lrcType=2),void this._loadPlayer([a])}let a=this.api.replace(":server",this.meta.server).replace(":type",this.meta.type).replace(":id",this.meta.id).replace(":auth",this.meta.auth).replace(":r",Math.random());fetch(a).then(a=>a.json()).then(a=>this._loadPlayer(a))}_loadPlayer(a){let b={audio:a,mutex:!0,lrcType:this.meta.lrcType||3,storageName:"metingjs"};if(a.length){let a=_objectSpread({},b,this.config);for(let b in a)("true"===a[b]||"false"===a[b])&&(a[b]="true"===a[b]);let c=document.createElement("div");a.container=c,this.appendChild(c),this.aplayer=new APlayer(a)}}}console.log("\n %c MetingJS v2.0.1 %c https://github.com/metowolf/MetingJS \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),window.customElements&&!window.customElements.get("meting-js")&&(window.MetingJSElement=MetingJSElement,window.customElements.define("meting-js",MetingJSElement));]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/runtime/runtime.css"/>
      <url>/js/runtime/runtime.css</url>
      
        <content type="html"><![CDATA[div#runtime {    width: 180px;    margin: auto;    color: #fff;    padding-inline: 5px;    border-radius: 10px;    background-color: rgba(0, 0, 0, .7)}#workboard {    font-size: 12px}[data-theme=dark] div#runtime {    color: #28b4c8;    box-shadow: 0 0 5px rgba(28, 69, 218, .71);    animation: flashlight 1s linear infinite alternate}#ghbdages .github-badge img {    height: 20px}@-moz-keyframes flashlight {    from {        box-shadow: 0 0 5px #1478d2    }    to {        box-shadow: 0 0 2px #1478d2    }}@-webkit-keyframes flashlight {    from {        box-shadow: 0 0 5px #1478d2    }    to {        box-shadow: 0 0 2px #1478d2    }}@-o-keyframes flashlight {    from {        box-shadow: 0 0 5px #1478d2    }    to {        box-shadow: 0 0 2px #1478d2    }}@keyframes flashlight {    from {        box-shadow: 0 0 5px #1478d2    }    to {        box-shadow: 0 0 2px #1478d2    }}]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/runtime/runtime.js"/>
      <url>/js/runtime/runtime.js</url>
      
        <content type="html"><![CDATA[var now = new Date();function createtime() {  var grt = new Date("01/07/2023 00:00:00");  now.setTime(now.getTime() + 250);  var days = (now - grt) / 1e3 / 60 / 60 / 24,    dnum = Math.floor(days),    hours = (now - grt) / 1e3 / 60 / 60 - 24 * dnum,    hnum = Math.floor(hours);  1 == String(hnum).length && (hnum = "0" + hnum);  var minutes = (now - grt) / 1e3 / 60 - 1440 * dnum - 60 * hnum,    mnum = Math.floor(minutes);  1 == String(mnum).length && (mnum = "0" + mnum);  var seconds = (now - grt) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,    snum = Math.round(seconds);  1 == String(snum).length && (snum = "0" + snum);  let currentTimeHtml = "";  (currentTimeHtml =    hnum < 18 && hnum >= 9      ? `<img class='boardsign' src='https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg' title='距离月入25k也就还差一个大佬带我~'><span class='textTip'> <br> 本站居然运行了 ${dnum} 天</span><span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span> <i class='fas fa-heartbeat' style='color:red'></i>`      : `<img class='boardsign' src='https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg' title='下班了就该开开心心的玩耍，嘿嘿~'><span class='textTip'> <br> 本站居然运行了 ${dnum} 天</span><span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span> <i class='fas fa-heartbeat' style='color:red'></i>`),    document.getElementById("workboard") && (document.getElementById("workboard").innerHTML = currentTimeHtml);}setInterval(() => {  createtime();}, 250);]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/js/plug-in_labels/ali_font.js"/>
      <url>/js/plug-in_labels/ali_font.js</url>
      
        <content type="html"><![CDATA[!(function (c) {    var l,      h,      a,      t,      i,      v =        '<svg><symbol id="icon-dragon_chen" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#D6B196" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-498.122105 265.620211L431.157895 754.526316V485.052632h-66.074948c-14.470737 110.645895-44.355368 197.066105-102.696421 260.742736l-39.747368-36.432842C306.526316 617.876211 323.368421 462.901895 323.368421 242.526316V215.578947h377.263158v53.894737H377.182316c-0.404211 58.260211-2.209684 112.128-6.359579 161.684211H700.631579v53.894737h-122.152421a481.172211 481.172211 0 0 0 76.826947 119.70021l66.479158-39.855158 27.728842 46.214737-54.460631 32.687158c29.507368 24.953263 63.757474 45.675789 102.80421 58.098526l-16.303158 51.361684c-134.224842-42.711579-222.773895-167.073684-261.551158-268.207157H485.052632v221.857684l68.985263-41.391158 27.728842 46.214737-109.783579 65.886316zM646.736842 377.263158h-215.578947v-53.894737h215.578947v53.894737z" fill="#231F20" ></path></symbol><symbol id="icon-dog_xu" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#D6B196" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-375.592421 150.393263c33.684211 44.544 75.210105 74.698105 124.739369 90.812632l11.425684 3.718737 10.401684-6.009264C781.204211 727.740632 808.421053 622.565053 808.421053 592.842105h-53.894737c0 22.069895-19.132632 80.869053-33.711158 103.504842-34.816-14.605474-64.538947-39.262316-89.249684-74.13221 48.316632-55.269053 92.079158-117.328842 120.535579-179.900632l-49.044211-22.285473c-23.767579 52.250947-59.742316 104.717474-100.055579 152.656842-24.010105-50.930526-41.148632-115.927579-51.658105-195.395369H700.631579v-53.894737h-155.189895A1848.050526 1848.050526 0 0 1 538.947368 161.684211h-53.894736c0 58.206316 2.155789 112.074105 6.494315 161.68421H323.368421v26.947368c0 216.549053-13.177263 263.545263-100.702316 359.046737l39.747369 36.432842c63.326316-69.093053 92.806737-118.272 105.714526-206.848H485.052632v-53.894736h-111.319579a1742.147368 1742.147368 0 0 0 3.449263-107.789474h120.158316c12.611368 98.250105 35.031579 177.475368 67.395368 238.187789-61.978947 65.536-128.053895 117.975579-173.298526 142.282106l25.519158 47.481263c47.589053-25.573053 114.095158-77.446737 177.55621-142.821053z m125.170526-411.971368l-80.842105-80.842106-38.103579 38.103579 80.842105 80.842106 38.103579-38.103579z" fill="#231F20" ></path></symbol><symbol id="icon-dog" viewBox="0 0 1024 1024"><path d="M894.814316 904.434526l83.240421-183.134315-13.824-13.204211c-0.485053-0.458105-45.648842-47.589053-47.939369-185.263158-0.134737-7.922526-0.134737-33.953684-0.134736-55.996631-30.693053 15.306105-70.090105 19.887158-106.09179 19.887157-92.752842 0-163.624421-23.983158-210.647579-71.275789a192.512 192.512 0 0 1-27.944421-36.513684H377.263158v377.263158c342.662737 0 403.105684 51.092211 494.592 128.377263 7.922526 6.682947 15.521684 13.312 22.959158 19.86021z" fill="#85C3DE" ></path><path d="M326.063158 282.947368c0 34.250105-13.231158 44.463158-29.642105 44.463158s-29.642105-10.213053-29.642106-44.463158c0-34.223158 13.231158-44.463158 29.642106-44.463157s29.642105 10.24 29.642105 44.463157zM269.473684 430.295579v311.646316L190.275368 916.210526h59.203369L323.368421 753.637053V377.263158h-26.947368c-119.403789 0-172.732632-53.382737-185.505685-107.789474h35.624421c51.092211 0 68.581053-15.764211 120.535579-62.544842 12.773053-11.506526 28.079158-25.276632 47.023158-41.741474l18.351158-15.952842-69.658947-99.139368-44.085895 30.989474 41.768421 59.472842c-11.183158 9.862737-20.884211 18.593684-29.480421 26.327579C180.736 212.156632 176.235789 215.578947 146.539789 215.578947H53.894737v26.947369c0 88.710737 66.910316 178.149053 215.578947 187.769263z m216.710737-161.414737c2.290526 71.733895 28.698947 136.326737 75.048421 182.918737C618.711579 509.628632 702.437053 538.947368 810.091789 538.947368c18.593684 0 36.190316-1.158737 52.628211-3.449263 3.745684 111.265684 33.630316 170.334316 51.496421 196.015158l-38.507789 84.722526C782.174316 742.049684 688.774737 700.631579 377.263158 700.631579v53.894737c34.277053 0 65.697684 0.512 94.639158 1.509052L374.595368 970.105263h59.203369l96.013474-211.240421c66.182737 4.338526 117.005474 11.829895 157.911578 22.016L626.229895 916.210526h59.176421l54.16421-119.134315c47.616 18.405053 79.737263 42.091789 113.125053 69.739789L805.753263 970.105263h59.203369l113.071157-248.778105-13.824-13.204211c-0.485053-0.458105-45.648842-47.589053-47.939368-185.263158C985.168842 498.553263 1024 447.811368 1024 377.263158c0-95.205053-66.506105-161.684211-161.684211-161.684211v53.894737c65.482105 0 107.789474 42.307368 107.789474 107.789474 0 89.088-87.013053 107.789474-160.013474 107.789474-92.752842 0-163.624421-23.983158-210.647578-71.27579-30.315789-30.504421-45.891368-65.832421-53.35579-98.735158 11.210105 6.952421 22.932211 13.338947 35.274105 19.186527l23.04-48.720843c-92.106105-43.654737-148.992-128.646737-219.243789-243.981473l-46.026105 28.05221c49.448421 81.246316 92.968421 148.506947 147.051789 199.302737z" fill="#231F20" ></path></symbol><symbol id="icon-goat" viewBox="0 0 1024 1024"><path d="M548.378947 646.736842a952.32 952.32 0 0 1 140.90779-161.68421H107.789474c0 107.600842 0 107.600842-63.649685 169.283368l-13.069473 12.665263L66.721684 754.526316h417.172211c20.345263-41.472 43.654737-77.446737 64.485052-107.789474z" fill="#F7C768" ></path><path d="M608.256 144.734316C555.762526 115.577263 506.098526 107.789474 485.052632 107.789474V53.894737c32.579368 0 91.270737 11.452632 149.369263 43.735579 75.290947 41.822316 130.694737 94.531368 171.385263 150.878316C755.873684 288.013474 697.101474 323.368421 646.736842 323.368421h-107.789474v-53.894737h107.789474c20.506947 0 48.424421-11.210105 80.437895-31.285895a471.04 471.04 0 0 0-118.918737-93.453473zM832.673684 342.231579c-16.384 0-29.642105 10.24-29.642105 44.463158 0 34.250105 13.231158 44.463158 29.642105 44.463158s29.642105-10.213053 29.642105-44.463158c0-34.223158-13.231158-44.463158-29.642105-44.463158zM1024 619.789474C1024 347.109053 901.066105 122.448842 686.753684 3.395368l-26.165895 47.104C914.324211 191.461053 964.688842 440.400842 969.647158 592.842105h-84.506947c-17.92-35.624421-45.352421-69.12-87.013053-101.995789l-16.788211-13.285053-16.734315 13.392842c-66.128842 52.897684-134.629053 127.083789-187.311158 209.677474H102.965895l-8.272842-20.318316C159.043368 617.013895 161.684211 603.109053 161.684211 485.052632v-53.894737h485.052631v-53.894737H161.684211c0-80.384 14.309053-110.026105 66.586947-137.916632l-25.384421-47.535158C123.365053 234.226526 107.789474 291.920842 107.789474 377.263158v107.789474c0 107.600842 0 107.600842-63.649685 169.283368l-13.069473 12.665263L110.618947 862.315789h58.206316l-43.897263-107.789473h103.477895l43.897263 107.789473h58.206316l-43.897263-107.789473h259.47621C508.981895 824.939789 485.052632 899.152842 485.052632 970.105263h53.894736c0-68.688842 27.270737-144.060632 68.958316-215.578947H687.157895c7.410526 0 13.473684 6.063158 13.473684 13.473684V862.315789h53.894737v-94.315789c0-37.160421-30.208-67.368421-67.368421-67.368421h-44.65179c40.771368-58.017684 89.438316-111.427368 138.913684-153.626947C841.512421 600.037053 862.315789 655.225263 862.315789 754.526316h53.894737c0-38.912-2.748632-74.482526-11.102315-107.789474H1024v-26.947368z" fill="#231F20" ></path></symbol><symbol id="icon-goat_wei" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#D6B196" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 50.202947c52.304842 70.925474 136.973474 152.144842 232.528843 190.383158l19.994947-50.041263c-109.271579-43.708632-202.805895-152.629895-238.780632-217.49221H808.421053v-53.894737H538.947368v-53.894737h215.578948v-53.894737h-215.578948V161.684211h-53.894736v161.68421h-215.578948v53.894737h215.578948v53.894737H215.578947v53.894737h255.757474c-35.974737 64.862316-129.536 173.783579-238.807579 217.49221l20.021895 50.041263c95.528421-38.238316 180.197053-119.484632 232.501895-190.383158V808.421053h53.894736v-246.218106z" fill="#231F20" ></path></symbol><symbol id="icon-dragon" viewBox="0 0 1024 1024"><path d="M366.376421 344.441263l152.980211-152.98021c43.142737-43.142737 141.204211-9.216 270.201263 115.738947-15.225263 9.835789-25.114947 15.818105-44.13979 32.256s-38.076632 35.489684-59.418947 56.832c-4.203789 4.203789-51.173053 53.221053-78.740211 82.027789-10.805895-12.126316-22.743579-24.171789-34.654315-36.082526L493.136842 362.792421l-54.218105 54.218105-72.542316-72.569263zM862.315789 512c0 46.834526-45.352421 80.842105-107.789473 80.842105-108.948211 0-189.359158-28.806737-267.129263-56.697263C414.100211 509.871158 344.872421 485.052632 258.182737 485.052632 80.788211 485.052632 0 588.126316 0 683.897263h53.894737C73.216 659.779368 135.302737 646.736842 177.340632 646.736842c77.338947 0 223.124211 23.282526 291.893894 47.912421C547.462737 722.701474 615.989895 754.526316 734.315789 754.526316 862.315789 754.526316 916.210526 670.315789 916.210526 512h-53.894737z" fill="#FF8787" ></path><path d="M552.421053 1024c-69.766737 0-113.825684-13.958737-156.402527-27.459368-54.487579-17.273263-110.807579-35.004632-232.421052-26.516211l-3.826527-53.733053c131.718737-9.458526 195.934316 10.967579 252.52379 28.887579 42.226526 13.365895 78.686316 24.926316 140.126316 24.926316 92.752842 0 148.210526-57.936842 148.210526-113.960421 0-16.949895-5.524211-101.618526-114.634105-101.618526-64.970105 0-112.747789 23.336421-163.328 48.02021C365.325474 830.571789 300.301474 862.315789 204.288 862.315789 85.908211 862.315789 0 787.294316 0 683.897263 0 588.126316 80.788211 485.052632 258.182737 485.052632c86.689684 0 155.917474 24.818526 229.214316 51.09221 45.810526 16.410947 92.564211 33.172211 145.488842 44.166737 9.000421-7.033263 13.850947-16.276211 13.850947-26.758737 0-37.187368-37.672421-74.859789-74.13221-111.265684l-3.287579-3.287579 38.103579-38.103579 3.260631 3.287579C652.853895 446.275368 700.631579 494.026105 700.631579 553.552842c0 12.719158-2.802526 24.926316-7.976421 36.109474A594.997895 594.997895 0 0 0 754.526316 592.842105c62.437053 0 107.789474-34.007579 107.789473-80.842105 0-58.853053-52.870737-110.268632-108.840421-164.702316l-8.057263-7.841684c-19.024842 16.437895-38.076632 35.489684-59.418947 56.832l-38.103579-38.103579c74.805895-74.832842 134.898526-134.898526 268.314947-141.931789V55.619368c-63.407158 7.787789-120.993684 39.424-121.667368 39.801264l-15.818105 8.811789-14.120421-11.344842C731.701895 66.452211 709.712842 53.894737 673.684211 53.894737c-41.418105 0-74.347789 25.869474-109.190737 53.301895-26.624 20.911158-54.137263 42.549895-86.851369 53.194105L469.342316 161.684211h-69.093053l-105.525895 105.525894-38.103579-38.130526L324.015158 161.684211H161.684211V107.789474h303.104c22.231579-8.272842 43.708632-25.168842 66.398315-42.981053C569.829053 34.438737 613.618526 0 673.684211 0c48.909474 0 81.408 17.946947 110.888421 40.097684C813.702737 26.300632 877.729684 0 943.157895 0h26.947368v323.368421h-53.894737v-53.167158c-54.164211 3.098947-92.914526 15.845053-127.002947 36.675369l1.832421 1.778526C852.587789 368.505263 916.210526 430.376421 916.210526 512c0 60.928-43.708632 109.945263-107.789473 127.622737V700.631579h53.894736v-53.894737h53.894737v53.894737h53.894737v53.894737h-53.894737v53.894737h-53.894737v-53.894737h-53.894736c-29.722947 0-53.894737-24.171789-53.894737-53.894737v-53.894737c-118.325895 0-207.063579-31.797895-285.318737-59.877053C400.437895 562.229895 335.494737 538.947368 258.182737 538.947368 117.059368 538.947368 53.894737 611.732211 53.894737 683.897263 53.894737 757.221053 115.738947 808.421053 204.288 808.421053c11.910737 0 23.228632-0.538947 34.034526-1.536C248.454737 796.321684 269.473684 770.640842 269.473684 739.166316c0-33.118316-43.088842-70.979368-58.152421-81.596632l30.935579-44.139789c8.299789 5.793684 81.111579 58.664421 81.111579 125.736421 0 19.429053-4.527158 37.052632-10.994526 52.304842 30.773895-10.051368 58.314105-23.498105 86.662737-37.349053C452.877474 727.848421 508.577684 700.631579 585.997474 700.631579 702.410105 700.631579 754.526316 778.725053 754.526316 856.144842 754.526316 938.657684 678.912 1024 552.421053 1024z m-21.180632-623.104L493.136842 362.792421l137.889684-137.889684 38.103579 38.103579-137.889684 137.889684z m-126.760421-18.351158l-38.103579-38.103579 152.980211-152.98021 38.103579 38.103579-152.980211 152.98021z m282.004211-218.624c15.494737-9.754947 43.331368-31.447579 43.331368-31.447579-25.734737-27.809684-49.556211-33.333895-67.368421-29.07621-19.240421 4.608-37.753263 24.602947-37.753263 24.602947s42.253474 22.447158 61.790316 35.920842z" fill="#231F20" ></path></symbol><symbol id="icon-horse" viewBox="0 0 1024 1024"><path d="M776.003368 646.736842c16.599579-99.947789 43.439158-181.086316 83.213474-256.538947l6.817684-12.934737H269.473684c-36.756211 0-53.894737 54.945684-53.894737 92.05221 0 46.753684 6.656 77.527579 70.278737 176.074106l84.533895 128.269473L498.876632 646.736842h277.126736z" fill="#FFAF6E" ></path><path d="M1024 0v404.210526c0 33.333895 0 134.736842-92.079158 134.736842h-13.824l-78.362947-109.056c-22.743579 49.906526-40.340211 103.046737-53.490527 162.950737h115.092211C937.310316 592.842105 970.105263 625.637053 970.105263 661.638737c0 60.631579-69.389474 154.300632-77.312 164.75621l-43.008-32.471579C875.466105 759.861895 916.210526 693.813895 916.210526 661.638737c0-5.982316-8.919579-14.901895-14.901894-14.901895h-125.332211C761.128421 736.121263 754.526316 840.569263 754.526316 970.105263h-53.894737c0-283.971368 31.097263-453.605053 110.888421-605.049263l20.318316-38.534737 112.801684 156.995369c14.443789-4.419368 25.465263-20.938105 25.465263-79.306106V0h53.894737z m-161.684211 161.684211h53.894737V0h-53.894737v80.842105c-17.381053-14.955789-38.184421-26.947368-80.842105-26.947368h-134.736842v53.894737h134.736842c37.672421 0 80.842105 40.906105 80.842105 53.894737z m-107.789473 0h-215.578948v53.894736h161.684211l53.894737-53.894736zM300.894316 766.544842L400.680421 916.210526h64.754526l-95.043368-142.551579L498.876632 646.736842h167.855157a1212.631579 1212.631579 0 0 1 9.431579-53.894737h-199.383579l-175.885473 173.702737z m109.97221-184.400842l-37.861052-38.319158-132.419369 130.802526C173.729684 571.095579 161.684211 529.812211 161.684211 469.315368 161.684211 398.578526 199.464421 323.368421 269.473684 323.368421h323.368421l53.894737-53.894737H269.473684c-6.709895 0-13.258105 0.565895-19.698526 1.482105C234.927158 249.451789 204.638316 215.578947 160.633263 215.578947 65.967158 215.578947 0 349.291789 0 469.315368c0 70.170947 16.141474 136.650105 49.232842 202.671158L6.197895 723.833263l41.472 34.41179 66.128842-79.737264-8.704-16.033684C83.105684 622.133895 53.894737 558.214737 53.894737 469.315368 53.894737 368.451368 106.765474 269.473684 160.633263 269.473684c13.231158 0 25.815579 9.889684 35.43579 20.533895C142.874947 321.967158 107.789474 388.500211 107.789474 469.315368c0 78.201263 19.698526 130.937263 93.642105 243.981474l-55.296 54.622316L280.899368 970.105263h64.754527l-130.048-195.072 195.260631-192.889263z" fill="#231F20" ></path></symbol><symbol id="icon-monkey_shen" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#BBC4C9" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 134.736842h161.684211v53.894737h53.894737V269.473684h-215.578948V161.684211h-53.894736v107.789473h-215.578948v431.157895h53.894737v-53.894737h161.684211v215.578947h53.894736v-215.578947z m0-161.68421h161.684211v107.789473h-161.684211v-107.789473z m-215.578947 0h161.684211v107.789473h-161.684211v-107.789473z m215.578947-161.684211h161.684211v107.789474h-161.684211v-107.789474z m-215.578947 0h161.684211v107.789474h-161.684211v-107.789474z" fill="#231F20" ></path></symbol><symbol id="icon-ox_chou" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#D6B196" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-161.68421 188.631579h-159.555369c13.985684-172.813474 43.115789-357.429895 70.817684-385.158737L700.631579 269.473684H323.368421v53.894737h107.169684c-1.940211 45.756632-8.192 103.962947-15.76421 161.684211H323.368421v53.894736h83.968c-9.862737 68.446316-20.264421 130.128842-25.734737 161.684211H215.578947v53.894737h592.842106v-53.894737z m-346.543158-161.684211h149.800421a3313.717895 3313.717895 0 0 0-16.842105 161.684211h-158.477474c6.036211-35.247158 16.114526-95.636211 25.519158-161.684211z m22.608842-215.578947h171.735579c-15.198316 41.121684-27.405474 100.594526-36.890948 161.684211h-150.123789c7.383579-57.505684 13.419789-115.361684 15.279158-161.684211z" fill="#231F20" ></path></symbol><symbol id="icon-monkey" viewBox="0 0 1024 1024"><path d="M757.733053 485.052632H565.894737a80.842105 80.842105 0 0 0-80.842105 80.842105v215.578947c0 40.96 43.546947 99.678316 77.446736 139.210105C596.426105 960.215579 603.055158 970.105263 603.055158 970.105263H754.526316s15.144421-18.674526 45.891368-58.071579S862.315789 809.984 862.315789 717.608421c0-89.573053-47.993263-166.346105-104.582736-232.555789z" fill="#C3D686" ></path><path d="M538.947368 1024h-53.894736c0-32.794947 25.869474-87.417263 77.446736-103.316211C528.599579 881.152 485.052632 822.433684 485.052632 781.473684c0-44.570947 36.271158-80.842105 80.842105-80.842105h80.842105v53.894737h-80.842105a26.947368 26.947368 0 0 0-26.947369 26.947368c0 19.725474 36.675368 77.473684 92.133053 134.736842h88.602947c20.210526-14.147368 88.737684-71.464421 88.737685-198.602105 0-108.382316-93.237895-202.967579-168.151579-278.986105-49.502316-50.202947-88.576-89.842526-98.735158-128.61979-11.749053-44.732632-21.584842-112.586105-26.327579-148.318315H377.263158c-45.136842 0-89.519158 8.434526-121.802105 53.894736H431.157895v53.894737c-97.28 0-107.789474 113.071158-107.789474 161.684211v53.894737h53.894737v161.68421h-53.894737v-107.789474h-26.947368c-170.253474 0-188.631579-94.234947-188.631579-134.736842 0-31.043368 35.220211-72.326737 55.727158-93.722947 2.694737-14.686316 5.847579-28.348632 9.431579-41.013895H161.684211V215.578947h31.528421C239.642947 120.993684 317.224421 107.789474 377.263158 107.789474h185.640421l2.802526 23.794526c0.134737 1.050947 12.719158 106.657684 27.944421 164.756211 6.494316 24.872421 44.624842 63.514947 84.965053 104.448C760.481684 483.813053 862.315789 587.129263 862.315789 717.608421c0 92.375579-31.124211 155.028211-61.898105 194.425263C904.919579 892.146526 970.105263 803.004632 970.105263 673.684211c0-91.405474-42.819368-154.381474-84.237474-215.255579C847.791158 402.458947 808.421053 344.576 808.421053 269.473684c0-119.349895 87.093895-161.684211 161.68421-161.68421v53.894737c-32.417684 0-107.789474 10.509474-107.789474 107.789473 0 58.502737 31.555368 104.933053 68.096 158.639158C974.282105 492.597895 1024 565.679158 1024 673.684211c0 177.286737-108.301474 296.421053-269.473684 296.421052h-161.684211c-37.672421 0-53.894737 40.906105-53.894737 53.894737zM229.214316 269.473684a384.808421 384.808421 0 0 0-14.012632 58.341053l-1.401263 8.488421-6.090105 6.117053c-22.878316 22.932211-44.813474 52.601263-46.026105 62.275368 0 56.805053 53.76 75.264 107.789473 79.386947V431.157895c0-58.691368 13.473684-119.619368 46.511158-161.684211h-86.770526zM323.368421 1024h-53.894737c0-32.794947 25.869474-87.417263 77.446737-103.316211C313.020632 881.152 269.473684 822.433684 269.473684 781.473684c0-44.570947 36.271158-80.842105 80.842105-80.842105h45.16379A188.847158 188.847158 0 0 1 565.894737 592.842105h134.736842v53.894737h-134.736842c-74.293895 0-134.736842 60.442947-134.736842 134.736842v26.516211l-53.894737 0.377263V781.473684c0-9.162105 0.646737-18.135579 1.913263-26.947368H350.315789c-14.848 0-26.947368 12.072421-26.947368 26.947368 0 19.725474 36.675368 77.473684 92.133053 134.736842H431.157895v53.894737h-53.894737c-37.672421 0-53.894737 40.906105-53.894737 53.894737z" fill="#231F20" ></path></symbol><symbol id="icon-horse_wu" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#FF8787" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 26.947368h269.473685v-53.894736H538.947368v-161.684211h161.684211v-53.894737H411.001263c12.045474-33.28 20.156632-69.793684 20.156632-107.789473h-53.894737c0 121.963789-105.364211 233.391158-106.415158 234.496l38.858105 37.349052c2.883368-3.018105 43.816421-46.133895 77.392842-110.160842H485.052632v161.684211H215.578947v53.894736h269.473685v323.368421h53.894736V538.947368z" fill="#231F20" ></path></symbol><symbol id="icon-ox" viewBox="0 0 1025 1024"><path d="M540.294737 754.526316h215.578947c20.210526 0 35.112421 1.374316 53.894737 4.581052 91.863579 15.656421 145.354105 67.691789 161.684211 86.069895V916.210526h53.894736V635.580632l-7.895579-7.895579c-9.269895-9.269895-36.513684-49.232842-44.032-196.527158H540.294737a161.684211 161.684211 0 0 0-161.684211 161.68421v131.098948c43.304421 20.210526 97.28 30.585263 161.684211 30.585263z" fill="#FFAF6E" ></path><path d="M1025.347368 635.580632V916.210526h-53.894736v-71.033263c-16.330105-18.405053-69.820632-70.413474-161.684211-86.069895V916.210526h-53.894737v-161.68421h-107.789473v215.578947h-53.894737V700.631579h161.68421c100.998737 0 172.570947 38.669474 215.578948 71.868632v-115.738948c-33.684211-43.627789-51.712-137.458526-53.706106-279.498105H701.978947c-76.934737 0-127.218526-26.219789-175.804631-51.550316a1556.048842 1556.048842 0 0 0-26.839579-13.743158c-26.839579 26.004211-66.209684 44.921263-115.738948 55.511579 24.441263 22.986105 60.874105 52.116211 106.469053 72.838737l-22.312421 49.044211c-76.584421-34.816-129.589895-88.926316-150.824421-113.125053-10.644211 0.619789-21.477053 1.024-32.687158 1.024a473.734737 473.734737 0 0 1-123.365053-15.952842l-93.022315 186.314105 68.581052 53.86779C167.882105 579.557053 237.891368 538.947368 324.715789 538.947368v53.894737c-95.986526 0-170.361263 62.490947-171.088842 63.137684l-16.78821 14.282106-136.838737-107.358316 109.729684-219.809684C46.430316 314.448842 1.347368 267.371789 1.347368 199.868632 1.347368 89.815579 121.586526 53.894737 163.031579 53.894737v53.894737c-14.120421 0-107.789474 17.165474-107.789474 92.079158C55.242105 290.465684 192.188632 323.368421 284.240842 323.368421c67.907368 0 122.421895-12.988632 157.696-35.624421-42.711579-14.336-95.097263-23.120842-169.337263-18.324211l-3.503158-53.786947c95.878737-6.117053 160.148211 8.515368 211.429053 28.833684C484.244211 235.439158 486.4 225.818947 486.4 215.578947c0-48.855579-57.829053-76.288-58.394947-76.557473l22.393263-49.017263C454.063158 91.648 540.294737 131.826526 540.294737 215.578947c0 18.566737-3.422316 35.84-9.997474 51.631158 7.060211 3.584 13.985684 7.168 20.776421 10.698106C597.854316 302.322526 638.248421 323.368421 701.978947 323.368421h269.473685v26.947368c0 214.689684 35.220211 266.590316 45.999157 277.369264l7.895579 7.895579z m-729.384421 25.141894l-98.789052 118.541474 86.797473 137.835789 45.594948-28.725894-65.913263-104.690527 37.052631-44.43621C358.642526 785.192421 439.080421 808.421053 540.294737 808.421053v-53.894737c-99.893895 0-175.077053-24.549053-223.474526-72.946527l-20.857264-20.857263z" fill="#231F20" ></path></symbol><symbol id="icon-rabbit_mao" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#7DD47F" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-377.263158-188.631579h107.789474v323.368421c-20.48 0-39.936-11.264-40.016842-11.317895l-27.728842 46.214737c3.206737 1.940211 32.660211 18.997895 67.745684 18.997895 30.746947 0 53.894737-23.147789 53.894737-53.894737V269.473684h-215.578948v538.947369h53.894737V323.368421z m-107.789473 242.526316v-242.526316h-53.894737v196.904421l-107.789474 40.421053v-243.927579l169.094737-48.316632-14.821053-51.819789L269.473684 276.102737v304.801684l-36.405895 13.662316 18.917053 50.472421 178.741895-67.018105c-5.039158 69.928421-55.269053 106.981053-165.133474 122.933894l7.733895 53.328842C325.712842 746.657684 485.052632 723.536842 485.052632 565.894737z" fill="#231F20" ></path></symbol><symbol id="icon-rabbit" viewBox="0 0 1024 1024"><path d="M680.96 488.744421a1666.667789 1666.667789 0 0 0-54.433684-23.95621c-16.006737 12.234105-33.899789 20.264421-60.631579 20.264421h-80.842105c-36.810105 0-83.644632 30.396632-104.394106 67.772631-42.819368 77.123368-53.409684 117.813895-11.021473 201.701053C397.096421 808.879158 431.157895 876.409263 431.157895 970.105263h338.539789l68.338527-138.859789c20.129684-40.96 24.252632-73.701053 24.252631-110.349474 0.026947-57.397895-25.061053-159.717053-181.328842-232.151579z" fill="#FFBDD8" ></path><path d="M862.315789 720.896c0 36.621474-4.122947 69.389474-24.252631 110.349474L769.697684 970.105263H485.052632v-53.894737h48.370526C507.877053 880.074105 485.052632 833.509053 485.052632 781.473684c0-59.418947 24.171789-113.313684 63.218526-152.360421l38.103579 38.103579A161.091368 161.091368 0 0 0 538.947368 781.473684c0 54.784 35.381895 104.043789 63.514948 134.736842h133.712842l53.490526-108.759579c15.710316-31.851789 18.755368-55.834947 18.755369-86.554947 0-80.976842-63.434105-150.096842-178.607158-195.503158-17.542737 8.138105-38.292211 13.554526-63.919158 13.554526h-80.842105c-13.958737 0-43.924211 15.979789-57.290106 40.016843l-47.104-26.165895C401.408 515.449263 448.242526 485.052632 485.052632 485.052632h80.842105c37.268211 0 57.478737-15.440842 79.090526-36.45979C625.367579 336.195368 549.753263 269.473684 485.052632 269.473684h-107.789474a21.288421 21.288421 0 0 0-5.955369 2.021053A683.762526 683.762526 0 0 0 302.187789 194.021053c-35.84-34.223158-61.763368-58.933895-94.908631-79.440842A42.442105 42.442105 0 0 0 185.478737 107.789474a22.824421 22.824421 0 0 0-17.381053 7.194947c-10.913684 11.425684-6.063158 28.240842 1.428211 39.181474 21.989053 32.121263 47.912421 56.858947 83.752421 91.109052 20.614737 19.671579 49.259789 43.169684 77.392842 63.08379C281.007158 367.400421 215.578947 484.432842 215.578947 592.842105c0 74.482526 24.791579 124.065684 51.065264 176.586106C294.534737 825.209263 323.368421 882.903579 323.368421 970.105263h-53.894737c0-74.482526-24.791579-124.065684-51.065263-176.586105C190.517895 737.738105 161.684211 680.043789 161.684211 592.842105c0-90.866526 42.226526-197.685895 93.453473-274.485894a803.759158 803.759158 0 0 1-39.046737-34.115369C177.852632 247.754105 150.231579 221.399579 125.035789 184.616421c-24.441263-35.759158-22.797474-78.686316 4.069053-106.819368 26.300632-27.567158 70.898526-31.043368 106.522947-9.000421 37.941895 23.444211 65.562947 49.798737 103.774316 86.258526 9.970526 9.512421 33.037474 32.309895 56.93979 60.550737h68.634947c-27.621053-37.780211-60.416-72.730947-88.522105-99.543579-28.833684-27.540211-54.730105-52.116211-84.533895-74.024421L326.305684 0.296421c31.232 23.228632 57.802105 48.532211 87.309474 76.719158 53.840842 51.388632 94.450526 100.594526 121.74821 146.83621 82.836211 26.650947 150.042947 116.870737 165.025685 230.750316l1.724631 13.177263-9.404631 9.404632c-3.772632 3.772632-7.706947 7.653053-11.802948 11.587368C837.227789 561.178947 862.315789 663.498105 862.315789 720.896zM309.463579 754.526316c3.934316 8.057263 7.895579 16.087579 11.991579 24.144842C348.887579 832.970105 377.263158 889.128421 377.263158 970.105263h53.894737c0-93.696-34.061474-161.226105-61.520842-215.578947h-60.173474z m597.90821 53.894737c-3.422316 9.404632-7.814737 19.806316-13.770105 31.959579L829.790316 970.105263h60.065684l52.143158-105.957052c10.778947-21.935158 17.515789-40.016842 21.90821-55.727158h-56.535579zM514.694737 390.736842c0-34.223158-13.231158-44.463158-29.642105-44.463158s-29.642105 10.24-29.642106 44.463158c0 34.250105 13.231158 44.463158 29.642106 44.463158s29.642105-10.213053 29.642105-44.463158z" fill="#231F20" ></path></symbol><symbol id="icon-rat_zi" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#85C3DE" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-431.157895 188.631579v-215.578947h269.473685v-53.894737H538.947368v-39.585684c26.543158-18.081684 94.585263-65.050947 177.852632-127.488L700.631579 215.578947H323.368421v53.894737h295.316211a4221.008842 4221.008842 0 0 1-121.640421 85.369263l-11.991579 8.003369V431.157895H242.526316v53.894737h242.526316v215.578947c0 48.343579-13.850947 53.894737-134.736843 53.894737v53.894737c105.391158 0 188.631579 0 188.631579-107.789474z" fill="#231F20" ></path></symbol><symbol id="icon-rat" viewBox="0 0 1024 1024"><path d="M727.659789 431.157895c-132.581053 0-220.348632 47.454316-285.803789 154.354526-19.779368 32.309895-15.845053 76.503579-9.404632 96.579368 3.260632 10.159158 7.760842 18.647579 12.422737 25.546106C464.761263 737.010526 499.927579 754.526316 538.947368 754.526316h66.829474c1.158737 17.893053-1.967158 34.762105-15.144421 53.975579-12.692211 18.539789-37.807158 40.151579-56.32 54.810947 25.249684-0.673684 52.709053-0.997053 83.240421-0.997053C877.487158 862.315789 970.105263 711.922526 970.105263 571.176421 936.421053 512 882.364632 431.157895 727.659789 431.157895z" fill="#85C3DE" ></path><path d="M210.432 1012.897684l-43.573895-31.690105c106.954105-147.051789 185.317053-171.196632 423.828211-172.705684 21.396211-31.258947 16.249263-56.266105 9.377684-89.70779-3.557053-17.138526-7.221895-34.842947-7.221895-54.433684 0-68.958316 25.330526-104.636632 63.407158-136.973474l34.896842 41.040842c-29.453474 25.061053-44.409263 46.780632-44.409263 95.932632 0 14.093474 2.937263 28.402526 6.063158 43.546947 5.901474 28.510316 12.8 62.032842-1.131789 99.462737 166.373053-10.24 264.542316-96.902737 264.542315-236.193684C916.210526 418.330947 827.580632 323.368421 684.921263 323.368421c-83.644632 0-153.303579 29.696-174.187789 39.612632a224.875789 224.875789 0 0 1-20.533895 31.339789l-41.741474-34.115368 20.884211 17.057684-20.911158-16.976842C448.781474 359.828211 485.052632 314.287158 485.052632 262.736842c0-34.816-8.946526-60.766316-26.570106-77.069474-17.515789-16.249263-44.786526-24.602947-81.219368-24.953263V323.368421h-53.894737V109.783579l24.872421-1.913263c64.700632-4.931368 114.095158 7.895579 146.863158 38.238316C524.207158 173.056 538.947368 212.291368 538.947368 262.736842c0 11.102316-1.131789 21.908211-3.072 32.202105 37.268211-12.584421 89.842526-25.465263 149.045895-25.465263C858.165895 269.473684 970.105263 387.907368 970.105263 571.176421 970.105263 711.922526 877.487158 862.315789 617.552842 862.315789c-258.667789 0-311.942737 19.698526-407.120842 150.581895z m19.105684-256.835368c-12.045474 0-24.387368-0.565895-37.025684-1.64379l-22.096842-1.859368-2.425263-22.016C167.747368 728.144842 161.684211 672.444632 161.684211 631.026526c0-103.585684 21.450105-178.903579 53.894736-259.045052V107.789474h53.894737v274.782315l-2.021052 4.904422C235.439158 465.758316 215.578947 533.800421 215.578947 631.026526c0 22.878316 2.101895 51.442526 3.826527 70.979369 99.678316 2.802526 172.813474-35.408842 222.450526-116.493474l48.020211 24.090947c-11.237053 28.133053-11.371789 51.577263-0.377264 67.853474 9.701053 14.282105 28.645053 23.174737 49.448421 23.174737v53.894737c-39.019789 0-74.186105-17.515789-94.073263-46.888421a100.244211 100.244211 0 0 1-12.422737-25.546106c-53.221053 49.178947-121.128421 73.943579-202.913684 73.970527zM379.957895 525.473684c0-34.223158-13.231158-44.463158-29.642106-44.463158s-29.642105 10.24-29.642105 44.463158c0 34.250105 13.231158 44.463158 29.642105 44.463158s29.642105-10.213053 29.642106-44.463158z" fill="#231F20" ></path></symbol><symbol id="icon-rooster_you" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#BBC4C9" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-215.578947-188.631579h-161.684211v-26.947368h161.684211V242.526316H269.473684v53.894737h161.684211v26.947368h-161.684211v485.052632h53.894737v-53.894737h377.263158v53.894737h53.894737V323.368421zM323.368421 646.736842h377.263158v53.894737H323.368421v-53.894737z m0-269.473684h107.789474c0 103.316211-72.784842 107.654737-81.084632 107.789474L350.315789 538.947368c46.592 0 134.736842-33.792 134.736843-161.68421h53.894736v107.789474c0 29.722947 24.171789 53.894737 53.894737 53.894736h107.789474v53.894737H323.368421v-215.578947z m377.263158 0v107.789474h-107.789474v-107.789474h107.789474z m-215.578947-80.842105h53.894736v26.947368h-53.894736v-26.947368z" fill="#231F20" ></path></symbol><symbol id="icon-rooster" viewBox="0 0 1024 1024"><path d="M891.688421 506.421895C877.244632 455.033263 862.315789 401.893053 862.315789 323.368421V116.224l-323.368421 195.745684V323.368421c0 78.524632 14.928842 131.664842 29.372632 183.053474 12.611368 44.894316 24.522105 87.282526 24.522105 140.314947 0 101.618526-77.931789 176.693895-168.286316 203.991579l5.416422 11.587368h215.578947c24.333474 0 43.385263-0.242526 58.556631-2.128842C811.52 846.821053 916.210526 764.550737 916.210526 646.736842c0-53.032421-11.910737-95.420632-24.522105-140.314947z" fill="#FF8787" ></path><path d="M673.684211 354.357895c-16.384 0-29.642105-10.213053-29.642106-44.463158 0-34.223158 13.231158-44.463158 29.642106-44.463158s29.642105 10.24 29.642105 44.463158c0 34.250105-13.258105 44.463158-29.642105 44.463158zM540.106105 970.105263l-50.58021-107.789474h156.05221l50.607158 107.789474h59.553684l-51.60421-109.918316C811.52 846.821053 916.210526 764.550737 916.210526 646.736842c0-53.032421-11.910737-95.420632-24.522105-140.314947C877.244632 455.033263 862.315789 401.893053 862.315789 323.368421V107.789474c0-59.445895-48.343579-107.789474-107.789473-107.789474a107.924211 107.924211 0 0 0-107.789474 106.172632 100.890947 100.890947 0 0 0-24.117895-3.314527 88.710737 88.710737 0 0 0-88.602947 88.602948c0 20.668632 5.227789 39.720421 10.671158 53.921684l-99.489684 59.688421 93.749894 14.470737V377.263158c0 14.416842-5.901474 21.692632-33.360842 49.152l-11.129263 11.129263C398.228211 326.521263 324.985263 269.473684 215.740632 269.473684 96.768 269.473684 0 366.241684 0 485.214316V646.736842h53.894737v-161.522526A162.007579 162.007579 0 0 1 215.740632 323.368421c82.081684 0 140.422737 36.244211 240.64 152.252632l-38.615579 38.615579C367.804632 461.285053 323.098947 431.157895 259.584 431.157895A151.983158 151.983158 0 0 0 107.789474 582.952421V754.526316h53.894737v-171.573895A98.007579 98.007579 0 0 1 259.584 485.052632c46.322526 0 79.629474 20.911158 137.027368 86.016l18.970948 21.530947 128.080842-128.080842C572.200421 435.981474 592.842105 415.366737 592.842105 377.263158v-97.926737l23.309474-14.120421-13.662316-23.04c-0.161684-0.242526-14.578526-24.899368-14.578526-50.688 0-19.132632 15.575579-34.708211 34.70821-34.708211 5.093053 0 26.785684 3.179789 39.558737 18.647579l26.327579 46.026106 39.774316-24.090948-20.372211-49.367579C704.754526 140.449684 700.631579 117.517474 700.631579 107.789474c0-29.722947 24.171789-53.894737 53.894737-53.894737s53.894737 24.171789 53.894737 53.894737v215.578947c0 85.935158 16.680421 145.300211 31.366736 197.632C851.887158 564.008421 862.315789 601.141895 862.315789 646.736842c0 95.285895-99.408842 161.684211-188.631578 161.684211h-209.461895l-68.419369-145.704421C375.242105 618.954105 338.108632 592.842105 296.448 592.842105A80.976842 80.976842 0 0 0 215.578947 673.711158V862.315789h53.894737v-188.604631c0-14.874947 12.099368-26.974316 26.974316-26.974316 20.533895 0 38.965895 14.147368 50.553263 38.858105L480.579368 970.105263h59.526737z" fill="#231F20" ></path></symbol><symbol id="icon-snake_si" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#FF8787" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-242.041263 180.762947l-52.116211-13.797052C657.219368 749.864421 651.425684 754.526316 619.789474 754.526316h-242.526316V485.052632h269.473684v53.894736h53.894737V215.578947H323.368421v538.947369c0 29.722947 24.171789 53.894737 53.894737 53.894737h242.526316c77.689263 0 91.189895-51.065263 108.274526-115.658106zM377.263158 269.473684h269.473684v161.684211H377.263158v-161.684211z" fill="#231F20" ></path></symbol><symbol id="icon-tiger_yin" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#7DD47F" ></path><path d="M970.105263 512c0 224.983579-163.166316 412.186947-377.263158 450.533053v-54.460632C777.135158 870.507789 916.210526 707.206737 916.210526 512c0-222.881684-181.328842-404.210526-404.210526-404.210526S107.789474 289.118316 107.789474 512s181.328842 404.210526 404.210526 404.210526c9.081263 0 18.000842-0.754526 26.947368-1.374315v53.894736c-8.973474 0.538947-17.866105 1.374316-26.947368 1.374316-252.604632 0-458.105263-205.500632-458.105263-458.105263S259.395368 53.894737 512 53.894737s458.105263 205.500632 458.105263 458.105263z m-257.42821 299.250526l-107.789474-53.894737-24.117895 48.208843 107.789474 53.894736 24.117895-48.208842z m-269.473685-5.658947l-24.117894-48.208842-107.789474 53.894737 24.117895 48.208842 107.789473-53.894737zM700.631579 431.157895h-161.684211v-53.894737h107.789474v-53.894737H377.263158v53.894737h107.789474v53.894737h-161.684211v323.368421h53.894737v-53.894737h269.473684v53.894737h53.894737V431.157895z m-161.684211 161.68421h107.789474v53.894737h-107.789474v-53.894737z m-161.68421 0h107.789474v53.894737h-107.789474v-53.894737z m161.68421-107.789473h107.789474v53.894736h-107.789474v-53.894736z m-161.68421 0h107.789474v53.894736h-107.789474v-53.894736zM754.526316 215.578947h-223.097263l-20.803369-62.410105-51.119158 17.057684L474.624 215.578947H269.473684v107.789474h53.894737v-53.894737h377.263158v53.894737h53.894737V215.578947z" fill="#231F20" ></path></symbol><symbol id="icon-snake" viewBox="0 0 1024 1024"><path d="M107.789474 790.474105c0-72.434526 67.880421-91.513263 121.451789-91.513263 74.401684 0 153.815579 34.438737 237.891369 70.925474 50.580211 21.935158 104.609684 45.325474 162.250105 63.083789-52.412632 44.786526-118.784 74.347789-195.152842 83.078737-143.171368 16.357053-326.440421 7.006316-326.440421-125.574737zM377.263158 215.578947c-15.575579 0-30.288842 3.449263-43.654737 9.377685A250.691368 250.691368 0 0 0 323.368421 296.421053c0 115.550316 76.422737 169.391158 137.83579 212.614736 8.138105 5.712842 16.141474 11.371789 23.848421 17.057685V323.368421a107.789474 107.789474 0 0 0-107.789474-107.789474z" fill="#C3D686" ></path><path d="M671.528421 788.857263c44.328421 11.964632 89.626947 19.563789 136.892632 19.56379 89.168842 0 161.684211-60.442947 161.68421-134.736842s-72.515368-134.736842-161.68421-134.736843c-19.078737 0-37.025684 1.509053-54.218106 4.015158-0.754526-101.402947-38.211368-172.355368-79.413894-219.648L673.684211 323.368421a1749.962105 1749.962105 0 0 1-79.036632-1.751579c45.702737 35.866947 108.705684 107.870316 105.984 232.367158 0 0.431158-0.080842 0.808421-0.10779 1.239579-34.923789 10.994526-66.155789 26.731789-95.097263 45.190737a163.085474 163.085474 0 0 0-15.845052-42.388211c-21.557895-39.639579-60.065684-66.775579-97.360842-93.022316C433.098105 423.343158 377.263158 384 377.263158 296.421053c0-130.290526 108.274526-188.631579 215.578947-188.631579 64.134737 0 132.715789 12.045474 214.366316 37.807158C802.330947 180.250947 780.099368 209.381053 700.631579 214.635789V161.684211h-53.894737v53.679157c-63.272421-1.024-104.528842-5.200842-104.986947-5.254736l-5.578106 53.598315C538.408421 263.949474 592.357053 269.473684 673.684211 269.473684c125.170526 0 188.631579-48.128 188.631578-143.063579V106.981053l-18.432-6.144C747.789474 68.823579 668.025263 53.894737 592.842105 53.894737c-158.666105 0-269.473684 99.732211-269.473684 242.526316 0 115.550316 76.422737 169.391158 137.83579 212.614736 33.684211 23.713684 65.509053 46.106947 81.003789 74.698106 9.539368 17.542737 13.285053 33.414737 12.341895 47.750737 21.153684 9.108211 42.118737 17.839158 62.949052 25.977263C671.151158 620.193684 729.977263 592.842105 808.421053 592.842105c59.445895 0 107.789474 36.271158 107.789473 80.842106s-48.343579 80.842105-107.789473 80.842105c-105.472 0-203.237053-42.388211-297.768421-83.429053-94.800842-41.094737-184.346947-79.952842-281.411369-79.952842C122.718316 591.171368 53.894737 644.715789 53.894737 727.578947c0 79.063579 67.098947 136.434526 159.555368 136.434527 142.174316 0 230.426947-66.883368 306.79579-129.886316 31.420632 13.419789 62.787368 26.058105 94.450526 37.133474-47.077053 49.637053-110.969263 82.566737-186.610526 91.270736l5.066105 53.625264c93.453474-7.006316 143.144421 9.350737 195.718737 26.543157 46.457263 15.225263 94.127158 30.854737 169.822316 30.854737 19.994947 0 41.957053-1.077895 66.344421-3.557052l-5.416421-53.625263c-105.283368 10.778947-158.100211-6.548211-213.935158-24.872422-22.150737-7.275789-44.624842-14.632421-70.305684-20.345263a334.848 334.848 0 0 0 96.14821-82.297263z m-458.078316 21.261474C162.573474 810.118737 107.789474 784.276211 107.789474 727.578947c0-60.847158 62.733474-82.539789 121.451789-82.539789 77.850947 0 154.731789 30.288842 235.250526 64.943158-66.263579 52.924632-139.722105 100.136421-251.041684 100.136421z" fill="#231F20" ></path></symbol><symbol id="icon-tiger" viewBox="0 0 1024 1024"><path d="M431.157895 162.250105V134.736842c0-41.552842-39.289263-80.842105-80.842106-80.842105-28.833684 0-57.128421 4.661895-58.314105 4.850526L269.473684 62.490947v83.887158C144.788211 223.824842 89.222737 346.839579 66.991158 431.157895h266.051368c240.747789 0 415.851789 107.789474 415.85179 269.473684-14.848-25.114947-43.924211-53.894737-88.68379-53.894737-67.988211 0-121.263158 71.033263-121.263158 161.684211 0 66.802526 30.477474 119.888842 60.712421 156.16 12.638316 15.171368 36.055579 37.726316 59.014737 58.88 5.066105 0.107789 9.781895 0.538947 15.009685 0.538947 219.297684 0 350.315789-191.811368 350.315789-377.263158C1024 327.545263 679.855158 172.813474 431.157895 162.250105z" fill="#F7C768" ></path><path d="M673.684211 1024c-114.768842 0-188.820211-33.333895-254.167579-62.787368-53.625263-24.144842-99.974737-45.002105-161.28-45.002106-40.448 0-83.590737 23.255579-103.639579 45.16379l-39.747369-36.432842C142.497684 894.787368 199.168 862.315789 258.236632 862.315789c68.392421 0 119.861895 21.288421 172.921263 45.056V673.684211c0-35.166316-17.542737-64.107789-30.639158-80.815158-15.198316 9.835789-32.067368 18.890105-50.741895 26.947368l-21.342316-49.475368C469.800421 509.413053 485.052632 377.317053 485.052632 323.368421V221.642105A597.827368 597.827368 0 0 0 404.210526 215.578947h-26.947368V134.736842c0-12.099368-14.848-26.947368-26.947369-26.947368-9.377684 0-18.836211 0.592842-26.947368 1.347368V269.473684h-53.894737V211.671579c-136.030316 102.912-158.450526 266.886737-161.306947 295.882105 9.135158 9.108211 38.992842 25.061053 71.976421 38.669474l38.103579-59.365053 12.449684-1.589894C321.212632 473.653895 377.263158 392.192 377.263158 323.368421h53.894737c0 88.333474-68.796632 192.242526-180.870737 213.342316l-48.397474 75.398737-20.291368-7.437474C53.894737 557.756632 53.894737 523.317895 53.894737 512c0-50.041263 37.025684-254.733474 215.578947-365.621895V62.490947l22.528-3.745684C293.187368 58.556632 321.482105 53.894737 350.315789 53.894737c41.552842 0 80.842105 39.289263 80.842106 80.842105v27.513263c248.697263 10.563368 592.842105 165.295158 592.842105 484.486737 0 185.451789-131.018105 377.263158-350.315789 377.263158z m-13.473685-323.368421c-36.513684 0-67.368421 49.367579-67.368421 107.789474 0 85.746526 68.096 145.084632 89.465263 161.549473 91.540211-2.533053 164.378947-45.487158 213.827369-107.654737H700.631579v-53.894736h230.238316c8.919579-17.273263 16.357053-35.354947 22.285473-53.894737h-239.885473l-6.467369-17.650527C706.290526 735.582316 692.439579 700.631579 660.210526 700.631579zM485.052632 931.112421c33.926737 14.066526 70.521263 26.597053 114.607157 33.468632C569.424842 928.309895 538.947368 875.223579 538.947368 808.421053c0-90.650947 53.274947-161.684211 121.263158-161.684211 44.759579 0 73.835789 28.779789 88.68379 53.894737h217.007158c2.775579-17.866105 4.203789-35.920842 4.203789-53.894737 0-38.938947-5.658947-74.752-15.925895-107.627789l-126.706526 126.679579-38.103579-38.103579L932.001684 485.052632a367.939368 367.939368 0 0 0-57.775158-81.596632l-154.543158 154.543158-38.103579-38.103579 153.573053-153.573053a537.869474 537.869474 0 0 0-82.593684-56.751158l-140.665263 140.638316-38.103579-38.103579 128.134737-128.134737A794.731789 794.731789 0 0 0 538.947368 231.046737V323.368421c0 50.149053-11.102316 156.698947-95.932631 236.328421 18.378105 23.417263 42.037895 63.407158 42.037895 113.987369v257.42821zM215.578947 431.157895v-53.894737c39.774316 0 53.894737-29.022316 53.894737-53.894737h53.894737c0 53.571368-37.025684 107.789474-107.789474 107.789474z" fill="#231F20" ></path></symbol><symbol id="icon-boar" viewBox="0 0 1024 1024"><path d="M732.079158 377.263158c-107.789474 0-186.421895 31.393684-281.869474 126.841263L180.331789 773.982316C257.724632 807.909053 348.725895 808.421053 485.052632 808.421053h96.013473c55.834947-34.411789 133.551158-53.894737 227.354948-53.894737h121.344L970.105263 680.555789V572.631579c0-94.315789-130.236632-195.368421-238.026105-195.368421z" fill="#FFBDD8" ></path><path d="M808.421053 700.631579v53.894737c-196.446316 0-323.368421 84.641684-323.368421 215.578947h-53.894737c0-163.705263 148.075789-269.473684 377.263158-269.473684z m-323.368421 107.789474v-53.894737c-158.342737 0-245.598316 0-319.649685-49.367579L158.612211 700.631579H80.842105c-21.692632 0-26.624-14.821053-26.947368-26.947368v-82.620632c84.156632-11.183158 161.684211-74.913684 161.68421-186.853053V215.578947H161.684211v161.684211H134.736842c-66.964211 0-134.736842 37.025684-134.736842 107.789474h53.894737c0-42.630737 52.870737-53.894737 80.842105-53.894737h24.629895C147.132632 504.912842 85.153684 538.947368 26.947368 538.947368H0v134.736843c0 32.498526 21.530947 80.842105 80.842105 80.842105h61.682527c32.687158 20.506947 67.125895 33.145263 105.957052 41.013895A232.879158 232.879158 0 0 0 215.578947 916.210526h53.894737c0-41.930105 14.012632-80.303158 39.424-112.505263C358.885053 808.151579 415.959579 808.421053 485.052632 808.421053z m-72.946527-342.420211L323.368421 554.738526V431.157895h-53.894737v253.682526l180.736-180.736-38.103579-38.103579zM323.368421 161.684211h-53.894737v190.032842a769.536 769.536 0 0 1 53.894737-49.098106V161.684211z m323.368421-53.894737c-72.623158 0-146.809263 23.336421-215.578947 58.637473V107.789474h-53.894737v154.138947C458.832842 205.392842 555.331368 161.684211 646.736842 161.684211c148.587789 0 269.473684 120.885895 269.473684 269.473684v235.654737L809.579789 862.315789h61.359158L970.105263 680.555789V431.157895c0-178.310737-145.057684-323.368421-323.368421-323.368421z" fill="#231F20" ></path></symbol><symbol id="icon-boar_hai" viewBox="0 0 1024 1024"><path d="M512 512m-296.421053 0a296.421053 296.421053 0 1 0 592.842106 0 296.421053 296.421053 0 1 0-592.842106 0Z" fill="#85C3DE" ></path><path d="M309.975579 804.756211l-27.136-46.592c103.073684-60.011789 183.026526-132.473263 241.475368-219.24379H350.315789l-13.473684-50.283789c58.88-33.980632 99.435789-117.571368 118.703158-165.295158H242.526316v-53.894737h538.947368v53.894737h-268.18021c-12.395789 34.088421-42.469053 106.603789-90.435369 161.68421h134.009263a680.555789 680.555789 0 0 0 46.349474-107.708631l51.092211 17.057684c-58.421895 175.265684-171.034947 309.490526-344.333474 410.381474z m192.350316-2.937264L467.806316 760.454737c88.414316-73.728 154.516211-158.773895 202.105263-259.907369l48.801684 22.959158a797.372632 797.372632 0 0 1-82.351158 137.781895c32.741053 15.009684 83.456 44.867368 137.647158 101.591579l-38.938947 37.268211c-57.236211-59.877053-109.325474-85.557895-133.766737-95.178106a850.997895 850.997895 0 0 1-98.977684 96.848842z m48.613052-536.872421l-80.842105-53.894737 29.884632-44.840421 80.842105 53.894737-29.884632 44.840421zM512 53.894737C259.395368 53.894737 53.894737 259.395368 53.894737 512s205.500632 458.105263 458.105263 458.105263c9.081263 0 17.973895-0.835368 26.947368-1.374316v-53.894736c-8.946526 0.619789-17.866105 1.374316-26.947368 1.374315-222.881684 0-404.210526-181.328842-404.210526-404.210526S289.118316 107.789474 512 107.789474s404.210526 181.328842 404.210526 404.210526c0 195.206737-139.075368 358.507789-323.368421 396.045474v54.460631c214.096842-38.346105 377.263158-225.549474 377.263158-450.533052C970.105263 259.395368 764.604632 53.894737 512 53.894737z" fill="#231F20" ></path></symbol><symbol id="icon-bilibili1" viewBox="0 0 1129 1024"><path d="M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75H212.377a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0" fill="#20B0E3" ></path><path d="M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0" fill="#20B0E3" ></path></symbol><symbol id="icon-yinle" viewBox="0 0 1024 1024"><path d="M512.2976 0a531.2 531.2 0 0 0-512 548.48V960h128V548.48a398.72 398.72 0 0 1 384-411.52 398.72 398.72 0 0 1 384 411.52V960h128V548.48A531.2 531.2 0 0 0 512.2976 0z" fill="#5c8add" ></path><path d="M64.2976 576l256 0 0 448-256 0 0-448Z" fill="#5c8add" ></path><path d="M704.2976 576l256 0 0 448-256 0 0-448Z" fill="#5c8add" ></path></symbol><symbol id="icon-icon-test-copy" viewBox="0 0 1024 1024"><path d="M512 512m-229.517241 0a229.517241 229.517241 0 1 0 459.034482 0 229.517241 229.517241 0 1 0-459.034482 0Z" fill="#5c8add" ></path><path d="M512 1024A512 512 0 1 1 1024 512 512 512 0 0 1 512 1024z m0-141.241379A370.758621 370.758621 0 1 0 141.241379 512 370.758621 370.758621 0 0 0 512 882.758621z" fill="#5c8add" ></path></symbol><symbol id="icon-V" viewBox="0 0 1024 1024"><path d="M1012.47774251 492.58192592L544.94137566 87.22962963a49.96686561 49.96686561 0 0 0-65.88275132 0L11.63784127 492.6975097c-21.03624691 18.26223633-23.3479224 49.93219048-5.08568606 70.96843739 18.03106878 21.03624691 49.93219048 23.3479224 70.96843738 5.08568607L512 191.83294532l434.71057495 376.91868784c9.47786949 8.20644797 21.26741446 12.25188008 32.82579189 12.13629629 14.10122046 0 27.97127337-5.77918871 38.02706173-17.33756613 18.14665256-20.92066314 15.95056084-52.70620106-5.08568606-70.9684374z" fill="#5c8add" ></path><path d="M109.30613051 567.59579541V896.89396825c0 42.53482892 34.90629982 77.44112875 77.44112875 77.44112875h220.76500882V666.30433862c0-25.54401411 20.92066314-46.46467725 46.46467724-46.46467724h116.16169313c25.54401411 0 46.46467725 20.92066314 46.46467725 46.46467724V974.335097h220.76500882c42.53482892 0 77.44112875-34.90629982 77.44112874-77.44112875l0.11558377-329.29817284L512 218.18604586 109.30613051 567.59579541zM848.00203175 197.49655027h-63.91782716c-12.82979894 0-23.23233862 10.40253968-23.23233863 23.23233862v24.27259259l110.49808818 95.70336508V220.72888889h-0.11558377c0-12.82979894-10.40253968-23.23233862-23.23233862-23.23233862zM905.44716754 83.18419754s-34.90629982 56.86721693-89.11508994 100.32671603c152.68616579 13.98563668 127.83565432-133.26809171 127.83565432-133.2680917-134.07717813-10.28695591-132.92134039 102.29164021-131.072 127.83565432 20.92066314-20.92066314 49.70102293-62.64640564 92.35143562-94.89427865zM798.53217637 174.61096297c-19.64924162-16.52847972-40.56990476-43.45949912-51.203612-53.97762258 0 0 32.94137566 20.57391182 56.40488184 49.3542716 2.42725926-18.37782011 6.47269135-93.3916896-93.16052205-85.3008254 0 0-13.98563668 104.71889947 87.95925221 89.92417638z" fill="#5c8add" ></path></symbol><symbol id="icon-zhifeiji" viewBox="0 0 1167 1024"><path d="M41.201759 463.52493L1110.665064 30.117647c10.32605-4.159104 21.942857 0.860504 26.101961 11.043137 1.434174 3.728852 1.864426 7.744538 1.003921 11.616807L949.033691 978.823529c-2.151261 10.89972-12.764146 17.927171-23.663865 15.632493-2.72493-0.573669-5.306443-1.721008-7.601121-3.298599L634.80624 789.79944l-163.065546 133.951821c-16.492997 13.62465-40.87395 11.186555-54.498599-5.306443-3.011765-3.728852-5.306443-7.887955-6.884034-12.477311l-102.973669-313.080112-265.178712-91.787115c-10.469468-3.585434-16.062745-15.058824-12.333893-25.528291 1.864426-5.44986 6.023529-9.895798 11.329972-12.047059z" fill="#FCFDFC" ></path><path d="M929.385512 1023.569748c-3.155182 0-6.453782-0.286835-9.752381-1.003922-6.740616-1.434174-12.907563-4.015686-18.50084-8.031372L635.953579 825.940616l-146.142297 120.040336c-13.911485 11.473389-31.408403 16.779832-49.335574 15.058824-17.927171-1.721008-34.133333-10.32605-45.463305-24.237535-5.306443-6.453782-9.322129-13.768067-11.903642-21.79944l-98.527731-299.598879-251.697479-87.19776c-12.333894-4.302521-22.229692-13.05098-27.966386-24.811204s-6.453782-24.954622-2.151261-37.288515c4.589356-13.337815 14.771989-23.9507 27.82297-29.257143L1099.908761 3.585434c24.954622-10.039216 53.351261 2.007843 63.533894 26.819048 3.585434 8.891877 4.445938 18.644258 2.581513 28.109804L977.143495 984.560224c-4.732773 23.090196-25.098039 39.009524-47.757983 39.009524z m-294.579272-233.770308l282.962465 201.357983c2.294678 1.577591 4.87619 2.72493 7.601121 3.298599 10.89972 2.151261 21.512605-4.87619 23.663865-15.632493L1137.914364 52.777591c0.860504-3.872269 0.430252-7.887955-1.003922-11.616807-4.159104-10.32605-15.919328-15.202241-26.101961-11.043137L41.201759 463.52493c-5.306443 2.151261-9.465546 6.597199-11.47339 12.047059-1.721008 5.019608-1.434174 10.469468 0.860505 15.345658 2.294678 4.87619 6.453782 8.461625 11.473389 10.182633l265.178711 91.787115L410.214644 905.967507c1.434174 4.589356 3.872269 8.748459 6.884033 12.477311 6.597199 8.031373 15.919328 12.907563 26.101961 13.911485 10.32605 1.003922 20.365266-2.007843 28.396639-8.605042l163.208963-133.951821z" fill="#4A4A4A" ></path><path d="M307.097557 592.743978l105.698599 316.091876c6.310364 18.787675 26.532213 28.970308 45.319888 22.659944 4.159104-1.434174 7.887955-3.442017 11.186555-6.166946l164.786555-133.951821-165.360224-118.892997c297.017367-287.982073 447.462185-433.980952 451.191036-437.853222 0.573669-0.573669 2.581513-3.442017 0.430252-7.027451-1.290756-1.577591-3.298599-3.298599-7.027451-2.15126-202.218487 120.327171-404.293557 242.805602-606.22521 367.291877z" fill="#CAE0EE" ></path><path d="M446.786072 934.794398c-5.736695 0-11.329972-1.290756-16.636414-3.872269-8.891877-4.445938-15.632493-12.047059-18.787675-21.512605L305.376549 592.313725l1.003921-0.573669C507.308201 467.684034 711.391114 344.058263 912.60568 224.161345l0.286835-0.143418c3.585434-1.147339 6.310364-0.286835 8.605042 2.581513l0.143417 0.143417c2.438095 4.015686 0.573669 7.457703-0.573669 8.74846-3.872269 4.015686-155.177591 150.87507-450.043698 436.705882l165.503642 119.036414-166.220728 135.09916c-3.442017 2.868347-7.457703 5.019608-11.760225 6.453782-3.728852 1.290756-7.744538 2.007843-11.760224 2.007843z m-137.967507-341.333334l105.268348 314.944538c2.868347 8.748459 9.035294 15.77591 17.210084 19.935014 8.17479 4.159104 17.496919 4.732773 26.245378 1.864426 3.872269-1.290756 7.60112-3.298599 10.756302-5.880112l163.352381-132.804482L466.434252 672.627451l1.290756-1.147339C763.308201 384.932213 915.043775 237.642577 918.772627 233.626891c0 0 2.007843-2.294678 0.286835-5.306443-1.003922-1.290756-2.438095-2.438095-5.306443-1.577591-200.784314 119.610084-404.293557 242.94902-604.934454 366.718207z" fill="#CAE0EE" ></path><path d="M460.840974 924.898599l7.457703-253.561904 165.933894 119.896918-168.658824 135.959664c-1.290756 1.003922-3.011765 0.860504-4.015686-0.430252-0.430252-0.430252-0.717087-1.147339-0.717087-1.864426z" fill="#94C3E2" ></path><path d="M463.709322 929.344538c-1.290756 0-2.438095-0.573669-3.2986-1.577591-0.573669-0.860504-1.003922-1.864426-1.003921-2.868348l7.60112-256.286834 169.519328 122.621848-1.434174 1.147339-168.658823 135.959664c-0.860504 0.717087-1.721008 1.003922-2.72493 1.003922z m6.023529-255.282913l-7.457703 250.836974c0 0.286835 0.143417 0.717087 0.286835 1.003922 0.430252 0.573669 1.434174 0.717087 2.007843 0.286835l167.22465-134.812325-162.061625-117.315406z" fill="#94C3E2" ></path></symbol><symbol id="icon-lianjie" viewBox="0 0 1079 1024"><path d="M695.355535 432.666896c-0.553495-1.10699-0.885592-2.186305-1.383737-3.265619-0.193723-0.193723-0.193723-0.359772-0.359771-0.719543-12.508983-26.318678-39.436506-43.366319-69.325226-41.013966-39.076734 3.265619-68.439634 39.021384-65.312388 79.841627 0.857917 10.516401 3.653066 20.147211 7.998 28.83708 19.78744 46.659613 11.097571 103.448181-25.377737 141.750022l-191.094085 199.950001a118.088119 118.088119 0 0 1-171.998513 0c-47.434506-49.537786-47.434506-130.098956 0-179.636742l71.234782-74.389703-0.52582-0.553494a75.911814 75.911814 0 0 0 24.326097-61.880721c-3.127246-40.820243-37.3609-71.51153-76.437634-68.24591a69.463599 69.463599 0 0 0-46.908685 23.966325l-0.166049-0.193723-72.618519 75.856464c-103.226783 107.793115-103.226783 282.36538 0 390.158495 103.171433 107.793115 270.299193 107.793115 373.498301 0l191.619904-200.1714c80.256748-83.992838 97.636485-208.307773 52.83108-310.289193z" fill="#5c8add" ></path><path d="M1002.047012 80.865592c-103.226783-107.82079-270.382217-107.82079-373.581325 0l-191.619905 200.199075c-80.284423 83.854464-97.66416 208.197074-52.997128 310.233843 0.52582 1.079315 0.857917 2.15863 1.383737 3.26562 0.166048 0.166048 0.166048 0.359772 0.332097 0.719543 12.536658 26.291004 39.46418 43.366319 69.3529 41.013966 39.076734-3.265619 68.439634-39.021384 65.312388-79.869302a78.679288 78.679288 0 0 0-7.998-28.864755c-19.78744-46.631938-11.097571-103.448181 25.377737-141.750022l191.287808-199.839302a118.088119 118.088119 0 0 1 172.026188 0c47.434506 49.537786 47.434506 130.126631 0 179.692091l-71.234782 74.417378 0.52582 0.553495a75.939489 75.939489 0 0 0-24.353772 61.88072c3.15492 40.847917 37.3609 71.51153 76.465309 68.245911a69.463599 69.463599 0 0 0 46.908685-23.938651l0.166049 0.166048 72.646194-75.856464c103.03306-107.82079 103.03306-282.642127 0-390.269194z" fill="#5c8add" ></path></symbol><symbol id="icon-liaotian" viewBox="0 0 1171 1024"><path d="M1068.71699 0.243751H102.193768C46.228437 0.243751 0.500666 45.045267 0.500666 99.74309v696.251622c0 54.697824 45.727771 99.450589 101.693102 99.450589h329.113198l120.851966 114.465677a48.652788 48.652788 0 0 0 66.641644 0l120.851966-114.465677h329.064448c55.965331 0 101.741852-44.752765 101.741852-99.450589V99.74309C1170.458842 45.045267 1124.682321 0.243751 1068.71699 0.243751z m-439.776354 596.849784h-370.989696c-27.933915 0-50.846551-22.425133-50.846551-49.774045 0-27.348912 22.912636-49.725294 50.846551-49.725294h370.989696c27.933915 0 50.846551 22.376382 50.846551 49.725294 0 27.348912-22.912636 49.774045-50.846551 49.774045z m287.18795-211.381252H254.782171a50.456549 50.456549 0 0 1-50.846551-49.725294c0-27.397662 22.912636-49.774045 50.846551-49.774045h661.346415c27.933915 0 50.846551 22.376382 50.846551 49.774045 0 27.348912-22.912636 49.725294-50.846551 49.725294z" fill="#5C8ADD" ></path></symbol><symbol id="icon-xinfeng" viewBox="0 0 1400 1024"><path d="M1301.63733163 214.78520234a207.81921797 207.81921797 0 0 1 7.02423018 52.42036465v489.73590176a205.10753818 205.10753818 0 0 1-205.05853125 205.05853125H283.05853124A205.15654424 205.15654424 0 0 1 77.99999999 756.79444971V267.20556699a201.36672685 201.36672685 0 0 1 7.02423106-52.42036465L586.24393329 562.1905874c69.44187217 51.96297217 146.36536612 49.13694404 214.1736961 0zM1103.60303056 62.0000167H283.05853124A204.50312753 204.50312753 0 0 0 106.37462518 163.41030547l489.71956641 335.75823018c62.43397646 50.77048623 127.85733457 50.31309463 194.62019765 0L1280.28693749 163.41030547A204.68281729 204.68281729 0 0 0 1103.60303056 62.0000167z m0 0" fill="#5c8add" ></path></symbol><symbol id="icon-QQ1" viewBox="0 0 1024 1024"><path d="M0 512a512 512 0 1 0 1024 0A512 512 0 1 0 0 512z" fill="#18ACFC" ></path><path d="M500.113 228.39c118.396-1.518 178.924 61.004 201 156 3.497 15.048 0.15 34.807 0 50 27.143 5.682 33.087 60.106 10 75v1h1c8.26 14.33 19.04 28.125 26 44 7.332 16.723 9.306 35.16 14 55 4.024 17.01-2.287 51.505-10 57-0.771 0.683-2.231 1.312-3 2-14.601-3.016-30.377-16.865-38-27-3.065-4.074-5.275-9.672-10-12-0.395 21.568-12.503 41.15-22 55-3.514 5.123-14.073 13.217-14 18 3.691 2.836 8.305 2.956 13 5 10.513 4.577 25.449 13.168 32 22 2.334 3.146 5.548 7.555 7 11 16.193 38.414-36.527 48.314-63 54-27.185 5.839-77.818-10.224-92-19-8.749-5.414-16.863-18.573-29-19-3.666 2.389-14.438 1.132-20 1-16.829 32.804-101.913 47.868-148 31-14.061-5.146-43.398-17.695-38-40 4.437-18.327 19.947-29.224 35-37 5.759-2.975 18.915-4.419 22-10-13.141-8.988-24.521-28.659-31-44-3.412-8.077-4.193-25.775-9-32-7.789 12.245-32.097 36.91-52 33-3.071-4.553-7.213-9.097-9-15-4.792-15.835-1.81-40.379 2-54 8.117-29.02 16.965-50.623 32-72 4.672-6.643 11.425-12.135 16-19-8.945-9.733-6.951-37.536-1-49 4.002-7.709 9.701-7.413 10-20-1.92-3.022-0.071-8.604-1-13-4.383-20.75 3.273-47.552 9-63 19.8-53.421 53.712-90.466 105-112 11.986-5.033 25.833-7.783 39-11 5.322-1.3 11.969 0.518 16-2z" fill="#FFFFFF" ></path></symbol><symbol id="icon-rss" viewBox="0 0 1024 1024"><path d="M749.61196492 908.06119793C749.61196492 560.41848146 463.58151854 274.36328126 115.93880207 274.36328126V115.93880207c434.50388795 0 792.12239584 357.61850789 792.12239586 792.12239586zM224.55858562 690.72261555a108.91682943 108.91682943 0 0 1 108.69404499 108.74355267C333.25263061 859.29616292 284.24005737 908.06119793 224.31104736 908.06119793 164.48105265 908.06119793 115.96355592 859.41993206 115.96355592 799.46616822s48.69077351-108.71879883 108.61978351-108.74355267zM641.01693522 908.06119793h-153.96879069c0-203.60020956-167.50913289-371.13409627-371.10934246-371.13409629v-153.96879068c288.03550619 0 525.07813313 237.11688843 525.07813315 525.10288697z" fill="#FFA500" ></path></symbol><symbol id="icon-youxiang" viewBox="0 0 1024 1024"><path d="M583.60666667 972h-68.08c-8.43333333 0-15.33333333-6.9-15.33333334-15.33333333V609.52c0-8.43333333 6.9-15.33333333 15.33333334-15.33333333h68.08c8.43333333 0 15.33333333 6.9 15.33333333 15.33333333V956.66666667c0 8.43333333-6.9 15.33333333-15.33333333 15.33333333z" fill="#629FF9" ></path><path d="M294.42 167c-113.62 0-205.77333333 92-205.77333333 205.31333333v336.72h411.39333333V372.31333333c0.15333333-113.31333333-92-205.31333333-205.62-205.31333333z" fill="#2166CC" ></path><path d="M519.97333333 627H216.98666667c-25.45333333 0-46-20.54666667-46-46V393.78c0-25.45333333 20.54666667-46 46-46h302.98666666c25.45333333 0 46 20.54666667 46 46V581c0 25.45333333-20.54666667 46-46 46z" fill="#D2E4FF" ></path><path d="M565.97333333 397a49.22 49.22 0 0 0-49.37333333-49.22H220.36c-27.29333333 0-49.37333333 22.08-49.37333333 49.22v10.27333333l179.4 94.60666667c11.34666667 5.98 24.84 5.98 36.18666666 0l179.4-94.60666667v-10.27333333z" fill="#FFFFFF" ></path><path d="M730.5 167h-427.8v0.46c109.78666667 4.29333333 197.49333333 94.3 197.49333333 205.00666667v336.72h411.39333334c27.29333333 0 49.37333333-22.08 49.37333333-49.22V397c0-126.96-103.19333333-230-230.46-230z" fill="#4E8DF6" ></path><path d="M845.80666667 52H681.12666667c-9.04666667 0-16.40666667 7.36-16.40666667 16.40666667v336.72a24.67133333 24.67133333 0 1 0 49.37333333 0V134.18666667h131.71333334c9.04666667 0 16.40666667-7.36 16.40666666-16.40666667V68.40666667c0-9.04666667-7.36-16.40666667-16.40666666-16.40666667z" fill="#2166CC" ></path><path d="M896.25333333 659.81333333h-35.11333333c-8.43333333 0-15.33333333-6.9-15.33333333-15.33333333v-35.11333333c0-8.43333333 6.9-15.33333333 15.33333333-15.33333334h35.11333333c8.43333333 0 15.33333333 6.9 15.33333334 15.33333334v35.11333333c0 8.58666667-6.9 15.33333333-15.33333334 15.33333333z" fill="#FFFFFF" ></path><path d="M88.8 709.18666667l-24.22666667 131.40666666c-9.66 54.43333333 26.83333333 98.59333333 81.26666667 98.59333334h213.9c54.58666667 0 106.56666667-44.16 116.22666667-98.59333334l23.15333333-131.40666666H88.8z" fill="#2974CE" ></path></symbol><symbol id="icon-gitHub" viewBox="0 0 1049 1024"><path d="M523.6581816 52C262.83923907 52 52 262.8401375 52 523.6581816c0 208.49703047 135.09433812 384.97758117 322.50789391 447.44906532 23.42658172 4.68531653 32.01647887-10.15136894 32.01647796-22.64584583 0-10.93210574-0.78163433-48.41463703-0.78163433-87.45953855-131.18885996 28.11189824-158.5200223-56.22379738-158.52002231-56.22379739-21.08437312-54.66232469-52.3201152-68.71827336-52.3201152-68.71827335-42.94858371-28.89353348 3.12384382-28.89353348 3.12384384-28.89353348 47.63479867 3.12384382 72.62285398 48.41643391 72.62285398 48.4164339 42.16784782 71.84121875 110.10538527 51.53758242 137.43654672 39.04400399 3.90457972-30.45500618 16.3990566-51.5393793 29.67427028-63.25222094-104.64023039-10.93300418-214.74561566-51.53848086-214.74561657-232.70524742 0-51.53848086 18.74126609-93.70632867 48.4164339-126.50444187-4.68621496-11.71284164-21.08527156-60.12837711 4.6844181-124.94207075 0 0 39.82563922-12.49447688 129.62738726 48.41463704 37.48253129-10.15136894 78.08980484-15.61742227 117.91454562-15.61742137s80.43201433 5.46605242 117.91454473 15.61742137c89.80264648-60.90911391 129.62828571-48.41463703 129.62828571-48.41463704 25.76879122 64.81369363 9.37063305 113.22922911 4.68531651 124.94207075 30.45410773 32.79721477 48.41463703 74.96506258 48.41463703 126.50444187 0 181.16676656-110.10538527 220.99150644-215.52545401 232.70524742 17.1797934 14.83668547 32.01647887 42.94858371 32.01647886 87.45953946 0 63.25222094-0.78163433 114.009965-0.78163523 129.62738636 0 12.49447688 8.59079468 27.33116234 32.01737731 22.64584583 187.41265734-62.4705866 322.50699547-238.95203574 322.50699546-447.44996375C995.31636231 262.8401375 783.69369203 52 523.6581816 52z" fill="#663399" ></path><path d="M230.82365863 729.03136735c-0.7807359 2.34310703-4.68531653 3.12384382-7.80916035 1.56237113s-5.46605242-4.68531653-3.90368129-7.02842356c0.7807359-2.34220859 4.68531653-3.12384382 7.80826192-1.56147269s4.68531653 4.68531653 3.90457972 7.02752512z m18.7412661 21.08437312c-2.34220859 2.34220859-7.02752512 0.78163433-9.37063305-2.34310703-3.12294539-3.12294539-3.90457972-7.80826192-1.5614727-10.15136894 2.34220859-2.34220859 6.24678922-0.7807359 9.37063305 2.34310702 3.12384382 3.90457972 3.90457972 8.58899782 1.5614727 10.15136895zM268.30618992 777.44690281c-3.12294539 2.34220859-7.80826192 0-10.15136895-3.90457972-3.12384382-3.90457972-3.12384382-9.37063305 0-10.93210574 3.12384382-2.34310703 7.80916035 0 10.15226739 3.90457972 3.12294539 3.90368129 3.12294539 8.58899782 0 10.93210574z m25.76968965 26.55042555c-2.34220859 3.12294539-7.80916035 2.34220859-12.49447688-1.56237113-3.90457972-3.90368129-5.46605242-9.37063305-2.34220859-11.71284164 2.34220859-3.12384382 7.80826192-2.34310703 12.49447687 1.56147269 3.90368129 3.12384382 4.68531653 8.58989625 2.3422086 11.71374008z m35.1403227 14.83668637c-0.78163433 3.90457972-6.24768766 5.46605242-11.71374008 3.90457972-5.46605242-1.5614727-8.58899782-6.24768766-7.80916036-9.37063305 0.78163433-3.90457972 6.24768766-5.46605242 11.71374009-3.90457972 5.46605242 1.5614727 8.58899782 5.46605242 7.80916035 9.37063305z m38.26416562 3.12384382c0 3.90457972-4.68621496 7.02752512-10.15226738 7.02752512-5.46605242 0-10.15226738-3.12294539-10.15226739-7.02752512s4.68621496-7.02842356 10.15226739-7.02842445c5.46605242 0 10.15226738 3.12384382 10.15226738 7.02842445z m35.92016106-6.24768766c0.78163433 3.90457972-3.12384382 7.80916035-8.58899872 8.58989625-5.46695086 0.78163433-10.15226738-1.5614727-10.93390172-5.46605241-0.77983747-3.90457972 3.12384382-7.80916035 8.5907947-8.58899872 5.46605242-0.78163433 10.15136894 1.56057426 10.93210574 5.46515488z m0 0" fill="#663399" ></path></symbol><symbol id="icon-bilibili" viewBox="0 0 1024 1024"><path d="M832.61667555 181.33447111h-164.32545185l74.45617778-74.45617778c12.84020148-12.84020148 12.84020148-30.8140563 0-43.65425778-12.84020148-12.84020148-30.8140563-12.84020148-43.65425778 0L573.2882963 189.04101925H450.04420741L324.2272237 63.23617185c-10.26730667-12.84020148-25.68040297-15.40096-41.08136295-7.70654815-2.57289482 0-2.57289482 2.57289482-5.13365334 5.13365333-12.84020148 12.84020148-12.84020148 30.8140563 0 43.65425779l77.02907259 77.02907259h-164.32545185c-89.86927408 0-164.32545185 74.45617778-164.32545185 164.32545184v408.24073483c0 87.29637925 74.45617778 161.75255703 164.32545185 161.75255703h25.68040296c0 30.8140563 25.68040297 53.92156445 53.92156444 53.92156444s53.92156445-25.68040297 53.92156445-53.92156444H704.23893333c2.57289482 30.8140563 28.24116148 53.92156445 59.05521778 51.34866964 28.24116148-2.57289482 48.78791111-23.10750815 51.34866964-51.34866964h20.53461333c89.86927408 0 164.32545185-74.45617778 164.32545184-164.32545186V343.09916445c-2.56075852-89.86927408-77.02907259-161.76469333-166.88621037-161.76469334z m-5.13365333 634.19429926H200.99527111c-33.37481482 0-59.05521778-28.24116148-61.61597629-61.61597629l-2.57289482-415.94728297c0-33.37481482 28.24116148-61.6159763 61.6159763-61.61597629h626.48775111c33.37481482 0 59.05521778 28.24116148 61.61597629 61.61597629l2.57289482 415.94728297c-2.57289482 35.93557333-28.24116148 61.6159763-61.6159763 61.61597629z" fill="#ff7299" ></path><path d="M403.82919111 417.55534222l15.40096 77.0290726-205.40681481 38.50846815-15.40096-77.0290726 205.40681481-38.50846815z m197.70026667 77.0290726l15.40096-77.0290726 205.40681481 38.50846815-15.40096 77.0290726-205.40681481-38.50846815z m41.08136297 161.75255703c0 2.57289482 0 7.70654815-2.57289483 10.26730667-12.84020148 28.24116148-41.08136297 46.2150163-74.45617777 48.78791111-20.53461333 0-41.08136297-10.26730667-53.92156445-25.68040296-15.40096 15.40096-33.37481482 25.68040297-53.92156445 25.68040296-30.8140563-2.57289482-59.05521778-20.53461333-74.45617777-48.78791111 0-2.57289482-2.57289482-5.13365333-2.57289481-10.26730667 0-10.26730667 7.70654815-17.97385482 17.97385481-20.53461333h2.57289482c7.70654815 0 12.84020148 2.57289482 15.40096 10.26730666 0 0 20.53461333 28.24116148 38.50846815 28.24116149 35.94770963 0 35.94770963-30.8140563 56.48232296-53.92156445 23.10750815 25.68040297 23.10750815 53.92156445 56.48232296 53.92156445 23.10750815 0 38.50846815-28.24116148 38.50846815-28.24116149 2.57289482-5.13365333 10.26730667-10.26730667 15.40096-10.26730666 10.26730667-2.57289482 17.97385482 5.13365333 20.53461333 15.40096v5.13365333h0.0364089z" fill="#ff7299" ></path></symbol></svg>',      o = (o = document.getElementsByTagName("script"))[o.length - 1].getAttribute("data-injectcss"),      p = function (c, l) {        l.parentNode.insertBefore(c, l);      };    if (o && !c.__iconfont__svg__cssinject__) {      c.__iconfont__svg__cssinject__ = !0;      try {        document.write(          "<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>"        );      } catch (c) {        console && console.log(c);      }    }    function d() {      i || ((i = !0), a());    }    function m() {      try {        t.documentElement.doScroll("left");      } catch (c) {        return void setTimeout(m, 50);      }      d();    }    (l = function () {      var c,        l = document.createElement("div");      (l.innerHTML = v),        (v = null),        (l = l.getElementsByTagName("svg")[0]) &&          (l.setAttribute("aria-hidden", "true"),          (l.style.position = "absolute"),          (l.style.width = 0),          (l.style.height = 0),          (l.style.overflow = "hidden"),          (l = l),          (c = document.body).firstChild ? p(l, c.firstChild) : c.appendChild(l));    }),      document.addEventListener        ? ~["complete", "loaded", "interactive"].indexOf(document.readyState)          ? setTimeout(l, 0)          : ((h = function () {              document.removeEventListener("DOMContentLoaded", h, !1), l();            }),            document.addEventListener("DOMContentLoaded", h, !1))        : document.attachEvent &&          ((a = l),          (t = c.document),          (i = !1),          m(),          (t.onreadystatechange = function () {            "complete" == t.readyState && ((t.onreadystatechange = null), d());          }));  })(window);]]></content>
      
    </entry>
    
    
  
</search>
